/*! For license information please see main.ae91f222aaa6b8ca5113.js.LICENSE.txt */
(()=>{var e={4479:e=>{e.exports=function(e){var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.innerDocument?n("v-row",{staticClass:"mb-1",class:{"docum-list-item__container-preview":e.isPreviewMode,"docum-list-item__container":!e.isPreviewMode},attrs:{"no-gutters":""}},[e.isFullMode?n("v-col",{staticStyle:{overflow:"hidden"},attrs:{md:"12"}},[n("v-card",{staticClass:"elevation-0"},[n("v-row",{attrs:{align:"center","no-gutters":""}},[n("v-row",{staticClass:"card-mobile",attrs:{"no-gutters":""}},[n("v-card-title",{staticClass:"px-0 py-0 card-tile"},[n("v-row",{attrs:{justify:"space-between","no-gutters":""}},[n("v-col",[n("div",{staticClass:"card-header"},[e.fromInstruction?n("v-icon",{staticClass:"description",attrs:{color:"primary",size:"22"}},[e._v("description")]):e._e(),n("document-template-renderer",{attrs:{document:e.innerDocument,"template-type":e.templateType,context:e.actionPanelContext,"lazy-card-actions-counter":e.lazyCardActionsCounter},on:{"set-card-actions":e.onSetCardActions,"set-card-actions-overlay":e.onSetCardActionsOverlay,"card-mounted":e.onCardMounted,"card-updated":e.onCardMounted}}),n("v-spacer"),e.fromInstruction?n("v-btn",{staticClass:"square-sm-button rounded-button elevation-0 grey document-button",class:{"lighten-2":e.selected,"grey lighten-3":e.fromInstruction&&!e.selected},on:{click:function(t){return e.$emit("open-origin-document")}}},[n("v-icon",{staticClass:"chrome-reader-mode",attrs:{color:"grey darken-2"}},[e._v("chrome_reader_mode")])],1):e._e()],1)]),n("v-col",{attrs:{cols:"auto"}},[e.innerDocument.viewFlag?e._e():n("v-avatar",{staticClass:"ml-2 mt-1",attrs:{size:"12",color:"error"}})],1)],1)],1),e.isContentTypeDocument?n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"selected"}]},[e.displayMainFile?n("v-col",{staticClass:"grey lighten-5"},[n("ld-attachment",{attrs:{file:e.innerDocument.mainFile}})],1):e._e()],1):e._e()],1)],1),e.isContentTypeDocument?n("v-card-actions",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"selected"}],staticClass:"px-0 pt-1 pb-2 action-mobile",attrs:{flat:""}},[n("action-panel",{attrs:{visible:!0,context:e.actionPanelContext,selected:e.selected,"custom-actions":e.customActions,"action-overlays":e.actionOverlays},on:{refresh:e.refreshItem}})],1):e._e()],1)],1):e._e()],1):e._e()},t=[];e.options["mobile-template"]=render,e.options["static-mobile-template"]=t}},95289:(e,t,n)=>{"use strict";var i,o,s;n.d(t,{Us:()=>i,uE:()=>o,Ao:()=>s}),function(e){e[e["Create"]=0]="Create",e[e["Edit"]=1]="Edit",e[e["Remove"]=2]="Remove"}(i||(i={})),function(e){e[e["None"]=0]="None",e[e["Error"]=1]="Error",e[e["Cancel"]=2]="Cancel",e[e["Open"]=3]="Open",e[e["OpenHere"]=4]="OpenHere",e[e["OpenModal"]=5]="OpenModal",e[e["Completed"]=6]="Completed",e[e["Link"]=7]="Link",e[e["Close"]=8]="Close"}(o||(o={})),function(e){e[e["None"]=0]="None",e[e["Updated"]=1]="Updated",e[e["NeedUpdate"]=2]="NeedUpdate",e[e["NeedUpdateList"]=3]="NeedUpdateList",e[e["RemoveFromFolder"]=4]="RemoveFromFolder"}(s||(s={}))},2557:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i={None:Symbol.for("None"),Login:Symbol.for("Login"),ToDashboard:Symbol.for("ToDashboard"),ToMessages:Symbol.for("ToMessages"),ToArchiveMessages:Symbol.for("ToArchiveMessages"),ToDocuments:Symbol.for("ToDocuments"),ToArchiveDocuments:Symbol.for("ToArchiveDocuments"),ToReports:Symbol.for("ToReports"),ToHistory:Symbol.for("ToHistory"),ToFavorites:Symbol.for("ToFavorites"),ToArchive:Symbol.for("ToArchive"),ToSettings:Symbol.for("ToSettings"),ToSearch:Symbol.for("ToSearch"),ToNotFound:Symbol.for("ToNotFound"),ToDssRedirect:Symbol.for("ToDssRedirect"),ToVocabularies:Symbol.for("ToVocabularies"),ToKanban:Symbol.for("ToKanban"),ToError:Symbol.for("ToError"),AcceptReport:Symbol.for("AcceptReport"),SendReport:Symbol.for("SendReport"),SendRejectionReport:Symbol.for("SendRejectionReport"),ViewMessage:Symbol.for("ViewMessage"),ViewVocabulary:Symbol.for("ViewVocabulary"),CreateMessage:Symbol.for("CreateMessage"),CreateReport:Symbol.for("CreateReport"),EditReport:Symbol.for("EditReport"),RepeatInstruction:Symbol.for("RepeatInstruction"),Edit:Symbol.for("Edit"),Replace:Symbol.for("Replace"),RedirectInstruction:Symbol.for("RedirectInstruction"),RedirectReportAsReport:Symbol.for("RedirectReportAsReport"),RedirectReportAsInstruction:Symbol.for("RedirectReportAsInstruction"),RepeatChain:Symbol.for("RepeatChain"),ToWork:Symbol.for("ToWork"),Revoke:Symbol.for("Revoke"),Archive:Symbol.for("Archive"),Restore:Symbol.for("Restore"),RemoveMessage:Symbol.for("RemoveMessage"),MoveToFolder:Symbol.for("MoveToFolder"),Link:Symbol.for("Link"),SetMessageReaded:Symbol.for("SetMessageReaded"),SetMessageUnreaded:Symbol.for("SetMessageUnreaded"),CreateDoc:Symbol.for("CreateDoc"),ViewDoc:Symbol.for("ViewDoc"),EditDoc:Symbol.for("EditDoc"),AddToFavourite:Symbol.for("AddToFavourite"),CreateShortcut:Symbol.for("CreateShortcut"),SendMessage:Symbol.for("SendMessage"),SetDocReaded:Symbol.for("SetDocReaded"),SetDocUnreaded:Symbol.for("SetDocUnreaded"),CardCustomAction:Symbol.for("CardCustomAction"),DeleteDoc:Symbol.for("DeleteDoc"),RemoveShortcut:Symbol.for("RemoveShortcut"),ArchiveDoc:Symbol.for("ArchiveDoc"),ViewDocumentData:Symbol.for("ViewDocumentData"),CreateFastReport:Symbol.for("CreateFastReport"),ViewFastReport:Symbol.for("ViewFastReport"),DownloadResult:Symbol.for("DownloadResult"),RepeatReport:Symbol.for("RepeatReport"),ToHome:Symbol.for("Home"),ToAdmin:Symbol.for("ToAdmin"),ToMvp:Symbol.for("ToMvp")}},69798:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={LaterDefine:Symbol.for("LaterDefine"),None:Symbol.for("none"),Dashboard:Symbol.for("Dashboard"),Login:Symbol.for("Login"),Messages:Symbol.for("Messages"),Documents:Symbol.for("Documents"),Reports:Symbol.for("Reports"),History:Symbol.for("History"),Favorites:Symbol.for("Favorites"),Archive:Symbol.for("Archive"),Settings:Symbol.for("Settings"),Search:Symbol.for("Search"),Vocabularies:Symbol.for("Vocabularies"),Kanban:Symbol.for("Kanban"),NotFound:Symbol.for("NotFound"),DssRedirecting:Symbol.for("DssRedirecting"),Error:Symbol.for("Error"),ViewingMessage:Symbol.for("ViewingMessage"),CreatingMessage:Symbol.for("CreatingMessage"),CreatingReport:Symbol.for("CreatingReport"),RepetitionMessage:Symbol.for("RepetitionMessage"),RedirectingMessage:Symbol.for("RedirectingMessage"),ReplacingMessage:Symbol.for("ReplacingMessage"),RepeatingChain:Symbol.for("RepeatingChain"),EditingMessage:Symbol.for("EditingMessage"),RedirectingReportAsInstruction:Symbol.for("RedirectingReportAsInstruction"),CreatingDoc:Symbol.for("CreatingDoc"),ViewingDoc:Symbol.for("ViewingDoc"),EditingDoc:Symbol.for("EditingDoc"),CreatingFastReport:Symbol.for("CreatingFastReport"),ViewingFastReport:Symbol.for("ViewingFastReport"),ViewingVocabulary:Symbol.for("ViewingVocabulary"),StatReport:Symbol.for("StatReport"),Mvp:Symbol.for("Mvp"),Admin:Symbol.for("Admin")}},40051:(e,t,n)=>{"use strict";n.d(t,{o:()=>toStr,M:()=>g});var i=n(95289),o=n(2557),s=n(64447),r=n(43867),a=n(1869),l=n(92673),c=n(98917),d=n(86700),u=n(66671),p=n.n(u),h=n(59859),m=n.n(h),f=n(69798),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const toStr=e=>Symbol.keyFor(e);let g=class Application{constructor(e,t,n,i){this._container=e,this._queryBus=t,this._logger=n,this.transitions=i,this._fsm=new(p())({observeUnchangedState:!0,init:toStr(f.Z.None),transitions:i,methods:{onTransition:this.onTransition.bind(this),onAfterTransition:this.onAfterTransition.bind(this),onBeforeTransition:this.onBeforeTransition.bind(this)},plugins:[new(m())({max:10})]})}get fsm(){return this._fsm}get lastTransition(){return this._transition}can(e){return this._fsm.can(toStr(e))}destStateForTransition(e,t){const n=this._fsm.seek(toStr(e),t);return f.Z[n]}back(){setTimeout((()=>{try{this._fsm.historyBack()}catch(e){this._logger.error(e)}}))}get state(){return f.Z[this._fsm.state]}onAfterTransition(e,t){if(this._transition)return e.prevResult}onBeforeTransition(e,t,n,i){return __awaiter(this,void 0,void 0,(function*(){if(this._action=null,this._cancelReason="",!(yield this.checkAccess(f.Z[e.to],t,n,i)))return this._cancelReason="Недостаточно прав для осуществления операции",!1;let getFinishState=()=>f.Z[e.from];if(e.from!==e.to&&f.Z[e.to]!==f.Z.LaterDefine)return!0;const s=Object.keys(o.k).find((t=>t.toLowerCase()===e.transition.toLowerCase()));if(!s)return!0;try{let n;const i=this._container.get(o.k[s]);if(i)try{if(e.from===e.to)n=f.Z[e.to];else if(getFinishState=i.getFinishState.bind(i),n=getFinishState.call(i,f.Z[e.from],t,null),!n)throw new Error(`FSM could not define finish state for transition ${e.transition}`);if(toStr(n)===e.from)return this._action=i,!1}catch(e){return this._logger.error(e),!0}}catch(e){this._onAbort&&this._onAbort(e)}return!0}))}onTransition(e,t,n,r){return __awaiter(this,void 0,void 0,(function*(){let a,l=null;try{if(!t)return a=!0,a;a=n;let d,getFinishState=()=>f.Z[e.from];if(!n){const n=Object.keys(o.k).find((t=>t.toLowerCase()===e.transition.toLowerCase()));if(n)try{if(d=this._container.get(o.k[n]),d&&(getFinishState=d.getFinishState.bind(d),a=yield d.execAsync(t,r),!a||!("type"in a)))throw new Error(`onEnterState to ${e.to}: handler for ${e.transition} don't have return value OR return value is not IActionResult`)}catch(t){if(t instanceof c.Ol)e.to=e.from;else if(t instanceof s.$Q&&t.error){const n=t.error.exception;n instanceof c.Ol&&(e.to=e.from)}else if(t.message&&t.message.includes("onEnterState to"))throw t}}if(e.to===toStr(f.Z.LaterDefine)){if(!getFinishState||!d)throw new Error('Not found "getFinishState" method');{let n=getFinishState.call(d,f.Z[e.from],t,a);if(!n)throw new Error(`FSM could not define finish state for transition ${e.transition}`);n===f.Z.LaterDefine&&(n=f.Z[e.from]),e.to=toStr(n)}}if(a)switch(a.type){case i.uE.Cancel:throw new c.Ol("Transition is cancelled");case i.uE.Open:case i.uE.Link:yield this.open(t,a,r);break;case i.uE.OpenHere:yield this.openHere(t,a,r);break;case i.uE.None:case i.uE.Completed:return!1;default:break}return a}catch(e){return l=e,!1}finally{null===l||void 0===l?this._onComplete&&setTimeout((()=>this._onComplete(a))):this._onAbort&&setTimeout((()=>this._onAbort(l)))}}))}abortTransition(){this.back()}go(e,t,n,o){return __awaiter(this,void 0,void 0,(function*(){let s,a=null;const l=new Promise((e=>{a=e}));this._onComplete=e=>a(e!==s&&"boolean"===typeof s?e:s),this._onAbort=e=>{this._logger.debug("onAbort in go !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),e instanceof c.Ol||e instanceof c.Mk?a({type:i.uE.Cancel,status:i.Ao.None,data:e}):a({type:i.uE.Error,status:i.Ao.None,data:e})};let d=!1;try{const c=this.getTransitionFunc(e);if(s=yield c.call(this._fsm,t,n,o),!s&&this._cancelReason)return this.state===f.Z.None&&setTimeout((()=>{this._queryBus.exec(new r.m("",this._cancelReason)),this.goHome()})),{type:i.uE.Error,status:i.Ao.None,message:this._cancelReason};if(!s&&this._action&&(d=!0,s=yield this._action.execAsync(t,o)),s&&"object"!==typeof s){const e={type:i.uE.None,status:i.Ao.None,data:s};s=e}return d&&a(s),l}catch(e){return this._logger.error(e),d&&a({type:i.uE.Cancel,status:i.Ao.None,data:e}),{type:i.uE.Cancel,status:i.Ao.None}}}))}forcedTransiton(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.getTransitionFunc(e),n=yield t.call(this.fsm);return!(!n&&this._cancelReason)||(this.state===f.Z.None&&setTimeout((()=>{this._queryBus.exec(new r.m("",this._cancelReason)),this.goHome()})),!1)}))}getTransitionFunc(e){this._transition=e;const t=this._fsm[toStr(e).toLowerCase()];if(!t)throw new Error(`The transition ${toStr(e)} is not exist in FSM`);return t}};g=__decorate([(0,d.b2)(),__param(0,(0,d.f3)(l.t.Container)),__param(1,(0,d.f3)(a.M.IQueryBus)),__param(2,(0,d.f3)(l.t.ILogger)),__param(3,(0,d.f3)(l.t.FsmTransitions)),__metadata("design:paramtypes",[d.W2,Object,Object,Array])],g)},4842:(e,t,n)=>{"use strict";n.d(t,{e:()=>l});var i=n(66860),o=n(1869),s=n(92673),r=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const a="login returns wrong response";let l=class AuthService{constructor(e,t){this._log=e,this._queryBus=t}basicLogin(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this._queryBus.exec(new i.iA(e,t));if("object"!==typeof n)throw new Error(a);return this._log.debug(`${e} is logged in successful`,n),n}catch(e){throw this._log.error(e),e}}))}winLogin(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this._queryBus.exec(new i.U2);if("object"!==typeof e)throw new Error(a);return this._log.debug("windows user is logged in successful",e),e}catch(e){throw this._log.error(e),e}}))}certLogin(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this._queryBus.exec(new i.Lv);if("object"!==typeof e)throw new Error(a);return this._log.debug("windows user is logged in successful",e),e}catch(e){throw this._log.error(e),e}}))}logout(){return __awaiter(this,void 0,void 0,(function*(){try{yield this._queryBus.exec(new i.RU),this._log.debug("current user is logged out")}catch(e){this._log.error(e)}}))}};l=__decorate([(0,r.b2)(),__param(0,(0,r.f3)(s.t.ILogger)),__param(1,(0,r.f3)(o.M.IQueryBus)),__metadata("design:paramtypes",[Object,Object])],l)},22713:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(67472),o=n(81086),s=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let r=class DocumentService{static getDocItemTitle(e){try{if(e.attributes)return`№${e.attributes.RegistrationNumber} ${(0,o.v)(e.attributes.RegistrationDate,"DD.MM.YYYY hh:mm")}`}catch(e){return console.error("getDocItemTitle",e),"-"}}static createEmptyAttributes(e){if(!Array.isArray(e))return{};const t={};return e.forEach((e=>{switch(e.columnType){case i.cV.Date:case i.cV.DateTime:t[e.fieldName]=null;break;case i.cV.Number:t[e.fieldName]=0;break;case i.cV.String:t[e.fieldName]="";break;default:t[e.fieldName]=null;break}})),t}};r=__decorate([(0,s.b2)()],r)},97625:(e,t,n)=>{"use strict";n.d(t,{X:()=>p});var i=n(43857),o=n(73043),s=n(22337),r=n(20386),a=n(58226),l=n(31025),c=n(92673),d=n(13319),u=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let p=class InstructionService{constructor(e,t,n){this.$config=e,this.$log=t,this._queryBus=n}static userNameShorting(e){return(0,d.nO)(e)}static getSentType(e){switch(e){case o.z.FanWithExecutive:return"Параллельная рассылка с ответственным исполнителем";case o.z.Fan:return"Параллельная рассылка без ответственного исполнителя";case o.z.ChainWithExecutive:return"Последовательная рассылка с ответственным исполнителем";default:return"Последовательная рассылка без ответственного исполнителя"}}static getInstructionTitle(e){try{const t=l.C.dateToString(new Date(e.createDateTime));return`${e.creatorName} от ${t}`}catch(t){console.error("Couldn't create instruction title",t,e)}return"-"}static validateReportRequiredFields(e,t){if(!t)return"";const n=!(0,d.hr)(e.text),o=Boolean(e.document)||e.files&&e.files.length;switch(t){case i.A.NoCheck:return null;case i.A.HasText:return n?null:'Поле "Отчет" должно быть заполнено';case i.A.HasDocument:return o?null:'Поле "Ответный документ" должно быть заполнено';case i.A.HasTextAndDocument:return n&&o?null:'Поля "Отчет" и "Ответный документ" должны быть заполнены';case i.A.HasTextOrDocument:return n||o?null:'Поле "Отчет" или "Ответный документ" должны быть заполнены';default:return null}}checkFilesVersions(e){return e&&e.filter((e=>21===e.objectType))}checkFileVersions(e){return __awaiter(this,void 0,void 0,(function*(){if(e&&e.fileId){const t=yield this._queryBus.exec(new s.MZ(e.fileId,"ListItem"));return t.filter((t=>t.VerN>e.verN)).length}return 0}))}newFileVersionAlert(e,t){return __awaiter(this,void 0,void 0,(function*(){let n=!1;return t?n=yield this._queryBus.exec(new r.l("Подтверждение",t)):e&&(n=yield this._queryBus.exec(new r.l("Подтверждение",`В файлы документа были внесены изменения с момента отправки Вам данного сообщения.<br>\n          Действие "${(0,d.kC)(e)}" будет выполнено только над актуальными (последними) версиями файлов документа, которые могут отличаться от первоначальных. Продолжить?`))),!!n}))}};p=__decorate([(0,u.b2)(),__param(0,(0,u.f3)(c.t.Config)),__param(1,(0,u.f3)(c.t.ILogger)),__param(2,(0,u.f3)(a.b)),__metadata("design:paramtypes",[Object,Object,Object])],p)},60917:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var i=n(76748),o=n(92673),s=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}};let r=class PubSubService{constructor(e,t,n){this._log=e,this._domainEventProvider=t,this._outerEventProvider=n,this._callBacksWithParams={}}on(e,t,n,o=i.Q.Both){try{Array.isArray(e)||(e=[e]);let s=t;return Array.isArray(n)&&n.length&&(s=e=>{let i=!0;if(e.length<n.length)i=!1;else for(let t=0;t<n.length;t++){const o=n[t];if(o!==e[t]){i=!1;break}}i&&t.apply(this,e)},e.forEach((e=>{this._callBacksWithParams[e]||(this._callBacksWithParams[e]=[]),this._callBacksWithParams[e].push({callback:t,params:n,newCb:s})}))),[i.Q.Client,i.Q.Both].includes(o)&&this._domainEventProvider.on(e,s),[i.Q.Server,i.Q.Both].includes(o)&&e.forEach((e=>this._outerEventProvider.on(e,s))),this}catch(e){this._log.error(e)}}off(e,t,n){try{return Array.isArray(e)||(e=[e]),e.forEach((e=>{let i=t;if(Array.isArray(n)&&n.length){const t=this._callBacksWithParams[e];let o=null,s=-1;if(t)for(let e=0;e<t.length;e++){const i=t[e];if(s=e,o=i,i.params.length<n.length)o=null;else{for(let e=0;e<n.length;e++){const t=n[e];if(t!==i.params[e]){o=null;break}}if(o)break}}else o=!1;o&&(i=o.newCb,this._callBacksWithParams[e].splice(s,1))}this._domainEventProvider.off(e,i),this._outerEventProvider.off(e,i)})),this}catch(e){this._log.error(e)}}domainEmit(e,...t){return this._domainEventProvider.emit(e,t),this}serverEmit(e,...t){return this._outerEventProvider.emit(e,t),this}};r=__decorate([(0,s.b2)(),__param(0,(0,s.f3)(o.t.ILogger)),__param(1,(0,s.f3)(o.t.IDomainEventProvider)),__param(2,(0,s.f3)(o.t.IOuterEventProvider)),__metadata("design:paramtypes",[Object,Object,Object])],r)},34170:(e,t,n)=>{"use strict";n.d(t,{FJ:()=>CardNewCommand,ji:()=>CardUpdateCommand,Mu:()=>CardDeleteCommand,IQ:()=>CardActivateCommand,E3:()=>CardUnzipCommand,sH:()=>CardExportCommand,xr:()=>CardImportCommand});class CardNewCommand{constructor(e,t,n,i){this.cardId=e,this.type=t,this.data=n,this.components=i}}class CardUpdateCommand{constructor(e,t,n,i,o){this.id=e,this.cardId=t,this.type=n,this.data=i,this.components=o}}class CardDeleteCommand{constructor(e){this.version=e}}class CardActivateCommand{constructor(e){this.version=e}}class CardUnzipCommand{constructor(e){this.fileInfo=e}getFormData(){const e=new FormData;return e.append("file",this.fileInfo.file),e}}class CardExportCommand{constructor(e){this.data=e}}class CardImportCommand{constructor(e){this.data=e}}},22402:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});const i={ICommandBus:Symbol.for("ICommandBus"),InstructionCreateDocCommand:Symbol.for("InstructionCreateDocCommand"),InstructionAddFilesCommand:Symbol.for("InstructionAddFilesCommand"),CreateMessageCommand:Symbol.for("CreateMessageCommand"),SendMessageCommand:Symbol.for("SendMessageCommand"),EditMessageCommand:Symbol.for("EditMessageCommand"),PutHistoryCommand:Symbol.for("PutHistoryCommand"),RemoveMessageCommand:Symbol.for("RemoveMessageCommand"),RepeatMessageCommand:Symbol.for("RepeatMessageCommand"),ReplaceMessageCommand:Symbol.for("ReplaceMessageCommand"),RedirectMessageCommand:Symbol.for("RedirectMessageCommand"),InstructionSendReportCommand:Symbol.for("InstructionSendReportCommand"),InstructionCreateReportProjectCommand:Symbol.for("InstructionCreateReportProjectCommand"),InstructionUpdateReportCommand:Symbol.for("InstructionUpdateReportCommand"),AcceptReportCommand:Symbol.for("AcceptReportCommand"),NoticeCloseCommand:Symbol.for("NoticeCloseCommand"),ViewStateCommand:Symbol.for("ViewStateCommand"),PutLastVisibledCommand:Symbol.for("PutLastVisibledCommand"),DocumentSaveCommand:Symbol.for("DocumentSaveCommand"),DocumentPartialSaveCommand:Symbol.for("DocumentPartialSaveCommand"),DocumentAddFileCommand:Symbol.for("DocumentAddFileCommand"),DeleteDocumentSheafCommand:Symbol.for("DeleteDocumentSheafCommand"),CreateDocumentSheafCommand:Symbol.for("CreateDocumentSheafCommand"),DocumentUnreadedCommand:Symbol.for("DocumentUnreadedCommand"),DocumentReadedCommand:Symbol.for("DocumentReadedCommand"),CopyFilesCommand:Symbol.for("CopyFilesCommand"),DocumentCreateChortcutCommand:Symbol.for("DocumentCreateChortcutCommand"),CallMethodCommand:Symbol.for("CallMethodCommand"),CopyOperationsCommand:Symbol.for("CopyOperationsCommand"),DocumentCreateShortcutCommand:Symbol.for("DocumentCreateShortcutCommand"),DocumentRemoveShortcutCommand:Symbol.for("DocumentRemoveShortcutCommand"),ExecScriptCommand:Symbol.for("ExecScriptCommand"),CreateDocumentsFolderCommand:Symbol.for("CreateDocumentsFolderCommand"),DeleteDocumentsFolderCommand:Symbol.for("DeleteDocumentsFolderCommand"),EditDocumentsFolderCommand:Symbol.for("EditDocumentsFolderCommand"),AddToFavouriteCommand:Symbol.for("AddToFavouriteCommand"),RemoveFromFavouriteCommand:Symbol.for("RemoveFromFavouriteCommand"),LdObjectCreateCommand:Symbol.for("LdObjectCreateCommand"),CancelJob:Symbol.for("CancelJob"),LdObjectUpdateCommand:Symbol.for("LdObjectUpdateCommand"),ArchiveDocCommand:Symbol.for("ArchiveDocCommand"),DeleteFileCommand:Symbol.for("DeleteFileCommand"),DeleteFileVersionCommand:Symbol.for("DeleteFileVersionCommand"),AddFileVersionCommand:Symbol.for("AddFileVersionCommand"),AddFileToIndexCommand:Symbol.for("AddFileToIndexCommand"),SaveStampsFileCommand:Symbol.for("SaveStampsFileCommand"),LockObjectCommand:Symbol.for("LockObjectCommand"),UnlockObjectCommand:Symbol.for("UnlockObjectCommand"),AddAttachmentCommand:Symbol.for("AddAttachmentCommand"),UpdateAttachmentCommand:Symbol.for("UpdateAttachmentCommand"),AddAttachmentVersionCommand:Symbol.for("AddAttachmentVersionCommand"),RenameAttachmentCommand:Symbol.for("RenameAttachmentCommand"),SaveAdminSettingsCommand:Symbol.for("SaveAdminSettingsCommand"),SaveUserSettingsCommand:Symbol.for("SaveUserSettingsCommand"),SaveUserSettingsPartiallyCommand:Symbol.for("SaveUserSettingsPartiallyCommand"),VocabularyItemCreateCommand:Symbol.for("VocabularyItemCreateCommand"),VocabularyItemUpdateCommand:Symbol.for("VocabularyItemUpdateCommand"),VocabularyItemSaveCommand:Symbol.for("VocabularyItemSaveCommand"),VocabularyItemDeleteCommand:Symbol.for("VocabularyItemDeleteCommand"),VocabularyItemLogicalDeleteCommand:Symbol.for("VocabularyItemLogicalDeleteCommand"),DownloadFileFromLdToR7Command:Symbol.for("DownloadFileFromLdToR7Command"),DownloadFileToR7Command:Symbol.for("DownloadFileToR7Command"),SaveEditingFileViaR7Command:Symbol.for("SaveEditingFileViaR7Command")}},64447:(e,t,n)=>{"use strict";n.d(t,{yr:()=>CommandError,$Q:()=>CommandResult,kj:()=>PutHistoryCommand,CF:()=>SetDeputyCommand,iR:()=>AddDeputyCommand,dw:()=>DeleteDeputyCommand,z_:()=>PutLastVisibledCommand,lF:()=>CallMethodCommand,O0:()=>ExecScriptCommand,L$:()=>RegisterExternalComponentCommand});class CommandError{constructor(e,t,n,i){this.exception=t,this.data=n,this.notDisplayError=i,Array.isArray(e)?this._messages=e:this._messages=[{name:"",text:e}],this.exception&&this.exception instanceof CommandError&&(this.exception=this.exception.exception)}get message(){let e="";return this._messages.forEach((t=>{t.name&&(e+=`${t.name} - `),t.text&&(e+=`${t.text}\r\n`)})),e}get messages(){return this._messages}}class CommandResult{constructor({value:e=null,error:t=null}={}){this.value=e,this.error=t}get isFailure(){return null!==this.error}get message(){return this.error?this.error.message:""}}class PutHistoryCommand{constructor(e,t){this.id=e,this.historyItemType=t}}class SetDeputyCommand{constructor(e,t){this.userId=e,this.fromRemote=t}}class AddDeputyCommand{constructor(e,t,n){this.deputyIds=e,this.beginDate=t,this.endDate=n}}class DeleteDeputyCommand{constructor(e){this.replacerUserId=e}}class PutLastVisibledCommand{constructor(e){this.url=e}}class CallMethodCommand{constructor(e,t,n,i){this.entity=e,this.method=t,this.parameters=n,this.fromRemote=i}}class ExecScriptCommand{constructor(e,t){this.scriptName=e,this.scriptParams=t}}class RegisterExternalComponentCommand{constructor(e,t,n,i){this.name=e,this.sfc=t,this.manifest=n,this.mixin=i}}},66422:(e,t,n)=>{"use strict";n.d(t,{fG:()=>ComponentCreateCommand,MT:()=>ComponentUpdateCommand,l1:()=>ComponentDeleteCommand,QM:()=>ComponentAddVersionCommand,QQ:()=>ComponentUpdateVersionCommand,oc:()=>ComponentDeleteVersionCommand,$H:()=>ComponentUnzipCommand,Aq:()=>ComponentExportCommand,CF:()=>ComponentImportCommand});class ComponentCreateCommand{constructor(e,t){this.code=e,this.name=t}}class ComponentUpdateCommand{constructor(e){this.component=e}}class ComponentDeleteCommand{constructor(e){this.code=e}}class ComponentAddVersionCommand{constructor(e,t,n){this.code=e,this.root=t,this.data=n}}class ComponentUpdateVersionCommand{constructor(e,t,n,i){this.id=e,this.code=t,this.root=n,this.data=i}}class ComponentDeleteVersionCommand{constructor(e){this.version=e}}class ComponentUnzipCommand{constructor(e){this.fileInfo=e}getFormData(){const e=new FormData;return e.append("file",this.fileInfo.file),e}}class ComponentExportCommand{constructor(e){this.data=e}}class ComponentImportCommand{constructor(e){this.data=e}}},72519:(e,t,n)=>{"use strict";n.d(t,{Tv:()=>AddDashboardCommand,Nu:()=>EditDashboardCommand,VE:()=>DeleteDashboardCommand,PA:()=>ClearDashboardsCommand,v5:()=>SelectDashboardCommand});class AddDashboardCommand{constructor(e,t,n,i){this.dashboardName=e,this.isDefault=t,this.isCommon=n,this.selected=i}}class EditDashboardCommand{constructor(e,t){this.guid=e,this.editedDashboard=t}}class DeleteDashboardCommand{constructor(e){this.guid=e}}class ClearDashboardsCommand{}class SelectDashboardCommand{constructor(e){this.guid=e}}},32904:(e,t,n)=>{"use strict";n.d(t,{Lt:()=>DocumentSaveCommand,WX:()=>DocumentPartialSaveCommand,Ae:()=>DocumentEditCommand,p2:()=>DocumentCreateCommand,gZ:()=>DocumentAddFileCommand,ek:()=>DocumentCreateShortcutCommand,Qy:()=>DocumentRemoveShortcutCommand,j2:()=>LdObjectCreateCommand,Ff:()=>LdObjectUpdateCommand,wp:()=>LdObjectDeleteCommand,$6:()=>DocumentReadedCommand,ng:()=>DocumentUnreadedCommand,Yb:()=>DocumentDeleteLogic,OH:()=>CreateDocumentSheafCommand,CS:()=>DeleteDocumentSheafCommand,cS:()=>CopyFilesCommand,m3:()=>CopyOperationsCommand,eC:()=>ArchiveDocCommand,b1:()=>SetJournalNumerationCommand,DS:()=>CreateDocumentsFolderCommand,eS:()=>DeleteDocumentsFolderCommand,YS:()=>EditDocumentsFolderCommand,Ml:()=>AddToFavouriteCommand,Wl:()=>RemoveFromFavouriteCommand});var i=n(50103);class DocumentSaveCommand{constructor(e,t,n,o,s,r,a,l=i.dS.Edit){this.attributes=e,this.referencesToAdd=t,this.referencesToDelete=n,this.id=o,this.journalId=s,this.documentTypeId=r,this.document=a,this.mode=l}}class DocumentPartialSaveCommand{constructor(e,t,n=i.dS.Edit){this.id=e,this.attributes=t,this.mode=n}}class DocumentEditCommand{constructor(e,t){this.id=e,this.document=t}}class DocumentCreateCommand{constructor(e,t){this.journalId=e,this.document=t}}class DocumentAddFileCommand{constructor(e,t,n,i){this.docId=e,this.name=t,this.file=n,this.typeId=i}}class DocumentCreateShortcutCommand{constructor(e,t){this.documentId=e,this.folderId=t}}class DocumentRemoveShortcutCommand{constructor(e,t){this.documentId=e,this.folderId=t}}class LdObjectCreateCommand{constructor(e,t,n){this.objectName=e,this.names=t,this.values=n}}class LdObjectUpdateCommand{constructor(e,t,n){this.objectId=e,this.names=t,this.values=n}}class LdObjectDeleteCommand{constructor(e,t,n){this.objectName=e,this.names=t,this.values=n}}class DocumentReadedCommand{constructor(e,t){this.id=e,this.journalId=t}}class DocumentUnreadedCommand{constructor(e,t){this.id=e,this.journalId=t}}class DocumentDeleteLogic{constructor(e,t){this.id=e,this.journalId=t}}class CreateDocumentSheafCommand{constructor(e,t,n,i){this.parentID=e,this.childID=t,this.sheafTypeID=n,this.comment=i}}class DeleteDocumentSheafCommand{constructor(e){this.id=e}}class CopyFilesCommand{constructor(e,t,n=!1){this.docId=e,this.fileIds=t,this.isCopyEsign=n}}class CopyOperationsCommand{constructor(e,t){this.recepientId=e,this.sourceDocId=t}}class ArchiveDocCommand{constructor(e,t,n){this.docId=e,this.journalId=t,this.isArchive=n}}class SetJournalNumerationCommand{constructor(e,t,n){this.journalId=e,this.currentNumber=t,this.year=n}}class CreateDocumentsFolderCommand{constructor(e,t){this.parentID=e,this.name=t}}class DeleteDocumentsFolderCommand{constructor(e){this.folderId=e}}class EditDocumentsFolderCommand{constructor(e,t,n){this.folderId=e,this.name=t,this.parentID=n}}class AddToFavouriteCommand{constructor(e){this.journalId=e}}class RemoveFromFavouriteCommand{constructor(e){this.journalId=e}}},69927:(e,t,n)=>{"use strict";n.d(t,{c:()=>PutTaskCommand,w:()=>AttachResultToDocCommand});class PutTaskCommand{constructor(e,t,n,i,o){this.reportUid=e,this.userParameters=t,this.documentId=n,this.alias=i,this.selectedObjectId=o}}class AttachResultToDocCommand{constructor(e,t){this.taskId=e,this.documentId=t}}},45154:(e,t,n)=>{"use strict";n.d(t,{Hq:()=>DeleteFileCommand,gm:()=>DeleteFileVersionCommand,Of:()=>AddFileToConvertCommand,lQ:()=>AddFileToIndexCommand,xC:()=>RenameFileCommand,Eq:()=>SaveStampsFileCommand,gL:()=>AddFileVersionCommand,de:()=>DownloadFileFromLdToR7Command,oE:()=>DownloadFileToR7Command,uO:()=>UnlockForceFileCommand,O_:()=>AttachFileTemplateToDocumentCommand,GY:()=>SaveEditingFileViaR7Command});class DeleteFileCommand{constructor(e,t){this.documentId=e,this.fileId=t}}class DeleteFileVersionCommand{constructor(e,t,n){this.documentId=e,this.fileId=t,this.versionId=n}}class AddFileToConvertCommand{constructor(e,t,n){this.versionId=e,this.convertType=t,this.documentId=n}}class AddFileToIndexCommand{constructor(e,t,n,i,o,s,r){this.fileId=e,this.ownerObjectType=t,this.ownerObjectId=n,this.contentId=i,this.contentName=o,this.file=s,this.metadata=r}}class RenameFileCommand{constructor(e,t){this.fileId=e,this.name=t}}class SaveStampsFileCommand{constructor(e,t){this.versionId=e,this.data=t}}class AddFileVersionCommand{constructor(e,t){this.fileId=e,this.data=t}}class DownloadFileFromLdToR7Command{constructor(e,t=""){this.fileid=e,this.r7Path=t}}class DownloadFileToR7Command{constructor(e,t,n=""){this.fileName=e,this.data=t,this.r7Path=n}}class UnlockForceFileCommand{constructor(e){this.fileid=e}}class AttachFileTemplateToDocumentCommand{constructor(e,t){this.documentId=e,this.path=t}}class SaveEditingFileViaR7Command{constructor(e){this.key=e}}},29256:(e,t,n)=>{"use strict";n.d(t,{R3:()=>InstructionCreateDocCommand,eY:()=>InstructionAddFilesCommand,BN:()=>CreateMessageCommand,AT:()=>SendMessageCommand,ud:()=>SendMessageSimpleCommand,gR:()=>EditMessageCommand,cu:()=>RemoveMessageCommand,y0:()=>RevokeMessageCommand,M3:()=>MessageToArchiveCommand,xS:()=>RestoreMessageCommand,b9:()=>MessageToWorkCommand,Xw:()=>MoveToFolderCommand,Ck:()=>RepeatMessageCommand,Hp:()=>ReplaceMessageCommand,mH:()=>ReplaceMessageOnlyCommand,Ut:()=>RedirectMessageCommand,Gm:()=>InstructionSendReportCommand,_S:()=>InstructionCreateReportProjectCommand,Vr:()=>InstructionUpdateReportCommand,g$:()=>InstructionAcceptReportCommand,zv:()=>RedirectReportAsMessageCommand,Id:()=>InstructionRepeatChainCommand,Ub:()=>InstructionReadedCommand,xd:()=>InstructionUnreadedCommand,Hd:()=>AddFavoriteReceiverCommand,SI:()=>DeleteFavoriteReceiverCommand,FO:()=>CreateFolderCommand,W2:()=>DeleteFolderCommand,wX:()=>UpdateFolderCommand,jM:()=>CreateFolderRuleCommand,BE:()=>EditFolderRuleCommand,aX:()=>DeleteFolderRuleCommand});class InstructionCreateDocCommand{constructor(e,t,n){this.documentTypeId=e,this.journalId=t,this.annotation=n}}class InstructionAddFilesCommand{constructor(e,t){this.documentId=e,this.data=t}}class CreateMessageCommand{constructor(e){this.message=e}}class SendMessageCommand{constructor({message:e,saveBeforeSend:t,srcInstructionId:n=null,srcReportId:i=null}){this.message=e,this.saveBeforeSend=t,this.srcInstructionId=n,this.srcReportId=i}}class SendMessageSimpleCommand{constructor(e){this.message=e}}class EditMessageCommand{constructor(e){this.message=e}}class RemoveMessageCommand{constructor(e,t){this.id=e,this.folderId=t}}class RevokeMessageCommand{constructor(e,t,n){this.id=e,this.revokeChain=t,this.folderId=n}}class MessageToArchiveCommand{constructor(e,t){this.id=e,this.folderId=t}}class RestoreMessageCommand{constructor(e,t){this.id=e,this.folderId=t}}class MessageToWorkCommand{constructor(e,t){this.id=e,this.folderId=t}}class MoveToFolderCommand{constructor(e,t,n){this.id=e,this.srcFolderId=t,this.destFolderId=n}}class RepeatMessageCommand{constructor(e,t){this.reportId=e,this.info=t}}class ReplaceMessageCommand{constructor(e,t){this.id=e,this.info=t}}class ReplaceMessageOnlyCommand{constructor(e,t){this.instructionId=e,this.receiverID=t}}class RedirectMessageCommand{constructor(e,t){this.id=e,this.message=t}}class InstructionSendReportCommand{constructor(e,t,n,i,o){this.instructionId=e,this.report=t,this.folder=n,this.completionTypeId=i,this.useLastVersion=o}}class InstructionCreateReportProjectCommand{constructor(e,t,n){this.instructionId=e,this.report=t,this.folder=n}}class InstructionUpdateReportCommand{constructor(e,t){this.report=e,this.folder=t}}class InstructionAcceptReportCommand{constructor(e,t){this.reportId=e,this.folder=t}}class RedirectReportAsMessageCommand{constructor(e,t,n){this.reportId=e,this.message=t,this.folder=n}}class InstructionRepeatChainCommand{constructor(e,t,n){this.reportId=e,this.message=t,this.folder=n}}class InstructionReadedCommand{constructor(e,t){this.id=e,this.folder=t}}class InstructionUnreadedCommand{constructor(e,t){this.id=e,this.folder=t}}class AddFavoriteReceiverCommand{constructor(e,t){this.instructionTypeId=e,this.receiverid=t}}class DeleteFavoriteReceiverCommand{constructor(e,t){this.instructionTypeId=e,this.receiverid=t}}class CreateFolderCommand{constructor(e,t,n){this.parentID=e,this.name=t,this.filterID=n}}class DeleteFolderCommand{constructor(e,t){this.id=e,this.removeChildren=t}}class UpdateFolderCommand{constructor(e,t,n){this.id=e,this.filterID=t,this.name=n}}class CreateFolderRuleCommand{constructor(e,t,n,i,o){this.folderId=e,this.conditions=t,this.isEnabled=n,this.isExecuteNewAndInbox=i,this.name=o}}class EditFolderRuleCommand{constructor(e,t,n,i,o,s,r){this.folderId=e,this.ruleId=t,this.conditions=n,this.isEnabled=i,this.isExecuteNewAndInbox=o,this.name=s,this.order=r}}class DeleteFolderRuleCommand{constructor(e,t){this.id=e,this.ruleId=t}}},95251:(e,t,n)=>{"use strict";n.d(t,{H:()=>AddKanbanBoardCommand,K:()=>AddKanbanTaskCommand});class AddKanbanBoardCommand{constructor(e){this.board=e}}class AddKanbanTaskCommand{constructor(e,t){this.payload=e,this.fromRemote=t}}},86418:(e,t,n)=>{"use strict";n.d(t,{n:()=>LockObjectCommand,rn:()=>UnlockObjectCommand,TD:()=>AddAttachmentCommand,UY:()=>UpdateAttachmentCommand,e2:()=>AddAttachmentVersionCommand,$t:()=>RenameAttachmentCommand});class LockObjectCommand{constructor(e){this.id=e}}class UnlockObjectCommand{constructor(e){this.id=e}}class AddAttachmentCommand{constructor(e,t,n,i=!0){this.objectId=e,this.name=t,this.file=n,this.readOnly=i}}class UpdateAttachmentCommand{constructor(e,t){this.id=e,this.file=t}}class AddAttachmentVersionCommand{constructor(e,t,n){this.id=e,this.file=t,this.fileName=n}}class RenameAttachmentCommand{constructor(e,t){this.id=e,this.name=t}}},10637:(e,t,n)=>{"use strict";n.d(t,{xO:()=>ViewStateCommand,On:()=>SaveAdminSettingsCommand,gY:()=>SaveUserSettingsCommand,Wj:()=>SaveUserSettingsPartiallyCommand,If:()=>ProcessRepositoryCommand,un:()=>CacheWhiteListsCommand,Qe:()=>DropCacheSectionCommand,QM:()=>DropAllCacheCommand,dr:()=>ResetSettingsCommand,NK:()=>UploadAdminSettingsCommand});class ViewStateCommand{constructor(e,t){this.key=e,this.data=t}}class SaveAdminSettingsCommand{constructor(e){this.adminSettings=e}}class SaveUserSettingsCommand{constructor(e){this.userSettings=e}}class SaveUserSettingsPartiallyCommand{constructor(e){this.userSettings=e}}class ProcessRepositoryCommand{constructor(e){this.repositoryModulesNames=e}}class CacheWhiteListsCommand{}class DropCacheSectionCommand{constructor(e){this.cacheTypename=e}}class DropAllCacheCommand{}class ResetSettingsCommand{}class UploadAdminSettingsCommand{constructor(e){this.fileInfo=e}getFormData(){const e=new FormData;return e.append("file",this.fileInfo.file),e}}},81695:(e,t,n)=>{"use strict";n.d(t,{ny:()=>VocabularyItemSaveCommand,nS:()=>VocabularyItemCreateCommand,ZG:()=>VocabularyItemUpdateCommand,Gv:()=>VocabularyItemDeleteCommand,sB:()=>VocabularyItemLogicalDeleteCommand,Fl:()=>VocabularyItemCacheRefreshCommand,tF:()=>VocabularyCacheFlushCommand});class VocabularyItemSaveCommand{constructor(e,t,n,i,o,s,r,a){this.name=e,this.attributes=t,this.referencesToAdd=n,this.referencesToDelete=i,this.childsReferencesToAdd=o,this.childsReferencesToDelete=s,this.id=r,this.item=a}}class VocabularyItemCreateCommand{constructor(e,t){this.name=e,this.item=t}}class VocabularyItemUpdateCommand{constructor(e,t,n){this.name=e,this.id=t,this.item=n}}class VocabularyItemDeleteCommand{constructor(e,t){this.name=e,this.id=t}}class VocabularyItemLogicalDeleteCommand{constructor(e,t,n=!1){this.name=e,this.id=t,this.withChildren=n}}class VocabularyItemCacheRefreshCommand{constructor(e){this.name=e}}class VocabularyCacheFlushCommand{constructor(){this.type="LanDocs.WebApi.Common.Services.Cache.HashSetCache.VocabularyItemsCache"}}},76748:(e,t,n)=>{"use strict";var i;n.d(t,{Q:()=>i}),function(e){e["Client"]="Client",e["Server"]="Server",e["Both"]="Both"}(i||(i={}))},87048:(e,t,n)=>{"use strict";var i,o;n.d(t,{e:()=>i,A:()=>o}),function(e){e["Item"]="Item",e["Create"]="Create",e["Edit"]="Edit",e["View"]="View"}(i||(i={})),function(e){e[e["Empty"]=0]="Empty",e[e["Root"]=1]="Root",e[e["Tab"]=2]="Tab",e[e["TabList"]=3]="TabList",e[e["Section"]=4]="Section",e[e["Row"]=5]="Row",e[e["Column"]=6]="Column",e[e["Field"]=7]="Field",e[e["FieldGroup"]=8]="FieldGroup",e[e["Block"]=9]="Block",e[e["Icon"]=10]="Icon",e[e["Custom"]=11]="Custom",e[e["Chip"]=12]="Chip"}(o||(o={}))},83149:(e,t,n)=>{"use strict";var i;n.d(t,{_:()=>i}),function(e){e[e["Create"]=0]="Create",e[e["Edit"]=1]="Edit",e[e["View"]=2]="View",e[e["Remove"]=3]="Remove"}(i||(i={}))},25173:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i="DOCUMENTSHORTCUT"},40471:(e,t,n)=>{"use strict";var i;n.d(t,{$:()=>i}),function(e){e[e["Item"]=0]="Item",e[e["View"]=1]="View",e[e["Edit"]=2]="Edit",e[e["Create"]=3]="Create",e[e["List"]=4]="List",e[e["CreateParams"]=5]="CreateParams",e[e["EditParams"]=6]="EditParams",e[e["ViewParams"]=7]="ViewParams"}(i||(i={}))},80790:(e,t,n)=>{"use strict";var i,o,s;n.d(t,{b:()=>i,id:()=>o,FT:()=>s}),function(e){e["Full"]="Full",e["AllAttributes"]="AllAttributes",e["ListSync"]="ListSync",e["ListItem"]="ListItem",e["Minimal"]="Minimal",e["Unused"]="Unused",e["None"]="None"}(i||(i={})),function(e){e[e["None"]=0]="None",e[e["OwnAttribute"]=1]="OwnAttribute",e[e["LinkedAttribute"]=2]="LinkedAttribute",e[e["ParentAttribute"]=3]="ParentAttribute",e[e["ReferenceAttribute"]=4]="ReferenceAttribute",e[e["DetailAttribute"]=5]="DetailAttribute"}(o||(o={})),function(e){e[e["LinearVocabulary"]=1]="LinearVocabulary",e[e["HierarchicVocabulary"]=2]="HierarchicVocabulary"}(s||(s={}))},24578:(e,t,n)=>{"use strict";var i,o,s,r;n.d(t,{Ky:()=>i,do:()=>o,Ho:()=>s}),function(e){e[e["Disabled"]=0]="Disabled",e[e["Enabled"]=1]="Enabled",e[e["Optional"]=2]="Optional",e[e["DSS"]=3]="DSS"}(i||(i={})),function(e){e[e["NoSign"]=0]="NoSign",e[e["Success"]=1]="Success",e[e["SignInvalid"]=2]="SignInvalid",e[e["OtherError"]=3]="OtherError",e[e["NotSignedByServer"]=4]="NotSignedByServer"}(o||(o={})),function(e){e[e["Signed"]=1]="Signed",e[e["SignRequired"]=2]="SignRequired",e[e["Failed"]=3]="Failed",e[e["NotNeeded"]=4]="NotNeeded",e[e["DssCredentialsRequired"]=5]="DssCredentialsRequired",e[e["DssSecurityTokenRequired"]=6]="DssSecurityTokenRequired"}(s||(s={})),function(e){e[e["EOC"]=0]="EOC",e[e["BOOLEAN"]=1]="BOOLEAN",e[e["INTEGER"]=2]="INTEGER",e[e["BIT_STRING"]=3]="BIT_STRING",e[e["OCTET_STRING"]=4]="OCTET_STRING",e[e["NULL"]=5]="NULL",e[e["OBJECT_IDENTIFIER"]=6]="OBJECT_IDENTIFIER",e[e["ObjectDescriptor"]=7]="ObjectDescriptor",e[e["EXTERNAL"]=8]="EXTERNAL",e[e["REAL"]=9]="REAL",e[e["ENUMERATED"]=10]="ENUMERATED",e[e["EMBEDDED_PDV"]=11]="EMBEDDED_PDV",e[e["UTF8String"]=12]="UTF8String",e[e["SEQUENCE"]=16]="SEQUENCE",e[e["SET"]=17]="SET",e[e["NumericString"]=18]="NumericString",e[e["PrintableString"]=19]="PrintableString",e[e["TeletexString"]=20]="TeletexString",e[e["VideotexString"]=21]="VideotexString",e[e["IA5String"]=22]="IA5String",e[e["UTCTime"]=23]="UTCTime",e[e["GeneralizedTime"]=24]="GeneralizedTime",e[e["GraphicString"]=25]="GraphicString",e[e["VisibleString"]=26]="VisibleString",e[e["GeneralString"]=27]="GeneralString",e[e["UniversalString"]=28]="UniversalString",e[e["BMPString"]=30]="BMPString"}(r||(r={}));r.BIT_STRING,r.OCTET_STRING,r.UTF8String,r.NumericString,r.PrintableString,r.TeletexString,r.VideotexString,r.IA5String,r.GraphicString,r.VisibleString,r.GeneralString,r.UniversalString,r.BMPString;var a,l;(function(e){e[e["unknown"]=0]="unknown",e[e["cert"]=1]="cert",e[e["serializedCert"]=2]="serializedCert",e[e["pfx"]=3]="pfx",e[e["pkcs12"]=3]="pkcs12",e[e["serializedStore"]=4]="serializedStore",e[e["pkcs7"]=5]="pkcs7",e[e["authenticode"]=6]="authenticode"})(a||(a={})),function(e){e[e["universal"]=0]="universal",e[e["application"]=1]="application",e[e["context"]=2]="context",e[e["privateTag"]=3]="privateTag"}(l||(l={}))},49216:(e,t,n)=>{"use strict";var i,o,s,r;n.d(t,{gX:()=>o,ui:()=>s}),function(e){e[e["None"]=0]="None",e[e["Word"]=1]="Word",e[e["Excel"]=2]="Excel",e[e["Pdf"]=3]="Pdf",e[e["PowerPoint"]=4]="PowerPoint",e[e["Ods"]=5]="Ods",e[e["Odt"]=6]="Odt",e[e["Xml"]=7]="Xml",e[e["Txt"]=8]="Txt"}(i||(i={})),function(e){e[e["Document"]=1]="Document",e[e["Instruction"]=2]="Instruction",e[e["Sidebar"]=3]="Sidebar"}(o||(o={})),function(e){e[e["Running"]=1]="Running",e[e["Complete"]=2]="Complete"}(s||(s={})),function(e){e[e["Create"]=0]="Create",e[e["View"]=1]="View"}(r||(r={}))},36378:(e,t,n)=>{"use strict";var i,o;n.d(t,{x:()=>i,i:()=>o}),function(e){e["None"]="None",e["LibreOffice"]="LibreOffice",e["MsWord"]="MsWord"}(i||(i={})),function(e){e[e["Folder"]=0]="Folder",e[e["File"]=1]="File"}(o||(o={}))},50633:(e,t,n)=>{"use strict";n.d(t,{ET:()=>i});var i;(function(e){e[e["Instruction"]=0]="Instruction",e[e["InstructionHistory"]=1]="InstructionHistory",e[e["Document"]=2]="Document"})(i||(i={}))},20734:(e,t,n)=>{"use strict";var i;n.d(t,{g:()=>i}),function(e){e[e["Document"]=1]="Document",e[e["Instruction"]=2]="Instruction"}(i||(i={}))},65779:(e,t,n)=>{"use strict";var i;n.d(t,{g:()=>i}),function(e){e[e["Success"]=1500]="Success",e[e["Reject"]=1501]="Reject",e[e["Report"]=-1]="Report"}(i||(i={}))},26825:(e,t,n)=>{"use strict";var i,o,s,r;n.d(t,{p0:()=>i,Wd:()=>o,nJ:()=>s,up:()=>r}),function(e){e[e["Incoming"]=0]="Incoming",e[e["Outcoming"]=1]="Outcoming"}(i||(i={})),function(e){e[e["NotActive"]=1]="NotActive",e[e["Active"]=2]="Active",e[e["InWork"]=3]="InWork",e[e["Done"]=4]="Done",e[e["Deleted"]=5]="Deleted",e[e["Approved"]=6]="Approved",e[e["Read"]=7]="Read",e[e["Canceled"]=8]="Canceled",e[e["CoExec"]=11]="CoExec"}(o||(o={})),function(e){e["NotActive"]="MS_NOTACTIVE",e["Active"]="MS_ACTIVE",e["ActiveRedirected"]="MS_ACTIVE_REDIRECTED",e["ActiveOvertime"]="MS_ACTIVE_OVERTIME",e["ActiveOvertimeRedirected"]="MS_ACTIVE_OVERTIME_REDIRECTED",e["InWork"]="MS_INWORK",e["InWorkRedirected"]="MS_INWORK_REDIRECTED",e["Done"]="MS_DONE",e["DoneRedirected"]="MS_DONE_REDIRECTED",e["DoneError"]="MS_DONE_ERROR",e["DoneErrorRedirected"]="MS_DONE_ERROR_REDIRECTED",e["ResultPlus"]="MS_RESULT_PLUS",e["ResultPlusRedirected"]="MS_RESULT_PLUS_REDIRECTED",e["ResultMinus"]="MS_RESULT_MINUS",e["ResultMinusRedirected"]="MS_RESULT_MINUS_REDIRECTED",e["Readed"]="MS_READED",e["ReadedRedirected"]="MS_READED_REDIRECTED",e["Canceled"]="CANCELED",e["CanceledRedirected"]="CANCELED_REDIRECTED",e["Deleted"]="MS_DELETED",e["DeletedRedirected"]="MS_DELETED_REDIRECTED"}(s||(s={})),function(e){e[e["InstructuionNode"]=0]="InstructuionNode",e[e["GroupNode"]=1]="GroupNode"}(r||(r={}))},37272:(e,t,n)=>{"use strict";var i,o,s;n.d(t,{NH:()=>i,xK:()=>o,OP:()=>s}),function(e){e[e["Working"]=0]="Working",e[e["Calendar"]=1]="Calendar"}(i||(i={})),function(e){e[e["Create"]=0]="Create",e[e["Edit"]=1]="Edit",e[e["Replace"]=2]="Replace",e[e["ForwardMessage"]=3]="ForwardMessage",e[e["RepeatMessage"]=4]="RepeatMessage",e[e["RepeatChain"]=5]="RepeatChain",e[e["ForwardReport"]=6]="ForwardReport",e[e["View"]=7]="View",e[e["CreateReport"]=8]="CreateReport"}(o||(o={})),function(e){e[e["User"]=6]="User",e[e["Role"]=7]="Role",e[e["Department"]=8]="Department",e[e["GroupUser"]=40]="GroupUser"}(s||(s={}))},43857:(e,t,n)=>{"use strict";var i;n.d(t,{A:()=>i}),function(e){e[e["NoCheck"]=1]="NoCheck",e[e["HasText"]=2]="HasText",e[e["HasDocument"]=3]="HasDocument",e[e["HasTextAndDocument"]=4]="HasTextAndDocument",e[e["HasTextOrDocument"]=5]="HasTextOrDocument"}(i||(i={}))},73043:(e,t,n)=>{"use strict";var i,o;n.d(t,{z:()=>i,a:()=>o}),function(e){e[e["FanWithExecutive"]=1]="FanWithExecutive",e[e["Fan"]=2]="Fan",e[e["ChainWithExecutive"]=3]="ChainWithExecutive",e[e["Chain"]=4]="Chain"}(i||(i={})),function(e){e[e["Fan"]=0]="Fan",e[e["Chain"]=1]="Chain"}(o||(o={}))},38235:(e,t,n)=>{"use strict";var i,o;n.d(t,{U:()=>i,c:()=>o}),function(e){e["NoType"]="notype",e["Positive"]="positive",e["Negative"]="negative"}(i||(i={})),function(e){e[e["Instruction"]=1]="Instruction",e[e["Task"]=2]="Task"}(o||(o={}))},3820:(e,t,n)=>{"use strict";var i,o,s,r;n.d(t,{yR:()=>i,g:()=>o,j4:()=>s,LE:()=>r}),function(e){e[e["None"]=0]="None",e[e["Simple"]=1]="Simple",e[e["List"]=2]="List",e[e["MultiSelect"]=3]="MultiSelect",e[e["ModalDialog"]=4]="ModalDialog"}(i||(i={}));(function(e){e[e["Integer"]=1]="Integer",e[e["String"]=2]="String",e[e["Date"]=3]="Date",e[e["Time"]=4]="Time",e[e["MultiLineString"]=5]="MultiLineString",e[e["Float"]=7]="Float",e[e["DateTime"]=8]="DateTime"})(o||(o={})),function(e){e[e["Default"]=-1]="Default",e[e["FirstLetters"]=1]="FirstLetters",e[e["Context"]=2]="Context"}(s||(s={})),function(e){e[e["Table"]=0]="Table",e[e["List"]=1]="List",e[e["CollapsedTree"]=2]="CollapsedTree",e[e["ExpandedTree"]=3]="ExpandedTree"}(r||(r={}))},11135:(e,t,n)=>{"use strict";var i,o,s;n.d(t,{Wy:()=>i,YG:()=>o,Fw:()=>s}),function(e){e[e["Inbox"]=0]="Inbox",e[e["Outbox"]=1]="Outbox"}(i||(i={})),function(e){e["None"]="none",e["Fast"]="fast",e["Null"]="null"}(o||(o={})),function(e){e["Today"]="Сегодня",e["Yesterday"]="Вчера",e["Week"]="Неделя",e["Month"]="Месяц",e["Quarter"]="Квартал",e["Year"]="Год"}(s||(s={}))},72835:(e,t,n)=>{"use strict";var i;n.d(t,{J:()=>i}),function(e){e[e["Fake"]=0]="Fake",e[e["InstructionFolder"]=1]="InstructionFolder",e[e["Journal"]=2]="Journal",e[e["DocumentFolder"]=3]="DocumentFolder",e[e["DocumentSearchFolder"]=4]="DocumentSearchFolder",e[e["SettingsFolder"]=5]="SettingsFolder",e[e["Kanban"]=6]="Kanban"}(i||(i={}))},98005:(e,t,n)=>{"use strict";var i;n.d(t,{K:()=>i}),function(e){e[e["NotRealRight"]=0]="NotRealRight",e[e["DeleteFile"]=1]="DeleteFile",e[e["EditFile"]=2]="EditFile",e[e["CreateFile"]=3]="CreateFile",e[e["DeleteFileVersion"]=4]="DeleteFileVersion",e[e["CreateDocument"]=5]="CreateDocument",e[e["RegisterDocument"]=512]="RegisterDocument",e[e["ViewDocument"]=513]="ViewDocument",e[e["DeleteDocument"]=517]="DeleteDocument",e[e["EditDocument"]=514]="EditDocument",e[e["ArchiveDocument"]=531]="ArchiveDocument",e[e["AddDeputies"]=669]="AddDeputies",e[e["ViewAllInstructions"]=698]="ViewAllInstructions",e[e["RenameFile"]=841]="RenameFile",e[e["ViewProjects"]=952]="ViewProjects",e[e["CoExecutorsViewRight"]=2115]="CoExecutorsViewRight",e[e["RemoveDocument"]=2146]="RemoveDocument",e[e["RestoreDocument"]=2147]="RestoreDocument",e[e["CanEditControlPage"]=251888]="CanEditControlPage",e[e["CanEditControlFields"]=251889]="CanEditControlFields",e[e["EditNumber"]=549]="EditNumber",e[e["CreateEditSheave"]=2627]="CreateEditSheave"}(i||(i={}))},42256:(e,t,n)=>{"use strict";var i;n.d(t,{S:()=>i}),function(e){e["Dashboard"]="dashboard",e["Documents"]="documents",e["Messages"]="messages",e["Reports"]="reports",e["History"]="history",e["Favorites"]="favorites",e["Archive"]="archive",e["Settings"]="settings",e["Search"]="search",e["Vocabularies"]="vocabularies",e["Kanban"]="kanban"}(i||(i={}))},67472:(e,t,n)=>{"use strict";var i,o,s,r,a;n.d(t,{AK:()=>i,F2:()=>o,cV:()=>s,Sr:()=>r,Ro:()=>a}),function(e){e[e["No"]=0]="No",e[e["Yes"]=1]="Yes",e[e["InboxOnly"]=2]="InboxOnly"}(i||(i={})),function(e){e[e["Yes"]=0]="Yes",e[e["No"]=1]="No",e[e["ForNewUsers"]=2]="ForNewUsers"}(o||(o={})),function(e){e[e["String"]=0]="String",e[e["Date"]=1]="Date",e[e["DateTime"]=2]="DateTime",e[e["Number"]=3]="Number",e[e["Other"]=4]="Other"}(s||(s={})),function(e){e[e["Asc"]=0]="Asc",e[e["Desc"]=1]="Desc"}(r||(r={})),function(e){e[e["Inbox"]=1999]="Inbox",e[e["Outbox"]=2101]="Outbox",e[e["Projects"]=2102]="Projects",e[e["InControl"]=2103]="InControl",e[e["ControlExecution"]=2104]="ControlExecution",e[e["Archive"]=987]="Archive",e[e["ArchiveInbox"]=2107]="ArchiveInbox",e[e["ArchiveOutbox"]=2108]="ArchiveOutbox",e[e["ArchivePreviousControl"]=2109]="ArchivePreviousControl",e[e["ArchiveControlExecution"]=2110]="ArchiveControlExecution",e[e["Kanban"]=3e3]="Kanban"}(a||(a={}))},50103:(e,t,n)=>{"use strict";var i,o,s,r;n.d(t,{Ml:()=>i,dS:()=>o,zc:()=>s}),function(e){e[e["None"]=0]="None",e[e["List"]=1]="List",e[e["Grid"]=2]="Grid",e[e["Calendar"]=3]="Calendar",e[e["Kanban"]=4]="Kanban",e[e["Card"]=5]="Card"}(i||(i={})),function(e){e[e["None"]=0]="None",e[e["Preview"]=1]="Preview",e[e["Create"]=2]="Create",e[e["Edit"]=3]="Edit",e[e["View"]=4]="View",e[e["List"]=5]="List",e[e["Remove"]=6]="Remove"}(o||(o={})),function(e){e[e["Document"]=0]="Document",e[e["Instruction"]=1]="Instruction",e[e["Settings"]=2]="Settings",e[e["FastReport"]=3]="FastReport",e[e["Vocabulary"]=4]="Vocabulary",e[e["Task"]=5]="Task"}(s||(s={})),function(e){e[e["Instruction"]=0]="Instruction",e[e["Document"]=1]="Document",e[e["None"]=2]="None"}(r||(r={}))},84337:(e,t,n)=>{"use strict";var i;n.d(t,{H:()=>i}),function(e){e[e["Normal"]=1]="Normal",e[e["System"]=2]="System",e[e["Fixed"]=3]="Fixed",e[e["ReadOnly"]=4]="ReadOnly",e[e["Archive"]=5]="Archive",e[e["Removed"]=6]="Removed"}(i||(i={}))},66860:(e,t,n)=>{"use strict";n.d(t,{iA:()=>AuthQuery,U2:()=>AuthWinQuery,Lv:()=>AuthCertQuery,RU:()=>AuthLogoutQuery,fu:()=>CheckUserQuery,SE:()=>PingUserQuery});class AuthQuery{constructor(e,t){this.username=e,this.password=t,this.fromRemote=!0}}class AuthWinQuery{constructor(){this.fromRemote=!0}}class AuthCertQuery{constructor(){this.fromRemote=!0}}class AuthLogoutQuery{constructor(){this.fromRemote=!0}}class CheckUserQuery{constructor(e){this.username=e,this.fromRemote=!0}}class PingUserQuery{constructor(e){this.fromRemote=e}}},44893:(e,t,n)=>{"use strict";n.d(t,{lQ:()=>CardsTreeQuery,$$:()=>CardsSearchQuery,J2:()=>CardsActualQuery,dw:()=>CardFetchQuery});class CardsTreeQuery{constructor(e){this.fromRemote=e}}class CardsSearchQuery{constructor(e,t,n,i){this.cardId=e,this.cardType=t,this.isActual=n,this.fromRemote=i}}class CardsActualQuery{constructor(e,t,n){this.cardId=e,this.cardType=t,this.fromRemote=n}}class CardFetchQuery{constructor(e,t,n,i){this.cardId=e,this.type=t,this.id=n,this.fromRemote=i}}},54235:(e,t,n)=>{"use strict";n.d(t,{K:()=>GetComponentsQuery,y:()=>ComponentVersionFetchQuery});class GetComponentsQuery{constructor(e){this.fromRemote=e}}class ComponentVersionFetchQuery{constructor(e,t,n){this.id=e,this.code=t,this.fromRemote=n}}},68385:(e,t,n)=>{"use strict";n.d(t,{Dr:()=>DefaultDashboardListQuery,$Z:()=>UserDashboardListQuery,QB:()=>CommonDashboardListQuery});class DefaultDashboardListQuery{constructor(e){this.fromRemote=e}}class UserDashboardListQuery{constructor(e){this.fromRemote=e}}class CommonDashboardListQuery{constructor(e){this.fromRemote=e}}},77896:(e,t,n)=>{"use strict";n.d(t,{Zc:()=>DocumentsFoldersQuery,u9:()=>DocumentsFoldersTreeQuery,PS:()=>JournalsListQuery,RF:()=>SingleJournalQuery,Ml:()=>DocumentRightsQuery,k9:()=>DocumentOperationsQuery,m$:()=>DocumentsListQuery,N8:()=>DocumentsFolderQuery,U_:()=>DocumentQuery,LU:()=>DocOperationsQuery,VX:()=>DocumentNewQuery,G4:()=>DocumentFilesQuery,pV:()=>BusinessObjectQuery,kb:()=>DocumentInstructionsQuery,XS:()=>DocumentMetadataQuery,Ip:()=>LdObjectsQuery,Hx:()=>DocumentChainsheavesQuery,hj:()=>ChainsheavesTypesQuery,rP:()=>DocumentsSearchQuery});var i=n(72835);class DocumentsFoldersQuery{constructor(e){this.fromRemote=e}}class DocumentsFoldersTreeQuery{constructor(e,t){this.withDepartments=e,this.fromRemote=t}}class JournalsListQuery{constructor(e,t,n,i,o,s,r){this.journalType=e,this.fromRemote=t,this.take=n,this.skip=i,this.orderBy=o,this.orderDir=s,this.searchText=r}}class SingleJournalQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class DocumentRightsQuery{constructor(e,t,n=i.J.Journal){this.journalId=e,this.fromRemote=t,this.folderType=n}}class DocumentOperationsQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class DocumentsListQuery{constructor(e,t,n,i,o,s=!0,r,a,l=!0,c=!0){this.journalId=e,this.archive=t,this.listInfo=n,this.cardId=i,this.fromRemote=o,this.cancelable=s,this.registrationDateStart=r,this.registrationDateFinish=a,this.withFile=l,this.isTemp=c}}class DocumentsFolderQuery{constructor(e,t,n=!0,i=!0){this.folderId=e,this.fromRemote=t,this.cancelable=n,this.isTemp=i}}class DocumentQuery{constructor(e,t,n,i){this.documentId=e,this.mode=t,this.journalId=n,this.fromRemote=i}}class DocOperationsQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class DocumentNewQuery{constructor(e,t){this.journalId=e,this.fromRemote=t}}class DocumentFilesQuery{constructor(e,t,n,i){this.documentId=e,this.cardId=t,this.cancelable=n,this.fromRemote=i}}class BusinessObjectQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class DocumentInstructionsQuery{constructor(e,t,n,i,o=!0){this.docId=e,this.withDeleted=t,this.fromRemote=n,this.uid=i,this.cancelable=o}}class DocumentMetadataQuery{constructor(e,t){this.name=e,this.fromRemote=t}}class LdObjectsQuery{constructor(e,t,n,i,o,s,r){this.type=e,this.atttributesGroup=t,this.members=n,this.constraint=i,this.position=o,this.count=s,this.fromRemote=r}}class DocumentChainsheavesQuery{constructor(e,t,n,i){this.id=e,this.cardId=t,this.chainsheafs=n,this.fromRemote=i}}class ChainsheavesTypesQuery{constructor(e){this.fromRemote=e}}class DocumentsSearchQuery{constructor(e,t,n,i,o,s,r,a=!0,l=!0,c=!0){this.folderId=e,this.cardId=t,this.archive=n,this.listInfo=i,this.fromRemote=o,this.registrationDateStart=s,this.registrationDateFinish=r,this.withFile=a,this.cancelable=l,this.isTemp=c}}},80174:(e,t,n)=>{"use strict";n.d(t,{AX:()=>EsignsQuery,nC:()=>EsignCertQuery,qK:()=>EsignCheckQuery});class EsignsQuery{constructor(e,t,n){this.entity=e,this.id=t,this.fromRemote=n}}class EsignCertQuery{constructor(e,t){this.year=e,this.fromRemote=t}}class EsignCheckQuery{constructor({entityName:e,entityId:t,objectId:n,operationId:i,fromRemote:o}){this.entityName=e,this.entityId=t,this.objectId=n,this.operationId=i,this.fromRemote=o}}},73179:(e,t,n)=>{"use strict";n.d(t,{qN:()=>ReportsFoldersQuery,K$:()=>ReportsListQuery,CQ:()=>LastParamsQuery,_R:()=>ReportTaskQuery});class ReportsFoldersQuery{constructor(e){this.fromRemote=e}}class ReportsListQuery{constructor(e,t,n,i,o,s){this.folderId=e,this.skip=t,this.take=n,this.where=i,this.order=o,this.fromRemote=s}}class LastParamsQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class ReportTaskQuery{constructor(e,t){this.id=e,this.fromRemote=t}}},22337:(e,t,n)=>{"use strict";n.d(t,{RO:()=>FileUrlQuery,uL:()=>FileTypesQuery,jn:()=>FileDownloadQuery,Je:()=>FileBytesQuery,sj:()=>FileSearchQuery,cV:()=>FileSearchDetailQuery,jY:()=>FileStampSettingsQuery,m5:()=>FileStampRegNumberQuery,O8:()=>FileStampEsignQuery,wp:()=>FileEditedQuery,Ap:()=>FileConvertQuery,gD:()=>StampsFileQuery,MZ:()=>FileVersionsQuery,G8:()=>FileTemplatesQuery,SS:()=>R7AuthQuery,fJ:()=>R7FileInfoQuery,cR:()=>R7FileEditDataQuery,s:()=>R7FileConfigQuery});class FileUrlQuery{constructor(e,t){this.fileId=e,this.fromRemote=t}}class FileTypesQuery{constructor(e){this.fromRemote=e}}class FileDownloadQuery{constructor(e,t,n){this.fileId=e,this.preview=t,this.fromRemote=n}}class FileBytesQuery{constructor(e,t){this.fileId=e,this.fromRemote=t}}class FileSearchQuery{constructor(e,t,n,i,o,s,r,a,l){this.query=e,this.count=t,this.from=n,this.resultFields=i,this.hlFields=o,this.aggs=s,this.sort=r,this.facets=a,this.fromRemote=l}}class FileSearchDetailQuery{constructor(e,t,n,i){this.query=e,this.contentId=t,this.resultFields=n,this.fromRemote=i}}class FileStampSettingsQuery{constructor(e){this.fromRemote=e}}class FileStampRegNumberQuery{constructor(e,t,n){this.documentId=e,this.versionId=t,this.fromRemote=n}}class FileStampEsignQuery{constructor(e,t,n,i,o){this.documentId=e,this.versionId=t,this.operTypeId=n,this.userID=i,this.fromRemote=o}}class FileEditedQuery{constructor(e){this.fromRemote=e}}class FileConvertQuery{constructor(e,t){this.taskId=e,this.fromRemote=t}}class StampsFileQuery{constructor(e,t){this.versionId=e,this.fromRemote=t}}class FileVersionsQuery{constructor(e,t,n,i){this.id=e,this.attributes=t,this.members=n,this.fromRemote=i}}class FileTemplatesQuery{constructor(e,t){this.path=e,this.fromRemote=t}}class R7AuthQuery{constructor(e){this.fromRemote=e}}class R7FileInfoQuery{constructor(e,t,n){this.r7FileId=e,this.fileId=t,this.fromRemote=n}}class R7FileEditDataQuery{constructor(e,t){this.r7FileId=e,this.fromRemote=t}}class R7FileConfigQuery{constructor(e,t){this.fileId=e,this.fromRemote=t}}},84258:(e,t,n)=>{"use strict";n.d(t,{YX:()=>FiltersQuery,oN:()=>SearchFolderFilterQuery,oV:()=>FilterParametersQuery,aq:()=>FilterRawDataQuery});class FiltersQuery{constructor(e,t,n,i){this.filterType=e,this.kind=t,this.journalId=n,this.fromRemote=i}}class SearchFolderFilterQuery{constructor(e,t){this.searchFolderId=e,this.fromRemote=t}}class FilterParametersQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class FilterRawDataQuery{constructor(e,t,n,i,o,s){this.refId=e,this.item=t,this.skip=n,this.take=i,this.value=o,this.fromRemote=s}}},69332:(e,t,n)=>{"use strict";n.d(t,{oY:()=>InstructionListQuery,oE:()=>InstructionQuery,I1:()=>InstructionFilesQuery,jl:()=>InstructionTypesQuery,tN:()=>InstructionTypesInfoQuery,vw:()=>InstructionTypeQuery,KM:()=>InstructionFoldersQuery,u8:()=>InstructionSingleFoldersQuery,z5:()=>InstructionStatisticQuery,c1:()=>InstructionFoldersToMoveQuery,Oz:()=>InstructionMessageResponseQuery,Rr:()=>InstructionExecEndDateQuery,MV:()=>InstructionExecIntervalQuery,Wr:()=>InstructionGetDocumentQuery,t9:()=>InstructionSingleForEdit,et:()=>InstructionReportForEditQuery,OU:()=>InstructionReportQuery,O6:()=>InstructionsTreeQuery,vW:()=>InstructionHistoryQuery,VZ:()=>InstructionOperationsQuery,AK:()=>FavoriteReceiversQuery,ZO:()=>InstructionFoldersNotificationQuery,fU:()=>InstructionFolderRulesQuery});class InstructionListQuery{constructor(e,t,n,i,o=!0,s,r,a){this.folderId=e,this.listInfo=t,this.members=n,this.fromRemote=i,this.cancelable=o,this.createDateTimeStart=s,this.createDateTimeFinish=r,this.permissionCheckMode=a}}class InstructionQuery{constructor(e,t,n){this.id=e,this.folderId=t,this.fromRemote=n}}class InstructionFilesQuery{constructor(e,t){this.instrId=e,this.fromRemote=t}}class InstructionTypesQuery{constructor(e){this.fromRemote=e}}class InstructionTypesInfoQuery{constructor(e){this.fromRemote=e}}class InstructionTypeQuery{constructor(e,t){this.typeId=e,this.fromRemote=t}}class InstructionFoldersQuery{constructor(e,t){this.rootId=e,this.fromRemote=t}}class InstructionSingleFoldersQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class InstructionStatisticQuery{constructor(e,t){this.ids=e,this.fromRemote=t}}class InstructionFoldersToMoveQuery{constructor(e,t){this.folderId=e,this.fromRemote=t}}class InstructionMessageResponseQuery{constructor(e,t,n,i,o){this.actionType=e,this.itemId=t,this.typeId=n,this.documentId=i,this.fromRemote=o}}class InstructionExecEndDateQuery{constructor(e,t,n,i){this.startDate=e,this.interval=t,this.intervalType=n,this.fromRemote=i}}class InstructionExecIntervalQuery{constructor(e,t,n,i){this.startDate=e,this.endDate=t,this.intervalType=n,this.fromRemote=i}}class InstructionGetDocumentQuery{constructor(e,t){this.documentId=e,this.fromRemote=t}}class InstructionSingleForEdit{constructor(e,t,n){this.id=e,this.actionType=t,this.fromRemote=n}}class InstructionReportForEditQuery{constructor(e,t,n,i){this.instructionId=e,this.actionType=t,this.srcReportId=n,this.fromRemote=i}}class InstructionReportQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class InstructionsTreeQuery{constructor(e,t,n){this.id=e,this.withDeleted=t,this.fromRemote=n}}class InstructionHistoryQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class InstructionOperationsQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class FavoriteReceiversQuery{constructor(e,t){this.instructionTypeId=e,this.fromRemote=t}}class InstructionFoldersNotificationQuery{constructor(e){this.fromRemote=e}}class InstructionFolderRulesQuery{constructor(e){this.fromRemote=e}}},43867:(e,t,n)=>{"use strict";n.d(t,{m:()=>AlertQuery});class AlertQuery{constructor(e,t,n){this.title=e,this.text=t,this.fromRemote=n}}},20386:(e,t,n)=>{"use strict";n.d(t,{l:()=>ConfirmQuery});class ConfirmQuery{constructor(e,t,n){this.title=e,this.text=t,this.fromRemote=n}}},45569:(e,t,n)=>{"use strict";n.d(t,{c:()=>CreateEditQuery});class CreateEditQuery{constructor({title:e,componentName:t,componentProps:n,fullHeight:i,width:o,height:s,hideFooter:r,darkTitle:a,closable:l,expandable:c,minimizable:d,collapsedSize:u,expandedSize:p,description:h,noModal:m,hostObject:f,fromRemote:g}){this.title=e,this.componentName=t,this.componentProps=n,this.fullHeight=i,this.width=o,this.height=s,this.hideFooter=r,this.darkTitle=a,this.closable=l,this.expandable=c,this.minimizable=d,this.collapsedSize=u,this.expandedSize=p,this.description=h,this.noModal=m,this.fromRemote=g,this.hostObject=f}}},3742:(e,t,n)=>{"use strict";n.d(t,{M:()=>DashboardAddWidgetQuery});class DashboardAddWidgetQuery{constructor(e,t,n,i,o,s,r){this.title=e,this.currentDashboard=t,this.widgets=n,this.width=i,this.fullHeight=o,this.selectAsOk=s,this.fromRemote=r}}},86006:(e,t,n)=>{"use strict";n.d(t,{j:()=>DashboardSettingsQuery});class DashboardSettingsQuery{constructor(e,t){this.currentDashboard=e,this.fromRemote=t}}},2385:(e,t,n)=>{"use strict";n.d(t,{R:()=>DashboardWidgetSettingsQuery});class DashboardWidgetSettingsQuery{constructor(e,t,n,i,o,s,r,a,l,c){this.widgetName=e,this.widgetID=t,this.templatePath=n,this.defaultRefreshTime=i,this.widgetSettings=o,this.currentDashboard=s,this.width=r,this.fullHeight=a,this.selectAsOk=l,this.fromRemote=c}}},23800:(e,t,n)=>{"use strict";n.d(t,{D:()=>DocPreviewQuery});class DocPreviewQuery{constructor(e,t,n){this.title=e,this.file=t,this.fromRemote=n}}},86949:(e,t,n)=>{"use strict";n.d(t,{b:()=>EditedFilesQuery});class EditedFilesQuery{constructor(e){this.fromRemote=e}}},99778:(e,t,n)=>{"use strict";n.d(t,{u:()=>EsignDetailsQuery});class EsignDetailsQuery{constructor(e,t,n,i,o,s,r,a,l){this.title=e,this.contentType=t,this.entityId=n,this.objectId=i,this.operationTypeId=o,this.operationId=s,this.esignRowInfo=r,this.documentAttributes=a,this.fromRemote=l}}},54626:(e,t,n)=>{"use strict";n.d(t,{_:()=>InfoWindowQuery});class InfoWindowQuery{constructor({title:e,component:t,componentProps:n,text:i,width:o,height:s,fullHeight:r,closeButton:a,fromRemote:l}){this.title=e,this.component=t,this.componentProps=n,this.text=i,this.width=o,this.height=s,this.fullHeight=r,this.closeButton=a,this.fromRemote=l}}},8107:(e,t,n)=>{"use strict";n.d(t,{a:()=>PdfViewerQuery});class PdfViewerQuery{constructor(e,t,n,i){this.title=e,this.file=t,this.fileVersion=n,this.fromRemote=i}}},1732:(e,t,n)=>{"use strict";n.d(t,{s:()=>R7ViewerQuery});class R7ViewerQuery{constructor(e,t,n,i){this.title=e,this.file=t,this.fileVersion=n,this.fromRemote=i}}},13560:(e,t,n)=>{"use strict";n.d(t,{F:()=>SelectQuery});class SelectQuery{constructor({title:e,componentName:t,componentProps:n,fullHeight:i,width:o,height:s,selectAsOk:r,fromRemote:a}){this.title=e,this.componentName=t,this.componentProps=n,this.fullHeight=i,this.width=o,this.height=s,this.selectAsOk=r,this.fromRemote=a}}},33438:(e,t,n)=>{"use strict";n.d(t,{z:()=>SelectCertificateQuery});class SelectCertificateQuery{constructor(e,t){this.certificates=e,this.fromRemote=t}}},18361:(e,t,n)=>{"use strict";n.d(t,{j:()=>SelectDocumentsQuery});class SelectDocumentsQuery{constructor(e,t,n,i,o,s){this.title=e,this.multiselect=t,this.selectedDocuments=n,this.withReceiverList=i,this.componentProps=o,this.fromRemote=s}}},91908:(e,t,n)=>{"use strict";n.d(t,{B:()=>SelectReceiversQuery});class SelectReceiversQuery{constructor(e,t,n,i,o,s,r,a,l){this.title=e,this.multiselect=t,this.availableTypes=n,this.selectedReceivers=i,this.instructionTypeId=o,this.withReceiverList=s,this.fromRemote=r,this.states=a,this.canReceiveInstruction=l}}},70068:(e,t,n)=>{"use strict";n.d(t,{D:()=>StampViewerQuery});class StampViewerQuery{constructor(e,t,n,i){this.title=e,this.file=t,this.fileVersion=n,this.fromRemote=i}}},47053:(e,t,n)=>{"use strict";n.d(t,{H:()=>KanbanBoardsQuery,O:()=>KanbanTasksQuery});class KanbanBoardsQuery{constructor(e){this.fromRemote=e}}class KanbanTasksQuery{constructor(e){this.fromRemote=e}}},51557:(e,t,n)=>{"use strict";n.d(t,{G:()=>LdOptionsQuery});class LdOptionsQuery{constructor(e=!1){this.fromRemote=e}}},2653:(e,t,n)=>{"use strict";n.d(t,{Yf:()=>CommonManifestQuery,R0:()=>EntityManifestQuery,kY:()=>DashboardManifestQuery,oc:()=>KanbanManifestQuery,Gf:()=>ExternalComponentQuery,ac:()=>ExternalMixinsQuery});class CommonManifestQuery{constructor(e){this.fromRemote=e}}class EntityManifestQuery{constructor(e,t,n){this.id=e,this.prop=t,this.fromRemote=n}}class DashboardManifestQuery{constructor(e){this.fromRemote=e}}class KanbanManifestQuery{constructor(e){this.fromRemote=e}}class ExternalComponentQuery{constructor(e,t,n){this.path=e,this.name=t,this.fromRemote=n}}class ExternalMixinsQuery{constructor(e,t,n,i){this.mixins=e,this.depentComponentName=t,this.mixinIsVueFile=n,this.fromRemote=i}}},1869:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});const i={IQueryBus:Symbol.for("IQueryBus"),CurrentUserQuery:Symbol.for("CurrentUserQuery"),DeputyQuery:Symbol.for("DeputiesQuery"),HistoryQuery:Symbol.for("HistoryQuery"),AuthQuery:Symbol.for("AuthQuery"),AuthWinQuery:Symbol.for("AuthWinQuery"),AuthCertQuery:Symbol.for("AuthCertQuery"),AuthLogoutQuery:Symbol.for("AuthLogoutQuery"),CheckUserQuery:Symbol.for("CheckUserQuery"),NoticeQuery:Symbol.for("NoticeQuery"),fetchEsigns:Symbol.for("fetchEsigns"),RightsQuery:Symbol.for("RightsQuery"),RightObjectQuery:Symbol.for("RightObjectQuery"),MemberRightQuery:Symbol.for("MemberRightQuery"),IntroManifestQuery:Symbol.for("IntroManifestQuery"),LdObjectsQuery:Symbol.for("LdObjectsQuery"),CommonManifestQuery:Symbol.for("CommonManifestQuery"),EntityManifestQuery:Symbol.for("EntityManifestQuery"),ExternalComponentQuery:Symbol.for("ExternalComponentQuery"),ExternalMixinsQuery:Symbol.for("ExternalMixinsQuery"),DashboardManifestQuery:Symbol.for("DashboardManifestQuery"),KanbanManifestQuery:Symbol.for("KanbanManifestQuery"),SearchReceiversById:Symbol.for("SearchReceiversById"),CallMethodQuery:Symbol.for("CallMethodQuery"),InstructionQuery:Symbol.for("InstructionQuery"),InstructionListQuery:Symbol.for("InstructionListQuery"),InstructionFilesQuery:Symbol.for("InstructionFilesQuery"),InstructionTypesQuery:Symbol.for("InstructionTypesQuery"),InstructionTypesInfoQuery:Symbol.for("InstructionTypesInfoQuery"),InstructionTypeQuery:Symbol.for("InstructionTypeQuery"),InstructionFoldersQuery:Symbol.for("InstructionFoldersQuery"),InstructionStatisticQuery:Symbol.for("InstructionStatisticQuery"),InstructionFoldersToMoveQuery:Symbol.for("InstructionFoldersToMoveQuery"),InstructionMessageResponseQuery:Symbol.for("InstructionMessageResponseQuery"),InstructionExecEndDateQuery:Symbol.for("InstructionExecEndDateQuery"),InstructionExecIntervalQuery:Symbol.for("InstructionExecIntervalQuery"),InstructionGetDocumentQuery:Symbol.for("InstructionGetDocumentQuery"),InstructionSingleForEdit:Symbol.for("InstructionSingleForEdit"),InstructionReportForEditQuery:Symbol.for("InstructionReportForEditQuery"),InstructionsTreeQuery:Symbol.for("InstructionsTreeQuery"),InstructionHistoryQuery:Symbol.for("InstructionHistoryQuery"),InstructionFolderUpdateQuery:Symbol.for("InstructionFolderUpdateQuery"),LastVisitedUrlQuery:Symbol.for("LastVisitedUrlQuery"),UserSettingsQuery:Symbol.for("UserSettingsQuery"),PublicSettingsQuery:Symbol.for("PublicSettingsQuery"),AdminSettingsQuery:Symbol.for("AdminSettingsQuery"),TopLevelAdminSettingsQuery:Symbol.for("TopLevelAdminSettingsQuery"),UserGridSettingsQuery:Symbol.for("UserGridSettingsQuery"),UserSettingsForNodeQuery:Symbol.for("UserSettingsForNodeQuery"),ColumnTemplatesQuery:Symbol.for("ColumnTemplatesQuery"),SidebarSettingsQuery:Symbol.for("SidebarSettingsQuery"),ContentSettingsQuery:Symbol.for("ContentSettingsQuery"),TableSettingsQuery:Symbol.for("TableSettingsQuery"),SortSettingsQuery:Symbol.for("SortSettingsQuery"),ViewStateQuery:Symbol.for("ViewStateQuery"),DocumentOperationsQuery:Symbol.for("DocumentOperationsQuery"),DocumentsFoldersQuery:Symbol.for("DocumentsFoldersQuery"),DocumentsListQuery:Symbol.for("DocumentsListQuery"),DocumentQuery:Symbol.for("DocumentQuery"),DocumentFilesQuery:Symbol.for("DocumentFilesQuery"),ChainsheavesTypesQuery:Symbol.for("ChainsheavesTypesQuery"),BusinessObjectQuery:Symbol.for("BusinessObjectQuery"),SingleJournalQuery:Symbol.for("SingleJournalQuery"),JournalsListQuery:Symbol.for("JournalsListQuery"),DocumentRightsQuery:Symbol.for("DocumentRightsQuery"),DocumentInstructionsQuery:Symbol.for("DocumentInstructionsQuery"),DocumentsSearchQuery:Symbol.for("DocumentsSearchQuery"),ReportsFoldersQuery:Symbol.for("ReportsFoldersQuery"),ReportTaskQuery:Symbol.for("ReportTaskQuery"),FiltersQuery:Symbol.for("FiltersQuery"),FilterParametersQuery:Symbol.for("FilterParametersQuery"),FilterRawDataQuery:Symbol.for("FilterRawDataQuery"),SearchFolderFilterQuery:Symbol.for("SearchFolderFilterQuery"),DepartmentsQuery:Symbol.for("DepartmentsQuery"),SearchDepartmentsQuery:Symbol.for("SearchDepartmentsQuery"),DepartmentUsersQuery:Symbol.for("DepartmentUsersQuery"),RolesQuery:Symbol.for("RolesQuery"),GroupUsersQuery:Symbol.for("GroupUsersQuery"),UserReceiversByGroupsQuery:Symbol.for("UserReceiversByGroupsQuery"),SearchReceiversByInstructionTypeQuery:Symbol.for("SearchReceiversByInstructionTypeQuery"),SearchUsersQuery:Symbol.for("SearchUsersQuery"),SomeUsersQuery:Symbol.for("SomeUsersQuery"),FileUrlQuery:Symbol.for("FileUrlQuery"),FileTypesQuery:Symbol.for("FileTypesQuery"),FileBytesQuery:Symbol.for("FileBytesQuery"),FileSearchQuery:Symbol.for("FileSearchQuery"),FileDownloadQuery:Symbol.for("FileDownloadQuery"),FileEditedQuery:Symbol.for("FileEditedQuery"),AvailableStampsQuery:Symbol.for("AvailableStampsQuery"),StampsFileQuery:Symbol.for("StampsFileQuery"),FileVersionsQuery:Symbol.for("FileVersionsQuery"),KanbanBoardsQuery:Symbol.for("KanbanBoardsQuery"),VocabularyQuery:Symbol.for("VocabularyQuery"),VocabularyItemQuery:Symbol.for("VocabularyItemQuery"),VocabularyFullQuery:Symbol.for("VocabularyFullQuery"),VocabularyFilterQuery:Symbol.for("VocabularyFilterQuery"),VocabularyTreeQuery:Symbol.for("VocabularyTreeQuery"),VocabularySearchQuery:Symbol.for("VocabularySearchQuery"),VocabularyItemsByIdQuery:Symbol.for("VocabularyItemsByIdQuery"),R7FileInfoQuery:Symbol.for("R7FileInfoQuery"),AttachmentQuery:Symbol.for("AttachmentQuery"),ConfirmQuery:Symbol.for("ConfirmQuery"),AlertQuery:Symbol.for("AlertQuery"),PromptQuery:Symbol.for("PromptQuery"),SelectFoldersQuery:Symbol.for("SelectFoldersQuery"),EditedFilesQuery:Symbol.for("EditedFilesQuery"),DashboardLayoutQuery:Symbol.for("DashboardLayoutQuery"),DashboardSettingsQuery:Symbol.for("DashboardSettingsQuery"),DashboardAddWidgetQuery:Symbol.for("DashboardAddWidgetQuery"),DashboardWidgetSettingsQuery:Symbol.for("DashboardWidgetSettingsQuery"),SelectReceiversQuery:Symbol.for("SelectReceiversQuery"),FreshDocSurveyQuery:Symbol.for("FreshDocSurveyQuery"),FreshDocFileQuery:Symbol.for("FreshDocFileQuery"),SelectDocumentsQuery:Symbol.for("SelectDocumentsQuery"),EditRoadmapStepQuery:Symbol.for("EditRoadmapStepQuery"),DocPreviewQuery:Symbol.for("DocPreviewQuery"),PdfViewerQuery:Symbol.for("pdfViewerQuery"),StampViewerQuery:Symbol.for("stampViewerQuery"),R7ViewerQuery:Symbol.for("r7ViewerQuery"),SelectInstructionTypesQuery:Symbol.for("SelectInstructionTypesQuery"),SelectDocumentJournalsQuery:Symbol.for("SelectDocumentJournalsQuery"),SelectCertificateQuery:Symbol.for("SelectCertificateQuery"),EsignDetailsQuery:Symbol.for("EsignDetailsQuery"),CanCloseReportQuery:Symbol.for("CanCloseReportQuery"),SelectVocabularyQuery:Symbol.for("SelectVocabularyQuery"),SelectQuery:Symbol.for("SelectQuery"),InfoWindowQuery:Symbol.for("InfoWindowQuery"),CreateEditQuery:Symbol.for("CreateEditQuery"),CustomActionsQuery:Symbol.for("CustomActionsQuery")}},71354:(e,t,n)=>{"use strict";n.d(t,{_Y:()=>RightsQuery,GB:()=>RightObjectQuery,qh:()=>MemberRightQuery});class RightsQuery{constructor(e,t){this.objectIds=e,this.fromRemote=t}}class RightObjectQuery{constructor(e,t){this.objectIds=e,this.fromRemote=t}}class MemberRightQuery{constructor(e,t){this.memberIDs=e,this.fromRemote=t}}},508:(e,t,n)=>{"use strict";n.d(t,{FD:()=>LastVisitedUrlQuery,n7:()=>UserSettingsQuery,wq:()=>SettingsFoldersQuery,u1:()=>PublicSettingsQuery,v2:()=>AdminSettingsQuery,pk:()=>TopLevelAdminSettingsQuery,Pn:()=>UserGridSettingsQuery,fZ:()=>UserSettingsForNodeQuery,bM:()=>ColumnTemplatesQuery,K:()=>SidebarSettingsQuery,mo:()=>ContentSettingsQuery,Wd:()=>TableSettingsQuery,e6:()=>SortSettingsQuery,Id:()=>ViewStateQuery,Lh:()=>CacheItemsQuery,Eo:()=>ExportAdminSettingsQuery});class LastVisitedUrlQuery{constructor(e){this.fromRemote=e}}class UserSettingsQuery{constructor(e){this.fromRemote=e}}class SettingsFoldersQuery{constructor(e,t){this.currentUser=e,this.fromRemote=t}}class PublicSettingsQuery{constructor(e){this.fromRemote=e}}class AdminSettingsQuery{constructor(e){this.fromRemote=e}}class TopLevelAdminSettingsQuery{constructor(e,t,n,i,o){this.contentType=e,this.folderId=t,this.topLevelParentId=n,this.cardId=i,this.fromRemote=o}}class UserGridSettingsQuery{constructor(e,t){this.settings=e,this.fromRemote=t}}class UserSettingsForNodeQuery{constructor(e,t,n,i){this.contentType=e,this.folderId=t,this.cardId=n,this.fromRemote=i}}class ColumnTemplatesQuery{constructor(e){this.fromRemote=e}}class SidebarSettingsQuery{constructor(e){this.fromRemote=e}}class ContentSettingsQuery{constructor(e,t,n){this.contentType=e,this.folderId=t,this.fromRemote=n}}class TableSettingsQuery{constructor(e,t,n){this.contentType=e,this.folderId=t,this.fromRemote=n}}class SortSettingsQuery{constructor(e,t,n){this.contentType=e,this.folderId=t,this.fromRemote=n}}class ViewStateQuery{constructor(e,t){this.key=e,this.fromRemote=t}}class CacheItemsQuery{constructor(e){this.fromRemote=e}}class ExportAdminSettingsQuery{constructor(e,t){this.key=e,this.fromRemote=t}}},6259:(e,t,n)=>{"use strict";n.d(t,{by:()=>CurrentUserQuery,Zo:()=>HistoryQuery,iE:()=>UserDeputiesQuery,MH:()=>DeputyQuery,K3:()=>FreshDocFileQuery,Ji:()=>FreshDocFetchSurveyQuery,Qs:()=>CurrentUserRightsQuery,O7:()=>UserInfoQuery});class CurrentUserQuery{constructor(e){this.fromRemote=e}}class HistoryQuery{constructor(e){this.fromRemote=e}}class UserDeputiesQuery{constructor(e){this.fromRemote=e}}class DeputyQuery{constructor(e,t){this.userId=e,this.fromRemote=t}}class FreshDocFileQuery{constructor(e,t,n,i){this.freshdocID=e,this.options=t,this.fileFormats=n,this.fromRemote=i}}class FreshDocFetchSurveyQuery{constructor(e,t){this.id=e,this.fromRemote=t}}class CurrentUserRightsQuery{constructor(e){this.fromRemote=e}}class UserInfoQuery{constructor(e,t){this.userId=e,this.fromRemote=t}}},77312:(e,t,n)=>{"use strict";n.d(t,{ty:()=>SearchUsersQuery,zD:()=>SomeUsersQuery,fd:()=>DepartmentsQuery,QB:()=>SearchDepartmentsQuery,xZ:()=>DepartmentUsersQuery,TB:()=>RolesQuery,Uv:()=>GroupUsersQuery,c0:()=>UserReceiversByGroupsQuery,qv:()=>SearchReceiversByInstructionTypeQuery,NF:()=>SearchReceiversByTypesQuery,uR:()=>SearchReceiversById});class SearchUsersQuery{constructor(e,t,n,i,o,s){this.searchTerm=e,this.fromRemote=t,this.departmentId=n,this.recursiveSearch=i,this.states=o,this.canReceiveInstruction=s}}class SomeUsersQuery{constructor(e,t){this.userIds=e,this.fromRemote=t}}class DepartmentsQuery{constructor(e,t){this.parentId=e,this.fromRemote=t}}class SearchDepartmentsQuery{constructor(e,t,n,i){this.countReceiverLists=e,this.searchTerm=t,this.instructionTypeId=n,this.fromRemote=i}}class DepartmentUsersQuery{constructor(e,t,n,i,o,s,r){this.departmentId=e,this.countReceiverLists=t,this.searchTerm=n,this.instructionTypeId=i,this.fromRemote=o,this.states=s,this.canReceiveInstruction=r}}class RolesQuery{constructor(e,t,n,i){this.countReceiverLists=e,this.searchTerm=t,this.instructionTypeId=n,this.fromRemote=i}}class GroupUsersQuery{constructor(e,t,n,i){this.countReceiverLists=e,this.searchTerm=t,this.instructionTypeId=n,this.fromRemote=i}}class UserReceiversByGroupsQuery{constructor(e,t){this.groupIds=e,this.fromRemote=t}}class SearchReceiversByInstructionTypeQuery{constructor(e,t,n,i,o,s,r){this.instructionTypeId=e,this.searchTerm=t,this.countLists=n,this.maxTake=i,this.fromRemote=o,this.states=s,this.canReceiveInstruction=r}}class SearchReceiversByTypesQuery{constructor(e,t,n,i,o){this.receiverTypes=e,this.searchTerm=t,this.maxTake=n,this.fromRemote=i,this.states=o}}class SearchReceiversById{constructor(e,t){this.userIds=e,this.fromRemote=t}}},23728:(e,t,n)=>{"use strict";n.d(t,{Yi:()=>VocabularyQuery,AG:()=>VocabularyItemQuery,Aj:()=>VocabularyFullQuery,hu:()=>VocabularyItemsByIdQuery,j_:()=>VocabularySearchQuery,Ox:()=>VocabularySearchV2Query,t:()=>VocabularyTreeQuery,Uw:()=>VocabularyRightsQuery});class VocabularyQuery{constructor(e,t,n,i,o){this.name=e,this.fullInfo=t,this.take=n,this.skip=i,this.fromRemote=o}}class VocabularyItemQuery{constructor(e,t,n){this.name=e,this.id=t,this.fromRemote=n}}class VocabularyFullQuery{constructor(e,t,n,i,o,s){this.name=e,this.states=t,this.take=n,this.skip=i,this.fromRemote=o,this.cancelable=s}}class VocabularyItemsByIdQuery{constructor(e,t,n){this.vocabularyName=e,this.ids=t,this.fromRemote=n}}class VocabularySearchQuery{constructor(e,t,n,i,o,s,r){this.name=e,this.states=t,this.isReturnActual=n,this.redisWhere=i,this.pagingInfo=o,this.fromRemote=s,this.cancelable=r}}class VocabularySearchV2Query extends VocabularySearchQuery{constructor(e,t,n,i,o,s,r,a){super(e,i,o,[],s,r,a),this.searchV2=t,this.searchTerm=n}}VocabularySearchV2Query.ORDER={asc:"Ascending",desc:"Descending"};class VocabularyTreeQuery{constructor(e,t=!1){this.fromRemote=e,this.cancelable=t}}class VocabularyRightsQuery{constructor(e,t){this.vocabularyName=e,this.fromRemote=t}}},58226:(e,t,n)=>{"use strict";n.d(t,{b:()=>a,Q:()=>Queryable});var i,o=n(92673),s=n(86700),r=n(20629),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}};let a=i=class QueryBus{constructor(e,t,n){this._container=e,this._store=t,this._log=n}exec(e){return this._exec(e.constructor.name,e)}exec1(e,t){return this._exec(Symbol.keyFor(e),t)}do(e,t){return this.exec1(e,t)}_exec(e,t){const n=Reflect.getMetadata(e,i);if(n)return this._store.dispatch(n,t);const o=this._container.get(e);if(o)return o.ask(t);this._log.error("Не найден обработчик для "+e)}};function Queryable(e,t){return(n,i)=>{const o=t?`${t}/${i}`:i;Reflect.defineMetadata(e.name,o,a)}}a=i=__decorate([(0,s.b2)(),__param(0,(0,s.f3)(o.t.Container)),__param(1,(0,s.f3)(o.t.Store)),__param(2,(0,s.f3)(o.t.ILogger)),__metadata("design:paramtypes",[s.W2,r.yh,Object])],a)},26744:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});var i=n(92673),o=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}};let s=class CancellationService{constructor(e,t){this.$log=e,this.$store=t,this.cancelRegister=[],this.$log.info("CancellationService initialized"),this.$store.state.cancelRegister=this}register(e){if((null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.uid)){const t=e.id&&e.uid?this.cancelRegister.findIndex((t=>t.id===e.id&&t.uid===e.uid)):this.cancelRegister.findIndex((t=>t.id===e.id));t>=0&&this.cancelRegister.splice(t,1)}this.cancelRegister.push(e)}unregister(e){const t=this.cancelRegister.findIndex((t=>t===e));t>=0&&this.cancelRegister.splice(t,1)}cancel(e,t){if(e||t){const n=e&&t?this.cancelRegister.findIndex((n=>n.id===e&&n.uid===t)):this.cancelRegister.findIndex((t=>t.id===e));if(n>=0){const e=this.cancelRegister[n].cancelFunc;this.cancelRegister.splice(n,1),e&&e("Request was cancelled")}}else while(this.cancelRegister.length){const e=this.cancelRegister.pop();(null===e||void 0===e?void 0:e.cancelFunc)&&e.cancelFunc("Request was cancelled")}}};s=__decorate([(0,o.b2)(),__param(0,(0,o.f3)(i.t.ILogger)),__param(1,(0,o.f3)(i.t.Store)),__metadata("design:paramtypes",[Object,Object])],s)},40551:(e,t,n)=>{"use strict";n.d(t,{b:()=>p});var i=n(80790),o=n(77896),s=n(80174),r=n(33438),a=n(1869),l=n(92673),c=n(86700),d=n(20629),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let u=!1,p=class CryptoProService{constructor(e,t,n,i){this.$log=e,this.$config=t,this.$store=n,this.$queryBus=i,this.providerName="Crypto-Pro GOST R 34.10-2001 Cryptographic Service Provider",this.providerType=75,this.pluginName="КриптоПро ЭЦП Browser plug-in",this.$log.info("CryptoProService initialized")}signBuffer(e,t){return __awaiter(this,void 0,void 0,(function*(){try{if(!u){const t=yield this.wrapCall(e.HasPrivateKey());if(t){const t=yield this.wrapCall(e.PrivateKey);yield this.propSet(t,"CachePin",!0),u=!0}}const n=yield this.createObject("CAdESCOM.CPSigner");yield this.propSet(n,"Certificate",e),yield this.propSet(n,"Options",0);const i=yield this.createObject("CAdESCOM.CadesSignedData");return yield this.propSet(i,"ContentEncoding",cadesplugin.CADESCOM_BASE64_TO_BINARY),yield this.propSet(i,"Content",t),yield this.wrapCall(i.SignCades(n,cadesplugin.CADESCOM_CADES_BES,!0))}catch(e){throw Object.assign(Object.assign({},e),{message:e.message,displayableError:!0})}}))}signHash(e,t){return __awaiter(this,void 0,void 0,(function*(){try{if(!u){const t=yield this.wrapCall(e.HasPrivateKey());if(t){const t=yield this.wrapCall(e.PrivateKey);yield this.propSet(t,"CachePin",!0),u=!0}}const n=yield this.createObject("CAdESCOM.CPSigner");yield this.propSet(n,"Certificate",e),yield this.propSet(n,"Options",0);const i=yield this.createObject("CAdESCOM.HashedData"),o=yield this.getHashAlgorithm(e);yield this.propSet(i,"Algorithm",o),yield this.propSet(i,"DataEncoding",cadesplugin.CADESCOM_BASE64_TO_BINARY),yield i.SetHashValue(t);const s=yield this.createObject("CAdESCOM.CadesSignedData");return yield this.wrapCall(s.SignHash(i,n,cadesplugin.CADESCOM_CADES_BES))}catch(e){throw Object.assign(Object.assign({},e),{message:e.message,displayableError:!0})}}))}hasPlugin(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.createObject("CAdESCOM.About");return Boolean(e)}catch(e){return!1}}))}getCspVersion(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.createObject("CAdESCOM.About"),t=yield this.wrapCall(e.CSPVersion(this.providerName,this.providerType));return t.toString()}catch(e){throw e.message.indexOf("0x80090019")+1?{message:"Указанный CSP не установлен"}:{message:e.message}}}))}getCertificatesFromDB(e){return __awaiter(this,void 0,void 0,(function*(){const t=(new Date).getFullYear(),n=`<CONSTRAINTS>\n    <GREAT field="ValidTo" value="01.01.${t}" />\n    <OR>\n    <EQUAL field="UserID" value="${e}" />\n    </OR>\n    <LESS field="ValidFrom" value="01.01.${t+1}" />\n    <ISNULL field="RevokeID" />\n    </CONSTRAINTS>`,{MCSCERTIFICATESTORE:s}=yield this.$queryBus.exec(new o.Ip("MCSCERTIFICATESTORE",i.b.AllAttributes,null,n));return s.length?s:[]}))}getCertificate(){return this.$queryBus.exec(new s.nC((new Date).getFullYear()))}getCertificateModal(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getCertificates();if(e.length<=0)throw this.noCertificateError();const t=[];for(const n of e){const e={Version:yield n.Version,Thumbprint:yield n.Thumbprint,SubjectName:yield this.subject(n),ValidToDate:yield n.ValidToDate,ValidFromDate:yield n.ValidFromDate,SerialNumber:yield n.SerialNumber,Display:null,HasPrivateKey:null,IsValid:null,IssuerName:null,PublicKey:null,GetInfo:null,Export:null};t.push(e)}const n=yield this.$queryBus.exec(new r.z(t));if(!n)return null;let i=null;for(const t of e)if(n.SerialNumber===(yield t.SerialNumber)){i=t;break}return i}))}getCertificates(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.createObject("CAdESCOM.Store");try{yield this.wrapCall(e.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED))}catch(e){throw{message:`Ошибка при открытии хранилища: ${e.message}`}}try{let t,n=0;try{t=yield this.wrapCall(e.Certificates),t&&(t=yield this.wrapCall(t.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_VALID)),t=yield this.wrapCall(t.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_KEY_USAGE,cadesplugin.CAPICOM_DIGITAL_SIGNATURE_KEY_USAGE)),n=yield this.wrapCall(t.Count))}catch(e){throw{mesage:`Ошибка получения списка сертификатов: ${e.message}`}}const i=[];try{for(let e=1;e<=n;e++){const n=yield this.wrapCall(t.Item(e));i.push(n)}}catch(e){throw{message:`Ошибка обработки сертификатов: ${e.message}`}}return i}finally{yield e.Close()}}))}subject(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.wrapCall(e.SubjectName);return/CN=([^,]*?)(,|$)/g.exec(t)[1]}))}validToDate(e){return __awaiter(this,void 0,void 0,(function*(){return new Date(yield this.wrapCall(e.ValidToDate))}))}getHashAlgorithm(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.wrapCall(e.PublicKey()),n=yield this.wrapCall(t.Algorithm),i=yield this.wrapCall(n.Value),{plugin:o}=yield this.getPlugin();let s;switch(i){case"1.2.643.2.2.20":s=o.CADESCOM_HASH_ALGORITHM_CP_GOST_3411;break;case"1.2.643.7.1.1.1.1":s=o.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_256;break;case"1.2.643.7.1.1.1.2":s=o.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_512;break;default:s=o.CADESCOM_HASH_ALGORITHM_CP_GOST_3411;break}return s}))}getSerialNumber(e){return this.wrapCall(e.SerialNumber)}verifySign(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.createObject("CAdESCOM.CadesSignedData"),{plugin:i}=yield this.getPlugin();try{return yield this.propSet(n,"ContentEncoding",cadesplugin.CADESCOM_BASE64_TO_BINARY),yield this.propSet(n,"Content",t),yield this.wrapCall(n.VerifyCades(e,i.CADESCOM_CADES_BES,!0)),!0}catch(e){return this.$log.error("Ошибка проверки подписи: "+e.message),!1}}))}verifyHash(e,t){return __awaiter(this,void 0,void 0,(function*(){const{plugin:n}=yield this.getPlugin();t instanceof ArrayBuffer&&(t=this.buf2hex(t));const i=yield this.createObject("CAdESCOM.HashedData");yield this.wrapCall(i.SetHashValue(t));const o=yield this.createObject("CAdESCOM.CadesSignedData");try{return yield this.wrapCall(o.VerifyHash(i,e,n.CADESCOM_CADES_BES)),!0}catch(e){return this.$log.error("Ошибка проверки подписи по хэшу файла: "+e.message),!1}}))}decrypt(e){return __awaiter(this,void 0,void 0,(function*(){const{plugin:t}=yield this.getPlugin();let n;try{n=yield this.createObject("CAdESCOM.CPEnvelopedData")}catch(e){throw new Error("Failed to create CAdESCOM.CPEnvelopedData: "+e.message+e.number)}try{yield this.propSet(n,"ContentEncoding",t.CADESCOM_BASE64_TO_BINARY),yield this.propSet(n,"Content",e),yield this.wrapCall(n.Decrypt(e));const i=yield this.wrapCall(n.Content);return this.$log.debug(i),i}catch(e){this.$log.error("Ошибка расшифрования файла: "+e.message)}}))}encrypt(e){return __awaiter(this,void 0,void 0,(function*(){const{plugin:t}=yield this.getPlugin();let n;try{n=yield this.createObject("CAdESCOM.CPEnvelopedData")}catch(e){throw new Error("Failed to create CAdESCOM.CPEnvelopedData: "+e.message+e.number)}const i=yield this.getCertificateModal();if(!i)throw new Error("Не установлен сертификат");try{yield this.propSet(n,"ContentEncoding",t.CADESCOM_BASE64_TO_BINARY),yield this.propSet(n,"Content",e);const o=yield this.wrapCall(n.Recipients);o.Clear(),o.Add(i);const s=yield this.wrapCall(o.Count);this.$log.debug("recipients.Count = ",s),yield this.wrapCall(n.Encrypt());const r=yield this.wrapCall(n.Content);return this.$log.debug(r),r}catch(e){this.$log.error("Ошибка расшифрования файла: "+e.message)}}))}buf2hex(e){return Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")}noCertificateError(){return{message:"Не найдено ни одного сертификата для подписи.",displayableError:!0}}propSet(e,t,n){return __awaiter(this,void 0,void 0,(function*(){const i=`propset_${t}`;i in e?yield e[i](n):e[t]=n}))}wrapCall(e){return e&&e instanceof Promise?e:new Promise(((t,n)=>{try{t(e)}catch(e){n(e)}}))}createObject(e){return __awaiter(this,void 0,void 0,(function*(){const{plugin:t}=yield this.getPlugin();return t.CreateObjectAsync?t.CreateObjectAsync(e):new Promise(((n,i)=>{try{n(t.CreateObject(e))}catch(e){i(e)}}))}))}getPlugin(){return this.plugin?Promise.resolve(this.plugin):new Promise(((e,t)=>{const n=window.cadesplugin;if(!n)return void t({message:`${this.pluginName}: отсутствует скрипт иницилизации плагина в браузере`});const i=n.then&&"function"===typeof n.then;i?window.cadesplugin.then((()=>(this.plugin={plugin:n},e(this.plugin),this.plugin)),(e=>{t({message:`${this.pluginName}: ${e}`})})):(this.onMessageHandler=i=>{"cadesplugin_loaded"===i.data?(this.plugin={plugin:n},e(this.plugin)):"cadesplugin_load_error"===i.data?t({message:`${this.pluginName}: плагин недоступен`}):t({message:`${this.pluginName}: ошибка иницилизации`})},window.addEventListener("message",this.onMessageHandler,{once:!0}),window.postMessage("cadesplugin_echo_request","*"))}))}};p.injectName="cryptoProService",p=__decorate([(0,c.b2)(),__param(0,(0,c.f3)(l.t.ILogger)),__param(1,(0,c.f3)(l.t.Config)),__param(2,(0,c.f3)(l.t.Store)),__param(3,(0,c.f3)(a.M.IQueryBus)),__metadata("design:paramtypes",[Object,Object,d.yh,Object])],p)},31025:(e,t,n)=>{"use strict";n.d(t,{C:()=>DateTimeService});var i=n(81086),o=n(40395);const s=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"];class DateTimeService{static culture(){return"ru-RU"}static now(){return new Date}static toServerString(e){if(!e)return null;const t=-e.getTimezoneOffset(),n=t>=0?"+":"-",pad=function(e){const t=Math.abs(Math.floor(e));return(t<10?"0":"")+t};return`${e.getFullYear()}-${pad(e.getMonth()+1)}-${pad(e.getDate())}T${pad(e.getHours())}:${pad(e.getMinutes())}:${pad(e.getSeconds())}${n}${pad(t/60)}:${pad(t%60)}`}static dateToString(e,t="date time"){let n;if("string"===typeof e)try{if(n=DateTimeService.convert(e),isNaN(n.getTime()))throw new Error("Invalid Date")}catch(e){return e.message}else n=e;const i=s[n.getMonth()],o=n.getFullYear();let r=`0${n.getDate()}`,a=`0${n.getHours()}`,l=`0${n.getMinutes()}`;switch(r=r.substr(r.length-2,2),a=a.substr(a.length-2,2),l=l.substr(l.length-2,2),t){case"date":return`${r} ${i} ${o}`;case"date time":return`${r} ${i} ${o} ${a}:${l}`;default:return"Invalid format"}}static convert(e){return e instanceof Date?e:Array.isArray(e)?new Date(e[0],e[1],e[2]):"number"===typeof e||"string"===typeof e?new Date(e):"object"===typeof e&&"year"in e&&"month"in e&&"date"in e?new Date(e.year,e.month,e.date):e}static compare(e,t){const n=e?this.convert(e).valueOf():0,i=t?this.convert(t).valueOf():0;return isFinite(n)&&isFinite(i)?Number(n>i)-Number(n<i):NaN}static inRange(e,t,n){const i=this.convert(e).valueOf(),o=this.convert(t).valueOf(),s=this.convert(n).valueOf();return isFinite(i)&&isFinite(o)&&isFinite(s)?o<=i&&i<=s:NaN}static dateTimeStringToDate(e){return e?new Date(DateTimeService.dateTimeLocalToISO(e)):null}static dateTimeLocalToISO(e){const t=e.split(" ");let n="";return t[0]&&(n=DateTimeService.dateLocalToISO(t[0])),t[1]&&(n+=" "+DateTimeService.timeLocalToISO(t[1])),n}static dateLocalToISO(e){const t=/^(\d\d?).(\d\d?).(\d\d\d?\d?)$/.exec(e);let n="",i="",o="";return t[1]&&(o=1===t[1].length?"0"+t[1]:t[1]),t[2]&&(i=1===t[2].length?"0"+t[2]:t[2]),t[3]&&(n=t[3]),o&&i&&n?`${n}-${i}-${o}`:""}static timeLocalToISO(e){return e}static dateTimeToLocal(e){if(e instanceof Date)return DateTimeService.dateToLocal(e)+" "+e.toLocaleTimeString();const t=e.split(" ");let n="";return t[0]&&(n=DateTimeService.dateToLocal(t[0])),t[1]&&(n+=" "+DateTimeService.timeToLocal(t[1])),n}static dateToLocal(e){if(e instanceof Date)return e.toLocaleDateString();const t=/^(\d\d\d?\d?)-(\d\d?)-(\d\d?)$/.exec(e);let n="",i="",o="";return t[1]&&(n=t[1]),t[2]&&(i=1===t[2].length?"0"+t[2]:t[2]),t[3]&&(o=1===t[3].length?"0"+t[3]:t[3]),o&&i&&n?`${o}.${i}.${n}`:""}static timeToLocal(e){return e}static shortDateFromISO(e){if(e){const t=new Date(e),n=new Date;if(t.toDateString()===n.toDateString())return`сегодня ${(0,i.v)(t,"hh:mm")}`;const o=t.getMonth()+1;return`${t.getDate()<10?"0"+t.getDate():t.getDate()}.${o<10?"0"+o:o}.${t.getFullYear()}`}return""}}DateTimeService.dateMask="`d.`m.Y",DateTimeService.dateGroups={d:{mask:o.ZP.MaskedRange,from:1,to:31,maxLength:2},m:{mask:o.ZP.MaskedRange,from:1,to:12,maxLength:2},Y:{mask:o.ZP.MaskedRange,from:1900,to:9999}},DateTimeService.timeMask="HH:mm",DateTimeService.timeGroups={HH:{mask:o.ZP.MaskedRange,from:0,to:23},mm:{mask:o.ZP.MaskedRange,from:0,to:59}},DateTimeService.dateTimeMask="`d.`m.Y HH:mm",DateTimeService.dateTimeGroups=Object.assign(Object.assign({},DateTimeService.dateGroups),DateTimeService.timeGroups),DateTimeService.dateTimeDisplayFormat="DD.MM.YYYY hh:mm",DateTimeService.dateDisplayFormat="DD.MM.YYYY",DateTimeService.timeDisplayFormat="hh:mm"},54052:(e,t,n)=>{"use strict";n.d(t,{c:()=>v});var i,o=n(64447),s=n(22402),r=n(24578),a=n(20386),l=n(54626),c=n(1869),d=n(508),u=n(40551),p=n(92673),h=n(98917),m=n(9669),f=n.n(m),g=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const y=[{key:"0x000004C7",value:"Операция была отменена пользователем."},{key:"0x8010006E",value:"Операция была отменена пользователем."},{key:"0x8009200B",value:"Произошла ошибка с вашим ключом. Проверьте ключ и настройки."},{key:"0x8010006B",value:"Неверный пароль. Повторите ввод."},{key:"0x800B010A",value:"Найденный сертификат выписан не доверенным корневым центром."},{key:"0x8007065B",value:"Срок действия этой версии Крипто про CSP истек."},{key:"0x80090010",value:"Истек срок действия ключа."},{key:"0x8010006C",value:"Нет доступа к карте. Число попыток ввести правильный PIN-код исчерпано."},{key:"0x80091007",value:"Неправильное значение хеша."},{key:"0x8009100E",value:"Не найден автор исходной подписи."}];class DssError extends Error{constructor(e,t){super(e),this.message=e,this.data=t}}let v=i=class EsignService{constructor(e,t,n,i,o){this._log=e,this._config=t,this.cryptoProService=n,this._commandBus=i,this._queryBus=o}static getErrorMessage(e){let t;if(e.number&&Number.isInteger(e.number)&&(t=`0x${i.decimalToHexString(e.number)}`),"string"===typeof e.message||t){const n=y.find((n=>{const i=new RegExp(`${n.key}`,"gi");return i.test(e.message)||t&&i.test(t)}));if(n)return n.value}return e.message}static decimalToHexString(e){return e<0&&(e=4294967295+e+1),e.toString(16).toUpperCase()}getEsigns(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const n=this.getEsignsUrl(e,t),{data:i}=yield f().get(n);return i}catch(e){(0,h.UZ)(e)}}))}getDetails(e,t,n,i){return __awaiter(this,void 0,void 0,(function*(){try{const o=this.getEsignsDetailsUrl(e,t,n),{data:{response:s}}=yield f().get(o,{params:{operationId:i}});return s}catch(e){let t;throw t=e.response&&e.response.data?e.response.data:{displayableError:!0,httpCode:e.status,message:e.message,response:null},t}}))}getBuffer(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const n=this.getDataBufferUrl(e,t),{data:i}=yield f().get(n);return i}catch(e){(0,h.UZ)(e)}}))}doSignableAction(e,t){var n,i;return __awaiter(this,void 0,void 0,(function*(){try{let n;this._log.debug("enter doSignableAction");const i=yield this.getEsignMode(!1);if(!this._config.enableEsign&&i!==r.Ky.Disabled){const e=yield this._queryBus.exec(new a.l("Внимание!","Операция будет выполнена без ЭП, т.к. эта возможность отключена на уровне конфигурации приложения.<br> Продолжить?"));if(!e)throw new h.Mk("Операция отменена пользователем (ЭП отключена на уровне конфигурации приложения)",null,!1)}let s,l,c=!1,d=!1,u="";if(i!==r.Ky.Disabled&&i!==r.Ky.DSS&&(c=yield this.checkPlugin(),c&&(s=yield this.cryptoProService.getCertificate(),"string"!==typeof s?(d=Boolean(s),d&&(l=yield this.cryptoProService.getHashAlgorithm(s))):u=s)),i===r.Ky.Optional){let e=!0;if(c){if(!d){const t=u||"Не найден подходящий сертификат.";e=yield this._queryBus.exec(new a.l("Внимание!",`Операция будет выполнена без ЭП. ${t}<br> Продолжить?`))}}else e=yield this._queryBus.exec(new a.l("Внимание!",`${this.noPluginMessage()}<br> Продолжить?`));if(!e)throw new h.Mk("Операция отменена пользователем (нет плагина Crypto Pro или подходящего сертификата)",null,!1)}else if(i===r.Ky.Enabled){if(!c)throw new h.vr(this.noPluginMessage(),!0);if(u)throw new h.vr(this.revokedCertificateMessage(),!0);if(!d)throw new h.vr(this.noCertificateMessage(),!0)}const p=localStorage.getItem("dss_code");p&&localStorage.removeItem("dss_code");const m={request:t,signs:[],operationSign:null,hasPlugin:c&&d,signServiceUrl:this.relativeToAbsolute(this._config.securityApiPath),dssSecurityToken:null,dssCredentials:{username:null,password:null,pinCode:p},algorithm:l,useLastVersion:null===t||void 0===t?void 0:t.useLastVersion};this._log.debug("doSignableAction");const{data:f}=yield this.makeSignableHttpRequest((()=>e(m)));if(n=f,f.signStatus===r.Ho.DssCredentialsRequired);else if(f.signStatus===r.Ho.DssSecurityTokenRequired){const e=f.oAuthUrl;if(window.location.pathname.includes("message/new")){const e=f.requestToSign.instructionId;this._commandBus.exec(new o.z_(`/message/${e}/edit`))}throw window.location.href=e,n.success.displayableError=!0,new DssError("Необходимо авторизоваться в DSS",n.success)}if(n.signStatus!==r.Ho.SignRequired)return n.success;m.request=n.requestToSign,yield this.addSignsToRequest(n,m,s);const g=yield this.makeSignableHttpRequest((()=>e(m)));return n=g.data,this._log.info(`ЭП статус ${r.Ho[n.signStatus]}, operationId=${n.operationId} `),n.success}catch(e){if(e instanceof h.vr)throw e;if(e.message.includes("0x000004C7"))throw new h.Mk(e.message.replace("(0x000004C7)",""),e,!0);if(e.response){const t=null===(i=null===(n=e.response.data)||void 0===n?void 0:n.success)||void 0===i?void 0:i.message;if(t)throw new h.vr(t,!0);if(500===e.response.status)throw new h.vr("Произошла непредвиденная ошибка",!0)}throw new h.vr(e.message,!0)}}))}signFiles(e,t,n){return __awaiter(this,void 0,void 0,(function*(){const i=[],o=[],s=yield this.getEsignMode(!1);let a,c,d=!0,u=!1,p=!1,m="";if(s!==r.Ky.Disabled&&s!==r.Ky.DSS?(u=yield this.checkPlugin(),u&&(a=yield this.cryptoProService.getCertificate(),"string"!==typeof a?p=Boolean(a):m=a)):d=!1,d&&!u)throw new h.vr(this.noPluginMessage(),!0);if(m)throw new h.vr(this.revokedCertificateMessage(),!0);if(d&&!p)throw new h.vr(this.noCertificateMessage(),!0);try{c=yield this.getFilesHash(this._config.apiPath(),n,e,u,a)}catch(e){throw new h.vr(e.message,!0)}if(this._log.debug(c),!Array.isArray(c)||!c.length)throw new h.vr("Нет файлов, требующих ЭП",!0);if(s===r.Ky.DSS){if(c=c.filter((e=>e.signStatus===r.Ho.DssSecurityTokenRequired)),c.length){const e=c[0],t=e.oAuthUrl;localStorage.setItem("dss_signFiles","true"),this._queryBus.exec(new l._({text:"<h3>Сейчас вы будете перенаправлены на страницу авторизации DSS</h3>"})),window.location.href=t;const n=e;throw n.success.displayableError=!0,new DssError("Необходимо авторизоваться в DSS",n.success)}return}if(c=c.filter((e=>e.signStatus===r.Ho.SignRequired)),!c.length)throw new h.vr("Нет файлов, требующих ЭП",!0);c.forEach(((e,n)=>{i.push({request:{operationTypeId:t},signs:[],operationSign:{base64Data:"",version:0,isHash:!1},hasPlugin:!0,signServiceUrl:this.relativeToAbsolute(this._config.securityApiPath)}),o.push(this.addSignsToRequest(e,i[n],a))})),yield Promise.all(o);const g={operationTypeId:t,objectId:n,operationESign:i[0].operationSign.base64Data,filesIds:e,filesSigns:[]};i.forEach((e=>{g.filesSigns.push(e.signs[0].base64Data)}));try{const{data:e}=yield f().post(`${this._config.apiPath()}document/signFiles`,g);this._log.info(e)}catch(e){throw new Error(e)}}))}checkPlugin(){return __awaiter(this,void 0,void 0,(function*(){if(this._config.enableEsign){const e=yield this.cryptoProService.hasPlugin();return e}return!1}))}getEsignMode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this._queryBus.exec(new d.n7(e));return t.esignMode}))}getEsignStatusColor(e){return e===r.do.Success?"success":"warning"}makeSignableHttpRequest(e){return __awaiter(this,void 0,void 0,(function*(){try{return yield e()}catch(e){if(e.data&&"signStatus"in e.data){const t=e.data;e.message=e.data.failMessage||e.message,e.displayableError=Boolean(e.data.failMessage),e.data=t.success||t.requestToSign}throw e}}))}addSignsToRequest(e,t,n){return __awaiter(this,void 0,void 0,(function*(){try{const i=yield this.cryptoProService.getCspVersion();this._log.debug(`CSP v.${i}`);for(const t of e.buffersToSign)t.isHash?t.base64Data=yield this.cryptoProService.signHash(n,t.base64Data):t.base64Data=yield this.cryptoProService.signBuffer(n,t.base64Data);const o=yield this.getOperationBuffer(e.requestToSign.operationTypeId||e.operationId,e.buffersToSign.map((e=>e.base64Data))),s=yield this.cryptoProService.signBuffer(n,o.operationBuffer);let r=0;t.signs=e.buffersToSign.map((e=>(e.base64Data=o.objectEsigns[r],r++,e))),t.operationSign={base64Data:s,version:0,isHash:!1}}catch(t){throw this.handleExceptionMessageForAddSignsToRequest(t,e.requestToSign)}}))}handleExceptionMessageForAddSignsToRequest(e,t){let n=null,o=!1;return"string"!==typeof e&&e.message&&(o=e.displayableError||!1,n=i.getErrorMessage(e)),{message:null!==n&&void 0!==n?n:e,data:t,displayableError:o}}getOperationBuffer(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=`${this._config.securityApiPath}operations/buffer`,i={operationId:e,entitySigns:t},{data:o}=yield f().post(n,i);return o}))}noPluginMessage(){return"Плагин КриптоПро не установлен или выключен. Обратитесь к администратору системы"}noCertificateMessage(){return"Не найдено ни одного действующего сертификата."}revokedCertificateMessage(){return"Невозможно подписать документ. Сертификат пользователя отозван."}getEsignsUrl(e,t){return`${this._config.securityApiPath}${e}/${t}/esigns`}getEsignsDetailsUrl(e,t,n){return`${this._config.apiPath()}${e}/${t}/esigns/${n}/details`}getDataBufferUrl(e,t){return`${this._config.securityApiPath}${e}/${t}/esigns/buffer`}relativeToAbsolute(e){const t=document.createElement("a");return t.href=e,t.href}getFilesHash(e,t,n,i,o){var s,r,a;return __awaiter(this,void 0,void 0,(function*(){let l;o&&(l=yield this.cryptoProService.getHashAlgorithm(o));const c=[],d=[],u=localStorage.getItem("dss_code");u&&localStorage.removeItem("dss_code"),n.forEach((e=>{c.push({request:{operationTypeId:o?0:void 0,instructionId:String(e),operationDocumentId:t},hasPlugin:i,signs:null,operationSign:null,signServiceUrl:null,algorithm:l,dssSecurityToken:null,dssCredentials:{username:null,password:null,pinCode:u}})})),c.forEach(((t,i)=>{d.push(f().post(`${e}instruction/${n[i]}/report/signDocs`,t))}));try{const e=yield Promise.all(d);return e.map((e=>e.data))}catch(e){if(this._log.error(e),null===(r=null===(s=e.response)||void 0===s?void 0:s.data)||void 0===r?void 0:r.failMessage)throw new Error(null===(a=e.response.data)||void 0===a?void 0:a.failMessage)}}))}};v=i=__decorate([(0,g.b2)(),__param(0,(0,g.f3)(p.t.ILogger)),__param(1,(0,g.f3)(p.t.Config)),__param(2,(0,g.f3)(u.b)),__param(3,(0,g.f3)(s.O.ICommandBus)),__param(4,(0,g.f3)(c.M.IQueryBus)),__metadata("design:paramtypes",[Object,Object,u.b,Object,Object])],v)},16273:(e,t,n)=>{"use strict";function getFileExtension(e){return e?e.slice(2+(e.lastIndexOf(".")-1>>>0)).toLowerCase():""}function cutFullFileName(e,t){if(!e)return"";const n=getFileExtension(e);return`${e.slice(0,t-3-n.length)}...${n}`}function fileExtensionCheck(e,t){return!e||0===e.length||e.every((e=>{var n;let i=null;i="extension"in e?e.extension:e.fileExtension;let o=null;return o="name"in e?e.name:null!==(n=e.fullFileName)&&void 0!==n?n:e.fileName,o&&!i&&(i=getFileExtension(o)),t.includes(i.toLowerCase())}))}n.d(t,{mD:()=>getFileExtension,dq:()=>cutFullFileName,ZV:()=>fileExtensionCheck})},28517:(e,t,n)=>{"use strict";n.d(t,{C:()=>IconService});var i=n(24578),o=n(26825);function getInstructionStateInfo(e){if(!e)return{name:e,num:0,desc:e};switch(e.toUpperCase()){case o.nJ.NotActive:return{name:e.toUpperCase(),num:1,desc:"Проект"};case o.nJ.Active:return{name:e.toUpperCase(),num:2,desc:"Активно"};case o.nJ.ActiveRedirected:return{name:e.toUpperCase(),num:3,desc:"Активно (перенаправлено)"};case o.nJ.ActiveOvertime:return{name:e.toUpperCase(),num:4,desc:"Активно (срок исполнения истек)"};case o.nJ.ActiveOvertimeRedirected:return{name:e.toUpperCase(),num:5,desc:"Активно (срок исполнения истек) (перенаправлено)"};case o.nJ.InWork:return{name:e.toUpperCase(),num:6,desc:"В работе"};case o.nJ.InWorkRedirected:return{name:e.toUpperCase(),num:7,desc:"В работе (перенаправлено)"};case o.nJ.Done:return{name:e.toUpperCase(),num:8,desc:"Подготовлен (успешно)"};case o.nJ.DoneRedirected:return{name:e.toUpperCase(),num:9,desc:"Завершено (успешно) (перенаправлено)"};case o.nJ.DoneError:return{name:e.toUpperCase(),num:10,desc:"Подготовлен (с отказом)"};case o.nJ.DoneErrorRedirected:return{name:e.toUpperCase(),num:11,desc:"Подготовлен (с отказом) (перенаправлен)"};case o.nJ.ResultPlus:return{name:e.toUpperCase(),num:12,desc:"Принят (успешно)"};case o.nJ.ResultPlusRedirected:return{name:e.toUpperCase(),num:13,desc:"Принят (успешно) (перенаправлено)"};case o.nJ.ResultMinus:return{name:e.toUpperCase(),num:14,desc:"Принят (с отказом)"};case o.nJ.ResultMinusRedirected:return{name:e.toUpperCase(),num:15,desc:"Принят (с отказом) (перенаправлено)"};case o.nJ.Readed:return{name:e.toUpperCase(),num:16,desc:"Прочитано"};case o.nJ.ReadedRedirected:return{name:e.toUpperCase(),num:17,desc:"Прочитано (перенаправлено)"};case o.nJ.Canceled:return{name:e.toUpperCase(),num:18,desc:"Отменено"};case o.nJ.CanceledRedirected:return{name:e.toUpperCase(),num:19,desc:"Отменено (перенаправлено)"};case o.nJ.Deleted:return{name:e.toUpperCase(),num:20,desc:"Удалено"};case o.nJ.DeletedRedirected:return{name:e.toUpperCase(),num:21,desc:"Удалено (перенаправлено)"};default:return{name:e.toUpperCase(),num:0,desc:e}}}var s=n(73043);const r="badge-danger",a="pe-7s-check",l="pe-7s-close-circle",c="pe-7s-repeat",d="pe-7s-help1",u="pe-7s-star";class IconService{static toBoolSprite(e,t,n){return!t||"true"!==e&&!0!==Boolean(e)?!n||"false"!==e&&!1!==Boolean(e)?"":`k-sprite ${n}`:`k-sprite ${t}`}static setEsignDetailsStatus(e){const t={badgeColor:"",stateName:""};switch(e){case i.do.NoSign:t.stateName="Подпись отсутствует",t.badgeColor="badge-secondary";break;case i.do.Success:t.stateName="Подпись верна",t.badgeColor="green";break;case i.do.SignInvalid:t.stateName="Подпись неверна",t.badgeColor=r;break;case i.do.OtherError:t.stateName="Ошибка проверки подписи",t.badgeColor=r;break;case i.do.NotSignedByServer:t.stateName="Подпись не заверена сервером безопасности",t.badgeColor=r;break}return t}static extentionSvgIcon(e){return e?(e=e.toLowerCase(),e.includes("doc")||e.includes("rtf")?"doc-file":e.includes("pdf")?"pdf-file":e.includes("png")||e.includes("jpg")?"img-file":"unknown-file"):"unknown-file"}static extentionIco(e){if(!e)return"";e=e.toLowerCase();const t="insert_drive_file";return e.includes("txt")?"description":e.includes("xls")?"tab":e.includes("jpg")||e.includes("gif")||e.includes("png")||e.includes("tif")?"image":e.includes("zip")||e.includes("rar")||e.includes("7z")||e.includes("tar")||e.includes("cab")?"archive":e.includes("mp3")||e.includes("wav")?"audiotrack":e.includes("mov")||e.includes("avi")?"ondemand_video":t}static getExtentionIco(e){return e?(e=e.toLowerCase(),e.includes("doc")||e.includes("rtf")?"fa-file-word-o":e.includes("txt")?"fa-file-text-o":e.includes("pdf")?"fa-file-pdf-o":e.includes("xls")?"fa-file-excel-o":e.includes("jpg")||e.includes("gif")||e.includes("png")||e.includes("tif")?"fa-file-image-o":e.includes("zip")||e.includes("rar")||e.includes("7z")||e.includes("tar")||e.includes("cab")?"fa-file-archive-o":e.includes("mp3")||e.includes("wav")?"fa-file-audio-o":e.includes("mov")||e.includes("avi")?"fa-file-video-o":"fa-file-o"):""}static toStateSprite(e){const t=IconService.getIconSprite(e);return t&&t.length>0?`k-sprite ${t}`:""}static toSentTypeSprite(e){switch(e){case s.z.FanWithExecutive:return"k-sprite fan";case s.z.Fan:return"k-sprite node";case s.z.ChainWithExecutive:return"k-sprite chain";case s.z.Chain:return"k-sprite chain";default:return""}}static nodeIcon(e){return"Входящая"===e.name?"fa fa-envelope":"Проекты"===e.name?"fa fa-pencil-square-o":"На контроле"===e.name?"fa fa-file":"Исходящая"===e.name?"fa fa-envelope-open-o":"Архив"===e.name?"fa fa-archive":"fa fa-folder-o"}static getListSheetIconInfo(e){switch(e){case 1:return"pe-7s-gleam";case 2:return"pe-7s-pen";case 3:return a;default:return l}}static getListIconInfo(e){const t=getInstructionStateInfo(e);switch(t.num){case 1:return{icon:"pe-7s-diskette",desc:t.desc};case 2:return{icon:"pe-7s-flag",desc:t.desc};case 3:return{icon:"pe-7s-flag",colorTop:"black",iconTop:c,desc:t.desc};case 4:return{icon:"pe-7s-stopwatch",desc:t.desc};case 5:return{icon:"pe-7s-stopwatch",colorTop:"black",iconTop:c,desc:t.desc};case 6:return{icon:"pe-7s-portfolio",desc:t.desc};case 7:return{icon:"pe-7s-portfolio",colorTop:"black",iconTop:c,desc:t.desc};case 8:return{icon:a,colorTop:"black",iconTop:d,desc:t.desc};case 9:return{icon:a,colorTop:"black",iconTop:c,colorBottom:"black",iconBottom:d,desc:t.desc};case 10:return{icon:l,colorTop:"black",iconTop:d,desc:t.desc};case 11:return{icon:l,colorTop:"black",iconTop:c,colorBottom:"black",iconBottom:d,desc:t.desc};case 12:return{icon:a,colorBottom:"black",iconBottom:u,desc:t.desc};case 13:return{icon:a,colorTop:"black",iconTop:c,colorBottom:"black",iconBottom:u,desc:t.desc};case 14:return{icon:l,colorBottom:"black",iconBottom:u,desc:t.desc};case 15:return{icon:l,colorTop:"black",iconTop:c,colorBottom:"black",iconBottom:u,desc:t.desc};case 16:return{icon:"pe-7s-mail-open",desc:t.desc};case 17:return{icon:"pe-7s-mail-open",colorTop:"black",iconTop:c,desc:t.desc};case 18:return{icon:"pe-7s-back",desc:t.desc};case 19:return{icon:"pe-7s-back",colorTop:"black",iconTop:c,desc:t.desc};case 20:case 21:return{icon:"pe-7s-trash",desc:t.desc};default:return{icon:l,colorTop:"danger",iconTop:"pe-7s-volume",desc:e}}}static getIconSprite(e){const t=getInstructionStateInfo(e).num;switch(t){case 1:return"diskette";case 2:return"active-message";case 3:return"active-message-resend";case 4:return"active-overdue-message";case 5:return"active-overdue-message-resend";case 6:return"briefcase";case 7:return"briefcase-resend";case 8:return"report-complete-successful-not-accepted";case 9:return"report-resend";case 10:return"report-complete-fail-not-accepted";case 11:return"report-complete-fail-not-accepted-resend";case 12:return"message-successful-accepted";case 13:return"message-successful-resend";case 14:return"message-fail-accepted";case 15:return"message-fail-accepted-resend";case 16:return"message-read-archive";case 17:return"message-read-archive-resend";case 18:return"withdrawn";case 19:return"withdrawn-resend";case 20:case 21:return"deleted";default:return""}}}},4381:(e,t,n)=>{"use strict";n.d(t,{g:()=>u});var i=n(38235),o=n(11135),s=n(72835),r=n(50103);class KanbanBoard{constructor(){this.id=0,this.name="",this.srcFolders=null,this.srcDocument=0,this.entityType=i.c.Task,this.folderKind=o.Wy.Inbox,this.groupingTitle="",this.groupBy="",this.groupName="",this.columns=[]}from(e){return e?(e.id&&(this.id=e.id),e.name&&(this.name=e.name),e.srcFolders&&(this.srcFolders=e.srcFolders),e.srcDocument&&(this.srcDocument=e.srcDocument),e.entityType&&(this.entityType=e.entityType),void 0!==e.folderKind&&(this.folderKind=e.folderKind),e.groupingTitle&&(this.groupingTitle=e.groupingTitle),e.groupBy&&(this.groupBy=e.groupBy),e.groupName&&(this.groupName=e.groupName),e.columns&&(this.columns=e.columns),e.entityType&&(this.entityType=e.entityType),this):this}toFolderInfo(){return{id:this.id,isConsolidated:!1,name:this.name,parentFolderID:0,parentId:0,folderKind:this.folderKind,topLevelFolderId:u.ROOT_NODE_ID,type:"",compositeId:null,nodeType:s.J.Kanban,contentType:this.getContentType()}}toObjectForSend(){const e={};return["name","srcFolders","srcDocument","entityType","folderKind","groupingTitle","groupBy","groupName"].forEach((t=>{e[t]=this[t]})),e.columns=this.columns.map((e=>e.toObjectForSend())),e}getContentType(){switch(this.entityType){case i.c.Instruction:return r.zc.Instruction;case i.c.Task:return r.zc.Task;default:return r.zc.Instruction}}}var a=n(76196);class KanbanArea{constructor(e,t="",n=i.U.NoType){this.active=!1,this.id=(0,a.Z)(6,"0-9"),this.columnId=e,this.caption=t,this.type=n}setActive(e){this.active=e}}class KanbanColumn{constructor(e=""){this.conditionId=null,this.moveConditionId=-1,this.areas=[],this.actionId="",this.scenarioId="default",this.order=0,this.default=!1,this.entities=[],this.highlight=!1,this.locked=!1,this.isManyAreas=!1,this.isCurrent=!1,this.isTarget=!1,this.isOwner=!1,this.id=(0,a.Z)(6,"0-9"),this.caption=e,this.areas=[new KanbanArea(this.id)]}from(e){return e?(void 0!==e.id&&(this.id=e.id),e.caption&&(this.caption=e.caption),void 0!==e.conditionId&&(this.conditionId=e.conditionId),void 0!==e.moveConditionId&&(this.moveConditionId=e.moveConditionId),e.scenarioId&&(this.scenarioId=e.scenarioId,this.actionId=""),e.actionId&&(this.actionId=e.actionId,this.scenarioId=""),void 0!==e.default&&(this.default=e.default),e.entities&&(this.entities=e.entities),this):this}reset(){this.highlight=!1,this.locked=!1,this.isTarget=!1,this.isCurrent=!1,this.isOwner=!1}createAreas(e=[{caption:"",type:i.U.NoType}]){this.areas=e.map((e=>new KanbanArea(this.id,e.caption,e.type))),this.areas.length>1&&(this.isManyAreas=!0)}findArea(e){return this.areas.find((t=>t.id===e))}findEntityIndex(e){return this.entities.findIndex((t=>t.uid===e))}setActiveArea(e){this.areas.forEach((t=>{t.setActive(t.id===e)}))}resetAreas(){this.areas.forEach((e=>{e.setActive(!1)}))}addEntity(e){this.entities.push({uid:e,columnId:this.id})}removeEntity(e){this.entities=this.entities.filter((t=>t.uid!==e))}toObjectForSend(){const e={};return["id","caption","conditionId","moveConditionId","actionId","scenarioId","order","default","entities"].forEach((t=>{e[t]=this[t]})),e}}var l=n(31025);class KanbanTask{constructor(e="",t=null,n=""){this.id=(0,a.Z)(6,"0-9"),this.subject=e,this.expDate=t,this.body=n}from(e){return e?(e.id&&(this.id=e.id),e.subject&&(this.subject=e.subject),e.expDate&&(this.expDate=e.expDate),e.body&&(this.body=e.body),this):this}get formatExpDate(){return this.expDate?new Date(this.expDate).toLocaleDateString():""}get isExpired(){return!!this.expDate&&-1===l.C.compare(new Date(this.expDate),new Date)}}var c,d=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let u=c=class KanbanService{static createBoard(e){const t=Object.keys(c.boards).length+1+c.ROOT_NODE_ID;return(new KanbanBoard).from(Object.assign({id:t},e))}static createColumn(e){return(new KanbanColumn).from(e)}static createTask(e){return(new KanbanTask).from(e)}static getUID(){return(0,a.Z)(6,"0-9")}};u.ROOT_NODE_ID=3e3,u.boards=null,u.excludeActions=["SendReport","SendRejectionReport","CreateReport","EditReport","ToWork"],u=c=__decorate([(0,d.b2)()],u)},11583:(e,t,n)=>{"use strict";function filterTableRows(e,t,n){if(!e||!t)return[];if(n){const i=[],o=new RegExp('[!@#$%^&*(),.?":{}|<>]');let s="";for(const e of n)o.exec(e)&&(s+="\\"),s+=e;let r="",a=!1;for(const o of e){for(const e of t)if(!a){if(o[e.prop]){if(r=o[e.prop].toString().toLowerCase(),r.match(s.toLowerCase())){i.push(o),a=!0;continue}}else""===n&&(i.push(o),a=!0);r=""}a=!1}return i}return e}n.d(t,{O:()=>filterTableRows})},76110:(e,t,n)=>{"use strict";n.d(t,{$:()=>findTreeNode,t:()=>toTreeViewModel});var i=n(11135),o=n(72835),s=n(50103);const r=".",a={1999:"inbox",2107:"inbox",2102:"projects",2101:"outbox",2108:"outbox",2103:"report-control",2109:"report-control",2104:"make-control",2110:"make-control",987:"archive"};function defaultTreeViewModel(){return{id:null,compositeId:"",name:"",spriteCssClass:"",showCountBadge:!1,countBadge:0,selected:!1,expanded:!1,items:[],nodeData:null,nodeKind:i.Wy.Inbox,topLevelNodeId:null,nodeType:o.J.Fake,contentType:null,canBeFavorite:!1,isFavourite:!1}}function getMappedIcon(e,t){return t===s.zc.Document?e.isConsolidated?"filtered":"folder":t===s.zc.Instruction?a[Number(e.id)]||(e.isConsolidated?"filtered":"folder"):""}function nodeFullId(e){return e.join(r)}function findTreeNode(e,t,n,i){let o=null;for(const s of e){if(s.nodeData.id==t&&s!==n&&(i&&s.nodeData.topLevelFolderId===i||!i)){o=s;break}if(o=findTreeNode(s.items,t,n,i),o)return o}return o}function toTreeViewModel(e,t,n=0,i=!1){var r,a,l;const c=[],d={},getHashed=(e,t)=>{let n=d[e];return(!n||t&&(null===n||void 0===n?void 0:n.parentId)!==t)&&(d[e]=defaultTreeViewModel(),n=d[e]),n},u={};for(const t of e)u[t.id]=t;const getPath=e=>{var t;const i=[];do{i.unshift(e);const n=u[e];e=n?null!==(t=n.parentId)&&void 0!==t?t:n.parentFolderID:null}while(null!==e&&e!==n);return i};for(const i of e){if(i.id==(null!==(r=i.parentId)&&void 0!==r?r:i.parentFolderID))throw new Error(`Tree item is cannot reference to itself, id=${i.id}, parentId=${null!==(a=i.parentId)&&void 0!==a?a:i.parentFolderID}`);const e=getHashed(i.id.toString(),i.parentId);let d;e.id=i.id,e.name=i.name,e.contentType=t||i.contentType,e.spriteCssClass=getMappedIcon(i,t||i.contentType),e.nodeData=i,e.nodeType=i.nodeType,e.nodeKind=i.kind,e.parentId=null!==(l=i.parentId)&&void 0!==l?l:i.parentFolderID,e.topLevelNodeId=i.topLevelFolderId,e.baseUrl=i.baseUrl,e.isFavourite=i.isFavourite,e.canBeFavorite=i.canBeFavorite,e.parentId!==n?(d=getHashed(e.parentId.toString()),d.items.push(e),d.nodeType!==o.J.Fake&&[s.zc.FastReport,s.zc.Vocabulary].includes(t)&&(d.nodeType=o.J.Fake)):c.push(e);const u=getPath(i.id);e.compositeId=nodeFullId(u),i.compositeId=e.compositeId}return i&&c.forEach((e=>{sortItems(e)})),c}function sortItems(e){e.items&&e.items.length&&(e.items=e.items.sort(((e,t)=>e.name<t.name?-1:1)),e.items.forEach((e=>{sortItems(e)})))}},31716:(e,t,n)=>{"use strict";function getUserFullString(e){if(e){if(e.positionName&&e.departmentName)return`${e.positionName}, ${e.departmentName}`;const t=e.positionName||e.departmentName;return t||""}return""}n.d(t,{F:()=>getUserFullString})},18220:(e,t,n)=>{"use strict";n.d(t,{Hg:()=>RootAction,Rm:()=>InstructionAction,jI:()=>DocumentAction,g4:()=>AuthAction,lY:()=>CardAction,d9:()=>ComponentAction,Gz:()=>FilterAction,p$:()=>FileAction,tz:()=>ReportAction,r5:()=>SettingAction,Vw:()=>UserAction,eI:()=>VocabularyAction,bV:()=>KanbanAction});var i=n(91487);function RootAction(e,t){return(0,i.aU)(e,t)}function InstructionAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="instructions"),(0,i.aU)(e,t)}function DocumentAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="documents"),(0,i.aU)(e,t)}function AuthAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="auth"),(0,i.aU)(e,t)}function CardAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="cards"),(0,i.aU)(e,t)}function ComponentAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="components"),(0,i.aU)(e,t)}function FilterAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="filters"),(0,i.aU)(e,t)}function FileAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="files"),(0,i.aU)(e,t)}function ReportAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="reports"),(0,i.aU)(e,t)}function SettingAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="settings"),(0,i.aU)(e,t)}function UserAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="users"),(0,i.aU)(e,t)}function VocabularyAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="vocabulary"),(0,i.aU)(e,t)}function KanbanAction(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="kanban"),(0,i.aU)(e,t)}},37920:(e,t,n)=>{"use strict";n.d(t,{u:()=>CardsGetter});var i=n(91487);function CardsGetter(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="cards"),(0,i.aD)(e,t)}},52469:(e,t,n)=>{"use strict";n.d(t,{d:()=>ComponentsGetter});var i=n(91487);function ComponentsGetter(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="components"),(0,i.aD)(e,t)}},54519:(e,t,n)=>{"use strict";n.d(t,{k:()=>DocumentGetter});var i=n(91487);function DocumentGetter(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="documents"),(0,i.aD)(e,t)}},17773:(e,t,n)=>{"use strict";n.d(t,{O:()=>RootGetter});var i=n(51414);function RootGetter(e,t){return(0,i.aD)(e,t)}},76764:(e,t,n)=>{"use strict";n.d(t,{Y:()=>InstructionGetter});var i=n(91487);function InstructionGetter(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="instructions"),(0,i.aD)(e,t)}},69585:(e,t,n)=>{"use strict";n.d(t,{x:()=>SettingsGetter});var i=n(91487);function SettingsGetter(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="settings"),(0,i.aD)(e,t)}},81675:(e,t,n)=>{"use strict";n.d(t,{Bu:()=>i,ZM:()=>o,YA:()=>s,w6:()=>r,c3:()=>a,cN:()=>l,Ss:()=>c,P$:()=>d});const i="SET_INSTR_FILTERS",o="SET_DOCS_FILTERS",s="SET_FILTER",r="SET_APPLIED_FILTER",a="SET_APPLIED_DATE_RANGE",l="SET_SRCH_FOLDER_FILTER",c="SET_APPLIED_SEARCH_TERM",d={[i](e,t){e.instructions[t.kind]=t.data},[o](e,t){e.documents[t.journalId]=t.data},[s](e,t){e.filters[Number(t.id)]=t.data},[r](e,{id:t,name:n,filter:i}){e.appliedFilters=Object.assign(Object.assign({},e.appliedFilters),{[t]:{name:n,filter:i}})},[a](e,{id:t,dateRange:n}){e.appliedDateRange=Object.assign(Object.assign({},e.appliedDateRange),{[t]:n})},[l](e,t){e.searchFolderFilters[t.searchFolderId]=t.data},[c](e,t){e.appliedSearchTerm=Object.assign(Object.assign({},e.appliedSearchTerm),{[t.folderId]:t.data})}}},83273:(e,t,n)=>{"use strict";var i;n.d(t,{x:()=>i}),function(e){e[e["Update"]=0]="Update",e[e["Remove"]=1]="Remove"}(i||(i={}))},25008:(e,t,n)=>{"use strict";n.d(t,{Ul:()=>i,bZ:()=>o,oT:()=>s,tO:()=>r,P$:()=>a});const i="SET_FOLDERS",o="SET_BOARDS",s="SET_PANEL_STATE",r="SET_PREVIEW_ENABLE",a={[i](e,t){e.folders=t},[o](e,t){e.boards=t},[s](e,t){e.expandedPanels=t},[r](e,t){e.previewEnabled=t}}},2770:(e,t,n)=>{"use strict";n.d(t,{Jx:()=>r,cl:()=>a,uC:()=>l,Ei:()=>c,hv:()=>d,So:()=>u,Kf:()=>p,lg:()=>h,s7:()=>m,z4:()=>f,gM:()=>g,O$:()=>b,lQ:()=>C,rV:()=>w,F9:()=>_,xZ:()=>x,ce:()=>S,Il:()=>I,re:()=>D,ex:()=>T,y0:()=>P,P$:()=>O});var i=n(34317),o=n(2934),s=n.n(o);const r="SET_IOC",a="SET_CONFIG",l="SET_CURRENT_USER",c="SET_DEPUTIES",d="SET_HISTORY",u="SET_NOTIFICATIONS",p="REMOVE_NOTIFICATION",h="SET_RIGHTS",m="SET_RIGHTOBJECTS",f="SET_MEMBERRIGHTS",g="SET_ARCHIVE_FOLDERS",y="SET_HELP_AUTO_START",v="SET_ARCHIVE_MENU_ACTIONS",b="SET_CERT",C="SET_TEMPLATE",w="SET_MANIFEST",_="SET_LD_OPTIONS",x="SET_FAV_FOLDER",S="SET_ACTIVE_MSG_ID",I="SET_ACTIVE_DOC_ID",D="SET_PREVIEW_DOC_ID",R="SET_CURRENT_FOLDER",T="SET_VIEW_STATE",P="SET_MIXIN",O={[r](e,t){e.container=t},[a](e,t){e.config=t},[y](e,t){e.helpAutoStart=t},[l](e,t){e.currentUser=t},[c](e,t){e.deputyList=t},[d](e,t){e.historyList=t},[u](e,t){s().set(e.notifications,t.notificationType,t.data)},[p](e,t){if(!e.notifications)return;const n=e.notifications[t.notificationType].findIndex((e=>e.folderId===t.id));n>=0&&e.notifications[t.notificationType].splice(n,1)},[h](e,t){t&&Object.keys(t).forEach((n=>{e.rights[Number(n)]=t[Number(n)]}))},[f](e,t){t&&Object.keys(t).forEach((n=>{e.memberRights[Number(n)]=t[Number(n)]}))},[m](e,t){t&&Object.keys(t).forEach((n=>{e.rightObjects[Number(n)]=t[Number(n)]}))},[g](e,t){let n,o;e.archiveInstrFolders=t.instr,e.archiveDocFolders=t.docs,Array.isArray(t.instr)&&(n=(0,i.F)(t.instr,"id")),Array.isArray(t.docs)&&(o=(0,i.F)(t.docs,"id")),e.archiveFolderDict=Object.assign(Object.assign({},n),o)},[v](e,t){let n=e.actions[t.folderId];n||(n={},e.actions[t.folderId]=n),n[t.id]=t.items},[b](e,t){e.cert=t},[C](e,t){e.templates[t.key]=t.template},[P](e,t){if(e.mixins[t.key]=t.data,t.depent){let n=e.mixinDependencies[t.key];n||(n=new Set,e.mixinDependencies[t.key]=n),n.add(t.depent)}},[w](e,t){e.manifest[t.key]=t.data},[_](e,t){e.ldOptions=t},[x](e,t){e.favouriteFolder=t},[S](e,t){e.activeMessageId=t},[I](e,t){e.activeDocumentId=t},[D](e,t){e.previewDocumentId=t},[R](e,t){e.currentFolder=t},[T](e,t){e.viewState[t.key]=t.data}}},74769:(e,t,n)=>{"use strict";var i;n.d(t,{i:()=>i}),function(e){e["Icon"]="Icon",e["RightIcon"]="RightIcon",e["Menu"]="Menu",e["Button"]="Button"}(i||(i={}))},39481:(e,t,n)=>{"use strict";n.d(t,{g:()=>fromRoute,O:()=>Breadcrumbs});var i=n(2557),o=n(73718);function fromRoute(e){return{fullPath:e.fullPath,hash:e.hash,params:e.params,path:e.path,query:e.query,meta:e.meta,name:e.name,redirectedFrom:e.redirectedFrom}}let s=0;class Breadcrumbs{constructor(e,t){this.id=++s,this._lostData=t||{},this._items=Array.isArray(e)?e:[],this._items.length&&"home"===this._items[0].text||(this._items.length&&!this._items[0].text&&this._items[0].route&&"default"===this._items[0].route.name?this._items[0].text="home":this._items.unshift({text:"home",route:{name:"default",path:"/",meta:{transition:i.k.ToHome}}}))}get items(){return[...this._items]}add(e){return!(!e||this._items.find((t=>t.route.path===e.route.path&&this.isEqualParams(t.route.params,e.route.params))))&&(this._lostData[e.route.path]&&(e.data=this._lostData[e.route.path],delete this._lostData[e.route.path]),this._items.push(e),!0)}replaceOrAdd(e){const t=this.last();return!!t&&(t.route.path===e.route.path&&this.isEqualParams(t.route.params,e.route.params)?(this._items[this._items.length-1]=e,!0):this.add(e))}tryReplaceLast(e){if(!this._items.length)return;const t=this._items[this._items.length-1];return"home"!==t.text&&(this._items[this._items.length-1]=e,!0)}last(){if(this._items&&this._items.length)return this._items[this._items.length-1]}updateText(e,t){this._items&&this._items.forEach((n=>{n.text===e&&(n.text=t)}))}addUrl(e,t,n){const i={text:e,remark:n,route:{path:t}};return this.add(i)}prev(e){if(this._items.length>1){e=e?Math.abs(e)+2:2;const t=this._items.length-e<0?0:this._items.length-e,n=this._items[t];return n.route}return null}itemsBefore(e){let t=[],n=!1;const i={};for(let o=this._items.length-1;o>=0;o--){const s=this._items[o];n||s.route.path!==e?n?t.push(s):s.data&&(i[s.route.path]=s.data):(n=!0,s.data&&(i[s.route.path]=s.data))}return t=t.reverse(),new Breadcrumbs(t,i)}setData(e){const t=this.last();t.data=e}isEqualParams(e,t){const n=Object.assign({},e);delete n.context;const i=Object.assign({},t);return delete i.context,(0,o.Z)(n,i)}}},69548:(e,t,n)=>{"use strict";var i;n.d(t,{H:()=>i}),function(e){e[e["Full"]=0]="Full",e[e["Preview"]=1]="Preview",e[e["Calendar"]=2]="Calendar",e[e["Card"]=3]="Card",e[e["Kanban"]=4]="Kanban"}(i||(i={}))},17996:(e,t,n)=>{"use strict";var i,o;n.d(t,{w:()=>i,m:()=>o}),function(e){e[e["Confirm"]=0]="Confirm",e[e["Alert"]=1]="Alert",e[e["Notification"]=2]="Notification",e[e["Select"]=3]="Select",e[e["Info"]=4]="Info",e[e["CreateEdit"]=5]="CreateEdit",e[e["Prompt"]=6]="Prompt"}(i||(i={})),function(e){e[e["Ok"]=0]="Ok",e[e["Cancel"]=1]="Cancel"}(o||(o={}))},92673:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});const i={Config:Symbol.for("Config"),Application:Symbol.for("Application"),Store:Symbol.for("Store"),Container:Symbol.for("Container"),ILogger:Symbol.for("Domain/Repositories/ILogger"),FsmTransitions:Symbol.for("FsmTransitions"),AppService:Symbol.for("Application/Services/AppService"),AuthService:Symbol.for("Application/Services/AuthService"),StatisticService:Symbol.for("Application/Services/StatisticService"),EsignService:Symbol.for("EsignService"),CryptoProService:Symbol.for("CryptoProService"),CancellationService:Symbol.for("CancellationService"),ITourManager:Symbol.for("ITourManager"),MicrosoftCloudService:Symbol.for("MicrosoftCloudService"),IDomainEventProvider:Symbol.for("IDomainEventProvider"),IOuterEventProvider:Symbol.for("IOuterEventProvider"),IOpenForm:Symbol.for("IOpenForm")}},71148:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var i=n(29339);const o=new i.Vue},20785:(e,t,n)=>{"use strict";function setListValues(e,t,n){const i=n.manyToManyRelations.find((t=>t.name===e));if(!n.data||!i)return;let o=n.data[e];Array.isArray(o)||(o=[],n.data[e]=o),Array.isArray(t)||(t=[t]),i.added=[],i.updated=[],i.removed=o.map((e=>e.id)),t.forEach((e=>{const t=o.find((t=>e===t.id));if(t){i.updated.push(e);const t=i.removed.indexOf(e);i.removed.splice(t,1)}else i.added.push(e)}))}function createReferences(e,t){const n={},i={};return Object.keys(e).forEach((o=>{let s=e[o];Array.isArray(s)||(s=[s]);let r=t[o]?t[o]:[];Array.isArray(r)||(r=[r]);const a=s.filter((e=>!r.includes(e))),l=r.filter((e=>!s.includes(e)));a.length&&(n[o]=a),l.length&&(i[o]=l)})),Object.keys(t).forEach((n=>{let o=t[n]?t[n]:[];Array.isArray(o)||(o=[o]);const s=e[n];!s&&o.length&&(i[n]=o)})),{referencesToAdd:n,referencesToDelete:i}}function createChildEntities(e,t){const n={},i={},getId=e=>e.ID||e.Id||e.id;return Object.keys(e).forEach((o=>{let s=e[o];Array.isArray(s)||(s=[s]);let r=t[o]?t[o]:[];Array.isArray(r)||(r=[r]);let a=s.filter((e=>!r.find((t=>getId(t)===getId(e)))));const l=r.filter((e=>!s.find((t=>getId(t)===getId(e))))),c=s.filter((e=>!a.find((t=>getId(t)===getId(e)))&&!l.find((t=>getId(t)===getId(e)))));a=a.concat(c),a.length&&(n[o]=a),l.length&&(i[o]=l)})),Object.keys(t).forEach((n=>{let o=t[n]?t[n]:[];Array.isArray(o)||(o=[o]);const s=e[n];!s&&o.length&&(i[n]=o.map((e=>getId(e))))})),{entitiesToAdd:n,entitiesToDelete:i}}function findDifferences(e,t){const n=JSON.parse(JSON.stringify(e));return cloneKeys(e,(e=>n[e]!==t[e]))}function cloneKeys(e,t){const n={};return Object.keys(e).filter(t).forEach((t=>n[t]=e[t])),n}function getIds(e){const t=[];if(e){let n=0;for(const i of e)i.id?(t[n]=i.id,n++):i.Id?(t[n]=i.Id,n++):i.ID&&(t[n]=i.ID,n++)}return t}function generateName(e,t,n="_$IDS"){let i=`${t}${n}`;while(Object.prototype.hasOwnProperty.call(e,i))n=`_${n}`,i=`${t}${n}`;return i}function normalizeDataIdNames(e){e.data&&Object.keys(e.data).forEach((t=>addRelationMapping(e,t)))}function addRelationMapping(e,t,n="name",i="id"){const o=e.data[t],s=o[0];if(!o||!s)return!0;const r=new RegExp(`^${i}$`,"i"),a=new RegExp(`^${n}$`,"i"),l=Object.keys(s).filter((e=>r.test(e)))[0],c=Object.keys(s).filter((e=>a.test(e)))[0];return!(!l||!c)&&(o.forEach((e=>{e.id=e[l],e.value=e[c],e.name=e[c]})),!0)}function getReferences(e,t="_$IDS"){const n={};return Object.keys(e.listAttr).filter((e=>e.endsWith(t))).forEach((i=>{Array.isArray(e.listAttr[i])&&e.listAttr[i].length&&(n[i.replace(t,"")]=e.listAttr[i])})),n}function getChildEntities(e,t="_$IDS"){const n={};return Object.keys(e.listAttr).filter((e=>!e.endsWith(t))).forEach((i=>{!e.listAttr[`${i}${t}`]&&Array.isArray(e.listAttr[i])&&e.listAttr[i].length&&(n[i]=e.listAttr[i])})),n}n.d(t,{SY:()=>setListValues,G4:()=>createReferences,Xv:()=>createChildEntities,xc:()=>findDifferences,TT:()=>cloneKeys,s3:()=>getIds,e9:()=>generateName,BK:()=>normalizeDataIdNames,QT:()=>getReferences,m9:()=>getChildEntities})},85236:(e,t,n)=>{"use strict";n.d(t,{Z:()=>parseValues});var i=n(3820);function getValue(e){const t=e.value;if(!t)return null;if(t.id&&(e.controlType===i.yR.List||e.controlType===i.yR.MultiSelect||e.controlType===i.yR.ModalDialog))switch(e.dataType){case i.g.Integer:return t.id;case i.g.String:return t.name;case i.g.Date:case i.g.DateTime:return t instanceof Date?t:new Date(t);default:return t.id}return t}function parseValues(e){return e?(Array.isArray(e.filterValues)&&e.filterValues.forEach((e=>{e.value=getValue(e)})),e):null}},81086:(e,t,n)=>{"use strict";n.d(t,{v:()=>dateFormat,G:()=>getPeriodDates});var i=n(11135),o=n(89806);function dateFormat(e,t="DD.MM.YYYY hh:mm",n){return e?"string"===typeof e?new o.$mol_time_moment(new Date(e)).toString(t):new o.$mol_time_moment(e).toString(t):n||""}function getPeriodDates(e,t){const n=new o.$mol_time_moment(e),s={dateStart:null,dateFinish:null};switch(t){case i.Fw.Today:s.dateStart=n;break;case i.Fw.Yesterday:s.dateStart=n.shift("P-1D"),s.dateFinish=s.dateStart;break;case i.Fw.Week:s.dateStart=n.merge({day:n.day-n.weekday});break;case i.Fw.Month:s.dateStart=n.merge({day:0});break;case i.Fw.Quarter:s.dateStart=n.merge({month:n.month-n.month%3,day:0});break;case i.Fw.Year:s.dateStart=n.merge({month:0,day:0})}return{dateStart:s.dateStart.native,dateFinish:(s.dateFinish||n).native}}},60601:(e,t,n)=>{"use strict";function kiloBytesToBytes(e){if(!e)return 0;const t=/^\d+/.exec(e);if(!t)return 0;let n=0;return n=t[0]?1e3*Number(t[0]):Number(e),n}function formatSize(e,t=2){if(!e)return"0 Bytes";if("string"===typeof e&&(e=Number(e)),Number.isNaN(e)||0===e)return"0 Bytes";const n=1024,i=t<=0?0:t||2,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,s)).toFixed(i))+" "+o[s]}n.d(t,{MK:()=>kiloBytesToBytes,BU:()=>formatSize})},36564:(e,t,n)=>{"use strict";n.d(t,{W:()=>d});var i=n(1869),o=n(17996),s=n(92673),r=n(71148),a=n(86700),l=n(20629),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const c="dialog:open";let d=class BaseInteractiveQueryHandler{constructor(e,t,n,i){this._log=e,this._config=t,this._store=n,this._queryBus=i}alertDialog(e){return __awaiter(this,void 0,void 0,(function*(){return e.type=o.w.Alert,this.simpleDialog(e)}))}promptDialog(e){return __awaiter(this,void 0,void 0,(function*(){return e.type=o.w.Prompt,e.twoStepOpen=!1,new Promise((t=>{r.X.$nextTick((()=>{e.resolveFunction=t,r.X.$emit(c,e)}))}))}))}noticeDialog(e){return __awaiter(this,void 0,void 0,(function*(){return e.type=o.w.Notification,this.simpleDialog(e)}))}confirmDialog(e){return __awaiter(this,void 0,void 0,(function*(){return e.type=o.w.Confirm,this.simpleDialog(e)}))}openInfoDialog(e){return __awaiter(this,void 0,void 0,(function*(){return e.type=o.w.Info,this.openTwoStepDialog(e)}))}waitForInfoDialog(e,t){return __awaiter(this,void 0,void 0,(function*(){return this.waitForTwoStepDialog(t,e)}))}openSelectDialog(e){return __awaiter(this,void 0,void 0,(function*(){return e.type=o.w.Select,this.openTwoStepDialog(e)}))}waitForSelectDialog(e,t){return __awaiter(this,void 0,void 0,(function*(){return this.waitForTwoStepDialog(t,e)}))}openCreateEditDialog(e){return __awaiter(this,void 0,void 0,(function*(){return e.type=o.w.CreateEdit,this.openTwoStepDialog(e)}))}waitForCreateEditDialog(e,t){return __awaiter(this,void 0,void 0,(function*(){return this.waitForTwoStepDialog(t,e)}))}simpleDialog(e){return __awaiter(this,void 0,void 0,(function*(){return e.twoStepOpen=!1,new Promise((t=>{r.X.$nextTick((()=>{e.resolveFunction=t,r.X.$emit(c,e)}))}))}))}openTwoStepDialog(e){return e.twoStepOpen=!0,new Promise((t=>{r.X.$nextTick((()=>{e.resolveFunction=t,r.X.$emit(c,e)}))}))}waitForTwoStepDialog(e,t){return new Promise((n=>{r.X.$nextTick((()=>{e.resolveFunction=n,r.X.$emit("dialog:set-data",t,e)}))}))}};d=__decorate([(0,a.b2)(),__param(0,(0,a.f3)(s.t.ILogger)),__param(1,(0,a.f3)(s.t.Config)),__param(2,(0,a.f3)(s.t.Store)),__param(3,(0,a.f3)(i.M.IQueryBus)),__metadata("design:paramtypes",[Object,Object,l.yh,Object])],d)},95478:(e,t,n)=>{"use strict";n.d(t,{J:()=>a});var i,o=n(20386),s=n(36564),r=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let a=i=class CanCloseReportQueryHandler extends s.W{ask(e){return __awaiter(this,void 0,void 0,(function*(){if(i.canCloseReport)return!0;const e=yield this._queryBus.exec(new o.l("Внимание!","Вы действительно хотите закрыть отчет?"));return e&&(i.canCloseReport=!0),e}))}};a.canCloseReport=!0,a=i=__decorate([(0,r.b2)()],a)},72878:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(2934),o=n.n(i),s=n(60390),r=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let a=class ChangeRenderMixin extends(o()){isMobileChanged(e,t){this.isMobile&&(e?this.innerChangeRender("mobile-template",""):this.innerChangeRender())}isTabletChanged(e,t){this.isTablet&&(e?this.innerChangeRender("tablet-template",""):this.innerChangeRender())}changeRender(e=null){this.innerChangeRender("additional-template",null!==e&&void 0!==e?e:void 0),this.$nextTick((()=>this.$forceUpdate()))}innerChangeRender(e="default",t="default"){let n=null,i=null;if(this.$options.__originalStaticRenderFns||(this.$options.__originalStaticRenderFns=this.$options.staticRenderFns),"default"===e||"default"===t)n=this.$options.render,i=this.$options.__originalStaticRenderFns;else{let o=`${e}`;t&&(o+=`-${t}`);const s=this.$options[o];s&&(n=s);const r=this.$options[`static-${o}`];r&&(i=r)}n&&(this._render=n),i&&(this.$options.staticRenderFns=i)}};__decorate([(0,r.Watch)("isMobile",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Boolean,Boolean]),__metadata("design:returntype",void 0)],a.prototype,"isMobileChanged",null),__decorate([(0,r.Watch)("isTablet",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Boolean,Boolean]),__metadata("design:returntype",void 0)],a.prototype,"isTabletChanged",null),a=__decorate([s.Mixin],a);const l=a},43206:(e,t,n)=>{"use strict";n.d(t,{r:()=>u});var i=n(2557),o=n(40471),s=n(92673),r=n(86700),a=n(2934),l=n.n(a),c=n(54486),d=n(60390),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let u=class CustomActionsMixin extends(l()){constructor(){super(...arguments),this.templateType=o.$.View,this.cardActions=null,this.customActions=[],this.actionOverlays=[]}onSetCardActions(e){if(!Array.isArray(e))return;this.cardActions=e;const t=this.container.get(i.k.CardCustomAction);this.cardActions.forEach((e=>{e.actionInfo={id:i.k.CardCustomAction,action:t,data:e.action,icon:e.icon,title:e.title,type:e.type};const n=this.customActions.findIndex((t=>t.uid===e.uid));n>=0?this.$set(this.customActions,n,e):this.customActions.push(e)}))}onSetCardActionsOverlay(e){Array.isArray(e)&&(this.actionOverlays=e)}};__decorate([(0,c.t)(s.t.Container),__metadata("design:type",r.W2)],u.prototype,"container",void 0),u=__decorate([d.Mixin],u)},73022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(2934),o=n.n(i);const s=o().extend({mounted(){this.$config.enableHelp&&this.$store.state.helpAutoStart&&(this.$store.commit("SET_HELP_AUTO_START",!1),setTimeout((()=>{this.runIntro()}),1e3))},updated(){},destroyed(){},methods:{runIntro(){this.$app.tourManager.start()}}})},15137:(e,t,n)=>{"use strict";function clearStringFast(e){return e?e.length<12?e:(" "+e).slice(1):e}n.d(t,{z:()=>i,Z:()=>c});var i,o=n(93162),s=n(40928),r=n.n(s),a=n(2934),l=n.n(a);(function(e){e[e["Standard"]=0]="Standard",e[e["Word"]=1]="Word",e[e["Both"]=2]="Both"})(i||(i={}));const c={install(e,t={}){e.mixin({methods:{$printExtComponent(e,t,n,i){if(!this.$store||!this.$store.state||!this.$store.state.manifest||!this.$store.state.manifest[0])throw new Error("Не установлен манифест для внешних компонентов");if(!this.$store.state.manifest[0].constructors)throw new Error("Не загужены внешние компоненты");const o=this.$store.state.manifest[0].constructors[e];if(!o)throw new Error(`Внешний комопонент ${e} не зарегистрирован`);const s=new o({propsData:t});s.$mount(),this.$print(s.$el,n,i)},$printComponent(e,t,n,i){const o=l().extend(e),s=new o({propsData:t});s.$mount(),this.$print(s.$el,n,i)},$print(e,n,s){s||(s={mode:i.Standard,useCommonStyles:!1,callback:()=>!0}),s.callback||(s.callback=()=>!0);const{name:a="_blank",replace:l=!0,styles:c=[]}=t,d=t.specs||["fullscreen=yes","titlebar=yes","scrollbars=yes"];let u,p=d.length?d.join(","):"";if(u="string"===typeof e?document.getElementById(e):e,!u)return void alert(`Element to print #${e} not found!`);const h="";s.mode===i.Word&&(p="scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,\n            width=5,height=5,left=0,top=0");const m=window.open(h,a||n,p,l);m.document.write('\n            <html>\n              <head>\n                <style>\n                @media print, screen {\n                  body{\n                    font-family: "Times-New-Roman";\n                    font-size: 12pt;\n                  }\n                  .bold {\n                    font-weight: bold;\n                  }\n                  .title {\n                    text-align: center;\n                    margin: 10px;\n                  }\n                  .title-right {\n                    text-align: right;\n                  }\n                  .underline {\n                    text-decoration:underline;\n                  }\n                  p {\n                    text-indent: 1.5em;\n                    text-align: justify;\n                  }\n                  .text-center {\n                    text-align: center;\n                  }\n                  .table {\n                    width: 100%;\n                    text-align: center;\n                    border-collapse: collapse;\n                    border: 1px solid black;\n                    margin-bottom: 20px;\n                  }\n                  .table th {\n                    padding: 8px 5px;\n                    color: #1f1f1f;\n                    text-align: center;\n                    border: 1px solid black;\n                    font-weight: normal;\n                    background: #efefef;\n                  }\n                  .table th.small {\n                    font-size: x-small;\n\n                  }\n                  .table td {\n                    padding: 8px 10px;\n                    border: 1px solid black;\n                  }\n                  .table__col-w10p {\n                    width: 10%;\n                  }\n                  .table__col-w20p {\n                    width: 20%;\n                  }\n                  .table__col-w30p {\n                    width: 30%;\n                  }\n                  .table__col-w40p {\n                    width: 40%;\n                  }\n                  .table__col-w50p {\n                    width: 30%;\n                  }\n                }\n                </style>\n              </head>\n              <body>\n              </body>\n            </html>\n          ');const f=u.cloneNode(!0);if(m.document.body.appendChild(f),s.useCommonStyles&&document){const e=getAllCss();if(e){const t=m.document.createElement("style");t.innerHTML=clearStringFast(e),m.document.head.appendChild(t)}}return addStyles(m,c),s.mode!==i.Standard&&s.mode!==i.Both||setTimeout((()=>{m.document.close(),m.focus(),m.print(),m.close(),s.callback()}),1e3),s.mode!==i.Word&&s.mode!==i.Both||setTimeout((()=>{s.mode===i.Word&&(m.document.close(),m.close()),n=n||"temp";let e=`<!DOCTYPE html>${m.document.documentElement.outerHTML}`;e=e.replace("@media print, screen","");const t=r().asBlob(e);(0,o.saveAs)(t,`${n}.docx`)}),50),!0}}})}};function getAllCss(){try{let e="";const t=document.getElementsByTagName("style");for(let n=0;n<t.length;n++)e+=t[n].innerHTML;for(let t=0;t<document.styleSheets.length;t++){const n=document.styleSheets[t],i="cssRules"in n?n.cssRules:n.rules;for(let t=0;t<i.length;t++)i[t].cssText&&(e+=i[t].cssText)}return e}catch(e){return console.error(e),""}}function addStyles(e,t){t.forEach((t=>{const n=e.document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",t),e.document.getElementsByTagName("head")[0].appendChild(n)}))}},39360:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(1869),o=n(16273),s=n(30036),r=n(2934),a=n.n(r),l=n(45904),c=n(54486),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const d=60;let u=class R7Mixin extends(a()){constructor(){super(...arguments),this.activeFile=null,this.loading=!1,this.config=null,this.operationMode="view",this.docEditor=null}get modifiedFileName(){if(!this.activeFile)return"";const e=this.activeFile.fullFileName;return e.length>d?(0,o.dq)(e,d):e}getCorrectEditorType(e){return s.a$.includes(e)?"text":s.Hu.includes(e)?"spreadsheet":s._j.includes(e)?"presentation":""}};__decorate([(0,c.t)(i.M.IQueryBus),__metadata("design:type",Object)],u.prototype,"queryBus",void 0),u=__decorate([l.default],u);const p=u},82464:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(2934),o=n.n(i),s=n(60390),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let r=class TrackElementSizeMixin extends(o()){constructor(){super(...arguments),this.elementHeight=0,this.elementWidth=0}mounted(){window.ResizeObserver?this.$el instanceof Element&&(this.resizeObserver=new window.ResizeObserver((e=>{e.length&&e[0].contentRect?(this.elementHeight=Math.round(e[0].contentRect.height),this.elementWidth=Math.round(e[0].contentRect.width)):(this.elementHeight=this.$el.clientHeight,this.elementWidth=this.$el.clientWidth)})),this.resizeObserver.observe(this.$el)):(this.elementHeight=this.$el.clientHeight,this.elementWidth=this.$el.clientWidth)}beforeUpdate(){if(!window.ResizeObserver)return this.elementHeight=this.$el.clientHeight,void(this.elementWidth=this.$el.clientWidth);this.resizeObserver&&this.resizeObserver.unobserve(this.$el),this.$el instanceof Element&&(this.resizeObserver=new window.ResizeObserver((e=>{e.length&&e[0].contentRect?(this.elementHeight=Math.round(e[0].contentRect.height),this.elementWidth=Math.round(e[0].contentRect.width)):(this.elementHeight=this.$el.clientHeight,this.elementWidth=this.$el.clientWidth)})),this.resizeObserver.observe(this.$el))}beforeDestroy(){this.resizeObserver&&this.resizeObserver.unobserve(this.$el)}};r=__decorate([s.Mixin],r);const a=r},25298:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(47767),o=n(2934),s=n.n(o);const r=s().extend({props:{rules:{type:Array,default(){return[]}},customRules:{type:Array,default(){return[]}},validateOnBlur:{type:Boolean,default:!0}},data(){return{myRules:[]}},computed:{validRules(){return this.required?[(0,i.n0)()].concat(this.myRules):this.myRules}},watch:{rules:{handler(e){Array.isArray(e)&&e.length?this.myRules=[...e,...this.customRules]:this.myRules=[...this.customRules]},immediate:!0}}})},24783:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(2934),o=n.n(i),s=n(60390),r=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let a=class ValidateMixin extends(o()){constructor(){super(...arguments),this.inputs=[],this.watchers=[],this.errorBag={},this.lazyValidation=!1,this.isValid=!0,this.section=null,this.form={register:this.register.bind(this),unregister:this.unregister.bind(this)}}onErrorBagChanged(){const e=Object.values(this.errorBag).includes(!0);this.isValid=!e}watchInput(e){const watcher=e=>e.$watch("hasError",(t=>{this.$set(this.errorBag,e._uid,t)}),{immediate:!0}),t={_uid:e._uid,valid:null,shouldValidate:null};return this.lazyValidation?t.shouldValidate=e.$watch("shouldValidate",(n=>{n&&(Object.prototype.hasOwnProperty.call(this.errorBag,e._uid)||(t.valid=watcher(e)))})):t.valid=watcher(e),t}validate(){const e=this.inputs.filter((e=>e.validate&&!e.validate(!0))).length;return!e}validateSection(e){const t=this.inputs.filter((t=>t.__cardSection==e&&t.validate&&!t.validate(!0))).length;return!t}reset(){for(let e=this.inputs.length;e>=0;e--)this.inputs[e].reset();this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)}resetValidation(){for(let e=this.inputs.length;e>=0;e--)this.inputs[e].resetValidation();this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)}register(e,t){t&&(this.section=t),this.section&&e.validate&&(e.__cardSection=this.section);const n=this.watchInput(e);this.inputs.push(e),this.watchers.push(n)}unregister(e){const t=this.inputs.find((t=>t._uid===e._uid));if(!t)return;const n=this.watchers.find((e=>e._uid===t._uid));n.valid&&n.valid(),n.shouldValidate&&n.shouldValidate(),this.watchers=this.watchers.filter((e=>e._uid!==t._uid)),this.inputs=this.inputs.filter((e=>e._uid!==t._uid)),this.$delete(this.errorBag,t._uid)}};__decorate([(0,r.Provide)("form"),__metadata("design:type",Object)],a.prototype,"form",void 0),__decorate([(0,r.Watch)("errorBag",{deep:!0,immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],a.prototype,"onErrorBagChanged",null),a=__decorate([s.Mixin],a);const l=a},27437:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var i=n(10637),o=n(508),s=n(18220),r=n(17773),a=n(42151),l=n(73718),c=n(58848),d=n(2934),u=n.n(d),p=n(60390),h=n(29339),m=n(51414),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let f=class ViewStateMixin extends(u()){constructor(){super(...arguments),this.autoApplyViewState=!1,this.throttleFunc={}}onRouteChanged(){return __awaiter(this,void 0,void 0,(function*(){if(this.autoApplyViewState){const e=yield this.readViewState(this.pageStateKey);this.applyPageState(e)}}))}get pageStateKey(){return""}readViewState(e){return __awaiter(this,void 0,void 0,(function*(){"string"===typeof e&&(e=[e]);const t=[];if(e.map((e=>{e&&t.push(this.fetchViewState(new o.Id(e)))})),!t.length)return Promise.resolve(null);try{const e=yield Promise.all(t),n={};return e.reduce(((e,t)=>(Object.assign(e,t),e)),n),n}catch(e){return this.$log.error(e),null}}))}applyPageState(e){}updateViewState(e,t){return __awaiter(this,void 0,void 0,(function*(){if(!e)return;let n=this.viewStateGetter(e);n||(n=yield this.readViewState(e));const o=(0,a.Z)(Object.assign(Object.assign({},n),t)),s=new i.xO(e,o);(0,l.Z)(n,o)||this.throttableSave(s)}))}forceUpdateViewState(e,t){if(!e)return;const n=new i.xO(e,t);this.throttableSave(n)}clearViewState(e){const t=new i.xO(e,null);this.throttableSave(t)}throttableSave(e){this.SET_VIEW_STATE(e);let t=this.throttleFunc[e.key];return t||(t=(0,c.Z)(this.doSave.bind(this),1e3,{leading:!1,trailing:!0}),this.throttleFunc[e.key]=t),t(e)}doSave(e){this.saveViewState(e)}};__decorate([(0,s.Hg)("fetchViewState"),__metadata("design:type",Object)],f.prototype,"fetchViewState",void 0),__decorate([(0,s.Hg)("saveViewState"),__metadata("design:type",Object)],f.prototype,"saveViewState",void 0),__decorate([(0,r.O)("getViewState"),__metadata("design:type",Object)],f.prototype,"viewStateGetter",void 0),__decorate([(0,m.mm)("SET_VIEW_STATE"),__metadata("design:type",Function)],f.prototype,"SET_VIEW_STATE",void 0),__decorate([(0,h.Watch)("$route"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],f.prototype,"onRouteChanged",null),f=__decorate([p.Mixin],f);const g=f},47767:(e,t,n)=>{"use strict";n.d(t,{n0:()=>requiredRule,z2:()=>o});var i=n(40379);const requiredRule=e=>t=>!(!t||!(0,i.C1)(t))||(e?`Поле ${e} обязательно`:"Это поле обязательно"),maxLengthRule=e=>t=>!!(0,i.BS)(e)(t)||`Значение должно быть меньше ${e} символов`,alphaRule=()=>e=>!!(0,i.Fq)(e)||"Разрешены только буквы",alphaNumRule=()=>e=>!!(0,i.Pf)(e)||"Разрешены только буквы и цифры",andRule=(...e)=>t=>!(0,i.xD)(e)(t)||"Ошибка",betweenRule=(e,t)=>n=>!!(0,i.vX)(e,t)(n)||`Значение должно быть в диапазоне от ${e} до ${t}`,decimalRule=()=>e=>!!(0,i.gH)(e)||"Значение должно быть целым или дробным числом",emailRule=()=>e=>!!(0,i.Do)(e)||"Неверный формат адреса эл.почты",integerRule=()=>e=>!!(0,i._L)(e)||"Значение должно быть целым числом",ipAddressRule=()=>e=>!!(0,i.ys)(e)||"Неправильный формат IP-адреса",macAddressRule=()=>e=>!!(0,i.QI)(e)||"Неправильный формат mac-адреса",maxValueRule=e=>t=>!!(0,i.PW)(e)(t)||`Значение должно быть меньше ${e}`,minValueRule=e=>t=>!!(0,i.uv)(e)(t)||`Значение должно быть больше ${e}`,numericRule=()=>e=>!!(0,i.uR)(e)||"Разрешены только цифры",urlRule=()=>e=>!!(0,i.HQ)(e)||"Неправильный формат URI",o={requiredRule,maxLengthRule,alphaRule,alphaNumRule,andRule,betweenRule,decimalRule,emailRule,integerRule,ipAddressRule,macAddressRule,maxValueRule,minValueRule,numericRule,urlRule}},98001:(e,t,n)=>{"use strict";n(28660),n(76124),n(60504);var i=n(2934),o=n.n(i),s=n(80172),r=n(17024),a=n(57894),l=n(10884),c=n(61118),d=n(85078),u=n(67416),p=n(39342),h=n(41123),m=n(54983),f=n(4287),g=n(82127),y=n(71100),v=n(64223),b=n(34451),C=n(22528),w=n(44971),_=n(7442),x=n(93185),S=n(50522),I=n(56330),D=n(85893),R=n(5255),T=n(42783),P=n(93462),O=n(91232),k=n(36292),F=n(56721),A=n(83240),$=n(99296),j=n(1246),E=n(75410),M=n(34405),N=n(67808),V=n(95467),B=n(60774),L=n(23087),U=n(63486),H=n(44557),Q=n(29442),z=n(86131),Z=n(94694),W=n(51333),q=n(83694),G=n(20309),K=n(77487),Y=n(97704),J=n(72976),X=n(22588),ee=n(95686),te=n(756),ne=n(41416),ie=n(4779),oe=n(67731),se=n(27540),re=n(32496),ae=n(53760),le=n(45903),ce=n(73444),de=n(59456),ue=n(60683),pe=n(66530),he=n(73845),me=n(22515),fe=n(59657),ge=n(74770),ye=n(83429),ve=n(38668),be=n(7563),Ce=n(97419),we=n(84556),_e=n(69101);const xe={VTextarea:s.Z,VCol:r.Z,VRow:a.Z,VApp:l.Z,VAppBar:c.Z,VAppBarNavIcon:d.Z,VAutocomplete:u.Z,VNavigationDrawer:p.Z,VFooter:h.Z,VList:m.Z,VListGroup:f.Z,VBtn:g.Z,VIcon:y.Z,VInput:v.Z,VToolbar:b.Z,VTextField:C.Z,VAvatar:w.Z,VTooltip:_.Z,VDialog:x.Z,VDatePicker:S.Z,VTimePicker:I.Z,VCard:D.Z,VCardActions:R.h7,VCardTitle:R.EB,VCardText:R.ZB,VCheckbox:T.Z,VChip:P.Z,VCombobox:O.Z,VSubheader:k.Z,VSwitch:F.Z,VForm:A.Z,VBreadcrumbs:$.Z,VBreadcrumbsItem:j.Z,VBtnToggle:E.Z,VDivider:M.Z,VProgressLinear:N.Z,VProgressCircular:V.Z,VRadio:B.Z,VRadioGroup:L.Z,VBadge:U.Z,VExpansionPanel:H.Z,VExpansionPanels:Q.Z,VExpansionPanelHeader:z.Z,VExpansionPanelContent:Z.Z,VMenu:W.Z,VSelect:q.Z,VSlideGroup:G.Z,VSlideItem:K.Z,VStepper:Y.Z,VStepperStep:J.Z,VStepperHeader:X.Rp,VTabs:ee.Z,VTab:te.Z,VTabItem:ne.Z,VTabsItems:ie.Z,VTabsSlider:oe.Z,VTimeline:se.Z,VTimelineItem:re.Z,VListItem:ae.Z,VListItemTitle:le.V9,VListItemAction:ce.Z,VListItemContent:le.km,VListItemSubtitle:le.oZ,VLayout:de.Z,VFlex:ue.Z,VContainer:pe.Z,VToolbarTitle:he.qW,VSpacer:me.Z,VHover:fe.Z,VMain:ge.Z,VSimpleCheckbox:ye.Z,VTreeview:ve.Z,transitions:Ce.ZP};o().use(be.Z,{components:xe});const Se={defaults:{global:{ripple:!1}},theme:{disable:!0},icons:{iconfont:"mdiSvg"},lang:{locales:{en:we.Z,ru:_e.Z},current:"ru"}},Ie=new be.Z(Se);var De,render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isElectronApp?n("ld-app-titlebar"):e._e(),e._v(" "),e.isAuthenticated?[e.isMobile?[n("v-app",{attrs:{id:"landocs"}},[n("v-navigation-drawer",{ref:"vNavigationDrawer",staticClass:"pb-0 app-sidemenu mobile",attrs:{width:e.drawerWidth,app:"",clipped:e.$vuetify.breakpoint.lgAndUp,"hide-overlay":"",temporary:e.isDrawerTemporary},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("div",{staticClass:"menu-header"},[n("div",{staticClass:"common-info"},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"logo"},[n("img",{staticClass:"main-logo-mobile",attrs:{src:"assets\\img\\LDlogo.png",alt:"LanDocs"},on:{click:function(t){return e.$app.goHome()}}})]),e._v(" "),n("v-col",[n("div",{staticClass:"d-flex justify-end"},[n("div",{staticClass:"logo-place"},[e.logoReceived?[e.logoSrc?n("img",{attrs:{src:e.logoSrc}}):n("svg-icon",{staticClass:"svg-icon grey--text lighten-3",attrs:{icon:"empty-brand-logo-sm"}})]:e._e()],2)])])],1),e._v(" "),n("v-row",{staticClass:"aling-end",staticStyle:{height:"100%"},attrs:{"no-gutters":""}},[n("v-col",{staticStyle:{height:"100%"},attrs:{cols:"auto"}},[n("v-menu",{attrs:{auto:"","offset-y":"",transition:"scale-transition",origin:"center center"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-tooltip",{attrs:{bottom:"","open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("v-btn",e._g({staticClass:"small-button",attrs:{tabindex:"-1",icon:""}},Object.assign({},i,o)),[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.historyLoading,expression:"!historyLoading"}],staticClass:"white--text common-info--history-icon"},[e._v("history")]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.historyLoading,expression:"historyLoading"}],attrs:{value:20,color:"primary",indeterminate:""}})],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("История просмотра")])],1)]}}],null,!1,231426817),model:{value:e.historyMenuShow,callback:function(t){e.historyMenuShow=t},expression:"historyMenuShow"}},[e._v(" "),e.hasHistory?n("v-list",e._l(e.historyList,(function(t,i){return n("v-list-item",{key:i,on:{click:function(n){return e.onHistoryClick(t)}}},[n("v-list-item-title",[e.isDocumentHistoryItem(t)?n("v-icon",{staticClass:"pr-1",attrs:{size:"18"}},[e._v("description")]):n("v-icon",{staticClass:"pr-1",attrs:{size:"18"}},[e._v("mail")]),e._v(" "),e.isDocumentHistoryItem(t)?n("span",{staticClass:"px-1"},[e._v(e._s(e.documentTitle(t)))]):[n("span",[e._v(e._s(t.item.documentType))]),e._v(" "),t.item.documentType?n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"px-1"},[e._v("от")]):e._e(),e._v(" "),n("span",[e._v(e._s(t.item.initiatorName))]),e._v(" "),n("span",{staticClass:"px-1"},[e._v("-")]),e._v(" "),n("span",[e._v(e._s(t.item.stateName))])]],2)],1)})),1):e.noHistory?n("v-list",[n("v-list-item",[n("v-list-item-title",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("История просмотра отсутствует")])],1)],1):e._e()],1)],1),e._v(" "),n("v-col",{staticStyle:{height:"100%"}},[n("v-menu",{attrs:{"offset-y":"","close-on-content-click":e.doCloseMenu},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"deputy-btn sm-text",staticStyle:{height:"auto"},attrs:{tabindex:"-1",text:""}},Object.assign({},i)),[n("div",{staticClass:"deputy-btn__inner"},[n("v-icon",{staticClass:"deputy-btn__icon white--text"},[e._v(" account_circle ")]),e._v(" "),e.currentUser?n("div",{staticClass:"deputy-btn__user white--text mx-2"},[e.currentUser.deputyUserId?[n("div",[n("translate",[e._v("Замещение")])],1),e._v(" "),n("div",[e._v(e._s(e.showName(e.currentUser.deputyUserName)))])]:[n("span",[e._v(e._s(e.showName(e.userName)))])]],2):e._e(),e._v(" "),n("v-icon",{staticClass:"white--text"},[e._v("keyboard_arrow_down")])],1)])]}}],null,!1,3457339506),model:{value:e.userNameMenuShow,callback:function(t){e.userNameMenuShow=t},expression:"userNameMenuShow"}},[e._v(" "),n("v-list",[n("v-list-item",{on:{click:e.onLogout}},[n("v-list-item-title",[e._v(e._s(e.$gettext("Выход")))])],1),e._v(" "),e.inDeputyMode?n("v-list-item",{on:{click:e.onDeputyExit}},[n("v-list-item-title",[e._v(e._s(e.$gettext("Отключить режим замещения")))])],1):e._e()],1),e._v(" "),n("v-divider"),e._v(" "),e.deputyLoading?n("v-list",[n("v-list-item",[n("v-list-item-title",[e._v(e._s(e.$gettext("Загрузка списка замещаемых...")))]),e._v(" "),n("v-progress-circular",{attrs:{value:18,color:"primary",indeterminate:""}})],1)],1):e.shownDeputies&&e.shownDeputies.length?n("v-list",[e._l(e.shownDeputies,(function(t,i){return n("v-list-item",{key:i,on:{click:function(n){return e.onSetDeputyUser(t)}}},[n("v-list-item-title",[t&&e.currentUser&&t.id!==e.currentUser.id?n("v-icon",{staticClass:"pr-1"},[e._v("account_circle")]):e._e(),e._v(e._s(t.name)+"\n                  ")],1)],1)})),e._v(" "),e.deputyList.length>10?n("v-list-item",[n("v-list-item-title",{staticClass:"primary--text"},[n("v-btn",{staticClass:"mt-2 rounded-button small-button header-button",attrs:{color:"primary"},on:{click:e.searchDeputy}},[n("v-icon",{attrs:{small:"",color:"white"}},[e._v(" search ")]),e._v(" "),n("translate",[e._v("Поиск")])],1)],1)],1):e._e()],2):e._e()],1)],1)],1)],1),e._v(" "),n("div",{staticClass:"search-field"},[n("v-row",{staticClass:"align-center px-2 justify-center",attrs:{"no-gutters":""}},[n("v-col",[n("v-text-field",{staticClass:"pl-0 small-input sm-text search",attrs:{text:"","hide-details":"","single-line":"",outlined:"",clearable:"",label:e.$gettext("Поиск по текущей папке")},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.onSearchClick(t))}},model:{value:e.searchTerms,callback:function(t){e.searchTerms=t},expression:"searchTerms"}})],1),e._v(" "),n("v-col",{attrs:{cols:"auto"}},[n("v-btn",{staticClass:"my-0 mr-1 header-btn",attrs:{block:"",icon:""}},[n("v-icon",{staticClass:"header-icon-btn",attrs:{color:"white"},on:{click:e.onSearchClick}},[e._v("search")])],1)],1)],1)],1)]),e._v(" "),n("v-divider",{staticClass:"menu-divider"}),e._v(" "),n("v-row",{staticClass:"fill-height no-gutters",staticStyle:{"flex-wrap":"nowrap"}},[n("div",{staticClass:"secondary main-menu-panel"},[n("div",{directives:[{name:"intro",rawName:"v-intro",value:e.$help.app.mainMenu,expression:"$help.app.mainMenu"},{name:"intro-step",rawName:"v-intro-step",value:1,expression:"1"}],staticClass:"main-menu-list"},e._l(e.filteredMainMenu,(function(t,i){return n("div",{key:t.text,staticClass:"main-menu-list-item my-2",class:e.menuItemClass(t),attrs:{"active-class":"grey"},on:{click:function(n){return e.onMenuItemClick(t)}}},[n("v-icon",{class:{"new-notifications":e.hasNewNotifications(t)},staticStyle:{width:"40px",height:"38px"},attrs:{dark:""}},[e._v(e._s(t.icon))])],1)})),0),e._v(" "),n("div",{staticClass:"version xs-text"},[e._v(e._s(e.version))])]),e._v(" "),e.isAuthenticated?n("v-col",{directives:[{name:"intro",rawName:"v-intro",value:e.$help.app.folderTree,expression:"$help.app.folderTree"},{name:"intro-step",rawName:"v-intro-step",value:2,expression:"2"},{name:"intro-hint",rawName:"v-intro-hint",value:e.$help.app.folderTree,expression:"$help.app.folderTree"}],staticClass:"sub-menu-panel",attrs:{id:"appFolderTree"}},[n("v-hover",{directives:[{name:"show",rawName:"v-show",value:e.isSubMenuVisibled,expression:"isSubMenuVisibled"}],scopedSlots:e._u([{key:"default",fn:function(t){t.hover;return[n("div",{staticClass:"sub-menu-panel-body"},[n("div",{staticClass:"sub-section-title subheading font-weight-regular"},[n("span",[e._v(e._s(e.sectionTitle))]),e._v(" "),e.isPinned&&e.canPin?n("v-btn",{staticClass:"small-round-button",attrs:{icon:""},on:{click:e.onUnpinClick}},[n("v-icon",{staticClass:"sm-icon"},[e._v("keyboard_arrow_left")])],1):e.canPin?n("v-btn",{staticClass:"small-round-button",attrs:{icon:""},nativeOn:{click:function(t){return e.onPinClick(t)}}},[n("svg-icon",{staticClass:"svg-icon",attrs:{icon:"pin"}})],1):e._e()],1),e._v(" "),n("folder-tree",{attrs:{"temp-section":e.tempSection,section:e.activeSection,"folder-id":e.folderId},on:{"folders-ready":e.onFoldersReady,"update-folder":e.onFolderChanged}})],1)]}}],null,!1,3499703265),model:{value:e.isSubMenuHover,callback:function(t){e.isSubMenuHover=t},expression:"isSubMenuHover"}})],1):e._e()],1)],1),e._v(" "),e.showToolbar?n("v-app-bar",{staticClass:"app-toolbar mobile",attrs:{app:"","clipped-left":e.$vuetify.breakpoint.lgAndUp,color:"white",fixed:"",height:"39"}},[e.isMenuButtonShow?n("v-tooltip",{attrs:{right:"",disabled:!e.isDesktop,"open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-app-bar-nav-icon",e._g({directives:[{name:"intro-hint",rawName:"v-intro-hint",value:e.$help.app.mainMenu,expression:"$help.app.mainMenu"}],class:{mobileDrawer:e.mobileDrawer},attrs:{tabindex:"-1"},on:{click:function(t){return t.stopPropagation(),e.onMenuButtonClick(t)}}},Object.assign({},i)),[n("v-icon",{class:{"primary--text":e.drawer}},[e._v("menu")])],1)]}}],null,!1,2641377785)},[e._v(" "),n("span",[e._v(" "+e._s(e.drawer?e.$gettext("Свернуть меню разделов"):e.$gettext("Развернуть меню разделов"))+" ")])]):e._e(),e._v(" "),e.mobileDrawer?e._e():n("v-col",{staticClass:"px-0 py-0",attrs:{id:"mobileHeaderWrapper"}},[e.isMobile&&e.isDashboard?n("dashboard-header",{on:{"new-message":e.newMessage,"new-document":e.newDocument}}):e._e()],1),e._v(" "),n("v-menu",{directives:[{name:"intro-hint",rawName:"v-intro-hint",value:e.$help.app.createBtn,expression:"$help.app.createBtn"},{name:"intro",rawName:"v-intro",value:e.$help.app.createBtn,expression:"$help.app.createBtn"},{name:"intro-step",rawName:"v-intro-step",value:3,expression:"3"}],attrs:{"offset-y":"","min-width":"100px !important"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.isMobile?e._e():n("v-btn",e._g({staticClass:"rounded-button small-button header-button",attrs:{tabindex:"-1",color:"primary"}},Object.assign({},i)),[n("v-icon",{attrs:{small:"",color:"white"}},[e._v(" add ")]),e._v(" "),n("translate",[e._v("Создать")])],1)]}}],null,!1,2864820593)},[e._v(" "),n("v-list",{staticClass:"create-global-menu"},[e.activeDocumentId||e.previewDocumentId?n("v-list-item",{on:{click:e.newMessageByDoc}},[n("v-list-item-title",[n("translate",[e._v("Сообщение по документу")])],1)],1):e._e(),e._v(" "),n("v-list-item",{on:{click:e.newMessage}},[n("v-list-item-title",[n("translate",[e._v("Сообщение")])],1)],1),e._v(" "),n("v-divider"),e._v(" "),n("v-list-item",{on:{click:e.newDocument}},[n("v-list-item-title",[n("translate",[e._v("Документ")])],1)],1)],1)],1),e._v(" "),n("v-tooltip",{attrs:{bottom:"","open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.isCanRunHelp&&!e.isMobile?n("v-icon",e._g({staticClass:"grey--text lighten-6 toolbar-helper ml-3",on:{click:e.runIntro}},Object.assign({},i)),[e._v("\n          live_help\n        ")]):e._e()]}}],null,!1,1886138566)},[e._v("\n      Интерактивный помощник\n    ")])],1):e._e(),e._v(" "),n("v-main",{ref:"vMain",attrs:{id:"main-content"}},[n("v-row",{staticClass:"fill-height no-gutters pa-0 fluid nowrap-content"},[n("vue-splitter",{staticClass:"splitter",attrs:{margin:0,"right-visibled":Boolean(e.viewPanel),"left-size-percent":e.leftPanelSize,"left-size-min":"30","right-size-min":"30"},on:{resize:e.onPanelResize}},[n("v-col",{key:"router",staticClass:"fill-height justify align",staticStyle:{padding:"0"},attrs:{slot:"left-pane"},slot:"left-pane"},[n("router-view",{attrs:{"force-is-mobile":e.forceIsMobile,"force-is-tablet":e.forceIsTablet,"search-options":e.updatedSearchOptions,drawer:e.mobileDrawer}},[e._v("\n            loading...\n          ")])],1),e._v(" "),n("v-col",{staticClass:"right-panel fill-height grey--border lighten-4",staticStyle:{padding:"0"},attrs:{slot:"right-pane",id:"appRightPanel"},slot:"right-pane"},[n("v-row",{staticClass:"no-gutters pl-2 pt-0 pb-0 mt-0 grey lighten-4 right-panel-action",staticStyle:{"max-height":"fit-content"},attrs:{id:"appRightPanelHeader"}},[e.isErrorView?e._e():n("v-row",{attrs:{"no-gutters":"",align:"center"}},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"primary--text pl-1 body-2 font-weight-bold",staticStyle:{cursor:"pointer"},on:{click:e.onOpenNewWindow}},[e._v("Открыть в новом окне")]),e._v(" "),n("v-icon",{attrs:{medium:"",color:"primary"},on:{click:e.onOpenNewWindow}},[e._v("chevron_right")])],1),e._v(" "),n("v-icon",{staticClass:"mr-2",on:{click:e.onCloseViewPanelClick}},[e._v("close")])],1),e._v(" "),e.isInstructionView&&!e.isReportView?n("div",{key:"act-pnl",staticClass:"right-panel-actions"},[n("action-panel",{attrs:{visible:!0,context:e.viewPanelActionContext,loading:e.loading,"force-is-mobile":e.forceIsMobileForRightPanel},on:{"action-result":e.onActionResult,"action-processing":e.onActionProcessing}})],1):e._e(),e._v(" "),n("div",{key:"appRightPanel",staticClass:"right-panel-content",class:{"grey lighten-4":e.isDocumentView},attrs:{id:"appRightPanelContent"}},[e.loading?n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.loading}}):e._e(),e._v(" "),e.isErrorView?n("span",[e._v(e._s(e.errorText))]):e.isReportView?n("instruction-report",{attrs:{instructionInfo:e.viewPanelInstructionInfo,reportId:Number(e.viewPanel.reportData.reportId),context:e.viewPanelActionContext,actionType:e.viewPanel.reportData.actionType,"do-close":e.wouldCloseViewPanel,"quick-report":e.viewPanel.reportData.quickReport,"force-is-mobile":e.forceIsMobileForRightPanel,"force-is-tablet":e.forceIsTabletForRightPanel},on:{"instruction-report-sent":e.doCloseViewPanel,"instruction-report-closed":e.doCloseViewPanel}}):e.isInstructionView?n("instruction-view",{attrs:{context:e.viewPanelInstructionInfo,"action-context":e.viewPanelActionContext,limitedMode:!0},on:{"instr-view-loading":e.onViewLoading}}):e.isDocumentView?n("document-template-renderer",{key:e.viewPanelDocument?e.viewPanelDocument.id:"viewPanel_document",attrs:{document:e.viewPanelDocument,"template-type":e.docTemplateType,"force-is-mobile":e.forceIsMobileForRightPanel,"force-is-tablet":e.forceIsTabletForRightPanel,context:e.viewPanelActionContext},on:{"external-component-loading":e.onViewLoading}}):e._e()],1)],1)],1)],1)],1),e._v(" "),n("modal-container")],1)]:[n("v-app",{class:{"height-fix":e.isDashboard},attrs:{id:"landocs"}},[n("v-navigation-drawer",{directives:[{name:"show",rawName:"v-show",value:!e.isDashboard,expression:"!isDashboard"}],ref:"vNavigationDrawer",staticClass:"pb-0 app-sidemenu",attrs:{width:e.drawerWidth,app:"",clipped:e.$vuetify.breakpoint.lgAndUp,"hide-overlay":"",temporary:e.isDrawerTemporary},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("v-row",{staticClass:"fill-height no-gutters",staticStyle:{"flex-wrap":"nowrap"}},[n("div",{staticClass:"secondary main-menu-panel"},[n("div",{directives:[{name:"intro",rawName:"v-intro",value:e.$help.app.mainMenu,expression:"$help.app.mainMenu"},{name:"intro-step",rawName:"v-intro-step",value:1,expression:"1"}],staticClass:"main-menu-list"},e._l(e.filteredMainMenu,(function(t,i){return n("div",{directives:[{name:"hover",rawName:"v-hover",value:{over:function(n){return e.onHover(t,!0)},leave:function(n){return e.onHover(t,!1)}},expression:"{ over: (e) => onHover(item, true), leave: (e) => onHover(item, false) }"}],key:t.id,staticClass:"main-menu-list-item my-3",class:e.menuItemClass(t),attrs:{"active-class":"grey"},on:{click:function(n){return e.onMenuItemClick(t)}}},[t.icon?[e.isMobile?n("v-icon",{staticClass:"pt-2",class:{"new-notifications":e.isLdApp&&e.hasNewNotifications(t),"pl-2":!e.isMobile},staticStyle:{width:"40px",height:"38px"},attrs:{dark:""}},[e._v("\n                "+e._s(t.icon)+"\n              ")]):n("v-icon",{staticClass:"sm-icon",class:{"new-notifications":e.isLdApp&&e.hasNewNotifications(t)},attrs:{dark:""}},[e._v("\n                "+e._s(t.icon)+"\n              ")])]:t.svg?[n("svg-icon",{attrs:{icon:t.svg}})]:e._e()],2)})),0)]),e._v(" "),e.isAuthenticated?n("v-col",{directives:[{name:"intro",rawName:"v-intro",value:e.$help.app.folderTree,expression:"$help.app.folderTree"},{name:"intro-step",rawName:"v-intro-step",value:2,expression:"2"},{name:"intro-hint",rawName:"v-intro-hint",value:e.$help.app.folderTree,expression:"$help.app.folderTree"}],staticClass:"sub-menu-panel",attrs:{id:"appFolderTree"}},[n("v-hover",{directives:[{name:"show",rawName:"v-show",value:e.isSubMenuVisibled,expression:"isSubMenuVisibled"}],scopedSlots:e._u([{key:"default",fn:function(t){t.hover;return[n("div",{staticClass:"sub-menu-panel-body"},[n("div",{staticClass:"sub-section-title body-2 font-weight-bold"},[n("span",[e._v(e._s(e.sectionTitle))]),e._v(" "),e.isPinned&&e.canPin?n("v-btn",{staticClass:"small-round-button",attrs:{icon:""},on:{click:e.onUnpinClick}},[n("v-icon",{staticClass:"sm-icon"},[e._v("keyboard_arrow_left")])],1):e.canPin?n("v-btn",{staticClass:"small-round-button",attrs:{icon:""},nativeOn:{click:function(t){return e.onPinClick(t)}}},[n("svg-icon",{staticClass:"svg-icon",attrs:{icon:"pin"}})],1):e._e()],1),e._v(" "),n("folder-tree",{attrs:{"temp-section":e.tempSection,section:e.activeSection,"folder-id":e.folderId},on:{"folders-ready":e.onFoldersReady,"update-folder":e.onFolderChanged}}),e._v(" "),n("div",{staticClass:"logo-field mt-2"},[e.logoReceived?[e.logoSrc?n("img",{attrs:{src:e.logoSrc}}):n("svg-icon",{staticClass:"svg-icon brand-logo",staticStyle:{width:"85px",height:"85px"},attrs:{icon:"empty-brand-logo-sm"}})]:e._e()],2),e._v(" "),n("div",{staticClass:"version xs-text mb-1"},[e._v(e._s(e.version))])],1)]}}],null,!1,2135946110),model:{value:e.isSubMenuHover,callback:function(t){e.isSubMenuHover=t},expression:"isSubMenuHover"}})],1):e._e()],1)],1),e._v(" "),e.showToolbar?n("v-app-bar",{staticClass:"app-toolbar",attrs:{"clipped-left":e.$vuetify.breakpoint.lgAndUp,color:"white",fixed:"",app:"",height:"39"}},[e.isMenuButtonShow?n("v-tooltip",{attrs:{right:"",disabled:!e.isDesktop,"open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-app-bar-nav-icon",e._g({directives:[{name:"intro-hint",rawName:"v-intro-hint",value:e.$help.app.mainMenu,expression:"$help.app.mainMenu"}],class:{mobileDrawer:e.mobileDrawer},attrs:{tabindex:"-1"},on:{click:function(t){return t.stopPropagation(),e.onMenuButtonClick(t)}}},Object.assign({},i)),[n("v-icon",[e._v("menu")])],1)]}}],null,!1,3379356541)},[e._v(" "),n("span",[e._v(" "+e._s(e.drawer?e.$gettext("Свернуть меню разделов"):e.$gettext("Развернуть меню разделов"))+" ")])]):e._e(),e._v(" "),e.isMobile?e._e():n("v-toolbar-title",{staticClass:"toolbar-image pt-1"},[n("img",{staticClass:"main-logo",attrs:{src:"assets\\img\\LDlogo.png",alt:"LanDocs"},on:{click:function(t){return e.$app.goHome()}}})]),e._v(" "),n("v-col",{staticClass:"px-0 py-0",attrs:{id:"mobileHeaderWrapper"}},[e.isMobile&&e.isDashboard?n("dashboard-header",{on:{"new-message":e.newMessage,"new-document":e.newDocument}}):e._e()],1),e._v(" "),e.isLdApp?n("v-menu",{directives:[{name:"intro-hint",rawName:"v-intro-hint",value:e.$help.app.createBtn,expression:"$help.app.createBtn"},{name:"intro",rawName:"v-intro",value:e.$help.app.createBtn,expression:"$help.app.createBtn"},{name:"intro-step",rawName:"v-intro-step",value:3,expression:"3"}],attrs:{"offset-y":"","min-width":"100px !important"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.isMobile?e._e():n("v-btn",e._g({staticClass:"rounded-button small-button header-button",attrs:{tabindex:"-1",color:"primary"}},Object.assign({},i)),[n("v-icon",{attrs:{small:"",color:"white"}},[e._v(" add ")]),e._v(" "),n("translate",[e._v("Создать")])],1)]}}],null,!1,2864820593)},[e._v(" "),n("v-list",{staticClass:"create-global-menu"},[e.activeDocumentId||e.previewDocumentId?n("v-list-item",{on:{click:e.newMessageByDoc}},[n("v-list-item-title",[n("translate",[e._v("Сообщение по документу")])],1)],1):e._e(),e._v(" "),n("v-list-item",{on:{click:e.newMessage}},[n("v-list-item-title",[n("translate",[e._v("Сообщение")])],1)],1),e._v(" "),n("v-divider"),e._v(" "),n("v-list-item",{on:{click:e.newDocument}},[n("v-list-item-title",[n("translate",[e._v("Документ")])],1)],1),e._v(" "),e.isKanban?[n("v-divider"),e._v(" "),n("v-list-item",{on:{click:e.newKanbanBoard}},[n("v-list-item-title",[n("translate",[e._v("Канбан-доску")])],1)],1)]:e._e()],2)],1):e._e(),e._v(" "),!e.isMobile&&e.isLdApp?n("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-tooltip",{attrs:{bottom:"","open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("v-btn",e._g({staticClass:"block-files-button ml-4",attrs:{tabindex:"-1",icon:""},on:{click:e.showBlockedFiles}},Object.assign({},i,o)),[n("v-icon",{staticClass:"block-files-icon grey--text darken-3",class:{notify:e.hasEditedFiles}},[e._v(" lock ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Заблокированные файлы")])],1)]}}],null,!1,895701794)}):e._e(),e._v(" "),!e.isMobile&&e.isLdApp?n("v-menu",{attrs:{auto:"","offset-y":"",transition:"scale-transition",origin:"center center"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-tooltip",{attrs:{bottom:"","open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("v-btn",e._g({attrs:{tabindex:"-1",icon:""}},Object.assign({},i,o)),[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.historyLoading,expression:"!historyLoading"}],staticClass:"grey--text darken-3"},[e._v("history")]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.historyLoading,expression:"historyLoading"}],attrs:{value:20,color:"primary",indeterminate:""}})],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("История просмотра")])],1)]}}],null,!1,2188582760),model:{value:e.historyMenuShow,callback:function(t){e.historyMenuShow=t},expression:"historyMenuShow"}},[e._v(" "),e.hasHistory?n("v-list",e._l(e.historyList,(function(t,i){return n("v-list-item",{key:i,on:{click:function(n){return e.onHistoryClick(t)}}},[n("v-list-item-title",[e.isDocumentHistoryItem(t)?n("v-icon",{staticClass:"pr-1",attrs:{size:"18"}},[e._v("description")]):n("v-icon",{staticClass:"pr-1",attrs:{size:"18"}},[e._v("mail")]),e._v(" "),e.isDocumentHistoryItem(t)?n("span",{staticClass:"px-1"},[e._v(e._s(e.documentTitle(t)))]):[n("span",[e._v(e._s(t.item.documentType))]),e._v(" "),t.item.documentType?n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"px-1"},[e._v("от")]):e._e(),e._v(" "),n("span",[e._v(e._s(t.item.initiatorName))]),e._v(" "),n("span",{staticClass:"px-1"},[e._v("-")]),e._v(" "),n("span",[e._v(e._s(t.item.stateName))])]],2)],1)})),1):e.noHistory?n("v-list",[n("v-list-item",[n("v-list-item-title",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("История просмотра отсутствует")])],1)],1):e._e()],1):e._e(),e._v(" "),n("v-menu",{attrs:{fixed:"",bottom:"","offset-y":"","close-on-content-click":e.doCloseMenu},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"deputy-btn sm-text ml-3",attrs:{tabindex:"-1",text:""}},Object.assign({},i)),[n("div",{staticClass:"deputy-btn__inner"},[e.isMobile&&e.drawer?e._e():n("v-icon",{staticClass:"deputy-btn__icon grey--text darken-3"},[e._v(" account_circle ")]),e._v(" "),e.currentUser&&e.isDesktop?n("div",{staticClass:"deputy-btn__user"},[e.currentUser.deputyUserId?[n("div",[n("translate",[e._v("Замещение")])],1),e._v(" "),n("div",[e._v(e._s(e.showName(e.currentUser.deputyUserName)))])]:[n("span",[e._v(e._s(e.showName(e.userName)))])]],2):e._e(),e._v(" "),e.isDesktop?n("v-icon",[e._v("keyboard_arrow_down")]):e._e()],1)])]}}],null,!1,704486206),model:{value:e.userNameMenuShow,callback:function(t){e.userNameMenuShow=t},expression:"userNameMenuShow"}},[e._v(" "),n("v-list",[e.isMobile&&e.currentUser?n("div",{staticClass:"deputy-name"},[e.currentUser.deputyUserName?n("span",[e._v("\n            "+e._s(e.showName(e.currentUser.name))+" замещает "+e._s(e.showName(e.currentUser.effectiveName))+"\n          ")]):n("span",[e._v(" "+e._s(e.currentUser.effectiveName)+" ")])]):e._e(),e._v(" "),n("v-list-item",{on:{click:e.onLogout}},[n("v-list-item-title",[e._v(e._s(e.$gettext("Выход")))])],1),e._v(" "),e.inDeputyMode?n("v-list-item",{on:{click:e.onDeputyExit}},[n("v-list-item-title",[e._v(e._s(e.$gettext("Отключить режим замещения")))])],1):e._e()],1),e._v(" "),e.isLdApp?n("v-divider"):e._e(),e._v(" "),e.isLdApp&&e.deputyLoading?n("v-list",[n("v-list-item",[n("v-list-item-title",[e._v(e._s(e.$gettext("Загрузка списка замещаемых...")))]),e._v(" "),n("v-progress-circular",{attrs:{value:18,color:"primary",indeterminate:""}})],1)],1):e.isLdApp&&e.shownDeputies&&e.shownDeputies.length?n("v-list",[e._l(e.shownDeputies,(function(t,i){return n("v-list-item",{key:i,on:{click:function(n){return e.onSetDeputyUser(t)}}},[n("v-list-item-title",[t&&e.currentUser&&t.id!==e.currentUser.id?n("v-icon",{staticClass:"pr-1"},[e._v("account_circle")]):e._e(),e._v(e._s(t.name)+"\n          ")],1)],1)})),e._v(" "),e.deputyList.length>10?n("v-list-item",[n("v-list-item-title",{staticClass:"primary--text"},[n("v-btn",{staticClass:"mt-2 rounded-button small-button header-button",attrs:{color:"primary"},on:{click:e.searchDeputy}},[n("v-icon",{attrs:{small:"",color:"white"}},[e._v(" search ")]),e._v(" "),n("translate",[e._v("Поиск")])],1)],1)],1):e._e()],2):e._e()],1),e._v(" "),e.isLdApp&&e.isCanRunHelp&&!e.isMobile?n("v-tooltip",{attrs:{bottom:"","open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-icon",e._g({staticClass:"grey--text lighten-6 toolbar-helper ml-3",on:{click:e.runIntro}},Object.assign({},i)),[e._v("\n          live_help\n        ")])]}}],null,!1,3473657100)},[e._v(" "),n("span",[e._v("Интерактивный помощник")])]):e._e()],1):e._e(),e._v(" "),e.isDashboard?n("nav",{staticClass:"home-menu"},[n("ul",{staticClass:"home-menu__list"},[e._l(e.filteredHomeMenu,(function(t,i){return n("li",{key:t.id},[n("v-btn",{staticClass:"elevation-0 home-menu__btn",class:{"home-menu__btn-home":t.home},attrs:{color:"white",outlined:t.home},on:{click:function(n){return e.onMenuItemClick(t)}}},[t.icon?[n("v-icon",{staticClass:"white--text sm-icon mr-2",class:{"new-notifications":e.isLdApp&&e.hasNewNotifications(t)}},[e._v("\n              "+e._s(t.icon)+"\n            ")])]:t.svg?[n("svg-icon",{staticClass:"white--text sm-icon",attrs:{icon:t.svg}})]:e._e(),e._v(" "),n("span",{staticClass:"text-body-1 font-weight-medium white--text"},[e._v(e._s(t.text))])],2)],1)})),e._v(" "),e.filteredHomeMenuTail.length?n("li",[n("v-menu",{attrs:{"open-on-click":"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""}},Object.assign({},i)),[n("v-icon",{staticClass:"white--text",attrs:{size:"24"}},[e._v(" more_vert ")])],1)]}}],null,!1,3436559544)},[e._v(" "),n("v-list",e._l(e.filteredHomeMenuTail,(function(t,i){return n("v-list-item",{key:t.id,on:{click:function(n){return e.onMenuItemClick(t)}}},[n("v-list-item-title",[e._v(" "+e._s(t.text)+" ")])],1)})),1)],1)],1):e._e()],2),e._v(" "),e.isSearchSectionEnabled?n("v-text-field",{staticClass:"pl-0 small-input sm-text search-field",attrs:{text:"","hide-details":"","single-line":"",outlined:"",clearable:"",autocomplete:"off","prepend-inner-icon":"search",label:e.$gettext("Поиск")},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.onSearchEnter(t))}},model:{value:e.searchTerms,callback:function(t){e.searchTerms=t},expression:"searchTerms"}}):e._e()],1):e._e(),e._v(" "),n("v-main",{ref:"vMain",class:{"margin-top-fix":e.isDashboard},attrs:{id:"main-content"}},[n("v-row",{staticClass:"fill-height no-gutters pa-0 fluid nowrap-content"},[e.isLdApp&&e.isSearchSection?[n("router-view",{attrs:{"force-is-mobile":e.forceIsMobile,"force-is-tablet":e.forceIsTablet}},[e._v(" loading... ")])]:n("vue-splitter",{staticClass:"splitter",attrs:{margin:0,"right-visibled":e.isLdApp&&Boolean(e.viewPanel),"left-size-percent":e.leftPanelSize,"left-size-min":"680px","right-size-min":"30"},on:{resize:e.onPanelResize}},[n("v-col",{key:"router",staticClass:"fill-height justify align",staticStyle:{padding:"0"},attrs:{slot:"left-pane"},slot:"left-pane"},[n("router-view",{attrs:{"force-is-mobile":e.forceIsMobile,"force-is-tablet":e.forceIsTablet}},[e._v(" loading... ")])],1),e._v(" "),e.isLdApp?n("v-col",{staticClass:"right-panel fill-height grey--border lighten-4",staticStyle:{padding:"0"},attrs:{slot:"right-pane",id:"appRightPanel"},slot:"right-pane"},[n("v-row",{staticClass:"no-gutters pl-2 pt-0 pb-0 mt-0 grey lighten-4 right-panel-action",staticStyle:{"max-height":"fit-content"},attrs:{id:"appRightPanelHeader"}},[e.isErrorView?e._e():n("v-row",{attrs:{"no-gutters":"",align:"center"}},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"primary--text pl-1 body-2 font-weight-bold",staticStyle:{cursor:"pointer"},on:{click:e.onOpenNewWindow}},[e._v("Открыть в новом окне")]),e._v(" "),n("v-icon",{attrs:{medium:"",color:"primary"},on:{click:e.onOpenNewWindow}},[e._v("chevron_right")])],1),e._v(" "),n("v-icon",{staticClass:"mr-2",on:{click:e.onCloseViewPanelClick}},[e._v("close")])],1),e._v(" "),e.isInstructionView&&!e.isReportView?n("div",{key:"act-pnl",staticClass:"right-panel-actions"},[n("action-panel",{attrs:{visible:!0,context:e.viewPanelActionContext,loading:e.loading,"force-is-mobile":e.forceIsMobileForRightPanel},on:{"action-result":e.onActionResult,"action-processing":e.onActionProcessing}})],1):e._e(),e._v(" "),n("div",{key:"appRightPanel",staticClass:"right-panel-content",class:{"grey lighten-4":e.isDocumentView},attrs:{id:"appRightPanelContent"}},[e.loading?n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.loading}}):e._e(),e._v(" "),e.isErrorView?n("span",[e._v(e._s(e.errorText))]):e.isReportView?n("instruction-report",{attrs:{instructionInfo:e.viewPanelInstructionInfo,reportId:Number(e.viewPanel.reportData.reportId),context:e.viewPanelActionContext,actionType:e.viewPanel.reportData.actionType,"do-close":e.wouldCloseViewPanel,"quick-report":e.viewPanel.reportData.quickReport,"force-is-mobile":e.forceIsMobileForRightPanel,"force-is-tablet":e.forceIsTabletForRightPanel},on:{"instruction-report-sent":e.doCloseViewPanel,"instruction-report-closed":e.doCloseViewPanel}}):e.isInstructionView?n("instruction-view",{attrs:{context:e.viewPanelInstructionInfo,"action-context":e.viewPanelActionContext,limitedMode:!0},on:{"instr-view-loading":e.onViewLoading}}):e.isDocumentView?n("document-template-renderer",{key:e.viewPanelDocument?e.viewPanelDocument.id:"viewPanel_document",attrs:{document:e.viewPanelDocument,"template-type":e.docTemplateType,"force-is-mobile":e.forceIsMobileForRightPanel,"force-is-tablet":e.forceIsTabletForRightPanel,context:e.viewPanelActionContext},on:{"external-component-loading":e.onViewLoading}}):e._e()],1)],1):e._e()],1)],2)],1),e._v(" "),n("modal-container")],1)]]:[n("v-app",{attrs:{id:"landocs"}},[n("v-main",{ref:"vMain",attrs:{id:"main-content"}},[n("v-row",{staticClass:"fill-height no-gutters pa-0 fluid nowrap-content"},[n("v-col",{key:"router",staticClass:"fill-height justify align",staticStyle:{padding:"0"},attrs:{slot:"left-pane"},slot:"left-pane"},[n("router-view",{attrs:{"force-is-mobile":e.forceIsMobile,"force-is-tablet":e.forceIsTablet}},[e._v(" loading... ")])],1)],1)],1)],1)]],2)},Re=[],Te=n(95289),Pe=n(2557),Oe=n(69798),ke=n(22713);(function(e){e[e["Mail"]=0]="Mail",e[e["Archive"]=1]="Archive",e[e["User"]=2]="User"})(De||(De={}));var Fe=n(69332);class NoticeQuery{constructor(e,t,n){this.maxNotificationsCount=e,this.lookIdAfter=t,this.fromRemote=n}}var Ae=n(1869),$e=n(508),je=n(92673),Ee=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(e,t){return function(n,i){t(n,i,e)}},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Me=class NoticeAndStatisticService{constructor(e,t,n){this._queryBus=e,this._log=t,this._config=n,this.folderIds=[1999,2103,2104,2107,2109,2110,2107],this._lookIdAfter=null,this._maxNotificationsCount=100,this.folderStat=[],this._log.debug("StatisticService created")}setDiffStatCallback(e){this.callbackStatDiff=e}start(e){return __awaiter(this,void 0,void 0,(function*(){if(!e)return;this.stop();const t=yield this._queryBus.exec(new $e.n7);if(t.getNotifications)try{if(this._config.folderStatistic){const e=yield this._queryBus.exec(new Fe.KM(0));this.folderIds=this.getStatisticFolderIds(e.filter((e=>!e.isConsolidated)))}this.doQuery(),this.statIntervalId=window.setInterval((()=>this.doQuery()),e)}catch(e){this._log.error(e)}}))}stop(){window.clearInterval(this.statIntervalId)}getNotices(){return __awaiter(this,void 0,void 0,(function*(){try{const e=new NoticeQuery(this._maxNotificationsCount,this._lookIdAfter,!0),t=yield this._queryBus.exec(e);this._log.debug("fetch new notifications",t),t&&(this._lookIdAfter=t.lookIdAfter)}catch(e){this._log.error(e)}}))}doQuery(){return __awaiter(this,void 0,void 0,(function*(){if(this._config.folderStatistic){const e=[];if(Array.isArray(this.folderIds)&&this.folderIds.length){try{const t=yield this._queryBus.exec(new Fe.z5(this.folderIds,!0));if(Array.isArray(t)&&t.length)for(const n of t)e.push(n)}catch(e){this._log.error(e)}const t=this.getStatDiff(e);this.folderStat=e,this.callbackStatDiff&&this.callbackStatDiff(t)}}else try{yield this._queryBus.exec(new Fe.ZO)}catch(e){this._log.error(e)}}))}getStatDiff(e){if(!Array.isArray(e))return[];if(!this.folderStat.length)return[];const t=[];return e.forEach((e=>{const n=this.folderStat.find((t=>t.folderID===e.folderID));(null===n||void 0===n?void 0:n.unreadItems)<e.unreadItems&&t.push({folderID:e.folderID,unreadItems:e.unreadItems-n.unreadItems})})),t}getStatisticFolderIds(e){if(!e)return[];const t=e.filter((e=>e.id===e.topLevelFolderId&&e.type!==De[De.Archive])),n=new Set(t.map((e=>e.id)));return e.filter((e=>n.has(e.topLevelFolderId))).map((e=>e.id))}};Me=__decorate([(0,Ee.b2)(),__param(0,(0,Ee.f3)(Ae.M.IQueryBus)),__param(1,(0,Ee.f3)(je.t.ILogger)),__param(2,(0,Ee.f3)(je.t.Config)),__metadata("design:paramtypes",[Object,Object,Object])],Me);var Ne=n(64447),Ve=n(22402),Be=n(20734),Le=n(42256),Ue=n(50103),He=n(77896),Qe=n(86949),ze=n(13560),Ze=n(6259),We=n(54519),qe=n(91487);function FileGetter(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="files"),(0,qe.aD)(e,t)}var Ge=n(17773),Ke=n(76764),Ye=n(39481),Je=n(71148),Xe=n(4842),et=n(40471),tt=n(2653);function AuthGetter(e,t){return t=null!==t&&void 0!==t?t:{},t.namespace||(t.namespace="auth"),(0,qe.aD)(e,t)}var nt=n(69585),it=n(13319),ot=n(54486),st=n(60390),rt=n(29339),at=n(51414),app_mixin_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},app_mixin_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},app_mixin_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const lt=40,ct=200,dt="app";let ut=class AppMixin extends rt.Vue{constructor(){super(...arguments),this.drawer=!1,this.isMenuHover=!1,this.isSubMenuHover=!1,this.openDelaySubMenu=200,this.sectionHovered=null,this.userNameMenuShow=!1,this.mini=!1,this.folderId="",this.activeItem=null,this.folderWasChanged=!0,this.isNowInTransition=!1,this.afterTransitionAction=[],this.version="3.7.2.93",this.docTemplateType=et.$.View,this.loading=!1,this.logoSrc=null,this.logoReceived=!1,this.errorText="",this.mainMenu=[],this.toHome=!1,this.doCloseMenu=!0,this.sectionFolders={},this.sectionFirstFolder={},this.subMenuPinnedInSectionState=!0,this.subMenuPinnedInSubSectionState=!1,this.rightPanelSize=30,this.tooltipDelay=500,this.isElectronApp=!1,this.appTitle="",this.isAppMaximized=!1}created(){const e=this.templatesLocation+"brand.png",t=new Image;t.onload=()=>{this.logoReceived=!0,this.logoSrc=e},t.onerror=()=>{this.logoReceived=!0},t.src=e;const n=new tt.Yf;this.queryBus.exec(n).then((e=>(e&&e.dependencies&&e.dependencies.forEach((e=>{const t=document.createElement("script");t.src=e,document.body.appendChild(t)})),e))).catch((e=>this.$log.error(e))),Je.X.$on("workspace-update-preview-mode",this.onWorkspaceUpdatePreviewMode),Je.X.$on("app-message",this.onAppMessage),Je.X.$on("abort-transition",this.onAbortTransition)}mounted(){0}beforeDestroy(){Je.X.$off("workspace-update-preview-mode",this.onWorkspaceUpdatePreviewMode),Je.X.$off("app-message",this.onAppMessage),Je.X.$off("abort-transition",this.onAbortTransition)}onStateChanged(){this.isInSectionState&&!this.drawer&&this.showDrawer(),this.setVmainPadding()}onDrawerChanged(){this.setVmainPadding()}onLeftChanged(){const e=this.isInSectionState?this.subMenuPinnedInSectionState:this.subMenuPinnedInSubSectionState;this.$vuetify.application.left!==lt+ct||e||(this.$vuetify.application.left=lt)}onIsSubMenuHoverChanged(){this.isSubMenuHover||this.isMenuHover||(this.sectionHovered=null)}onIsAuthenticatedChanged(){this.isAuthenticated||this.setMenuItemActive(null),this.isAuthenticated&&this.readViewState(dt).then((e=>(e&&"subMenuPinnedInSection"in e&&(this.subMenuPinnedInSectionState=e.subMenuPinnedInSection),e&&"subMenuPinnedInSubSection"in e&&(this.subMenuPinnedInSubSectionState=e.subMenuPinnedInSubSection),e&&"rightPanelSize"in e&&(this.rightPanelSize=e.rightPanelSize),e))).catch((e=>this.$log.error(e)))}onRouteChangedHandler(e,t,n){var i,o,s;return app_mixin_awaiter(this,void 0,void 0,(function*(){let r;this.appTitle=document.title;try{if(this._lastToRoute===e||e.name===(null===t||void 0===t?void 0:t.name)&&e.path===(null===t||void 0===t?void 0:t.path))return;let a;this._lastToRoute=e,this.routeChangedPromise=new Promise((e=>r=e));const l=this.$config.defaultSection||Le.S.Dashboard,c="/"===e.path?l:e.path.split("/")[1];if(this.toHome?(this.toHome=!1,a=this.mainMenu.find((e=>c===e.menuItem.id&&e.home))):a=l===Le.S.Dashboard?this.mainMenu.find((e=>c===e.menuItem.id)):this.mainMenu.find((e=>c===e.menuItem.id&&!e.home)),this.setMenuItemActive(a),!a||(null===e||void 0===e?void 0:e.meta)&&(null===a||void 0===a?void 0:a.menuItem.state)!==(null===(i=null===e||void 0===e?void 0:e.meta)||void 0===i?void 0:i.state))return void(this.subMenuPinnedInSubSectionState?this.showDrawer():this.hideDrawer());let d="";if(e.params&&e.params.parentId?d=String(e.params.parentId):e.meta&&e.meta.id&&(d=e.meta.id),""!==d&&"0"!==d||(d=null),!d&&a&&a.menuItem.submenu){const e=yield this.readViewState(c);(null===e||void 0===e?void 0:e.folderId)&&(d=String(e.folderId))}if(this.isMobile||this.showDrawer(),!n&&c!==Le.S.Settings&&!(null===(o=e.params)||void 0===o?void 0:o.parentId)&&d)return(null===(s=a.menuItem)||void 0===s?void 0:s.activeSubItem)&&(a.menuItem.activeSubItem.id=null),this.onFolderChanged({id:d},!1,a.menuItem.id);this.folderId&&this.folderId===d?this.folderWasChanged||this.$nextTick((()=>{Je.X.$emit("same-folder-select",Number(this.folderId))})):(n||(this.folderId=d),this.isInSectionState&&this.folderId&&!this.folderWasChanged&&this.onFolderChanged({id:this.folderId},!1,a.menuItem.id))}finally{this.folderWasChanged=!1,r&&r()}}))}onMenuItemClick(e){var t,n;return app_mixin_awaiter(this,void 0,void 0,(function*(){if(!e)throw new Error("Не установлен пункт меню");if(e.active)return;this.sectionHovered=null;const i={section:null===e||void 0===e?void 0:e.menuItem.id,collectionViewMode:Ue.Ml.None,entityViewMode:Ue.dS.None,contentType:Ue.zc.Instruction,folderId:this.folderId,folderName:""},o={},s=e.menuItem&&e.menuItem.submenu?null===(n=null===(t=e.menuItem.activeSubItem)||void 0===t?void 0:t.id)||void 0===n?void 0:n.toString():null;o.path=`/${e.menuItem.id}`,s&&(o.path+=`/${s}`);try{this.isNowInTransition=!0,e.home&&(this.toHome=!0),yield this.$app.goto(e.menuItem.transition,i,o)}catch(e){this.$log.error(e)}finally{this.isNowInTransition=!1;while(this.afterTransitionAction.length){const e=this.afterTransitionAction.shift();"function"===typeof e&&e()}this.isMobile&&(this.drawer=!1)}}))}onMenuButtonClick(e,t){this.setMenuTopPosition(),this.drawer?this.hideDrawer():this.showDrawer()}onHover(e,t){this.isMenuHover=t,this.isMenuHover&&(this.sectionHovered=e.menuItem.submenu?e:null,this.isSubMenuHover=e.menuItem.submenu),this.setVmainPadding()}onAbortTransition(e){if(!e&&!this.toHome)return;let t;t="string"===typeof e?{path:e,fullPath:e,hash:null,matched:[],params:null,query:null}:e,this.onRouteChangedHandler(t,null,!0)}menuItemClass(e){let t=this.isMobile?"m-mobile":"";return t+=e.active?"menu-item-active primary":"",t}onLogout(){return app_mixin_awaiter(this,void 0,void 0,(function*(){try{this.beforeLogout(),this.activeItem&&(this.activeItem.menuItem.activeSubItem=null,this.setMenuItemActive(null));try{yield this.authService.logout()}catch(e){this.$log.error(e)}}finally{this.$router.push("/login"),this.$app.stopApp()}}))}beforeLogout(){}onFolderChanged(e,t,n){var i,o;if(this.isNowInTransition)return;let s=!0;this.folderWasChanged=!0,this.activeItem||(s=this.drawer,this.setItemActive(n));const r=this.mainMenu.find((e=>e.menuItem.id===n));if(r){if(t||!this.isItemActive(n)||(null===(o=null===(i=r.menuItem)||void 0===i?void 0:i.activeSubItem)||void 0===o?void 0:o.id)!=e.id){if(this.isInSectionState||this.hideDrawer(),this.$log.debug("onFolderChanged"),r.menuItem.activeSubItem=e,this.setCurrentFolder(e),this.updateViewState(r.menuItem.id,{folderId:e.id}),t&&this.$app.state===r.menuItem.state)return this.isMobile&&this.hideDrawer(),Je.X.$emit("same-folder-select",Number(e.id));if(s){let t,i;if(e&&e.id){let n=`/${r.menuItem.id}`;e.baseUrl&&(n+=`/${e.baseUrl}`),n+=`/${e.id}`,t={path:n}}e.parents&&e.parents.length&&(i=e.parents.map((e=>({text:e.name,route:{path:`/${r.menuItem.id}/${e.id}`}}))));const o={section:n,collectionViewMode:Ue.Ml.None,contentType:null===e||void 0===e?void 0:e.contentType,entityViewMode:Ue.dS.None,folderId:null===e||void 0===e?void 0:e.id,folderName:null===e||void 0===e?void 0:e.name,breadcrumbs:new Ye.O(i)};this.$app.goto(r.menuItem.transition,o,t)}}}else this.$log.error(`Menu item for ${n} not found`)}onFoldersReady(e,t,n){return app_mixin_awaiter(this,void 0,void 0,(function*(){this.setCurrentFolder(e),this.sectionHovered||(yield this.routeChangedPromise,this.sectionFolders[this.activeSection]=t,this.sectionFirstFolder[this.activeSection]=e,!this.folderId&&e&&(this.folderId=String(e.id),this.isInSectionState&&n===this.activeSection&&this.folderId&&!this.folderWasChanged&&(this.isNowInTransition?this.afterTransitionAction.push((()=>this.onFolderChanged(e,!1,n))):this.onFolderChanged(e,!1,n))))}))}onUnpinClick(){this.isInSectionState?(this.subMenuPinnedInSectionState=!1,this.updateViewState(dt,{subMenuPinnedInSection:this.subMenuPinnedInSectionState})):(this.subMenuPinnedInSubSectionState=!1,this.updateViewState(dt,{subMenuPinnedInSubSection:this.subMenuPinnedInSubSectionState}),this.hideDrawer()),this.isSubMenuHover=!1,this.setVmainPadding(),this.isInSectionState||this.$nextTick((()=>{this.setMenuTopPosition()}))}onPinClick(){this.isInSectionState?(this.subMenuPinnedInSectionState=!0,this.updateViewState(dt,{subMenuPinnedInSection:this.subMenuPinnedInSectionState})):(this.subMenuPinnedInSubSectionState=!0,this.updateViewState(dt,{subMenuPinnedInSubSection:this.subMenuPinnedInSubSectionState})),this.setVmainPadding(),this.isInSectionState||this.$nextTick((()=>{this.setMenuTopPosition()}))}onPanelResize(e){this.rightPanelSize=100-e,this.updateViewState(dt,{rightPanelSize:this.rightPanelSize})}onViewLoading(e){this.loading=e}onWorkspaceUpdatePreviewMode(e){}onAppMessage(e,t){if(null===t||void 0===t)e.toLowerCase().includes(this.$gettext("ошибка"))?this.$toasted.error(e):this.$toasted.show(e);else switch(t){case Te.uE.Error:this.$toasted.error(e);break;case Te.uE.Completed:this.$toasted.success(e);break;case Te.uE.Cancel:this.$toasted.info(e);break;default:this.$toasted.show(e);break}}showName(e){return(0,it.nO)(e)}hideDrawer(){this.drawer=!1}setVmainPadding(){var e;let t=0;if(this.isDesktop&&(this.isInSectionState&&!this.isDashboard?(t=lt,this.subMenuPinnedInSectionState&&(null===(e=this.activeItem)||void 0===e?void 0:e.menuItem.submenu)&&(t=lt+ct)):this.drawer&&(t=this.subMenuPinnedInSubSectionState&&!this.isDashboard?lt+ct:0)),this.$refs.vMain){const e=this.$refs.vMain.$el;e.style.paddingLeft=`${t}px`}}setMenuBoxShadow(e){if(this.$refs.vNavigationDrawer){const t=this.$refs.vNavigationDrawer.$el;t.style.boxShadow=e?"0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12)":"none"}}setMenuTopPosition(){if(this.isDesktop&&this.$refs.vNavigationDrawer){const e=this.$refs.vNavigationDrawer.$el;e.style.top=`${this.$vuetify.application.top}px`,e.style.height=window.innerHeight-this.$vuetify.application.top+"px",e.style.zIndex="5"}}isItemActive(e){return!!this.activeItem&&this.activeItem.menuItem.id===e}setMenuItemActive(e){this.mainMenu.forEach((e=>e.active=!1)),this.activeItem=e,e&&(e.active=!0)}setItemActive(e){const t=this.mainMenu.find((t=>t.menuItem.id===e));return t&&this.setMenuItemActive(t),t}showDrawer(){this.drawer=!0}get activeSection(){var e,t,n;return null!==(n=null===(t=null===(e=this.activeItem)||void 0===e?void 0:e.menuItem)||void 0===t?void 0:t.id)&&void 0!==n?n:null}get tempSection(){return this.sectionHovered?this.sectionHovered.menuItem.id:null}get isInSectionState(){return Boolean(this.mainMenu.find((e=>e.menuItem.state===this.$app.state)))}get isPinned(){return this.isInSectionState?this.subMenuPinnedInSectionState:this.subMenuPinnedInSubSectionState}get isDrawerTemporary(){return!(!this.isMobile&&!this.isTablet)||!this.isInSectionState&&!this.subMenuPinnedInSubSectionState}get canPin(){return!this.isInSectionState||this.hasSubmenu}get showToolbar(){return!(this.isMobile&&!this.$app.isSectionState)}get userName(){return this.currentUser&&this.currentUser.deputyUserName?this.currentUser.deputyUserName:this.currentUser?this.currentUser.name:""}get isSubMenuVisibled(){if(!this.drawer)return!1;let e=!1;(this.hasSubmenu&&this.subMenuPinnedInSectionState&&this.isInSectionState||!this.isInSectionState)&&(e=!0),e=Boolean(this.sectionHovered||this.hasSubmenu&&this.subMenuPinnedInSectionState&&this.isInSectionState||!this.isInSectionState);let t=!1;return t=!this.isDesktop||(this.isInSectionState?this.hasSubmenu?!!e&&!this.subMenuPinnedInSectionState:e:!this.subMenuPinnedInSubSectionState),this.setMenuBoxShadow(t),e}get drawerWidth(){if(!this.drawer||this.isDashboard)return 0;if(this.isInSectionState){const e=this.sectionHovered?this.sectionHovered.menuItem.submenu:this.hasSubmenu,t=e?lt+ct:lt;return this.isSubMenuVisibled?t:lt}return this.isSubMenuVisibled?lt+ct:lt}get hasSubmenu(){return this.activeItem&&this.activeItem.menuItem.submenu}get isMenuButtonShow(){return!this.isDesktop||!this.isInSectionState}get isErrorView(){return Boolean(this.errorText)}get mobileDrawer(){return!(!this.isMobile||!this.drawer)}get filteredMainMenu(){return this.isMobile?this.mainMenu.filter((e=>e.menuItem.id!==Le.S.Settings&&e.menuItem.id!==Le.S.Kanban)):this.mainMenu}get filteredHomeMenu(){const e=this.filteredMainMenu.length,t=this.filteredMainMenu.filter((e=>e.menuItem.id!==Le.S.Search));let n;this.$vuetify.breakpoint.xl&&(n=9),this.$vuetify.breakpoint.lg&&(n=7),this.$vuetify.breakpoint.md&&(n=5),this.$vuetify.breakpoint.sm&&(n=3);const i=e>n?e-n:0;return i?[...t].slice(0,e-i):t}get filteredHomeMenuTail(){const e=this.filteredMainMenu.filter((e=>e.menuItem.id!==Le.S.Search)),t=e.length-this.filteredHomeMenu.length;return t>0?[...e].slice(-1*t):[]}get leftPanelSize(){return 100-this.rightPanelSize}get forceIsMobile(){return this.leftPanelSize<=30}get forceIsTablet(){return this.leftPanelSize>30&&this.leftPanelSize<=70}get forceIsMobileForRightPanel(){return this.rightPanelSize<=30}get forceIsTabletForRightPanel(){return this.rightPanelSize>30&&this.rightPanelSize<=70}get templatesLocation(){return this.$config.templatesLocation}get isDashboard(){return this.$app.state===Oe.Z.Dashboard}get isAdminApp(){return!1}get isLdApp(){return!0}get inDeputyMode(){var e;return Boolean(null===(e=this.currentUser)||void 0===e?void 0:e.deputyUserId)}};app_mixin_decorate([(0,ot.t)(),app_mixin_metadata("design:type",Xe.e)],ut.prototype,"authService",void 0),app_mixin_decorate([(0,ot.t)(Ae.M.IQueryBus),app_mixin_metadata("design:type",Object)],ut.prototype,"queryBus",void 0),app_mixin_decorate([(0,ot.t)(Ve.O.ICommandBus),app_mixin_metadata("design:type",Object)],ut.prototype,"commandBus",void 0),app_mixin_decorate([(0,Ge.O)("currentUser"),app_mixin_metadata("design:type",Object)],ut.prototype,"currentUser",void 0),app_mixin_decorate([AuthGetter("isAuthenticated"),app_mixin_metadata("design:type",Boolean)],ut.prototype,"isAuthenticated",void 0),app_mixin_decorate([AuthGetter("isFirstStart"),app_mixin_metadata("design:type",Object)],ut.prototype,"isFirstStart",void 0),app_mixin_decorate([(0,nt.x)("userSettings"),app_mixin_metadata("design:type",Object)],ut.prototype,"userSettings",void 0),app_mixin_decorate([(0,at.mm)("SET_CURRENT_FOLDER"),app_mixin_metadata("design:type",Function)],ut.prototype,"setCurrentFolder",void 0),app_mixin_decorate([(0,rt.Watch)("$app.state"),app_mixin_metadata("design:type",Function),app_mixin_metadata("design:paramtypes",[]),app_mixin_metadata("design:returntype",void 0)],ut.prototype,"onStateChanged",null),app_mixin_decorate([(0,rt.Watch)("drawer"),app_mixin_metadata("design:type",Function),app_mixin_metadata("design:paramtypes",[]),app_mixin_metadata("design:returntype",void 0)],ut.prototype,"onDrawerChanged",null),app_mixin_decorate([(0,rt.Watch)("$vuetify.application.left"),app_mixin_metadata("design:type",Function),app_mixin_metadata("design:paramtypes",[]),app_mixin_metadata("design:returntype",void 0)],ut.prototype,"onLeftChanged",null),app_mixin_decorate([(0,rt.Watch)("isSubMenuHover"),app_mixin_metadata("design:type",Function),app_mixin_metadata("design:paramtypes",[]),app_mixin_metadata("design:returntype",void 0)],ut.prototype,"onIsSubMenuHoverChanged",null),app_mixin_decorate([(0,rt.Watch)("isAuthenticated",{immediate:!0}),app_mixin_metadata("design:type",Function),app_mixin_metadata("design:paramtypes",[]),app_mixin_metadata("design:returntype",void 0)],ut.prototype,"onIsAuthenticatedChanged",null),ut=app_mixin_decorate([st.Mixin],ut);const pt=ut;var ht=n(73022),mt=n(27437),dashboardHeadervue_type_template_id_050e6c8e_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{class:{mobile:e.isMobile},attrs:{justify:"space-between",id:"dashboard-header-wrapper"}},[e.isMobile?[n("v-row",{staticClass:"align-center ml-2",attrs:{"no-gutters":"",justify:"space-between"}},[n("v-col",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"body-1 font-weight-bold"},[e._v("Главная страница")])],1)],1),e._v(" "),n("v-col",{attrs:{cols:"auto"}},[n("v-row",{staticClass:"buttons-wrapper"},[n("v-menu",{attrs:{"offset-y":"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("div",{staticClass:"menu-add mobile"},[n("v-btn",e._g({staticClass:"my-0 header-btn bordered-button square-sm-button",attrs:{color:"primary"}},Object.assign({},i)),[n("v-icon",{staticClass:"medium-icon",attrs:{color:"white"}},[e._v("add")])],1)],1)]}}],null,!1,1565130715)},[e._v(" "),n("v-list",{staticClass:"create-global-menu"},[n("v-list-item",{on:{click:e.newMessageClick}},[n("v-list-item-title",[n("a",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Сообщение")])])],1),e._v(" "),n("v-divider"),e._v(" "),n("v-list-item",{on:{click:e.newDocumentClick}},[n("v-list-item-title",[n("a",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Документ")])])],1)],1)],1)],1)],1)],1)]:n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"headline"},[e._v("Главная страница")]),e._v(" "),n("v-row",{staticClass:"buttons-wrapper"},[n("v-menu",{attrs:{"offset-y":"",left:""}},[n("v-btn",{staticClass:"my-0 square-sm-button rounded-button bordered-button grey--border lighten-2 elevation-0",attrs:{slot:"activator"},slot:"activator"},[n("v-icon",{attrs:{color:"primary"}},[e._v("add")])],1),e._v(" "),n("v-list",{staticClass:"create-global-menu"},[n("v-list-tile",{on:{click:e.newMessageClick}},[n("v-list-tile-title",[n("a",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Сообщение")])])],1),e._v(" "),n("v-divider"),e._v(" "),n("v-list-tile",{on:{click:e.newDocumentClick}},[n("v-list-tile-title",[n("a",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Документ")])])],1)],1)],1)],1)],1)],2)},ft=[],gt=n(45904),dashboardHeadervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let yt=class DashboardHeaderComponent extends(o()){newMessageClick(){this.$emit("new-message")}newDocumentClick(){this.$emit("new-document")}};yt=dashboardHeadervue_type_script_lang_js_decorate([gt.default],yt);const vt=yt,bt=vt;var Ct=n(51900),wt=n(43453),_t=n.n(wt),xt=(0,Ct.Z)(bt,dashboardHeadervue_type_template_id_050e6c8e_scoped_true_render,ft,!1,null,"050e6c8e",null);const St=xt.exports;_t()(xt,{VBtn:g.Z,VCol:r.Z,VDivider:M.Z,VIcon:y.Z,VList:m.Z,VMenu:W.Z,VRow:a.Z});var folderTreevue_type_template_id_0e6a1246_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"folder-tree body-1"},[n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.isLoading}}),e._v(" "),n("tree-view",e._b({directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],ref:"tree",staticStyle:{"overflow-y":"auto","overflow-x":"hidden"},attrs:{model:e.folders,selection:e.selection,onSelect:e.onSelect},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{key:t.item.id,staticClass:"black--text",class:{"unread-mark":e.isLdApp&&e.hasNewNotifications(t.item.id)},attrs:{id:t.item.id,"data-test-id":"treeNode","data-test-uid":t.item.id}},[e._v("\n        "+e._s(t.item.name)+"\n      ")]),e._v(" "),e.isLdApp&&e.hasUnreadItems(t.item.id)?n("span",{staticClass:"background"},[n("span",{staticClass:"unread-messages white--text small-text font-weight-medium"},[e._v(e._s(e.unreadItemsCount(t.item.id))+"\n        ")])]):e._e()]}}])},"tree-view",e.treeOptions,!1))],1)},It=[],Dt=n(32904),Rt=n(11135),Tt=n(72835),Pt=n(23728),Ot=n(28517),kt=n(76110),Ft=n(12853);class ArchiveFoldersQuery{constructor(e,t,n){this.contentType=e,this.withDepartments=t,this.fromRemote=n}}var At=n(47053),$t=n(73179),folderTreevue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},folderTreevue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},folderTreevue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const jt="instructions",Et=1,Mt=10;let Nt=class FolderTreeComponent extends rt.Vue{constructor(){super(...arguments),this.loading={},this.loadedFolders={},this.folderInfo={id:0,topLevelFolderId:0,kind:Rt.Wy.Inbox,name:"",compositeId:"",nodeType:Tt.J.Fake,contentType:Ue.zc.Instruction,parentId:0,canBeFavorite:!1,isFavourite:!1},this.selection=[],this.treeOptions={category:"items",unique:e=>e.id,css:{TreeView:"tree-view"},strategies:{click:["select"],selection:["single",this.selectionStrategy.bind(this)],fold:["opener-control"]},openerOpts:{position:"left"}},this.isPinned=!1,this.scrollTop={}}onMsgFoldersChanged(){if(!this.instructionFolders||!this.instructionFolders.length)return;const e=(0,kt.t)(this.instructionFolders,Ue.zc.Instruction);this.$set(this.loadedFolders,Le.S.Messages,e)}onUserSettingsChanged(){this.loadedFolders[Le.S.Documents]&&this.onDocFoldersChanged()}onDocFoldersChanged(){const e=this.getDocFolders(this.userSettings.useGroupJournalsByDepartments);if(!e||!e.length)return;const t=(0,kt.t)(e,Ue.zc.Document,0,this.userSettings.useGroupJournalsByDepartments),n=t.find((e=>e.id===Mt));n.items.sort(((e,t)=>e.name.localeCompare(t.name)));for(let e=t.length-1;e>=0;e--){const n=t[e];n.items&&n.items.length||t.splice(e,1)}this.$set(this.loadedFolders,Le.S.Documents,t)}onReportFoldersChanged(){if(!this.reportFolders||!this.reportFolders.length)return;const e=(0,kt.t)(this.reportFolders,Ue.zc.FastReport);this.$set(this.loadedFolders,Le.S.Reports,e)}onKanbanBoardsChanged(){if(!this.boards||!this.boards.length)return;const e=(0,kt.t)(this.boards);this.$set(this.loadedFolders,Le.S.Kanban,e),this.setSelectedFolder(this.folders,this.folderId)}onArchiveFoldersChanged(){const e=this.getArchiveFolders(this.userSettings.useGroupJournalsByDepartments);if(!e||!e.length)return;const t=(0,kt.t)(e);this.$set(this.loadedFolders,Le.S.Archive,t)}onAddOrDeleteFromFavourite(){var e,t;(null===(e=this.favouriteFolder)||void 0===e?void 0:e.folder)&&!(null===(t=this.favouriteFolder)||void 0===t?void 0:t.completed)&&(this.onFavoriteUpdate(this.favouriteFolder.folder),this.setSelectedFolder(this.folders,this.folderId))}onSettingFoldersChanged(){if(!this.settingFolders||!this.settingFolders.length)return;const e=(0,kt.t)(this.settingFolders,Ue.zc.Settings,"");this.$set(this.loadedFolders,Le.S.Settings,e)}onVocFoldersChanged(){if(!this.vocFolders||!this.vocFolders.length)return;const e=(0,kt.t)(this.vocFolders,Ue.zc.Vocabulary);this.$set(this.loadedFolders,Le.S.Vocabularies,e)}onTempSectionChanged(e,t){this.onSectionChanged(e,t,!0)}onSectionChanged(e,t,n=!1){return folderTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e||e===t||this.loading[e])return;let i;try{if(this.sectionChangedPromise=new Promise((e=>i=e)),this.loadedFolders[e]||(yield this.fetchFolders(e)),this.loadedFolders[e]&&!n&&(this.section===this.tempSection||!this.tempSection)){const t=this.findFirstSelectableFolder(this.folders);this.$emit("folders-ready",null===t||void 0===t?void 0:t.nodeData,this.flattenFolders(this.folders),e),this.oldFolderId===this.folderId&&this.onFolderIdChanged(this.folderId,null)}}catch(e){this.$log.error(e)}finally{i()}}))}onFolderIdChanged(e,t){return folderTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){e!==t&&e&&(this.oldFolderId=this.folderId,yield this.sectionChangedPromise,this.setSelectedFolder(this.folders,this.folderId),this.expandParentNodes())}))}expandParentNodes(){return folderTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.folderId){let e;const t=100;let n=0;const waitForExpand=i=>i.__onExpandNode__?(clearInterval(e),Promise.resolve()):(n++,n>t?(clearInterval(e),Promise.reject(new Error("time is out"))):void(e=setInterval((()=>waitForExpand(i)),100))),i=(0,kt.$)(this.folders,this.folderId);if(!i)return;if(i){let e=[];this.getParentNodes(i,e),e=e.reverse();for(const t of e)try{yield waitForExpand(t),t.expanded=!0,t.__onExpandNode__()}catch(e){this.$log.error(e)}}}}))}onSelect(e,t,n,i){if([Ue.zc.Document,Ue.zc.Vocabulary].includes(t.contentType)&&t.nodeType!==Tt.J.DocumentFolder&&t.items&&t.items.length)return void(t.__onExpandNode__&&t.__onExpandNode__(!0));if(this.activeSection===Le.S.Vocabularies&&t.items&&t.items.length)return;if(this.activeSection===Le.S.Archive&&t.nodeType===Tt.J.Fake)return;e&&e.length&&(this.selection=e);let o=!1;e&&e.length?this.folderInfo=this.toFolderInfo(e[0]):o=!0,this.scrollTop[this.activeSection]=this.$refs.tree.$el.scrollTop,this.$emit("update-folder",this.folderInfo,o,this.activeSection)}selectionStrategy(e,t){if(this.activeSection===Le.S.Documents)return e.nodeType===Tt.J.Fake?[]:e.nodeType===Tt.J.DocumentFolder?t:t.filter((e=>e.parentId>0));if(this.activeSection===Le.S.Vocabularies){if(e.items&&e.items.length)return[]}else if(this.activeSection===Le.S.Archive&&e.nodeType===Tt.J.Fake)return[];return t}hasNewNotifications(e){if(!this.isInstruction||!this.isArchive)return!1;const t=!this.getNotifications(Le.S.Messages);if(!Array.isArray(t))return!1;const n=t.filter((t=>t.folderId===e));return n.length>0}hasUnreadItems(e){return!!this.$config.folderStatistic&&(!(!this.isInstruction&&!this.isArchive||!this.folderStat[e])&&this.folderStat[e].unreadItems>0)}unreadItemsCount(e){return(this.isInstruction||this.isArchive)&&this.folderStat[e]?this.folderStat[e].unreadItems:0}nodeIcon(e){return Ot.C.nodeIcon(e)}canBeFavorite(e){return null===e||void 0===e?void 0:e.canBeFavorite}icon(e){return(null===e||void 0===e?void 0:e.isFavourite)?"star":"star_outline"}onFavoriteUpdate(e){return folderTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e)return;const t=(0,kt.$)(this.folders,e.id);if(t.canBeFavorite){const e=this.$gettext("Ошибка удаления из избранного");if(t.isFavourite){try{yield this.commandBus.exec(new Dt.Wl(Number(t.id)))}catch(t){return this.$log.error(t),void this.$toasted.error(`${e} ${t.message}`)}t.isFavourite=!1,t.parentId===Mt?this.removeNode(t):this.removeNode(t,Mt);const n=this.folders.find((e=>e.id===Et)),i=null===n||void 0===n?void 0:n.items.find((e=>e.id===t.id));i&&(i.isFavourite=!1)}else try{yield this.commandBus.exec(new Dt.Ml(Number(t.id)))}catch(t){return this.$log.error(t),void this.$toasted.error(`${e} ${t.message}`)}}this.SET_FAV_FOLDER({folder:e,completed:!0})}))}removeNode(e,t){if(!e)return;t=t||Number(e.parentId);let n=this.folders.find((e=>e.id===t));if(n&&this.userSettings.useGroupJournalsByDepartments&&(n=n.items.find((t=>t.nodeData.departmentID===e.nodeData.departmentID))),n){const t=n.items.findIndex((t=>t.id===e.id));t>=0&&n.items.splice(t,1)}}moveNode(e,t){if(!e)return;const n=this.folders.find((t=>t.id===e.parentId));if(n){const t=n.items.findIndex((t=>t.id===e.id));t>=0&&n.items.splice(t,1)}const i=this.folders.find((e=>e.id===t));i&&(e.parentId=t,i.items.push(e),i.items.sort(((e,t)=>e.name.localeCompare(t.name))))}get activeSection(){var e;return null!==(e=this.tempSection)&&void 0!==e?e:this.section}get folders(){var e;return this.activeSection?(setTimeout((()=>{var e,t;const n=null===(e=this.$refs.tree)||void 0===e?void 0:e.$el;n&&(n.scrollTop=null!==(t=this.scrollTop[this.activeSection])&&void 0!==t?t:0)}),100),null!==(e=this.loadedFolders[this.activeSection])&&void 0!==e?e:[]):[]}get folderName(){return this.folderInfo.name}get isInstruction(){return this.activeSection===Le.S.Messages}get isArchive(){return this.activeSection===Le.S.Archive}get isKanban(){return this.activeSection===Le.S.Kanban}get isVisibled(){return"none"!==this.$el.style.display}get isLoading(){return Boolean(this.loading[this.activeSection])}get isLdApp(){return!0}fetchFolders(e,t=!1){return folderTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{switch(this.$set(this.loading,e,!0),e){case Le.S.Messages:t||this.onMsgFoldersChanged(),this.loadedFolders[e]&&!t||(yield this.queryBus.exec(new Fe.KM(null,t)));break;case Le.S.Documents:t||this.onDocFoldersChanged(),this.loadedFolders[e]&&!t||(yield this.queryBus.exec(new He.u9(this.userSettings.useGroupJournalsByDepartments,t)));break;case Le.S.Reports:t||this.onReportFoldersChanged(),this.loadedFolders[e]&&!t||(yield this.queryBus.exec(new $t.qN(t)));break;case Le.S.Archive:t||this.onArchiveFoldersChanged(),this.loadedFolders[e]&&!t||(yield this.queryBus.exec(new ArchiveFoldersQuery(null,this.userSettings.useGroupJournalsByDepartments)));break;case Le.S.Kanban:t||this.onKanbanBoardsChanged(),this.loadedFolders[e]&&!t||(yield this.queryBus.exec(new At.H));break;case Le.S.Settings:t||this.onSettingFoldersChanged(),this.loadedFolders[e]&&!t||(this.currentUser=yield this.queryBus.exec(new Ze.by),yield this.queryBus.exec(new $e.wq(this.currentUser,t)));break;case Le.S.Vocabularies:t||this.onVocFoldersChanged(),this.loadedFolders[e]&&!t||(yield this.queryBus.exec(new Pt.t(t)));break;default:break}}catch(e){this.$log.error(this.$gettextInterpolate(this.$gettext("Ошибка fetchFolders: %{err}"),{err:e}))}finally{this.$set(this.loading,e,!1)}}))}findFirstSelectableFolder(e){if(!Array.isArray(e)||!e.length)return null;let t=e[0];return t.nodeType===Tt.J.Fake&&(t=this.findFirstSelectableFolder(t.items)),t}toFolderInfo(e){if(!e)return null;let t=[];return this.getParentNodes(e,t),t=t.reverse(),{id:e.id,compositeId:e.compositeId,name:e.name,kind:e.nodeData.kind,topLevelFolderId:e.topLevelNodeId,cardId:e.nodeData.cardId,nodeType:e.nodeData.nodeType,isConsolidated:e.nodeData.isConsolidated,hasChild:e.items&&e.items.length>0,contentType:e.contentType,parents:t.map((e=>({id:e.id,name:e.name}))),parentId:e.parentId,baseUrl:e.baseUrl,canBeFavorite:e.canBeFavorite,isFavourite:e.isFavourite}}setSelectedFolder(e,t){if(!t)return;const n=(0,kt.$)(e,t);if(n&&n){this.folderInfo=this.toFolderInfo(n);const i=this.selection.length;if(this.selection.pop(),i>1&&(this.selection.length=0),this.selection.push(n),i>1&&this.selection.push(n),this.activeSection===Le.S.Documents&&[Mt,Et].includes(Number(n.parentId))){const i=(0,kt.$)(e,t,n);i&&this.selection.push(i)}const o=this.$refs.tree.$el;if(!o)return;const s=o.getBoundingClientRect(),waitForSelectedSet=()=>{const e=o.getElementsByClassName("selected");if(e.length){const t=e[0].getBoundingClientRect();if(t.top>s.top+s.height||t.top<s.top||t.bottom<s.top){let t;const onScroll=()=>{clearTimeout(t),t=setTimeout((()=>{o.removeEventListener("scroll",onScroll),this.scrollTop[this.activeSection]=o.scrollTop}),100)};o.addEventListener("scroll",onScroll,{passive:!0}),e[0].scrollIntoView({block:"center",behavior:"smooth"})}return e[0]}return null};setTimeout((()=>{waitForSelectedSet()||setTimeout((()=>waitForSelectedSet()),100)}),100)}}getParentNodes(e,t){if(e&&e.parentId){const n=(0,kt.$)(this.folders,e.parentId);n&&(t.push(n),this.getParentNodes(n,t))}}flattenFolders(e){let t=e.map((e=>e.nodeData));for(const n of e){const e=this.flattenFolders(n.items);Array.isArray(e)&&e.length&&(t=t.concat(e))}return t}};folderTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),folderTreevue_type_script_lang_js_metadata("design:type",String)],Nt.prototype,"folderId",void 0),folderTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),folderTreevue_type_script_lang_js_metadata("design:type",String)],Nt.prototype,"section",void 0),folderTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),folderTreevue_type_script_lang_js_metadata("design:type",String)],Nt.prototype,"tempSection",void 0),folderTreevue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),folderTreevue_type_script_lang_js_metadata("design:type",Object)],Nt.prototype,"queryBus",void 0),folderTreevue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),folderTreevue_type_script_lang_js_metadata("design:type",Object)],Nt.prototype,"commandBus",void 0),folderTreevue_type_script_lang_js_decorate([(0,nt.x)("userSettings"),folderTreevue_type_script_lang_js_metadata("design:type",Object)],Nt.prototype,"userSettings",void 0),folderTreevue_type_script_lang_js_decorate([(0,Ge.O)("getNotifications"),folderTreevue_type_script_lang_js_metadata("design:type",Function)],Nt.prototype,"getNotifications",void 0),folderTreevue_type_script_lang_js_decorate([(0,Ge.O)("getFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Object)],Nt.prototype,"getArchiveFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,Ke.Y)("instructionFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Object)],Nt.prototype,"instructionFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,We.k)("getFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Object)],Nt.prototype,"getDocFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("folders",{namespace:"documents"}),folderTreevue_type_script_lang_js_metadata("design:type",Array)],Nt.prototype,"docFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("folders",{namespace:jt}),folderTreevue_type_script_lang_js_metadata("design:type",Array)],Nt.prototype,"msgFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("folders",{namespace:"reports"}),folderTreevue_type_script_lang_js_metadata("design:type",Array)],Nt.prototype,"reportFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("folders",{namespace:"kanban"}),folderTreevue_type_script_lang_js_metadata("design:type",Array)],Nt.prototype,"boards",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("archiveDocFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Array)],Nt.prototype,"archiveDocFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("archiveInstrFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Array)],Nt.prototype,"archiveInstrFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("favouriteFolder"),folderTreevue_type_script_lang_js_metadata("design:type",Object)],Nt.prototype,"favouriteFolder",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("folderStat",{namespace:jt}),folderTreevue_type_script_lang_js_metadata("design:type",Object)],Nt.prototype,"folderStat",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("folders",{namespace:"settings"}),folderTreevue_type_script_lang_js_metadata("design:type",Array)],Nt.prototype,"settingFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.ZM)("folders",{namespace:"vocabulary"}),folderTreevue_type_script_lang_js_metadata("design:type",Array)],Nt.prototype,"vocFolders",void 0),folderTreevue_type_script_lang_js_decorate([(0,at.mm)("SET_FAV_FOLDER"),folderTreevue_type_script_lang_js_metadata("design:type",Function)],Nt.prototype,"SET_FAV_FOLDER",void 0),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("msgFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onMsgFoldersChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("userSettings.useGroupJournalsByDepartments"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onUserSettingsChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("docFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onDocFoldersChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("reportFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onReportFoldersChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("boards"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onKanbanBoardsChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("archiveInstrFolders"),(0,rt.Watch)("archiveDocFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onArchiveFoldersChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("favouriteFolder"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onAddOrDeleteFromFavourite",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("settingFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onSettingFoldersChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("vocFolders"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onVocFoldersChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("tempSection"),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[String,String]),folderTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Nt.prototype,"onTempSectionChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("section",{immediate:!0}),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[String,String,Boolean]),folderTreevue_type_script_lang_js_metadata("design:returntype",Promise)],Nt.prototype,"onSectionChanged",null),folderTreevue_type_script_lang_js_decorate([(0,rt.Watch)("folderId",{immediate:!0}),folderTreevue_type_script_lang_js_metadata("design:type",Function),folderTreevue_type_script_lang_js_metadata("design:paramtypes",[String,String]),folderTreevue_type_script_lang_js_metadata("design:returntype",Promise)],Nt.prototype,"onFolderIdChanged",null),Nt=folderTreevue_type_script_lang_js_decorate([(0,rt.Component)({components:{"tree-view":Ft.L}})],Nt);const Vt=Nt,Bt=Vt;var Lt=(0,Ct.Z)(Bt,folderTreevue_type_template_id_0e6a1246_scoped_true_render,It,!1,null,"0e6a1246",null);const Ut=Lt.exports;var Ht=n(8756),Qt=n(59976),modalContainervue_type_template_id_7595c30d_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isMobile?[n("div",e._l(e.modals,(function(t){return n("div",{key:t.id},[n("v-dialog",{attrs:{fullscreen:!e.isNotification(t),"full-width":"",transition:"dialog-bottom-transition",persistent:"","hide-header-close":!t.closable,"hide-overlay":t.noModal,"no-click-animation":t.noModal,"retain-focus":t.retainFocus},on:{hide:function(n){return e.handleHide(t)},keydown:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.handleConfirm(t)},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"esc",27,n.key,["Esc","Escape"])?null:e.handleCancel(t)}]},model:{value:t.show,callback:function(n){e.$set(t,"show",n)},expression:"modal.show"}},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:t.loading}}),e._v(" "),n("v-card",{staticClass:"mobile-card",class:{"not-select-dialog":e.isNotification(t)}},[n("v-toolbar",{staticClass:"modal-header",attrs:{dark:""}},[n("v-toolbar-title",{staticClass:"font-weight-bold"},[e._v(" "+e._s(e.modalTitle(t))+" ")]),e._v(" "),n("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(n){return e.handleCancel(t)}}},[n("v-icon",[e._v("close")])],1)],1),e._v(" "),n("div",{staticClass:"mobile-container"},[t.content&&!e.isPromptDialog(t)?n("v-card-text",{staticClass:"content text-content",domProps:{innerHTML:e._s(t.content)}}):e.isPromptDialog(t)?n("v-card-text",{staticClass:"content"},[n("v-textarea",{staticClass:"small-input body-1 font-weight-light my-0",attrs:{flat:"",solo:"","single-line":"",outlined:"",rows:"3"},model:{value:e.promptInput,callback:function(t){e.promptInput=t},expression:"promptInput"}})],1):t.component&&t.data?n("v-card-text",[e.isInfoDialog(t)?n(t.component,e._b({tag:"component",on:{"set-result":function(n){return e.onSetResult(t,n)},"external-component-created":function(n){return e.onComponentInstanceCreated(t,n)},"external-component-loading":function(e){t.loading=e}}},"component",t.data.props||t.data.anyData,!1)):e.isCreateEditDialog(t)?n(t.component,e._b({tag:"component",on:{"set-result":function(n){return e.onSetResult(t,n)},"external-component-created":function(n){return e.onComponentInstanceCreated(t,n)},"external-component-loading":function(e){t.loading=e}}},"component",t.data.props,!1)):e.isSelectDialog(t)?n(t.component,e._b({tag:"component",attrs:{data:t.data.model||t.data.lists,"is-tree":t.data.isTree,disabled:t.data.disabledItems,selected:t.data.selectedItems,"any-data":t.data.anyData,multiselect:t.data.multiselect},on:{"external-component-created":function(n){return e.onComponentInstanceCreated(t,n)},"external-component-loading":function(e){t.loading=e},"set-result":function(n){return e.onSetResult(t,n)},"set-result-and-close":function(n){return e.onSetResultAndClose(t,n)}}},"component",t.data.props,!1)):e._e()],1):e._e()],1),e._v(" "),t.hideFooter?e._e():n("v-card-actions",{staticClass:"pt-0",staticStyle:{"justify-content":"center"}},[n("v-btn",{staticClass:"small-button rounded-button elevation-0",attrs:{disabled:t.okDisabled,loading:t.okLoading,color:"primary"},nativeOn:{click:function(n){return e.handleOk(t)}}},[e._v(e._s(e.okButtonText(t))+"\n          ")]),e._v(" "),e.isAlertDialog(t)||e.isInfoDialog(t)?e._e():n("v-btn",{staticClass:"small-button rounded-button",attrs:{disabled:t.okOnly||t.okLoading,outlined:"",color:"primary"},nativeOn:{click:function(n){return e.handleCancel(t)}}},[n("translate",[e._v("Отмена")])],1)],1)],1)],1)],1)})),0)]:e.isMobile?e._e():[n("div",{staticStyle:{height:"100%"}},[n("minimized-dialogs",{staticClass:"minimized-dialogs",attrs:{dialogs:e.minimized},on:{maximize:function(t){return e.onMinimize(t)},close:function(t){return e.handleCancel(t)},"close-all":e.onCloseAll}}),e._v(" "),e._l(e.modals,(function(t){return n("div",{key:t.id},[n("v-dialog",{attrs:{"content-class":e.modalClass(t),width:e.modalWidth(t),persistent:"","hide-header-close":!t.closable,"hide-overlay":t.noModal,"no-click-animation":t.noModal,"retain-focus":t.retainFocus},on:{hide:function(n){return e.handleHide(t)},keydown:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.handleConfirm(t)},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"esc",27,n.key,["Esc","Escape"])?null:e.handleCancel(t)}]},model:{value:t.show,callback:function(n){e.$set(t,"show",n)},expression:"modal.show"}},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:t.loading}}),e._v(" "),n("v-card",{staticClass:"card",class:[{"promt-card":!e.isSelectDialog(t)&&!e.isCreateEditDialog(t)},e.cardClass(t)]},[n("v-card-title",{staticClass:"modal-title body-2 font-weight-bold pb-0",class:e.titleCssClasses(t)},[n("span",[e._v(e._s(t.title))]),e._v(" "),n("v-spacer"),e._v(" "),t.minimizable?n("v-icon",{staticClass:"ml-1",class:{"grey--text lighten-8":t.darkTitle},staticStyle:{cursor:"pointer"},attrs:{icon:"",size:"18"},nativeOn:{click:function(n){return e.onMinimize(t)}}},[e._v("\n                minimize\n              ")]):e._e(),e._v(" "),e.isExpanded(t)?n("v-icon",{staticClass:"ml-1",class:{"grey--text lighten-8":t.darkTitle},staticStyle:{cursor:"pointer"},attrs:{icon:"",size:"18"},nativeOn:{click:function(n){return e.onExpandCollapse(t)}}},[e._v("\n                close_fullscreen\n              ")]):e._e(),e._v(" "),e.isCollapsed(t)?n("v-icon",{staticClass:"ml-1",class:{"grey--text lighten-8":t.darkTitle},staticStyle:{cursor:"pointer"},attrs:{icon:"",size:"18"},nativeOn:{click:function(n){return e.onExpandCollapse(t)}}},[e._v("\n                open_in_full\n              ")]):e._e(),e._v(" "),t.closable||e.isInfoDialog(t)?n("v-icon",{staticClass:"ml-1",class:{"grey--text lighten-8":t.darkTitle},staticStyle:{cursor:"pointer"},attrs:{icon:"",size:"20"},nativeOn:{click:function(n){return e.handleCancel(t)}}},[e._v("\n                close\n              ")]):e._e()],1),e._v(" "),t.content&&!e.isPromptDialog(t)?n("v-card-text",{staticClass:"content body-1 text-content",domProps:{innerHTML:e._s(t.content)}}):e.isPromptDialog(t)?n("v-card-text",{staticClass:"content"},[n("v-textarea",{staticClass:"small-input body-1 font-weight-light my-0",attrs:{text:"",solo:"","single-line":"",outlined:"",rows:"3"},model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"modal.content"}})],1):t.component&&t.data?n("v-card-text",{staticClass:"content",style:"visibility: "+e.visibility},[e.isInfoDialog(t)?n(t.component,e._b({tag:"component",on:{"set-result":function(n){return e.onSetResult(t,n)},"external-component-created":function(n){return e.onComponentInstanceCreated(t,n)},"external-component-loading":function(e){t.loading=e}}},"component",t.data.props||t.data.anyData,!1)):e.isCreateEditDialog(t)?n(t.component,e._b({tag:"component",on:{cancel:function(n){return e.handleCancel(t)},"set-result":function(n){return e.onSetResult(t,n)},"dialog:activate":function(n){return e.onDlgActivate(t)},"dialog:processing":function(n){return e.onProcessing(t,n)},"external-component-created":function(n){return e.onComponentInstanceCreated(t,n)},"external-component-loading":function(e){t.loading=e}}},"component",t.data.props,!1)):e.isSelectDialog(t)?n(t.component,e._b({tag:"component",attrs:{data:t.data.model||t.data.lists,"is-tree":t.data.isTree,disabled:t.data.disabledItems,selected:t.data.selectedItems,"any-data":t.data.anyData,multiselect:t.data.multiselect},on:{"external-component-created":function(n){return e.onComponentInstanceCreated(t,n)},"external-component-loading":function(e){t.loading=e},"set-result":function(n){return e.onSetResult(t,n)},"set-result-and-close":function(n){return e.onSetResultAndClose(t,n)}}},"component",t.data.props,!1)):e._e()],1):e._e(),e._v(" "),t.hideFooter?e._e():n("v-card-actions",{staticClass:"pt-0 footer",class:{footerBtnEnd:e.isSelectDialog(t)},staticStyle:{"justify-content":"center"}},[n("v-btn",{staticClass:"small-button rounded-button elevation-0",attrs:{id:"modalOk",disabled:t.okDisabled,loading:t.okLoading,color:"primary"},nativeOn:{click:function(n){return e.handleOk(t)}}},[e._v(e._s(e.okButtonText(t))+"\n              ")]),e._v(" "),e.isAlertDialog(t)||e.isInfoDialog(t)?e._e():n("v-btn",{staticClass:"small-button rounded-button",attrs:{id:"modalCancel",disabled:t.okOnly||t.okLoading,outlined:"",color:"primary"},nativeOn:{click:function(n){return e.handleCancel(t)}}},[e._v("\n                "+e._s(e.cancelButtonText(t))+"\n              ")])],1)],1)],1)],1)}))],2)]],2)},zt=[],Zt=n(20386),Wt=n(17996),qt=n(38775),Gt=n(56556),modalContainervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},modalContainervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},modalContainervue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Kt=class ModalContainerComponent extends rt.Vue{constructor(){super(...arguments),this.modals=[],this.minimized=[],this.counter=1,this.modalResult=null,this.visibility="visible"}created(){this.dialogManager.setMinimized(this.minimized)}mounted(){this.$nextTick((()=>{Je.X.$on("dialog:set-data",this.set),Je.X.$on("dialog:open",this.open)})),Je.X.$on("dialog:close:all",this.closeAll)}beforeDestroy(){Je.X.$off("dialog:set-data",this.set),Je.X.$off("dialog:open",this.open),Je.X.$off("dialog:close:all",this.closeAll)}open(e){var t,n;if(e.hostObject){const t=this.modals.find((t=>{var n,i,o;return(null===(n=t.hostObject)||void 0===n?void 0:n.id)===e.hostObject.id&&(null===(i=t.hostObject)||void 0===i?void 0:i.contentType)===e.hostObject.contentType&&(null===(o=t.hostObject)||void 0===o?void 0:o.kind)===e.hostObject.kind}));if(t)return void this.dialogManager.activate(t)}const i={id:this.counter++,hostObject:e.hostObject,noModal:e.noModal,size:e.size?e.size:"sm",type:e.type,title:e.title,description:e.description,darkTitle:e.darkTitle,content:e.content,resolveFunction:e.resolveFunction,okOnly:e.type===Wt.w.Alert||e.type===Wt.w.Notification||e.type===Wt.w.Info,show:!0,loading:e.twoStepOpen,okLoading:!1,okDisabled:e.type===Wt.w.Select,selectAsOk:e.selectAsOk,hideFooter:"hideFooter"in e?e.hideFooter:"selectAsOk"in e&&e.selectAsOk,resolved:!1,width:e.width,height:e.height,fullHeight:e.fullHeight,closable:!("closable"in e)||e.closable,expandable:e.expandable,minimizable:e.minimizable,minimized:!1,expandedSize:e.expandedSize,collapsedSize:e.collapsedSize,isChanged:e.isChanged,retainFocus:!1};if(i.expandable)if(i.expanded=this.$config.isExpandedCreateEditFormPriority,i.expandedSize||i.collapsedSize)if(i.expandedSize&&!i.collapsedSize){const{height:e,width:t}=i.expandedSize;i.noModal=i.expandedSize.noModal,i.collapsedSize={width:this.changeValue(t,!1),height:this.changeValue(e,!1)}}else if(!i.expandedSize&&i.collapsedSize){const{height:e,width:t}=i.collapsedSize;i.noModal=i.collapsedSize.noModal,i.expandedSize={width:this.changeValue(t,!0),height:this.changeValue(e,!0)}}else i.noModal=!i.expanded;else{const e=null!==(t=i.width)&&void 0!==t?t:"80%",o=null!==(n=i.height)&&void 0!==n?n:e;i.expandedSize={width:e,height:o};const s=this.changeValue(e,!1),r=this.changeValue(o,!1);i.collapsedSize={width:s,height:r},i.noModal=!1}this.modals.push(i),e.twoStepOpen&&e.resolveFunction(i.id);const o=setInterval((()=>{const e=document.querySelector(`.${this.uniqKey(i)}`);e&&(clearInterval(o),i.el=e,this.dialogManager.dialogCreated(i))}),100)}set(e,t){const n=this.modals.find((t=>t.id===e));n&&(n.data=t,n.resolveFunction=t.resolveFunction,n.component=t.component,n.loading=!1)}handleConfirm(e){e.type===Wt.w.Confirm&&this.handleOk(e)}handleOk(e,t){let n=!0;try{if(this.$log.debug("handleOk"),e.type===Wt.w.Prompt){const t=e.content;return e.resolveFunction(t)}if(!t&&e.type===Wt.w.CreateEdit&&e.componentInstance&&e.componentInstance.save){n=!1,e.okLoading=!0;const t=e.componentInstance.save.call(e.componentInstance);return void(t instanceof Promise?t.catch((e=>this.$log.error(e))).finally((()=>{e.okLoading=!1})):e.okLoading=!1)}if(e.show=!1,e.type!==Wt.w.Select&&e.type!==Wt.w.CreateEdit)return e.resolveFunction(!0);const i={button:Wt.m.Ok,data:this.modalResult};this.modalResult=null,e.resolveFunction(i)}finally{n&&this.remove(e),Je.X.$emit("modal-ok")}}handleCancel(e){var t;return modalContainervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{if(this.$log.debug("handleCancel"),[Wt.w.CreateEdit].includes(e.type)){let n=!1,i=this.$gettext("Вы уверены, что хотите закрыть окно?");if("function"===typeof e.isChanged)n=!e.isChanged();else{const e=new Event("beforeunload");e.modal=!0,window.dispatchEvent(e),n=!("canUnload"in e)||e.canUnload,i=null!==(t=e.dialogText)&&void 0!==t?t:i}if(!n){const e=yield this.queryBus.exec(new Zt.l(this.$gettext("Подтверждение"),i));if(!e)return}}if(e.show=!1,e.type!==Wt.w.Select)return e.resolveFunction(!1);const n={button:Wt.m.Cancel,data:this.modalResult};this.modalResult=null,e.resolveFunction(n)}finally{e.show||(this.remove(e),Je.X.$emit("modal-cancel"))}}))}handleHide(e){this.$log.debug("handleHide"),e.resolved||this.handleOk(e)}onProcessing(e,t){t&&(e.processingDescription=t),this.dialogManager.dialogProcessing(e)}onDlgActivate(e){e.processingDescription=null,this.dialogManager.activate(e)}onSetResult(e,t){if(e.okLoading=!1,this.modalResult=t,t){if(e.selectAsOk)return e.show=!1,this.handleOk(e,t);Array.isArray(t)?e.okDisabled=0===t.length:e.okDisabled=!1}else e.okDisabled=!0}onSetResultAndClose(e,t){if(this.modalResult=t,t)return e.show=!1,this.handleOk(e,t);e.okDisabled=!0}onExpandCollapse(e){this.visibility="hidden",window.requestAnimationFrame((()=>{var t,n;e.expanded=!e.expanded;const i=e.noModal;e.expanded?e.noModal=null!==(n=e.expandedSize.noModal)&&void 0!==n&&n:e.noModal=null!==(t=e.collapsedSize.noModal)&&void 0!==t&&t,window.requestAnimationFrame((()=>{e.noModal!==i&&this.dialogManager.dialogModalChanged(e),setTimeout((()=>{this.visibility="visible"}),600)}))}))}onMinimize(e){e.minimized=!e.minimized,this.dialogManager.dialogMinimizeChanged(e)}remove(e){e.resolved=!0,this.$nextTick((()=>{const t=this.modals.indexOf(e);t>-1&&(this.modals.splice(t,1),this.dialogManager.dialogClosed(e))}))}modalClass(e){let t=e.width?"":"modal";return e.fullHeight&&(t+=" height-full"),t+=` ${this.uniqKey(e)} ${Wt.w[e.type]}`,t}modalWidth(e){var t,n;return this.$nextTick((()=>{(e.expandable||e.height)&&(e.el||(e.el=document.querySelector(`.${this.uniqKey(e)}`)),e.el&&(e.el.style.height=String(this.modalHeight(e)),e.el.style.borderRadius="8px 8px 0 0"))})),e.expandable?e.expanded?null===(t=e.expandedSize)||void 0===t?void 0:t.width:null===(n=e.collapsedSize)||void 0===n?void 0:n.width:e.width?e.width:"auto"}modalHeight(e){var t,n;return e.expandable?e.expanded?null===(t=e.expandedSize)||void 0===t?void 0:t.height:null===(n=e.collapsedSize)||void 0===n?void 0:n.height:e.height||null}cardClass(e){return e.component?"":"no-grid"}okButtonText(e){switch(e.type){case Wt.w.Select:return this.$gettext("Выбрать");case Wt.w.Confirm:return this.$gettext("Да");case Wt.w.Info:return this.$gettext("Закрыть");case Wt.w.CreateEdit:return this.$gettext("Сохранить");default:return this.$gettext("Ок")}}cancelButtonText(e){return e.type===Wt.w.Confirm?this.$gettext("Нет"):this.$gettext("Отменить")}onComponentInstanceCreated(e,t){e.componentInstance=t}isInfoDialog(e){return e.type===Wt.w.Info}isSelectDialog(e){return e.type===Wt.w.Select}isCreateEditDialog(e){return e.type===Wt.w.CreateEdit}isAlertDialog(e){return e.type===Wt.w.Alert}isPromptDialog(e){return e.type===Wt.w.Prompt}isConfirmDialog(e){return e.type===Wt.w.Confirm}isNotification(e){return this.isInfoDialog(e)||this.isAlertDialog(e)||this.isPromptDialog(e)||this.isConfirmDialog(e)}titleCssClasses(e){return e.darkTitle?"dark-title white-text":"black-text"}isExpanded(e){return!!e.expandable&&e.expanded}isCollapsed(e){return!!e.expandable&&!e.expanded}uniqKey(e){return`dlg-${e.id}`}modalTitle(e){return e.description?e.description:e.title}onCloseAll(){return modalContainervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.queryBus.exec(new Zt.l(this.$gettext("Подтверждение"),this.$gettext("Вами были внесены изменения. Вы уверены что хотите закрыть все окна?")));e&&this.closeAll(!0)}))}closeAll(e=!1){this.modals.forEach((t=>{!e&&t.noModal||this.remove(t)}))}changeValue(e,t){let n=0;if("string"===typeof e){if(n=Number.parseInt(e,10),Number.isNaN(n))return e}else n=e;const i=t?2*n:n/2;let o;return o="string"===typeof e?e.replace(String(n),String(i)):`${i}px`,o}};Kt.Name="ModalContainerComponent",modalContainervue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),modalContainervue_type_script_lang_js_metadata("design:type",Object)],Kt.prototype,"queryBus",void 0),modalContainervue_type_script_lang_js_decorate([(0,ot.t)(je.t.IOpenForm),modalContainervue_type_script_lang_js_metadata("design:type",qt.r)],Kt.prototype,"dialogManager",void 0),Kt=modalContainervue_type_script_lang_js_decorate([(0,rt.Component)({components:{"minimized-dialogs":Gt.Z}})],Kt);const Yt=Kt,Jt=Yt;var Xt=(0,Ct.Z)(Jt,modalContainervue_type_template_id_7595c30d_scoped_true_render,zt,!1,null,"7595c30d",null);const en=Xt.exports;_t()(Xt,{VBtn:g.Z,VCard:D.Z,VCardActions:R.h7,VCardText:R.ZB,VCardTitle:R.EB,VDialog:x.Z,VIcon:y.Z,VSpacer:me.Z,VTextarea:s.Z});var appvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},appvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},appvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const tn="Справочники";let nn=class AppComponent extends pt{constructor(){super(...arguments),this.deputyList=null,this.shownDeputies=[],this.deputyLoading=!1,this.historyMenuShow=!1,this.historyList=null,this.historyLoading=!1,this.showedNotification=[],this.viewPanel=null,this.wouldCloseViewPanel=0,this.errorText="",this.dashboard={menuItem:{id:Le.S.Dashboard,submenu:!1,transition:Pe.k.ToDashboard,state:Oe.Z.Dashboard},icon:"home",text:this.$gettext("Главная"),active:!1,home:!0},this.menuItems=[{menuItem:{id:Le.S.Messages,submenu:!0,activeSubItem:null,transition:Pe.k.ToMessages,state:Oe.Z.Messages},icon:"mail",text:this.$gettext("Сообщения"),active:!1},{menuItem:{id:Le.S.Documents,submenu:!0,activeSubItem:null,transition:Pe.k.ToDocuments,state:Oe.Z.Documents},icon:"description",text:this.$gettext("Документы"),active:!1},{menuItem:{id:Le.S.Reports,submenu:!0,activeSubItem:null,transition:Pe.k.ToReports,state:Oe.Z.Reports},icon:"pie_chart",text:this.$gettext("Отчёты"),active:!1},{menuItem:{id:Le.S.History,transition:Pe.k.ToHistory,state:Oe.Z.History},icon:"watch_later",text:this.$gettext("История"),active:!1},{menuItem:{id:Le.S.Favorites,transition:Pe.k.ToFavorites,state:Oe.Z.Favorites},icon:"star",text:this.$gettext("Избранное"),active:!1},{menuItem:{id:Le.S.Archive,submenu:!0,transition:Pe.k.ToArchive,state:Oe.Z.Archive},icon:"archive",text:this.$gettext("Архив"),active:!1},{menuItem:{id:Le.S.Settings,submenu:!0,activeSubItem:null,transition:Pe.k.ToSettings,state:Oe.Z.Settings},icon:"settings",text:this.$gettext("Настройки"),active:!1},{menuItem:{id:Le.S.Search,transition:Pe.k.ToSearch,state:Oe.Z.Search},icon:"search",text:this.$gettext("Поиск по документам"),active:!1},{menuItem:{id:Le.S.Vocabularies,submenu:!0,activeSubItem:null,transition:Pe.k.ToVocabularies,state:Oe.Z.Vocabularies},icon:"class",text:this.$gettext(tn),active:!1},{menuItem:{id:Le.S.Kanban,submenu:!0,activeSubItem:null,transition:Pe.k.ToKanban,state:Oe.Z.Kanban},svg:"kanban",text:this.$gettext("Канбан"),active:!1}],this.searchTerms="",this.updatedSearchOptions=""}created(){var e,t;const n=this.$app.homeState;if(n!==Oe.Z.Dashboard){const e=this.menuItems.find((e=>e.menuItem.state===n));e?this.mainMenu.push(Object.assign(Object.assign({},e),{icon:this.dashboard.icon,text:this.dashboard.text,home:!0})):this.dashboard&&this.mainMenu.push(this.dashboard)}else this.dashboard&&this.mainMenu.push(this.dashboard);const i=this.$config.sections;Array.isArray(i)&&i.length?i.forEach((e=>{const t=this.menuItems.find((t=>t.menuItem.id===e));t&&this.mainMenu.push(t)})):this.mainMenu.push(...this.menuItems),this.isAuthenticated&&this.queryBus.exec(new Qe.b),Je.X.$on("app-view-open",this.onOpenViewPanel),Je.X.$on("app-view-close",this.onCloseViewPanel),Je.X.$on("app-view-set-save",this.onSetSavePromise),(null===(e=this.userSettings)||void 0===e?void 0:e.getNotifications)&&(null===(t=this.userSettings)||void 0===t?void 0:t.getPushNotifications)&&this.statisticService.setDiffStatCallback(this.onDiffStat.bind(this))}beforeDestroy(){Je.X.$off("app-view-open",this.onOpenViewPanel),Je.X.$off("app-view-close",this.onCloseViewPanel),Je.X.$off("app-view-set-save",this.onSetSavePromise)}onUserNameMenuShowChanged(){return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.deputyLoading&&this.userNameMenuShow)try{this.currentUser&&!this.deputyList&&(this.deputyLoading=!0,this.deputyList=yield this.queryBus.exec(new Ze.MH(this.currentUser.id)),this.deputyList||(this.deputyList=[]),this.shownDeputies=this.deputyList.slice(0,9))}finally{this.deputyLoading=!1}}))}onHistoryMenuShowChanged(){return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.historyLoading&&this.historyMenuShow)try{this.historyLoading=!0,this.historyList=yield this.queryBus.exec(new Ze.Zo)}finally{this.historyLoading=!1}}))}onNotificationsChanged(){var e,t;if(!(null===(e=this.userSettings)||void 0===e?void 0:e.getNotifications)||!(null===(t=this.userSettings)||void 0===t?void 0:t.getPushNotifications))return;const n=this.getNotifications(Le.S.Messages);if(Array.isArray(n)&&n.length){this.showedNotification=[];const e=n[0];this.showedNotification.push({lastUpdate:e.lastUpdate,folderID:String(e.folderId),userID:String(e.userId)}),this.sendNotification("LanDocs: Веб-клиент",{body:"Вам поступило новое сообщение",dir:"auto",icon:"/assets/img/favicon.jpg"})}}onViewPanelChange(e,t){t&&t.callback&&t.callback()}onRouteChanged(e,t,n){this.onRouteChangedHandler(e,t,n)}showBlockedFiles(){return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.queryBus.exec(new Qe.b)}))}beforeLogout(){this.deputyList=null,this.shownDeputies=[],this.userNameMenuShow=!1}onDiffStat(e){Array.isArray(e)&&e.length&&this.sendNotification("LanDocs: Веб-клиент",{body:"Вам поступило новое сообщение",dir:"auto",icon:"/assets/img/favicon.jpg"})}onOpenViewPanel(e){this.loading=!0,this.viewPanel&&this.wouldCloseViewPanel++,setTimeout((()=>appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.viewPanel=e,this.errorText="";try{switch(e.contentType){case Ue.zc.Document:e.document||(yield this.queryBus.exec(new He.U_(Number(e.id),e.context.entityViewMode,Number(e.context.folderId))));break;case Ue.zc.Instruction:e.instructionInfo||(yield this.queryBus.exec(new Fe.oE(this.viewPanel.id,0)));break}}catch(e){e.response&&e.response.data?this.errorText=e.response.data:this.errorText=e.message}finally{this.loading=!1,Je.X.$emit("app-view-opened",e)}}))),100)}onCloseViewPanelClick(){this.onCloseViewPanel(this.viewPanel.forEntityId,this.viewPanel.contentType)}onSetSavePromise(e){this.viewPanel&&(this.viewPanel.saveData=e)}onCloseViewPanel(e,t){return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.viewPanel)return;this.viewPanel.callback&&this.viewPanel.callback();let n=!e;if(this.viewPanel.forEntityId.toString()===(null===e||void 0===e?void 0:e.toString())&&this.viewPanel.contentType===t&&(n=!0),n){if("function"===typeof this.viewPanel.saveData)try{yield this.viewPanel.saveData(!0)}catch(e){this.$log.error(e),n=!1}if(!n)return;this.$nextTick((()=>{this.doCloseViewPanel()}))}}))}doCloseViewPanel(){this.viewPanel&&(this.viewPanel=null,Je.X.$emit("app-view-closed"))}onOpenNewWindow(){var e;return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.viewPanel)return;let t=!0;if("function"===typeof this.viewPanel.saveData)try{yield this.viewPanel.saveData(!1)}catch(e){this.$log.error(e),t=!1}if(t)try{this.viewPanel.context.limitedMode=!1,this.viewPanel.contentType===Ue.zc.Instruction&&this.viewPanel.reportData?this.$app.goto(Pe.k.CreateReport,this.viewPanelActionContext,{id:String(null===(e=this.viewPanelInstructionInfo)||void 0===e?void 0:e.instruction.id),reportId:this.viewPanel.reportData.reportId?String(this.viewPanel.reportData.reportId):null,actionType:this.viewPanel.reportData.actionType,folderId:this.viewPanel.context.folderId,folderName:this.viewPanel.context.folderName}):this.viewPanel.contentType===Ue.zc.Document?this.$app.viewDoc(this.viewPanel.id,this.viewPanelActionContext,!0):this.viewPanel.contentType===Ue.zc.Instruction&&this.$app.viewMessage(this.viewPanel.id,this.viewPanelActionContext)}finally{this.onCloseViewPanelClick()}}))}onHistoryClick(e){switch(e.historyItemType){case Be.g.Instruction:this.$app.viewMessage(e.item.id,this.createContext(Ue.zc.Instruction));break;case Be.g.Document:this.$app.viewDoc(e.item.id,this.createContext(Ue.zc.Document));break;default:break}}searchDeputy(){return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e={disabledItems:[],selectedItems:[],searchable:!0,searchFields:["name","subtitle","subname"],lists:[{isTree:!1,items:this.deputyList}],multiselect:!1},t=new ze.F({title:this.$gettext("Найти сотрудника"),componentName:"select-items",componentProps:e,selectAsOk:!0}),n=yield this.queryBus.exec(t);n&&n[0]&&n[0].id&&this.onSetDeputyUser(n[0])}))}onDeputyExit(){const e={departmentId:this.currentUser.departmentID,id:this.currentUser.id,name:this.currentUser.name};this.onSetDeputyUser(e)}onSetDeputyUser(e){return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.$app.goHome(),yield this.commandBus.exec(new Ne.CF(e.id)),setTimeout((()=>window.location.reload(!0)),100)}catch(e){this.$log.error(e)}}))}isDocumentHistoryItem(e){return e.historyItemType===Be.g.Document}documentTitle(e){return ke.Z.getDocItemTitle(e.item)}onActionResult(e,t){return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if((null===e||void 0===e?void 0:e.type)===Te.uE.Completed&&this.viewPanel)try{yield this.queryBus.exec(new Fe.oE(this.viewPanel.id,0,!0))}catch(e){this.$log.error(e),this.onCloseViewPanelClick(),Je.X.$emit("app-entity-removed",this.viewPanel.id)}}))}onActionProcessing(e){this.loading=e}hasNewNotifications(e){if(![Le.S.Messages,Le.S.Archive].includes(e.menuItem.id))return!1;let t=[];const n=this.sectionFolders[e.menuItem.id];t=n?n.map((e=>String(e.id))):e.menuItem.id===Le.S.Archive?["2107","2109","2110"]:["1999","2103","2104"];const i=this.getNotifications(Le.S.Messages);let o=!1;return Array.isArray(i)&&i.length?o=i.some((e=>t.includes(String(e.folderId)))):this.$config.folderStatistic&&(o=Object.keys(this.folderStat).some((e=>t.includes(e)&&this.folderStat[Number(e)].unreadItems))),o}notificationClickHandler(){window.focus()}sendNotification(e,t){if("Notification"in window)if("granted"===Notification.permission){this.$log.debug("Права на уведомление есть");const n=new Notification(e,t);n.onclick=()=>{this.notificationClickHandler()}}else"denied"!==Notification.permission?(this.$log.debug("Прав на уведомление нет, запрашиваем"),Notification.requestPermission((n=>{if("granted"===n){const n=new Notification(e,t);n.onclick=()=>{this.notificationClickHandler()}}else this.$log.info("Вы запретили показывать уведомления")}))):this.$log.info("Вы запретили показывать уведомления ранее");else this.$log.info("Ваш браузер не поддерживает HTML Notifications, его необходимо обновить.")}newMessage(){this.$app.createMessage({context:this.createContext(Ue.zc.Instruction)})}newDocument(){this.$app.createDocument({context:this.createContext(Ue.zc.Document,!1)})}newKanbanBoard(){this.$app.createKanbanBoard({modalTitle:this.$gettext("Создание новой канбан-доски")})}onSearchClick(){this.hideDrawer(),this.updatedSearchOptions=this.searchTerms}onSearchEnter(){if(!this.searchTerms)return;const e=this.searchTerms;this.searchTerms="",this.$router.push({name:"search",query:{query:e}})}newMessageByDoc(){var e;return appvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let t;(this.activeDocumentId||this.previewDocumentId)&&(t=yield this.queryBus.exec(new He.U_(null!==(e=this.activeDocumentId)&&void 0!==e?e:this.previewDocumentId,Ue.dS.View))),this.$app.createMessage({context:this.createContext(Ue.zc.Instruction),baseDocument:t})}))}createContext(e,t=!0){var n,i,o,s;let r=null,a=0;t&&(r=this.activeItem&&this.activeItem.menuItem.activeSubItem?this.activeItem.menuItem.activeSubItem.name:"",a=this.activeItem&&this.activeItem.menuItem.activeSubItem?Number(this.activeItem.menuItem.activeSubItem.id):0);let l=(0,Ye.g)(this.$route);(null===(i=null===(n=this.activeItem)||void 0===n?void 0:n.menuItem)||void 0===i?void 0:i.id)!==Le.S.Messages&&e===Ue.zc.Instruction&&(a=1999,r="Входящая",l={path:`/${Le.S.Messages}/${a}`});const c=new Ye.O;return a&&r&&c.add({text:r,route:l}),{section:null===(s=null===(o=this.activeItem)||void 0===o?void 0:o.menuItem)||void 0===s?void 0:s.id,collectionViewMode:Ue.Ml.None,contentType:e,entityViewMode:Ue.dS.None,folderId:a,folderName:r,breadcrumbs:c}}get hasEditedFiles(){return this.listEditedFiles&&this.listEditedFiles.length>0}get isReportView(){return this.viewPanel&&this.viewPanel.contentType===Ue.zc.Instruction&&this.viewPanel.reportData&&Boolean(this.viewPanelInstructionInfo)}get isInstructionView(){return this.viewPanel&&this.viewPanel.contentType===Ue.zc.Instruction&&Boolean(this.viewPanelInstructionInfo)}get isDocumentView(){return this.viewPanel&&this.viewPanel.contentType===Ue.zc.Document&&Boolean(this.viewPanelDocument)}get isKanban(){return this.$app.state===Oe.Z.Kanban}get isSearchSection(){return this.$app.state===Oe.Z.Search}get isCanRunHelp(){return this.$config.enableHelp}get hasDeputies(){return this.deputyList.length>this.shownDeputies.length}get noHistory(){return!this.historyLoading&&(!this.historyList||!this.historyList.length)}get hasHistory(){return!this.historyLoading&&this.historyList&&Boolean(this.historyList.length)}get sectionTitle(){var e;let t="";const n=null!==(e=this.tempSection)&&void 0!==e?e:this.activeSection;if(!n)return"";switch(n){case Le.S.Messages:t=this.$gettext("Сообщения");break;case Le.S.Documents:t=this.$gettext("Документы");break;case Le.S.Reports:t=this.$gettext("Отчёты");break;case Le.S.Settings:t=this.$gettext("Настройки");break;case Le.S.Vocabularies:t=this.$gettext(tn);break;case Le.S.Kanban:t=this.$gettext("Канбан-доски");break;case Le.S.Archive:t=this.$gettext("Архив");break;default:t="";break}return t}get forceIsMobile(){return!!this.viewPanel&&this.leftPanelSize<=30}get forceIsTablet(){return!!this.viewPanel&&(this.leftPanelSize>30&&this.leftPanelSize<=70)}get viewPanelInstructionInfo(){return this.getInstruction(String(this.viewPanel.id),null)}get viewPanelDocument(){return this.getDocument(Number(this.viewPanel.id))}get viewPanelActionContext(){const e=this.viewPanel;switch(e.context.instructionInfo=null,e.context.document=null,e.context.entity=null,e.contentType){case Ue.zc.Document:e.context.document=[this.viewPanelDocument],e.context.entity=[this.viewPanelDocument];break;case Ue.zc.Instruction:e.context.instructionInfo=[this.viewPanelInstructionInfo],e.context.entity=[this.viewPanelInstructionInfo];break}return Object.assign({},this.viewPanel.context)}get isSearchSectionEnabled(){return this.$config.sections.includes("search")}};appvue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),appvue_type_script_lang_js_metadata("design:type",Object)],nn.prototype,"queryBus",void 0),appvue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),appvue_type_script_lang_js_metadata("design:type",Object)],nn.prototype,"commandBus",void 0),appvue_type_script_lang_js_decorate([(0,ot.t)(),appvue_type_script_lang_js_metadata("design:type",Me)],nn.prototype,"statisticService",void 0),appvue_type_script_lang_js_decorate([(0,Ge.O)("getNotifications"),appvue_type_script_lang_js_metadata("design:type",Object)],nn.prototype,"getNotifications",void 0),appvue_type_script_lang_js_decorate([FileGetter("listEditedFiles"),appvue_type_script_lang_js_metadata("design:type",Object)],nn.prototype,"listEditedFiles",void 0),appvue_type_script_lang_js_decorate([(0,Ke.Y)("getInstruction"),appvue_type_script_lang_js_metadata("design:type",Object)],nn.prototype,"getInstruction",void 0),appvue_type_script_lang_js_decorate([(0,We.k)("getDocument"),appvue_type_script_lang_js_metadata("design:type",Object)],nn.prototype,"getDocument",void 0),appvue_type_script_lang_js_decorate([(0,at.ZM)("folderStat",{namespace:"instructions"}),appvue_type_script_lang_js_metadata("design:type",Object)],nn.prototype,"folderStat",void 0),appvue_type_script_lang_js_decorate([(0,at.ZM)("notifications"),appvue_type_script_lang_js_metadata("design:type",Object)],nn.prototype,"notifications",void 0),appvue_type_script_lang_js_decorate([(0,at.ZM)("activeDocumentId"),appvue_type_script_lang_js_metadata("design:type",Number)],nn.prototype,"activeDocumentId",void 0),appvue_type_script_lang_js_decorate([(0,at.ZM)("previewDocumentId"),appvue_type_script_lang_js_metadata("design:type",Number)],nn.prototype,"previewDocumentId",void 0),appvue_type_script_lang_js_decorate([(0,rt.Watch)("userNameMenuShow"),appvue_type_script_lang_js_metadata("design:type",Function),appvue_type_script_lang_js_metadata("design:paramtypes",[]),appvue_type_script_lang_js_metadata("design:returntype",Promise)],nn.prototype,"onUserNameMenuShowChanged",null),appvue_type_script_lang_js_decorate([(0,rt.Watch)("historyMenuShow"),appvue_type_script_lang_js_metadata("design:type",Function),appvue_type_script_lang_js_metadata("design:paramtypes",[]),appvue_type_script_lang_js_metadata("design:returntype",Promise)],nn.prototype,"onHistoryMenuShowChanged",null),appvue_type_script_lang_js_decorate([(0,rt.Watch)("notifications",{deep:!0,immediate:!1}),appvue_type_script_lang_js_metadata("design:type",Function),appvue_type_script_lang_js_metadata("design:paramtypes",[]),appvue_type_script_lang_js_metadata("design:returntype",void 0)],nn.prototype,"onNotificationsChanged",null),appvue_type_script_lang_js_decorate([(0,rt.Watch)("viewPanel"),appvue_type_script_lang_js_metadata("design:type",Function),appvue_type_script_lang_js_metadata("design:paramtypes",[Object,Object]),appvue_type_script_lang_js_metadata("design:returntype",void 0)],nn.prototype,"onViewPanelChange",null),appvue_type_script_lang_js_decorate([(0,rt.Watch)("$route"),appvue_type_script_lang_js_metadata("design:type",Function),appvue_type_script_lang_js_metadata("design:paramtypes",[Object,Object,Boolean]),appvue_type_script_lang_js_metadata("design:returntype",void 0)],nn.prototype,"onRouteChanged",null),nn=appvue_type_script_lang_js_decorate([(0,rt.Component)({mixins:[ht.Z,mt.Z],components:{"folder-tree":Ut,"modal-container":en,"instruction-report":Ht.Z,"instruction-view":Qt.default,"dashboard-header":St}})],nn);const on=nn,sn=on;var rn=(0,Ct.Z)(sn,render,Re,!1,null,"5144d060",null);const an=rn.exports,ln=JSON.parse('{"defLang":"ru","displayVersionWatermark":true,"displayMainFile":false,"mainInstructionFeature":true,"mainInstructionFeatureCards":[],"nativeAppAddress":"http://localhost:9000/","nativeAppVersion":1.01,"apiPath":"/LanDocs.WebApi.NetCore/api/v1/","securityApiPath":"/LanDocs.Security.WebApi/api/v1/","freshDocApiPath":"http://195.26.187.212/LanDocs.FreshDoc.Api/","apiTimeout":60000,"enableEsign":true,"certificateSidPath":["2.5.29.17","1.2.643.1.12345.1"],"templatesLocation":"assets/templates/","videomostApiPath":"http://dsud-videomost.local/","defaultSection":"","sections":["dashboard","messages","kanban","documents","reports","vocabularies","archive","settings"],"enableHelp":false,"dashboardNewsFolderId":124394653,"microsoftCloud":{"enable":false,"appId":"38549c4a-f06d-4fdb-ba60-76392611c240","redirectUri":"http://localhost:3000/","scopes":["user.read","calendars.read","files.readwrite.all"]},"standardResolutionSource":"TYPERESOLUTION","esignReportToFile":false,"loginByCert":false,"defaultListView":"list","monitor":false,"cardDevelop":false,"folderStatistic":false,"enableCalendar":true,"enableR7":false,"canDropAllCache":false,"isExpandedCreateEditFormPriority":false,"fileStampsEnabled":false,"fileTemplatesEnabled":false}');var cn=n(20629),dn=n(72519),un=n(29256);class NoticeCloseCommand{constructor(e){this.id=e}}var pn=n(86418),hn=n(10637);class RunJob{constructor(e,t,n,i){this.workflowID=e,this.jobID=t,this.taskID=n,this.variables=i}}class CancelJob{constructor(e,t){this.jobID=e,this.reason=t}}var mn=n(68385),fn=n(80174),gn=n(43867),yn=n(51557);class AttachmentQuery{constructor(e,t){this.id=e,this.fromRemote=t}}var vn,bn=n(71354),Cn=n(58848),command_bus_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},command_bus_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},command_bus_param=function(e,t){return function(n,i){t(n,i,e)}};let wn=vn=class CommandBus{constructor(e,t,n){this._container=e,this._store=t,this._log=n}exec(e){return this._exec(e.constructor.name,e)}exec1(e,t){return this._exec(Symbol.keyFor(e),t)}_exec(e,t){const n=Reflect.getMetadata(e,vn);if(n)return this._store.dispatch(n,t);const i=this._container.get(e);if(i)return i.exec(t);this._log.error("Не найден обработчик для "+e)}};function Commandable(e,t,n=0,i={leading:!1,trailing:!0}){return(o,s,r)=>{const a=t?`${t}/${s}`:s;if(Reflect.defineMetadata(e.name,a,wn),n){const e=r.value;return r.value=(0,Cn.Z)(e,n,i),r}}}wn=vn=command_bus_decorate([(0,Ee.b2)(),command_bus_param(0,(0,Ee.f3)(je.t.Container)),command_bus_param(1,(0,Ee.f3)(je.t.Store)),command_bus_param(2,(0,Ee.f3)(je.t.ILogger)),command_bus_metadata("design:paramtypes",[Ee.W2,cn.yh,Object])],wn);var _n=n(9669),xn=n.n(_n),utils_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};function toActionTree(e){const t=Object.getOwnPropertyNames(Object.getPrototypeOf(e)),n={};return t.forEach((t=>{"constructor"!==t&&(n[t]=e[t])})),n}function toDict(e){const t=Object.keys(e).concat(Object.getOwnPropertyNames(Object.getPrototypeOf(e))),n={};return t.forEach((t=>{"constructor"!==t&&(n[t]=e[t])})),n}function promisifyFetch1(e,t,n,i,o,s){return utils_awaiter(this,void 0,void 0,(function*(){let r;if(n&&e[t][n]?r=e[t][n]:!n&&e[t]&&(r=e[t]),r instanceof Promise)try{r=yield r}catch(e){throw console.error(e),e}if(!i.fromRemote&&r)return r;const a=new Promise(((e,t)=>utils_awaiter(this,void 0,void 0,(function*(){try{r=yield o();let t=null;s&&(t=s(r)),e(t||r)}catch(e){t(e)}}))));return n?e[t][n]=a:e[t]=a,a}))}function promisifyFetch2(e,t,n,i,o){return utils_awaiter(this,void 0,void 0,(function*(){let s=n();if(s instanceof Promise)try{s=yield s}catch(e){throw console.error(e),e}if(!e.fromRemote&&s)return s;const r=new Promise(((e,t)=>{i().then((t=>{let n=null;return"data"in t&&(t=t.data),o&&(n=o(t)),e(n||t),t})).catch((e=>t(e)))}));return t(r),r.catch((e=>(t(null),null))),r}))}var Sn=n(87048);class TemplateGeneratorError extends Error{constructor(e,t){super(e),this.name=t,Object.setPrototypeOf(this,new.target.prototype)}}class UnknownComponentTypeError extends TemplateGeneratorError{constructor(e){super(e,UnknownComponentTypeError.name)}}class ComponentFactory{createComponent(e,t){switch(e){case Sn.A.Empty:return new EmptyComponent(t);case Sn.A.Root:return new RootComponent(t);case Sn.A.Column:return new ColumnComponent(t);case Sn.A.Custom:return new CustomComponent(t);case Sn.A.Field:return new FieldComponent(t);case Sn.A.FieldGroup:return new FieldGroupComponent(t);case Sn.A.Icon:return new IconComponent(t);case Sn.A.Chip:return new ChipComponent(t);case Sn.A.Row:return new RowComponent(t);case Sn.A.Section:return new SectionComponent(t);case Sn.A.Tab:return new TabComponent(t);case Sn.A.TabList:return new TabListComponent(t);case Sn.A.Block:return new BlockComponent(t);default:throw new UnknownComponentTypeError(String(e))}}}class BaseComponent{constructor(e){this.options=e}}const template=(e,...t)=>new GeneratorResult(e,t),column=({attributes:e},t)=>template`
  <div class="tg-column" ${e.toHtml()}>${t.getTemplate()}</div>
`,field=({component:e,text:t,label:n,required:i,attributes:o},s)=>template`
  <div class="tg-field">
    ${n&&`\n    <div class="tg-field-col col-label" title="${n}">\n      <span class="tg-field-label font-weight-bold sm-text">${n}</span><i v-if="${i}" class="tg-field-required">*</i>\n    </div>`}
    <div class="tg-field-col col-field">
      ${s?s.getTemplate():template`<${e} ${o.toHtml()}>${t}</${e}>`}
    </div>
  </div>
`,root=(e,t)=>template`
  <div class="tg-root">${t.getTemplate()}</div>
`,row=({attributes:e},t)=>template`
  <div class="tg-row" ${e.toHtml()}>${t.getTemplate()}</div>
`,section=({title:e,divider:t,attributes:n},i)=>template`
  <div class="tg-section" ${n.toHtml()}>
    ${e&&`<h4 class="tg-section-title body-2 font-weight-bold">${e}</h4>`}
    ${i.getTemplate()}
    ${t&&'<hr class="tg-section-divider" />'}
  </div>
`,tab=({attributes:e},t)=>template`
  <ld-tab ${e.toHtml()}>${t.getTemplate()}</ld-tab>
`,icon=({icon:e,attributes:t})=>template`<v-icon ${t.toHtml()}>${e}</v-icon>`,empty=()=>template`<!-- -->`,customComponent=({name:e,attributes:t})=>template`${e?template`<${e} ${t.toHtml()}></${e}>`:empty()}`,block=({code:e,attributes:t})=>template`<${e} ${t.toHtml()}/>`,tabList=({attributes:e,isWizard:t},n)=>template`
  ${t?template`<ld-wizard-tabs ${e.toHtml()}>${n.getTemplate()}</ld-wizard-tabs>`:template`<ld-tabs ${e.toHtml()}>${n.getTemplate()}</ld-tabs>`}
`,chip=({text:e,attributes:t})=>template`<v-chip ${t.toHtml()}>${e}</v-chip>`;class AbstractGenerator{generateColumn(e,t){return column(e,t)}generateIcon(e){return icon(e)}generateChip(e){return chip(e)}generateCustomComponent(e){return customComponent(e)}generateField(e){return field(e)}generateBlock(e){return block(e)}generateEmpty(e){return empty()}generateFieldGroup(e,t){return field(e,t)}generateRoot(e,t){return root(e,t)}generateRow(e,t){return row(e,t)}generateSection(e,t){return section(e,t)}generateTab(e,t){return tab(e,t)}generateTabList(e,t){return tabList(e,t)}}class GeneratorCreateStrategy extends AbstractGenerator{}class GeneratorEditStrategy extends AbstractGenerator{}class GeneratorViewStrategy extends AbstractGenerator{}class Generator{}Generator.create=e=>{switch(e){case Sn.e.Create:return new GeneratorCreateStrategy;case Sn.e.Edit:return new GeneratorEditStrategy;case Sn.e.View:default:return new GeneratorViewStrategy}};class GeneratorResult{constructor(e,t){this.strings=e,this.values=t}getTemplate(){return this.strings.reduce(((e,t,n)=>`${e}${t}${GeneratorResult.getTemplateValue(this.values[n])}`),"")}}GeneratorResult.getTemplateValue=e=>e instanceof GeneratorResult?e.getTemplate():!1===e?"":null!==e&&void 0!==e?e:"";class GeneratorResultCollection{constructor(e=[]){this.results=e}getTemplate(){return this.results.map((e=>e.getTemplate())).join("")}}class CompositeComponent extends BaseComponent{constructor(){super(...arguments),this.components=[]}children(e){return new GeneratorResultCollection(this.components.map((t=>t.getResult(e))))}addChild(e){this.components=[...this.components,e]}}class OptionBadValueError extends TemplateGeneratorError{constructor(e){super(e,OptionBadValueError.name)}}class Attributes{constructor(e={}){if(this.attributes=e,String(this.attributes)!==String({}))throw new OptionBadValueError(`${Attributes.name}: ${this.attributes}`)}toHtml(){return Object.keys(this.attributes).reduce(((e,t)=>`${e} ${t}="${Attributes.getEncodedAttribute(this.attributes[t])}"`),"").substr(1)}}Attributes.ENCODE_QUOTE="&quot;",Attributes.getEncodedAttribute=e=>"object"===typeof e?JSON.stringify(e).replace(/"/g,Attributes.ENCODE_QUOTE):e;class AbstractData{constructor(e){this.options=e}get attributes(){return new Attributes(this.options.getOptionBy(AbstractData.OPTION_ATTRIBUTES))}}AbstractData.OPTION_ATTRIBUTES="attributes";class BaseData extends AbstractData{}class FieldGroupData extends AbstractData{get label(){return this.options.getOptionBy(FieldGroupData.OPTION_LABEL)}get required(){return this.options.getOptionBy(FieldGroupData.OPTION_REQUIRED)}}FieldGroupData.OPTION_LABEL="label",FieldGroupData.OPTION_REQUIRED="required";class FieldData extends FieldGroupData{get component(){const e=this.options.getOptionBy(FieldData.OPTION_COMPONENT);if("string"===typeof e&&e.length>0)return e;throw new OptionBadValueError(`${FieldData.OPTION_COMPONENT}: ${e}`)}get text(){return this.options.getOptionBy(FieldData.OPTION_TEXT)}}FieldData.OPTION_COMPONENT="component",FieldData.OPTION_TEXT="text";class SectionData extends AbstractData{get divider(){return this.options.getOptionBy(SectionData.OPTION_DIVIDER)}get title(){return this.options.getOptionBy(SectionData.OPTION_TITLE)}}SectionData.OPTION_DIVIDER="divider",SectionData.OPTION_TITLE="title";class IconData extends AbstractData{get icon(){return this.options.getOptionBy(IconData.OPTION_ICON)}}IconData.OPTION_ICON="icon";class CustomComponentData extends AbstractData{get name(){return this.options.getOptionBy(CustomComponentData.OPTION_NAME)}}CustomComponentData.OPTION_NAME="name";class TabListData extends AbstractData{get isWizard(){return this.options.getOptionBy(TabListData.OPTION_IS_WIZARD)}}TabListData.OPTION_IS_WIZARD="isWizard";class BlockData extends AbstractData{get code(){return this.options.getOptionBy(BlockData.OPTION_CODE)}}BlockData.OPTION_CODE="code";class ColumnComponent extends CompositeComponent{getResult(e){return e.generateColumn(new BaseData(this.options),this.children(e))}}class FieldComponent extends BaseComponent{getResult(e){return e.generateField(new FieldData(this.options))}}class FieldGroupComponent extends CompositeComponent{getResult(e){return e.generateFieldGroup(new FieldGroupData(this.options),this.children(e))}}class RootComponent extends CompositeComponent{getResult(e){return e.generateRoot(new BaseData(this.options),this.children(e))}}class IconComponent extends BaseComponent{getResult(e){return e.generateIcon(new IconData(this.options))}}class CustomComponent extends BaseComponent{getResult(e){return e.generateCustomComponent(new CustomComponentData(this.options))}}class RowComponent extends CompositeComponent{getResult(e){return e.generateRow(new BaseData(this.options),this.children(e))}}class SectionComponent extends CompositeComponent{getResult(e){return e.generateSection(new SectionData(this.options),this.children(e))}}class TabComponent extends CompositeComponent{getResult(e){return e.generateTab(new BaseData(this.options),this.children(e))}}class TabListComponent extends CompositeComponent{getResult(e){return e.generateTabList(new TabListData(this.options),this.children(e))}}class BlockComponent extends BaseComponent{getResult(e){return e.generateBlock(new BlockData(this.options))}}class EmptyComponent extends BaseComponent{getResult(e){return e.generateEmpty(new BaseData(this.options))}}class ChipData extends AbstractData{get text(){return this.options.getOptionBy(ChipData.OPTION_TEXT)}}ChipData.OPTION_TEXT="text";class ChipComponent extends BaseComponent{getResult(e){return e.generateChip(new ChipData(this.options))}}class ConfigBadValueError extends TemplateGeneratorError{constructor(e){super(e,ConfigBadValueError.name)}}class ChildrenConfig{constructor(e=[]){if(this.children=e,!(this.children instanceof Array))throw new ConfigBadValueError(`${ChildrenConfig.name}: ${this.children}`)}get items(){return this.children.map((e=>new RootConfig(e)))}}class AbstractConfig{constructor(e){if(this.config=e,!this.config||"object"!==typeof this.config)throw new ConfigBadValueError(`${new.target.name}: ${this.config}`)}}class OptionsConfig extends AbstractConfig{constructor(e={}){super(e)}getOptionBy(e){return this.config[e]}}class RootConfig extends AbstractConfig{get type(){return this.config.type}get options(){return new OptionsConfig(this.config.options)}get children(){return new ChildrenConfig(this.config.children)}}class InputConfig extends AbstractConfig{get cardType(){return this.config.cardType}get root(){return new RootConfig(this.config.template)}}class TreeMapper{constructor(e){this.factory=e}map({children:e,options:t,type:n},i){return this.createTree(e.items,i.addRoot(this.factory.createComponent(n,t))),i.getRoot()}createTree(e,t){e.forEach((({children:e,type:n,options:i})=>this.createTree(e.items,t.addChild(this.factory.createComponent(n,i)))))}}class TreeBuilder{constructor(e=null){this.root=e}getRoot(){return this.root}addRoot(e){return this.root=e,this}addChild(e){return this.root instanceof CompositeComponent&&this.root.addChild(e),new TreeBuilder(e)}}class Template{from(e){const{root:t,cardType:n}=new InputConfig(e),i=new TreeBuilder,o=new ComponentFactory,s=new TreeMapper(o),r=s.map(t,i),a=Generator.create(n),l=r.getResult(a);return l.getTemplate()}}function parseSFC(e){const t={};return["script","template","style"].forEach((n=>{t[n]=_parseTag(e,n)})),t}function _parseTag(e,t){const n=`<${t}[^>]*/?>`,i=new RegExp(n,"gmi");if(i.exec(e),i.lastIndex<=0)return"";const o=i.lastIndex+1,s=e.indexOf(`</${t}>`);return-1===s?"":e.substring(o,s).trim()}var In=n(80504),Dn=n.n(In),template_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Rn="assets/templates/";function loadAndParseComponent(e,t,n,i){return template_awaiter(this,void 0,void 0,(function*(){const o=getTemplateUrl(t.path,n),s=getPathToComponent(n,o);return promisifyFetch2(t,(e=>{i(s,e)}),(()=>{const t=e.templates[s];return t instanceof Promise||t&&t.template?t:null}),(()=>template_awaiter(this,void 0,void 0,(function*(){try{let i;if(e.extCompPatches&&(i=e.extCompPatches[s]),!i){const{data:e}=yield xn().get(o);i=e}return createSFC(t,n,i,e.extCompPatches).then((e=>e)).catch((e=>e))}catch(e){if(e&&e.response&&404===e.response.status)return{url:o,template:`<h3 class="mx-2">Шаблон для документа ${t.path} не найден</h3>`,raw:null};throw e}}))),(e=>{if(i)return i(s,e),e})).then((e=>e)).catch((e=>e))}))}function getPathToComponent(e,t){const n=getTemplatesLocation(e);let i=t.replace(n,"");return"/"!==i[0]&&"\\"!==i[0]||(i=i.substring(1,i.length)),i}function getTemplatesLocation(e){let t=e&&e.templatesLocation?e.templatesLocation:Rn;return t.endsWith("/")||(t+="/"),t}function getTemplateUrl(e,t){const n=getTemplatesLocation(t);/\.(html|vue|js)$/.test(e)||(e+=".html");let i=`${n}${e}`;return i}function createSFC(e,t,i,o,s=!1){return template_awaiter(this,void 0,void 0,(function*(){if(!i)return null;const r=Dn()(e.path),a=`data-ld-${r}`,l="ld-step",c="ld-include",d="ld-tab",u="ld-section",p=parseSFC(i);p.template||s||(p.template=i,p.script=null,p.style=null);const h={name:e.name,raw:i,template:p.template,url:getTemplateUrl(e.path,t)};if(h.template||(h.template=""),"object"===typeof h.template&&(h.template=(new Template).from(h.template)),h.template){h.template=h.template.replace(/(?=<!--)([\S\s]*?)-->/gm,"");const e=new DOMParser;let n;const i=new Promise(((e,t)=>{n=e})),s=/<(ld-step|ld-include)(.|\s)+?(\/>|<\/ld-step>|<\/ld-include>)/gi,r=h.template.match(s);if(r&&r.length)for(let i=0;i<r.length;i++){const s=r[i],a=e.parseFromString(s,"text/html");let d;if(s.includes(l)?d=a.getElementsByTagName(l)[0]:s.includes(c)&&(d=a.getElementsByTagName(c)[0]),d){let e=null,n="";if(d.hasAttributes()){const i=d.attributes;for(let s=0;s<i.length;s++){const r=i[s];if("src"===r.name){let n=r.value;const i=h.url.lastIndexOf("/");i>=0&&(n=`${h.url.substring(0,i)}/${r.value}`);try{if(o){const i=getPathToComponent(t,n);e=o[i]}if(!e){const t=yield xn().get(n);e=t.data}}catch(t){e=`<h3>Ошибка загрузки шаблона ${n}</h3>`}}else n=n?`${n} ${r.name}="${r.value}"`:`${r.name}="${r.value}"`}e&&(e=e.replace(/(?=<!--)([\S\s]*?)-->/gm,""),s.includes(l)?e=`<${l} ${n}>${e}</${l}>`:s.includes(c)&&(e=e.replace(">",` ${n}>`)))}e&&(h.template=h.template.replace(s,e))}i===r.length-1&&n(!0)}else n(!0);yield i;const p=e.parseFromString(h.template.trim(),"text/html"),m=p.body.childNodes[0],setScopeId=e=>{1===e.nodeType&&e.setAttribute(a,""),e.childNodes.forEach((e=>setScopeId(e)))};m&&(m.setAttribute(a,""),setScopeId(m));const f=p.getElementsByTagName(d);if(f&&f.length)for(let e=0;e<f.length;e++){const t=f[e],n=t.attributes.getNamedItem("index"),i=t.firstChild;if(i&&n){const e=p.createElement(u);e.innerText=`${u} ${n.value}`,e.style.display="none",e.setAttribute("index",n.value),t.insertBefore(e,i)}}h.template=p.body.innerHTML}if(p.script){h.script=p.script.replace("export default ","return ");try{h.script=new Function(`"use strict";${h.script}`)()}catch(e){h.script=null,console.error("createSFC: eval script error:",e)}}if("<"===p.style&&(p.style=""),p.style){const{compileStyle:e}=yield Promise.all([n.e(8479),n.e(5131)]).then(n.bind(n,65131)),{code:t,map:i,errors:o}=e({source:p.style,filename:null,id:a,map:!1,scoped:!0,trim:!0});h.style=t||null,(o&&o.length||i)&&console.error("fetchTemplate style:",o,p.style)}return h}))}var manifest_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};function loadManifest(e,t,n,i,o){return manifest_awaiter(this,void 0,void 0,(function*(){let s=e.manifest["0"];if(!s)throw new Error("The main manifest is not found");if(s instanceof Promise&&(s=yield s),!s[i])return null;const r=s[i][t.id];let a=e.manifest[t.id];if(a instanceof Promise)try{a=yield a}catch(e){a=null}if(void 0===a&&"messages"!==i)try{a=yield promisifyFetch2(t,(n=>{e.manifest[t.id]=n}),(()=>e.manifest[t.id]),(()=>{let e=getTemplatesLocation(n);return e+=i&&"cards"!==i?`${i}/${t.id}/manifest.json`:`${t.id}/manifest.json`,xn().get(e)}),o)}catch(e){a=null}return a||r}))}function loadMainManifest(e,t,n,i,o,s,r){return manifest_awaiter(this,void 0,void 0,(function*(){const a="0";try{let l=getTemplatesLocation(n);l+="manifest.json";const c=yield promisifyFetch1(e,"manifest",a,t,(()=>manifest_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(l);t.constructors={};const c={},d=["components","esign"];for(const e of d)if(t[e])if("components"===e)for(const n of Object.keys(t[e]))c[n]={folder:e,path:t.components[n]};else c.esign={folder:e,path:t.esign.extDocFilesDetail};if("monitor"in t)for(const e of Object.keys(t.monitor)){const n=t.monitor[e];if(Array.isArray(n))for(const e of n){const t=e.replace(/\/|\\/g,"-");c[t]={folder:"monitor",path:e}}}const u=getTemplatesLocation(n);let p,h=u;for(const s of Object.keys(c)){const a=c[s],l=a.path;h=l.includes("/")||l.includes("\\")||!l.endsWith(".vue")?l.includes("/")||l.includes("\\")&&l.endsWith(".vue")?l:`${a.folder}/${l}/${l}.vue`:`${a.folder}/${l}`,p=new tt.Gf(h,s);const d=yield loadAndParseComponent(e,p,n,r);yield registerExternalComponent(s,d,i,t,o)}return s&&s(a,t),t}catch(e){if(e&&e.response&&404===e.response.status){const e=getDefaultManifest();return s&&s(a,e),e}}}))));return c}catch(e){const t=getDefaultManifest();return s&&s(a,t),t}}))}function registerExternalComponent(e,t,n,i,s){return manifest_awaiter(this,void 0,void 0,(function*(){try{let r=[];const a=t.script;t.script&&a.mixins&&(r=yield n.exec(new tt.ac(a.mixins,e,i.mixinIsVueFile)),delete a.mixins);const l=o().extend(Object.assign({name:e,mixins:s?[s,...r]:[...r],template:t.template},t.script));if(o().component(e,l),t.style){const n=document.head||document.getElementsByTagName("head")[0];let i=n.querySelector(`#css-${e}`);i&&i.parentNode.removeChild(i),i=document.createElement("style"),i.id=`css-${e}`,i.appendChild(document.createTextNode(t.style)),n.appendChild(i),t.styleAppended=!0}return t.raw||console.error("!!!!"),t.raw=null,t.template=null,t.script=null,t.style=null,i.constructors[e]=l,l}catch(e){console.error(e)}}))}function getDefaultManifest(){return{documents:{},cards:{default:{item:"item.html",view:"view.html",create:"create.html",edit:"edit.html"}},messages:{default:{item:"item.html",view:"view.html",create:"create.html",edit:"edit.html"}}}}var mixin_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};function loadMixins(e,t,n,i){return mixin_awaiter(this,void 0,void 0,(function*(){const s=[],r=[],a=[];let l="js";if(t.mixinIsVueFile&&(l="vue"),!t.fromRemote)for(const n of t.mixins){if("validate"===n&&e.mixins[n]){r.push(e.mixins[n]);continue}const o=`mixins/${n}.${l}`;if(e.extCompPatches)for(const t of Object.keys(e.extCompPatches))e.mixins[t]&&delete e.mixins[t];!e.mixins[o]||e.mixins[o]instanceof Promise?e.mixins[o]instanceof Promise?a.push(e.mixins[o]):s.push({path:o,name:n}):(r.push(e.mixins[o]),i&&t.depentComponentName&&i(o,e.mixins[o],t.depentComponentName))}const c=getTemplatesLocation(n);try{for(const{path:t,name:n}of s){const i=new Promise(((i,o)=>{e.extCompPatches&&e.extCompPatches[t]?i({path:t,name:n,data:e.extCompPatches[t]}):xn().get(`${c}${t}`).then((e=>i({path:t,name:n,data:e.data}))).catch((e=>o(e)))}));a.push(i),e.mixins[t]=i}const d=yield Promise.all(a);if(t.mixinIsVueFile){const o=new tt.Gf("mixin",null);for(const s of d){const a=yield createSFC(o,n,s.data,e.extCompPatches,!0);a.script&&(r.push(a.script),a.name=s.name,a.script.name=s.name,i&&i(s.path,a.script,t.depentComponentName))}}else{window.Vue=o();for(let e=0;e<d.length;e++){let n=d[e].data;n=n.replace("export default","return");try{const o=new Function(`"use strict";${n}`)();if(r.push(o),i){const n=`mixins/${t.mixins[e]}.${l}`;i(n,o,t.depentComponentName)}}catch(e){console.error("loadMixins: eval script error:",e)}}window.Vue=null}return r}catch(e){throw console.error("loadMixins",e),e}}))}var Tn=n(58226),Pn=n(40551),On=n(2770),kn=n(24783),Fn=n(98917),actions_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const An="The main manifest is not found";class Actions{init({state:e,commit:t}){}forbidden({state:e,commit:t}){const n=e.container.get(je.t.Application);n.stopApp(),Mr()}fetchViewState({state:e,commit:t},n){return actions_awaiter(this,void 0,void 0,(function*(){const i=promisifyFetch1(e.viewState,n.key,null,n,(()=>actions_awaiter(this,void 0,void 0,(function*(){const i=`${e.config.apiPath()}viewstate?key=${n.key}`;let{data:o}=yield xn().get(i);return o||(o={}),t(On.ex,{key:n.key,data:o}),o}))));return i}))}saveViewState({state:e,commit:t},n){return actions_awaiter(this,void 0,void 0,(function*(){try{t(On.ex,n);const{data:i}=yield xn().put(`${e.config.apiPath()}viewstate?key=${n.key}`,n.data);return new Ne.$Q({value:null!==i})}catch(e){const t=new Ne.yr(`Ошибка записи viewstate key=${n.key}: ${e.message}`,e);return Promise.reject(new Ne.$Q({value:e.data,error:t}))}}))}fetchUserDeputies({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}deputies`);return t.items}catch(e){(0,Fn.UZ)(e)}}))}fetchDefaultDashboardsList({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}dashboards/default`);return t}catch(e){(0,Fn.UZ)(e)}}))}fetchUserDashboardsList({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}dashboards/list`);return t}catch(e){(0,Fn.UZ)(e)}}))}fetchCommonDashboardsList({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}dashboards/listCommon`);return t}catch(e){(0,Fn.UZ)(e)}}))}addDashboard({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}dashboards/add`,{dashboardName:t.dashboardName,isDefault:t.isDefault,isCommon:t.isCommon,selected:t.selected});return new Ne.$Q({value:n})}catch(e){return new Ne.$Q({error:e})}}))}clearDashboards({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().post(`${e.config.apiPath()}dashboards/clear`),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}editDashboard({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().put(`${e.config.apiPath()}dashboards/${t.guid}`,{dashboardID:t.guid,editedDashboard:t.editedDashboard});return new Ne.$Q({value:n})}catch(e){return new Ne.$Q({error:e})}}))}deleteDashboard({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().delete(`${e.config.apiPath()}dashboards/${t.guid}`),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}setDashboard({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().get(`${e.config.apiPath()}dashboards/${t.guid}`),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}fetchDeputyList({commit:e,state:t},n){return actions_awaiter(this,void 0,void 0,(function*(){if(!n.fromRemote&&t.deputyList&&t.deputyList.length)return t.deputyList;const{data:i}=yield xn().get(`${t.config.apiPath()}me/deputyusers`,{params:{userId:n.userId}});return e(On.Ei,i.items),i.items}))}fetchHistory({commit:e,state:t},n){return actions_awaiter(this,void 0,void 0,(function*(){const{data:n}=yield xn().get(`${t.config.apiPath()}me/history`);return e(On.hv,n),n}))}fetchSurveyData({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){const{data:n}=yield xn().get(`${e.config.freshDocApiPath}api/FreshDoc/template/${t.id}/options`);return n}))}fetchFreshDocFile({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){const{data:n}=yield xn().post(`${e.config.freshDocApiPath}api/FreshDoc/file`,t,{responseType:"blob"});return n}))}fetchRights({commit:e,getters:t,state:n},i){return actions_awaiter(this,void 0,void 0,(function*(){const o=`${n.config.apiPath()}rights/objects`,s={};let r=[];if(i.fromRemote)r=i.objectIds;else if(i.objectIds.forEach((e=>{!n.rights[e]||n.rights[e]instanceof Promise?r.push(e):s[e]=n.rights[e]})),0===r.length)return s;const a=yield promisifyFetch2(i,(t=>{const n=t;let i;t instanceof Promise&&(i={},r.forEach((e=>{i[e]=t}))),e(On.lg,null!==i&&void 0!==i?i:n)}),(()=>{const e=t.getRights(r[0]);if(e instanceof Promise)return e;if(!e)return null;const n={};return r.forEach((e=>{const i=t.getRights(e);n[e]=i})),Object.assign(n,s)}),(()=>actions_awaiter(this,void 0,void 0,(function*(){var e;const t=yield xn().post(o,{objectIds:r});return null===(e=null===t||void 0===t?void 0:t.data)||void 0===e?void 0:e.rights}))),(t=>{if(t){const n={};return r.forEach((e=>{n[e]=t[e]||[]})),e(On.lg,n),Object.assign(n,s)}return null}));return a}))}fetchMemberRights({commit:e,getters:t,state:n},i){return actions_awaiter(this,void 0,void 0,(function*(){const o=`${n.config.apiPath()}rights/memberright`,s={};let r=[];if(i.fromRemote)r=i.memberIDs;else if(i.memberIDs.forEach((e=>{!n.memberRights[e]||n.memberRights[e]instanceof Promise?r.push(e):s[e]=n.memberRights[e]})),0===r.length)return s;const a=yield promisifyFetch2(i,(t=>{const n=t;let i;t instanceof Promise&&(i={},r.forEach((e=>{i[e]=t}))),e(On.z4,null!==i&&void 0!==i?i:n)}),(()=>{const e=t.getMemberRights(r[0]);if(e instanceof Promise)return e;if(!e)return null;const n={};return r.forEach((e=>{const i=t.getMemberRights(e);n[e]=i})),Object.assign(n,s)}),(()=>actions_awaiter(this,void 0,void 0,(function*(){const e=yield xn().post(o,{memberIDs:r}),t=e.data||[],n={};return Array.isArray(t)&&t.forEach((e=>{n[e.memberID]||(n[e.memberID]=[]),n[e.memberID].push(e.rightID)})),r.forEach((e=>{n[e]||(n[e]=[])})),n}))),(t=>t?(e(On.z4,t),Object.assign(t,s)):null));return a}))}fetchRightObject({commit:e,getters:t,state:n},i){return actions_awaiter(this,void 0,void 0,(function*(){const o=`${n.config.apiPath()}rights/rightobject`,s={},r={};if(i.fromRemote)i.objectIds.forEach((e=>{r[e]=null}));else if(i.objectIds.forEach((e=>{!n.rightObjects[e]||n.rightObjects[e]instanceof Promise?r[e]=null:s[e]=n.rightObjects[e]})),0===Object.keys(r).length)return s;return yield promisifyFetch2(i,(t=>{const n={};t instanceof Promise?Object.keys(r).forEach((e=>{n[e]=t})):Array.isArray(t)&&t.forEach((e=>{n[e.id]||(n[e.id]=[]),n[e.id].push(e)})),e(On.s7,n)}),(()=>{let e;const n=Object.keys(r);if(n.length){const i=Number(n[0]);if(e=t.getRightObjects(i),e instanceof Promise)return e}if(!e)return null;let i=[];return Object.keys(r).forEach((e=>{const n=t.getRightObjects(Number(e));r[Number(e)]=n,i=i.concat(n)})),i}),(()=>xn().post(o,{objectIds:Object.keys(r)})),(t=>(Object.keys(r).forEach((e=>{r[Number(e)]=[]})),Array.isArray(t)&&t.forEach((e=>{r[e.id].push(e)})),e(On.s7,r),t))),Object.assign(r,s)}))}fetchEsigns({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){const{data:n}=yield xn().get(`${e.config.apiPath()}${t.entity}/${t.id}/esigns`);return n}))}fetchEsignCert({commit:e,state:t},n){return actions_awaiter(this,void 0,void 0,(function*(){if(!n.fromRemote&&t.cert)return t.cert;const{data:i}=yield xn().get(`${t.config.apiPath()}esigns/certs`,{params:{year:n.year}});if(Array.isArray(i)){const n=t.container.get(Pn.b);if(!n)throw new Error("CryptoProService was not found");const o=yield n.getCertificates();let s,r=!1;for(const e of i)if(e.isRevoked)r=!0;else for(const t of o){const i=yield n.getSerialNumber(t);if(e.serialNumber===i){s=t;break}}if(s)return e(On.O$,s),s;if(r){const t="Сертификат отозван.";return e(On.O$,t),t}}return null}))}checkEsign({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){const n=t.operationId?{params:{operationId:t.operationId}}:null,{data:i}=yield xn().get(`${e.config.apiPath()}${t.entityName}/${t.entityId}/esigns/${t.objectId}/details`,n);return i}))}fetchArchiveFolders({commit:e,dispatch:t,rootState:n,getters:i},o){return actions_awaiter(this,void 0,void 0,(function*(){if(!o.fromRemote){const e=i.getFolders(o.withDepartments);if(Array.isArray(e))return e}try{yield t("instructions/fetchFolders",{fromRemote:!1}),yield t("documents/fetchFolders",{fromRemote:!1});const s=yield n.archiveInstrFolders;return e(On.gM,{instr:s[0],docs:s[1]}),i.getFolders(o.withDepartments)}catch(e){(0,Fn.UZ)(e)}}))}fetchExternalComponent({commit:e,rootState:t,state:n},i){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield loadAndParseComponent(n,i,t.config,((t,n)=>{e(On.lQ,{key:t,template:n})}))}catch(e){(0,Fn.UZ)(e)}}))}fetchMixins({commit:e,rootState:t,state:n},i){return actions_awaiter(this,void 0,void 0,(function*(){try{if(!n.mixins["validate"]){const t=kn.Z;e(On.y0,{key:"validate",data:t,depent:i.depentComponentName})}return loadMixins(n,i,t.config,((t,n,i)=>{e(On.y0,{key:t,data:n,depent:i})}))}catch(e){(0,Fn.UZ)(e)}}))}fetchManifest({commit:e,state:t,rootState:n},i){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield loadManifest(t,i,n.config,i.prop,(t=>{const n=t;return e(On.rV,{key:i.id,data:n}),n}))}catch(t){e(On.rV,{key:i.id,data:null}),(0,Fn.UZ)(t)}}))}fetchDashboardManifest({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){const t="dashboard";try{let n=e.manifest["0"];if(!n)throw new Error(An);return n instanceof Promise&&(n=yield n),n[t]?n[t]:null}catch(e){(0,Fn.UZ)(e)}}))}fetchKanbanManifest({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){const t="kanban";try{let n=e.manifest["0"];if(!n)throw new Error(An);return n instanceof Promise&&(n=yield n),n[t]?n[t]:null}catch(e){(0,Fn.UZ)(e)}}))}fetchCommonManifest({commit:e,rootState:t,state:n},i){return actions_awaiter(this,void 0,void 0,(function*(){try{const o=getMixin(t.container),s=t.container.get(Ae.M.IQueryBus),r=yield loadMainManifest(n,i,t.config,s,o,((t,n)=>{e(On.rV,{key:t,data:n})}),((t,n)=>{e(On.lQ,{key:t,template:n})}));return r}catch(e){(0,Fn.UZ)(e)}}))}fetchCurrentUserRights({rootState:e,dispatch:t}){return actions_awaiter(this,void 0,void 0,(function*(){try{const n=e.currentUser,i=[];return i.push(n.effectiveId),n.roles.forEach((e=>{i.push(e.id)})),yield t("fetchMemberRights",new bn.qh(i))}catch(e){(0,Fn.UZ)(e)}}))}fetchLdOptions({commit:e,state:t},n){return actions_awaiter(this,void 0,void 0,(function*(){try{if(!n.fromRemote&&t.ldOptions)return t.ldOptions;const{data:i}=yield xn().get(`${t.config.apiPath()}admin/landocs/options`);return e(On.F9,i),i}catch(e){(0,Fn.UZ)(e)}}))}closeNoticeCommand({dispatch:e,commit:t},n){return actions_awaiter(this,void 0,void 0,(function*(){try{const i=yield e("instructions/setInstructionReadedCommand",new un.Ub(n.id,null));return t(On.Kf,n.id),i}catch(e){if(e instanceof Ne.$Q)return Promise.reject(e);const t=new Ne.yr(e.message,e);return Promise.reject(new Ne.$Q({error:t}))}}))}lockObjectCommand({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().put(`${e.config.apiPath()}proxy/objects/${t.id}/lock`);return new Ne.$Q({value:Boolean(n)})}catch(e){const t=new Ne.yr(`Ошибка блокировки объекта: ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}unlockObjectCommand({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().put(`${e.config.apiPath()}proxy/objects/${t.id}/unlock`);return new Ne.$Q({value:Boolean(n)})}catch(e){const t=new Ne.yr(`Ошибка разблокировки объекта: ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}addAttachmentCommand({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const n=yield toBase64(t.file),{data:i}=yield xn().post(`${e.config.apiPath()}proxy/attachments`,{objectId:t.objectId,name:t.name,content:n,readOnly:t.readOnly});return new Ne.$Q({value:i})}catch(e){const t=new Ne.yr(`Ошибка создания вложения: ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}updateAttachmentCommand({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const n=yield toBase64(t.file);return yield xn().put(`${e.config.apiPath()}proxy/attachments/${t.id}`,{content:n}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}renameAttachmentCommand({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().post(`${e.config.apiPath()}proxy/attachments/${t.id}/rename`,t),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}addAttachmentVersionCommand({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const n=yield toBase64(t.file),{data:i}=yield xn().post(`${e.config.apiPath()}proxy/attachments/${t.id}/versions`,{content:n,fileName:t.fileName});return new Ne.$Q({value:i})}catch(e){const t=new Ne.yr(`Ошибка создания версии вложения: ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}fetchAttachment({commit:e,state:t},n){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().get(`${t.config.apiPath()}proxy/attachments/${n.id}`);return e}catch(e){(0,Fn.UZ)(e)}}))}PutHistoryCommand({rootState:e},t){try{return xn().put(`${e.config.apiPath()}me/history`,t),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}setDeputy({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().put(`${e.config.apiPath()}me/deputy/${t.userId}`),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}addDeputy({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().post(`${e.config.apiPath()}deputies`,t),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}execScript({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}Script/execute`,t);return new Ne.$Q({value:n})}catch(e){return new Ne.$Q({error:e})}}))}deleteDeputy({rootState:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().delete(`${e.config.apiPath()}deputies/${t.replacerUserId}`),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}putLastVisibled({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().put(`${e.config.apiPath()}me/lasturl`,{lastVisitedUrl:t.url}),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}callMethod({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{let n;const i=Dn()(t);if(!t.fromRemote&&(n=e.proxyResults[i],e.proxyResults[i]instanceof Promise&&(n=yield e.proxyResults[i]),n))return new Ne.$Q({value:n});const o=xn().post(`${e.config.apiPath()}proxy/call-method`,t);e.proxyResults[i]=o;const{data:s}=yield o;return e.proxyResults[i]=s,new Ne.$Q({value:s})}catch(e){return new Ne.$Q({error:e})}}))}runJob({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().post(`${e.config.apiPath()}WorkflowService/job`,{jobID:t.jobID,workflowID:t.workflowID,taskID:t.taskID,variables:t.variables}),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}cancelJob({state:e},t){return actions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().post(`${e.config.apiPath()}WorkflowService/job/cancel`,{jobID:t.jobID,reason:t.reason}),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}registerExternalComponentCommand({rootState:e,dispatch:t},n){return actions_awaiter(this,void 0,void 0,(function*(){try{let i=n.manifest;i||(i=yield t("fetchCommonManifest",new tt.Yf));const o=e.container.get(Ae.M.IQueryBus),s=yield registerExternalComponent(n.name,n.sfc,o,i,n.mixin);return new Ne.$Q({value:s})}catch(e){return new Ne.$Q({error:e})}}))}}function getMixin(e){const t=e.get(Ae.M.IQueryBus),n=e.get(Ve.O.ICommandBus),i={data(){return{queryId:Ae.M,commandId:Ve.O,actionId:Pe.k}},methods:{alert(e){return t.exec(new gn.m("",e))},confirm(e){return t.exec(new Zt.l("Предупреждение",e))},execQuery(e,n){return actions_awaiter(this,void 0,void 0,(function*(){const i=yield t.exec1(e,n);return i}))},execCommand(e,t){return actions_awaiter(this,void 0,void 0,(function*(){const i=yield n.exec1(e,t);if(i.isFailure)throw new Error(i.error.message);return i.value}))},objectDelete(e,t,i){return n.exec(new Dt.wp(e,t,i))},objectCreate(e,t,i){return n.exec(new Dt.j2(e,t,i))},objectUpdate(e,t,i){return n.exec(new Dt.Ff(e,t,i))}},computed:{}};return i}function processDocumentFolders(e,t=!1){if(!Array.isArray(e))return null;const n=[],i={};let o=1e3;return e.forEach((e=>{var s;if(e.contentType=Ue.zc.Document,e.topLevelFolderId=e.topLevelParentId,e.parentId=e.__originalParent,!t||!e.departmentID)return void n.push(e);const r=`${e.parentId}.${e.departmentID}`;let a=i[r];if(!a){a={id:o++,depId:e.departmentID,name:null!==(s=e.department)&&void 0!==s?s:"Подразделение",items:[],parentId:e.parentId},i[r]=a;const t={id:a.id,compositeId:r,contentType:Ue.zc.Document,name:a.name,parentId:a.parentId,nodeType:Tt.J.Fake,topLevelFolderId:a.parentId,department:a.name,departmentID:a.depId};n.push(t)}e.parentId=a.id,n.push(e)})),n}function toBase64(e){return new Promise(((t,n)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=()=>{let e=i.result.toString();e.includes(",")&&(e=e.split(",")[1]),t(e)},i.onerror=e=>n(e)}))}actions_decorate([(0,Tn.Q)($e.Id),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,$e.Id]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchViewState",null),actions_decorate([Commandable(hn.xO),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,hn.xO]),actions_metadata("design:returntype",Promise)],Actions.prototype,"saveViewState",null),actions_decorate([(0,Tn.Q)(Ze.iE),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ze.iE]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchUserDeputies",null),actions_decorate([(0,Tn.Q)(mn.Dr),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,mn.Dr]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchDefaultDashboardsList",null),actions_decorate([(0,Tn.Q)(mn.$Z),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,mn.$Z]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchUserDashboardsList",null),actions_decorate([(0,Tn.Q)(mn.QB),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,mn.QB]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchCommonDashboardsList",null),actions_decorate([Commandable(dn.Tv),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,dn.Tv]),actions_metadata("design:returntype",Promise)],Actions.prototype,"addDashboard",null),actions_decorate([Commandable(dn.PA),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,dn.PA]),actions_metadata("design:returntype",Promise)],Actions.prototype,"clearDashboards",null),actions_decorate([Commandable(dn.Nu),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,dn.Nu]),actions_metadata("design:returntype",Promise)],Actions.prototype,"editDashboard",null),actions_decorate([Commandable(dn.VE),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,dn.VE]),actions_metadata("design:returntype",Promise)],Actions.prototype,"deleteDashboard",null),actions_decorate([Commandable(dn.v5),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,dn.v5]),actions_metadata("design:returntype",Promise)],Actions.prototype,"setDashboard",null),actions_decorate([(0,Tn.Q)(Ze.MH),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ze.MH]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchDeputyList",null),actions_decorate([(0,Tn.Q)(Ze.Zo),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ze.Zo]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchHistory",null),actions_decorate([(0,Tn.Q)(Ze.Ji),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ze.Ji]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchSurveyData",null),actions_decorate([(0,Tn.Q)(Ze.K3),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ze.K3]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchFreshDocFile",null),actions_decorate([(0,Tn.Q)(bn._Y),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,bn._Y]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchRights",null),actions_decorate([(0,Tn.Q)(bn.qh),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,bn.qh]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchMemberRights",null),actions_decorate([(0,Tn.Q)(bn.GB),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,bn.GB]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchRightObject",null),actions_decorate([(0,Tn.Q)(fn.AX),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,fn.AX]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchEsigns",null),actions_decorate([(0,Tn.Q)(fn.nC),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,fn.nC]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchEsignCert",null),actions_decorate([(0,Tn.Q)(fn.qK),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,fn.qK]),actions_metadata("design:returntype",Promise)],Actions.prototype,"checkEsign",null),actions_decorate([(0,Tn.Q)(ArchiveFoldersQuery),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,ArchiveFoldersQuery]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchArchiveFolders",null),actions_decorate([(0,Tn.Q)(tt.Gf),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,tt.Gf]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchExternalComponent",null),actions_decorate([(0,Tn.Q)(tt.ac),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,tt.ac]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchMixins",null),actions_decorate([(0,Tn.Q)(tt.R0),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,tt.R0]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchManifest",null),actions_decorate([(0,Tn.Q)(tt.kY),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,tt.kY]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchDashboardManifest",null),actions_decorate([(0,Tn.Q)(tt.oc),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,tt.oc]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchKanbanManifest",null),actions_decorate([(0,Tn.Q)(tt.Yf),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,tt.Yf]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchCommonManifest",null),actions_decorate([(0,Tn.Q)(Ze.Qs),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchCurrentUserRights",null),actions_decorate([(0,Tn.Q)(yn.G),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,yn.G]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchLdOptions",null),actions_decorate([Commandable(NoticeCloseCommand),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,NoticeCloseCommand]),actions_metadata("design:returntype",Promise)],Actions.prototype,"closeNoticeCommand",null),actions_decorate([Commandable(pn.n),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,pn.n]),actions_metadata("design:returntype",Promise)],Actions.prototype,"lockObjectCommand",null),actions_decorate([Commandable(pn.rn),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,pn.rn]),actions_metadata("design:returntype",Promise)],Actions.prototype,"unlockObjectCommand",null),actions_decorate([Commandable(pn.TD),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,pn.TD]),actions_metadata("design:returntype",Promise)],Actions.prototype,"addAttachmentCommand",null),actions_decorate([Commandable(pn.UY),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,pn.UY]),actions_metadata("design:returntype",Promise)],Actions.prototype,"updateAttachmentCommand",null),actions_decorate([Commandable(pn.$t),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,pn.$t]),actions_metadata("design:returntype",Promise)],Actions.prototype,"renameAttachmentCommand",null),actions_decorate([Commandable(pn.e2),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,pn.e2]),actions_metadata("design:returntype",Promise)],Actions.prototype,"addAttachmentVersionCommand",null),actions_decorate([(0,Tn.Q)(AttachmentQuery),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,AttachmentQuery]),actions_metadata("design:returntype",Promise)],Actions.prototype,"fetchAttachment",null),actions_decorate([Commandable(Ne.kj),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ne.kj]),actions_metadata("design:returntype",Ne.$Q)],Actions.prototype,"PutHistoryCommand",null),actions_decorate([Commandable(Ne.CF),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ne.CF]),actions_metadata("design:returntype",Promise)],Actions.prototype,"setDeputy",null),actions_decorate([Commandable(Ne.iR),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ne.iR]),actions_metadata("design:returntype",Promise)],Actions.prototype,"addDeputy",null),actions_decorate([Commandable(Ne.O0),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ne.O0]),actions_metadata("design:returntype",Promise)],Actions.prototype,"execScript",null),actions_decorate([Commandable(Ne.dw),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ne.dw]),actions_metadata("design:returntype",Promise)],Actions.prototype,"deleteDeputy",null),actions_decorate([Commandable(Ne.z_),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ne.z_]),actions_metadata("design:returntype",Promise)],Actions.prototype,"putLastVisibled",null),actions_decorate([Commandable(Ne.lF),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ne.lF]),actions_metadata("design:returntype",Promise)],Actions.prototype,"callMethod",null),actions_decorate([Commandable(RunJob),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,RunJob]),actions_metadata("design:returntype",Promise)],Actions.prototype,"runJob",null),actions_decorate([Commandable(CancelJob),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,CancelJob]),actions_metadata("design:returntype",Promise)],Actions.prototype,"cancelJob",null),actions_decorate([Commandable(Ne.L$),actions_metadata("design:type",Function),actions_metadata("design:paramtypes",[Object,Ne.L$]),actions_metadata("design:returntype",Promise)],Actions.prototype,"registerExternalComponentCommand",null);var $n=n(42151);class Getters{constructor(){this.getNotifications=e=>t=>{const{notifications:n}=e;return n?n[t]:null},this.getArchiveFolder=e=>t=>e.archiveFolderDict[t]?e.archiveFolderDict[t]:null,this.getRights=e=>t=>e.rights[t]?e.rights[t]:null,this.getMemberRights=e=>t=>e.memberRights[t]?e.memberRights[t]:null,this.getRightObjects=e=>t=>e.rightObjects[t]?e.rightObjects[t]:null,this.ldOptions=({ldOptions:e})=>e,this.getFolders=e=>(t=!1)=>{if(!Array.isArray(e.archiveInstrFolders)||!Array.isArray(e.archiveDocFolders))return null;const n=[{id:1,name:"Сообщения",contentType:Ue.zc.Instruction,nodeType:Tt.J.Fake,parentId:0,compositeId:"1",topLevelFolderId:0,archive:!0},{id:2,name:"Документы",contentType:Ue.zc.Document,nodeType:Tt.J.Fake,parentId:0,compositeId:"2",topLevelFolderId:0,archive:!0}];e.archiveInstrFolders.forEach((e=>{e.parentId=e.parentId?e.parentId:1,e.archive=!0,n.push(e)}));const i=processDocumentFolders(e.archiveDocFolders,t);return i.forEach((e=>{1===e.parentId&&(e.__originalParent=e.parentId,e.parentId=2),e.archive=!0,n.push(e)})),n},this.getViewState=e=>t=>{const n=e.viewState?e.viewState[t]:null;return n?Object.assign({},n):null}}currentUser(e){return(0,$n.Z)(e.currentUser)}commonManifest(e){return(0,$n.Z)(e.manifest["0"])}}var jn=n(12676),En=n(65779),Mn=n(26825),Nn=n(37272);function instructionIsReport(e){return 132===e}var Vn=n(3820),Bn=n(67472),Ln=n(31025),Un=n(54052);class getters_instructions_Getters{constructor(){this.getStat=e=>t=>{const{folderStat:n}=e;return n?Object.assign({},n[t]):null},this.getInstructionsTotalCount=e=>t=>e.instructionsByFolder[t]?e.instructionsByFolder[t].totalCount:0,this.getInstruction=e=>(t,n,i=!0)=>{const o=e.instructions[t];if(o&&(i&&o.fullyRead||!i))return o;const s=findInstruction(e,t,n);return null===s||void 0===s?void 0:s.instructionInfo},this.getInstructionFolder=e=>t=>{const n=e.folderDict[t]?e.folderDict[t]:null;return o().observable((0,$n.Z)(n))},this.getInstructionTypeInfo=e=>t=>e.types?(0,$n.Z)(e.types.find((e=>e.id===t))):null,this.getInstructionActionMenuItems=e=>(t,n)=>{const i=e.actions[t];return i?i[n]:null},this.getFiles=e=>t=>e.files[t]?o().observable((0,$n.Z)(e.files[t])):null}getInstructionFolders(e){return o().observable((0,$n.Z)(e.folderDict))}instructionFolders(e){return o().observable((0,$n.Z)(e.folders))}getInstructionTypes(e){return(0,$n.Z)(e.types)}}function findInstruction(e,t,n){const i={filtered:[],instructionsByFolder:[]};let o,s,r,a,l;const c=["filtered","instructionsByFolder"];return c.forEach((c=>{var d;n?(o=e[c][n],o&&i[c].push(o)):Object.keys(e[c]).forEach((t=>{o=e[c][Number(t)],o&&i[c].push(o)})),e[c][0]&&!i[c].length&&i[c].push(e[c][0]);for(const e of i[c]){const n=null===(d=null===e||void 0===e?void 0:e.items)||void 0===d?void 0:d.findIndex((e=>e.instruction.id===t));n>=0&&("filtered"===c&&(l=n,r=null===e||void 0===e?void 0:e.items[n],s=e),"instructionsByFolder"===c&&(a=n,r||(r=null===e||void 0===e?void 0:e.items[n]),o=e))}})),r?{instructionInfo:r,listIndex:a,filteredIndex:l,list:o,filtered:s}:null}var Hn=n(83273),Qn=n(34317);const zn="SET_FOLDERS",Zn="SET_INSTRUCTION_TYPES",Wn="SET_INSTR_LIST",qn="SET_FILTERED_LIST",Gn="SET_STAT",Kn="SET_MENU_ACTIONS",Yn="SET_INSTRUCTION",Jn="SET_FILES",Xn="CREATE_INSTRUCTION",ei="EDIT_INSTRUCTION",ti="SEND_INSTRUCTION",ni="REPEAT_INSTRUCTION",ii="REPLACE_INSTRUCTION",oi="REDIRECT_INSTRUCTION",si="INSTRUCTION_CLEAR_FOLDER",ri="TO_WORK_INSTRUCTION",ai="INSTRUCTION_MOVE_TO_FOLDER",li="RESET_ACTIONS",ci="UPDATE_ACTIONS",di="REMOVE_FROM_FOLDER",ui="SET_LOG",pi="UPDATE_FOLDER_STAT",hi={[ui](e,t){var n,i,o,s;let r={type:Hn.x.Remove,folderId:(null===(n=null===t||void 0===t?void 0:t.payload)||void 0===n?void 0:n.folderId)||(null===(i=null===t||void 0===t?void 0:t.payload)||void 0===i?void 0:i.srcFolderId),destFolderId:null===(o=null===t||void 0===t?void 0:t.payload)||void 0===o?void 0:o.destFolderId,id:null===(s=null===t||void 0===t?void 0:t.payload)||void 0===s?void 0:s.id};"instructions/SET_INSTRUCTION"===t.type&&(r={type:Hn.x.Update,folderId:t.payload.folderId,id:t.payload.item.instruction.id,value:t.payload.item}),10===e.log.length?e.log=[e.log[6],e.log[7],e.log[8],e.log[9],r]:e.log.push(r)},[Zn](e,t){e.types=t},[zn](e,t){e.folders=t,e.folderDict=(0,Qn.F)(t,"id")},[Wn](e,t){o().set(e.instructionsByFolder,t.folderId,t.items),setActionsEnabled(e,t.folderId)},[Yn](e,t){let n;delete e.instructions[t.item.instruction.id],o().set(e.instructions,t.item.instruction.id,t.item);let i=!1;const s=findInstruction(e,t.item.instruction.id,t.folderId);if((null===s||void 0===s?void 0:s.instructionInfo)&&(s.listIndex>=0&&o().set(s.list.items,s.listIndex,t.item),s.filteredIndex>=0&&(o().set(s.filtered.items,s.filteredIndex,t.item),i=!0)),!(null===s||void 0===s?void 0:s.instructionInfo))if(t.folderId!==t.queryFolderId){if(n=i?e.filtered[t.folderId]:e.instructionsByFolder[t.folderId],!n)return;n.items.push(t.item)}else n=i?e.filtered[0]:e.instructionsByFolder[0],n||(n={items:[],totalCount:1},i?o().set(e.filtered,"0",n):o().set(e.instructionsByFolder,"0",n)),n.items.push(t.item)},[Xn](e,t){(null===t||void 0===t?void 0:t.folderId)?clearFolder(e,{folderId:t.folderId}):clearFolder(e,null)},[ei](e,t){(null===t||void 0===t?void 0:t.folderId)?clearFolder(e,{folderId:t.folderId}):clearFolder(e,null)},[ti](e,t){clearFolder(e,null)},[ni](e,t){clearFolder(e,null)},[ii](e,t){clearFolder(e,null)},[oi](e,t){clearFolder(e,null)},[di](e,t){removeFromFolder(e,t.folderId,t.id)},[si](e,t){clearFolder(e,t)},[qn](e,t){o().set(e.filtered,t.folderId,t.items),setActionsEnabled(e,t.folderId)},[Gn](e,t){e.folderStat=Object.assign(Object.assign({},e.folderStat),(0,Qn.F)(t,"folderID"))},[Jn](e,t){e.files[t.id]=t.items},[ri](e,t){},[ai](e,t){removeFromFolder(e,t.srcFolderId,t.id)},[Kn](e,t){let n=e.actions[t.folderId];n||(n={},e.actions[t.folderId]=n),n[t.id]=t.items},[li](e,t){setActionsEnabled(e,t)},[ci](e,t){updateActions(e,t.folderId,t.id,t.status,t.disabledItems,t.loadingItems)},[pi](e,t){const n=e.folderStat[t.folderId];n&&(n.unreadItems+=t.value)}};function clearFolder(e,t){var n,i;if(null===t||void 0===t?void 0:t.id){let o=-1;const s=findInstruction(e,t.id,t.folderId);(null===s||void 0===s?void 0:s.instructionInfo)&&(o=null===(n=e.instructionsByFolder[t.folderId])||void 0===n?void 0:n.items.findIndex((e=>e===s.instructionInfo)),o<0&&(o=null===(i=e.filtered[t.folderId])||void 0===i?void 0:i.items.findIndex((e=>e===s.instructionInfo)))),(null===s||void 0===s?void 0:s.instructionInfo)&&(e.lastRemovedItem={id:t.id,folderId:t.folderId,index:o,item:s.instructionInfo})}if(null===t||void 0===t?void 0:t.folderId){let n=e.instructionsByFolder[t.folderId];n&&n.items.forEach((t=>{o().set(e.instructions,t.instruction.id,null),delete e.instructions[t.instruction.id]})),n=e.filtered[t.folderId],n&&n.items.forEach((t=>{o().set(e.instructions,t.instruction.id,null),delete e.instructions[t.instruction.id]})),e.instructionsByFolder[t.folderId]=null,e.filtered[t.folderId]=null,e.actions[t.folderId]=null,e.instructionsByFolder=Object.assign({},e.instructionsByFolder),e.filtered=Object.assign({},e.filtered)}else e.instructionsByFolder={0:null},e.instructions={},e.filtered={0:null}}function removeFromFolder(e,t,n){removeFrom(e,"instructionsByFolder",t,n),removeFrom(e,"filtered",t,n),delete e.instructions[n],e.instructions=Object.assign({},e.instructions)}function removeFrom(e,t,n,i){const o=n?[n]:Object.keys(e[t]);for(const s of o){const o=e[t][Number(s)];if(o){const s=o.items.findIndex((e=>e.instruction.id===i));if(s>=0){const r=o.items.splice(s,1);o.totalCount=o.items.length,e[t]=Object.assign({},e[t]),e.lastRemovedItem={id:i,folderId:n,index:s,item:r[0]};break}}}}function setActionsEnabled(e,t){const n=e.actions[t];n&&Object.keys(n).forEach((e=>{const t=n[Number(e)];Array.isArray(t)&&t.forEach((e=>{e.disabled=!1,e.loading=!1}))}))}function updateActions(e,t,n,i,o,s){const r=e.actions[t];if(!r)return;const a=r[n];Array.isArray(a)&&a.forEach((e=>{if(Array.isArray(o)){const t=o.find((t=>t===e.actionInfo.id));t&&(e.disabled=i)}if(Array.isArray(s)){const t=s.find((t=>t===e.actionInfo.id));t&&(e.loading=i)}}))}var actions_instructions_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_instructions_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_instructions_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const mi="instructions";class actions_instructions_Actions{init({state:e,commit:t},n){n&&n.push("SET_INSTRUCTION","REMOVE_FROM_FOLDER","SET_INSTRUCTION_READED","SET_INSTRUCTION_UNREADED","INSTRUCTION_MOVE_TO_FOLDER")}fetchFolders({commit:e,getters:t,state:n,rootState:i},o){return actions_instructions_awaiter(this,void 0,void 0,(function*(){if(!o.fromRemote&&n.folders)return t.instructionFolders;try{let{data:n}=yield xn().get(`${i.config.apiPath()}instructions/folder/${o.rootId||0}/folders`);n=n.sort(((e,t)=>e.parentFolderID-t.parentFolderID));const s=new Set,r=[],a=[];let l=0;for(const e of n)"Архив"!==e.name?s.has(e.parentFolderID)?(r.push(e),s.add(e.id)):a.push(e):(s.add(e.id),l=e.id);const c=r.map((e=>({id:e.id,name:e.name,parentId:e.parentFolderID===l?0:e.parentFolderID,kind:e.folderKind,topLevelFolderId:e.topLevelFolderId,type:e.type,comments:e.comments,creator:e.creator,createdDateTime:e.createdDateTime,isConsolidated:e.isConsolidated,nodeType:Tt.J.InstructionFolder,contentType:Ue.zc.Instruction,compositeId:null,filterID:e.filterID})));i.msgArchiveResolve(c);const d=a.map((e=>({id:e.id,name:e.name,parentId:e.parentFolderID,kind:e.folderKind,topLevelFolderId:e.topLevelFolderId,type:e.type,comments:e.comments,creator:e.creator,createdDateTime:e.createdDateTime,isConsolidated:e.isConsolidated,nodeType:Tt.J.InstructionFolder,contentType:Ue.zc.Instruction,compositeId:null,filterID:e.filterID})));return e(zn,d),t.instructionFolders}catch(e){(0,Fn.UZ)(e)}}))}fetchSingleInstructionFolder({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}instructions/folder/${t.id}`);return n}catch(e){(0,Fn.UZ)(e)}}))}fetchInstructions({commit:e,state:t,rootState:n},i){return actions_instructions_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){if(!i.listInfo.searchText&&!i.listInfo.filter&&t.instructionsByFolder[i.folderId])return t.instructionsByFolder[i.folderId];if(t.filtered[i.folderId])return t.filtered[i.folderId]}try{const{createDateTimeStart:o,createDateTimeFinish:s}=i,r={top:i.listInfo.maxTake||500,skip:0,searchText:null,members:null,filterId:null,filterValues:null,createDateTimeStart:Ln.C.toServerString(o),createDateTimeFinish:Ln.C.toServerString(s)};i.listInfo.searchText?r.searchText=i.listInfo.searchText:i.listInfo.filter&&(r.filterId=i.listInfo.filter.refId,r.filterValues=i.listInfo.filter.filterValues.map((e=>{const t=Object.assign({},e);return[Vn.g.Date,Vn.g.DateTime].includes(e.dataType)&&(t.value=Ln.C.toServerString(e.value)),t}))),r.permissionCheckMode=i.listInfo.permissionCheckMode;const{data:a}=yield xn().post(`${n.config.apiPath()}instructions/folder/${i.folderId||0}/instructions`,r,{cancelable:i.cancelable});if(Array.isArray(null===a||void 0===a?void 0:a.items)&&(null===a||void 0===a?void 0:a.items.length)){const e={},t={},n={};a.items.forEach((o=>{var s;"redirectFlag"in(null===o||void 0===o?void 0:o.instruction)||(o.instruction.redirectFlag=null),o.instruction.folder||(o.instruction.folder={id:i.folderId,name:String(i.folderId)}),(null===(s=o.instruction)||void 0===s?void 0:s.customAttributes)&&makeCustomAttributes(o,e,t,n)}))}const l={items:a.items,totalCount:a.totalCount},c=t.folderDict[i.folderId]?t.folderDict[i.folderId]:n.archiveFolderDict[i.folderId];if(l.items)for(const e of l.items){const t=e.instruction;fillCalculatedFields(t,c)}r.searchText||r.filterId?e(qn,{folderId:i.folderId,items:l}):e(Wn,{folderId:i.folderId,items:l});try{e(On.Kf,{notificationType:Le.S.Messages,id:i.folderId},{root:!0})}catch(e){}return l}catch(e){(0,Fn.UZ)(e)}}))}fetchStatistic({commit:e,state:t,rootState:n},i){return actions_instructions_awaiter(this,void 0,void 0,(function*(){const o=Object.keys(t.folderStat);if(!i.fromRemote&&o.length)return o.map((e=>t.folderStat[Number(e)]));try{const t=new URLSearchParams;Array.isArray(i.ids)&&i.ids.forEach((e=>t.append("folderIds",e.toString())));const{data:{folderStatistics:o}}=yield xn().get(`${n.config.apiPath()}instructions/folders/statistic`,{params:t});return e(Gn,o),o}catch(e){(0,Fn.UZ)(e)}}))}fetchInstruction({commit:e,state:t,rootState:n,getters:i},o){var s,r,a;return actions_instructions_awaiter(this,void 0,void 0,(function*(){if(!o.fromRemote){let e=t.instructions[o.id];if(e instanceof Promise&&(e=yield e),e)return e}try{let l=`${n.config.apiPath()}instruction/${o.id||0}`;l+=o.folderId?`?folderId=${o.folderId}`:"";const c=xn().get(l);t.instructions[o.id]=c;let{data:d}=yield c;if(!d)throw{message:`instruction id=${o.id} is not found`,response:{status:404}};let u=o.folderId;!u&&(null===(s=d.instruction)||void 0===s?void 0:s.folder)&&(u=d.instruction.folder.id||0);let p=null!==(r=t.folderDict[u])&&void 0!==r?r:n.archiveFolderDict[u];if(!p&&d.instruction&&d.instruction.folder&&(p=d.instruction.folder),d.fullyRead=!0,fillCalculatedFields(d.instruction,p),null===(a=d.instruction)||void 0===a?void 0:a.customAttributes){const e={},t={},n={};makeCustomAttributes(d,e,t,n)}e(Yn,{folderId:u,queryFolderId:o.folderId,item:d});const h=i.getInstruction(String(o.id),u);return h&&(d=h),d}catch(e){(0,Fn.UZ)(e)}}))}fetchFiles({commit:e,getters:t,rootState:n},i){return actions_instructions_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){const e=t.getFiles(Number(i.instrId));if(e)return e}try{const{data:{items:o}}=yield xn().get(`${n.config.apiPath()}instruction/${i.instrId||0}/addons/files`);return e(Jn,{id:i.instrId,items:o}),t.getFiles(Number(i.instrId))}catch(e){(0,Fn.UZ)(e)}}))}fetchFoldersToMove({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}instructions/folder/${t.folderId}/folderstomove`);return n.map((e=>({id:e.id,name:e.name,parentId:e.parentFolderID,kind:e.folderKind,topLevelFolderId:e.topLevelFolderId,type:e.type,comments:e.comments,creator:e.creator,createdDateTime:e.createdDateTime,isConsolidated:e.isConsolidated,nodeType:Tt.J.InstructionFolder,contentType:Ue.zc.Instruction,compositeId:null,filterID:e.filterID})))}catch(e){throw"URIError"===e.name?new Fn.ao("Ошибка в URI",e):"SyntaxError"===e.name?new Fn.ao("Синтаксическая ошибка в данных",e):e}}))}fetchTypes({state:e,rootState:t,commit:n,getters:i},o){return actions_instructions_awaiter(this,void 0,void 0,(function*(){if(!(null===o||void 0===o?void 0:o.fromRemote)&&e.types)return i.getInstructionTypes;try{const{data:e}=yield xn().get(`${t.config.apiPath()}instruction/types`);return n(Zn,e),i.getInstructionTypes}catch(e){(0,Fn.UZ)(e)}}))}fetchTypesInfo({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}instruction/typesinfo`);return t}catch(e){(0,Fn.UZ)(e)}}))}fetchMessageResponse({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}instruction/message`,t,{chainedRead:!0});return n.mainInstruction&&(n.mainInstruction.executionDate||(n.mainInstruction.executionDate=null),n.mainInstruction.execInterval||(n.mainInstruction.execInterval=null),n.mainInstruction.initiator=n.mainInstruction.initiator?[n.mainInstruction.initiator]:Array(0),n.mainInstruction.execAuditor=n.mainInstruction.execAuditor?[n.mainInstruction.execAuditor]:Array(0),n.mainInstruction.reportReceiver=n.mainInstruction.reportReceiver?[n.mainInstruction.reportReceiver]:Array(0)),n}catch(e){(0,Fn.UZ)(e)}}))}fetchExecEndDate({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=new Date(t.startDate.toString());if(t.intervalType===Nn.NH.Calendar){const e=new Date(n.toISOString());return e.setDate(e.getDate()+t.interval),e}const{data:i}=yield xn().get(`${e.config.apiPath()}instruction/endDate?startDate=${n.toISOString()}&interval=${t.interval||0}`);return i}catch(e){(0,Fn.UZ)(e)}}))}fetchExecInterval({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=new Date(t.startDate).getTime(),i=new Date(t.endDate).getTime();if(t.intervalType===Nn.NH.Calendar)return Math.round((i-n)/1e3/60/60/24);const{data:o}=yield xn().get(`${e.config.apiPath()}instruction/interval?startDate=${t.startDate.toISOString()}&endDate=${t.endDate.toISOString()}`);return o}catch(e){(0,Fn.UZ)(e)}}))}fetchFavoriteReceivers({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=Object.assign({},t),{data:i}=yield xn().get(`${e.config.apiPath()}instruction/favorite-receivers`,{params:n});return i}catch(e){(0,Fn.UZ)(e)}}))}fetchInstructionsTree({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:{items:n}}=yield xn().get(`${e.config.apiPath()}instruction/${t.id||0}/addons/tree?withDeleted=${t.withDeleted}`);return n}catch(e){(0,Fn.UZ)(e)}}))}fetchInstructionType({rootState:e,state:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{if(!n.fromRemote&&t.types){const e=t.types.find((e=>e.id===n.typeId));if(e)return e}const{data:i}=yield xn().get(`${e.config.apiPath()}instruction/type/${n.typeId}`);return i}catch(e){(0,Fn.UZ)(e)}}))}fetchInstructionHistory({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:{items:n}}=yield xn().get(`${e.config.apiPath()}instruction/${t.id||0}/addons/history`);return n}catch(e){(0,Fn.UZ)(e)}}))}fetchInstructionOperations({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:{items:n}}=yield xn().get(`${e.config.apiPath()}instruction/${t.id||0}/addons/docoperations`);return n}catch(e){(0,Fn.UZ)(e)}}))}fetchDocument({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}instructions/document/${t.documentId||0}`);return n}catch(e){(0,Fn.UZ)(e)}}))}fetchSingleMessage({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}instruction/${t.id||0}/singlemessage/?actionType=${t.actionType}`,{chainedRead:!0});return n&&(n.receiver=Array.isArray(n.receiver)?n.receiver:n.receiver?[n.receiver]:[],n.initiator=Array.isArray(n.initiator)?n.initiator:n.initiator?[n.initiator]:[],n.execAuditor=Array.isArray(n.execAuditor)?n.execAuditor:n.execAuditor?[n.execAuditor]:[],n.reportReceiver=Array.isArray(n.reportReceiver)?n.reportReceiver:n.reportReceiver?[n.reportReceiver]:[]),n}catch(e){(0,Fn.UZ)(e)}}))}fetchReport({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=Object.assign({},t);delete n.instructionId;const{data:i}=yield xn().get(`${e.config.apiPath()}instruction/${t.instructionId||0}/report/foredit`,{params:n,chainedRead:!0});if(i.error)throw new Error(i.error);const o=i.response;return o.executionDate&&(o.executionDate=new Date(o.executionDate)),o}catch(e){(0,Fn.UZ)(e)}}))}fetchReport2({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=e.config.apiPath(2),{data:i}=yield xn().get(`${n}instruction/${t.id||0}/report`);if(i.error)throw new Error(i.error);const o=i.response;return o.executionDate&&(o.executionDate=new Date(o.executionDate)),o}catch(e){(0,Fn.UZ)(e)}}))}fetchFoldersUpdate({rootState:e,commit:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}instructions/folders/unreaded`);t(On.So,{notificationType:Le.S.Messages,data:n.instrFolderUpdateInfoList},{root:!0})}catch(e){(0,Fn.UZ)(e)}}))}fetchFolderRules({rootState:e,commit:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}instructions/folder/rules`);return t}catch(e){(0,Fn.UZ)(e)}}))}addFavoriteReceiverCommand({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().post(`${e.config.apiPath()}instruction/favorite-receiver`,t),new Ne.$Q({value:!0})}catch(e){const t=new Ne.yr(`Ошибка добавления получателя в "частые контакты": ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}deleteFavoriteReceiverCommand({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{return yield xn().delete(`${e.config.apiPath()}instruction/favorite-receiver?instructionTypeId=${t.instructionTypeId}&receiverid=${t.receiverid}`),new Ne.$Q({value:!0})}catch(e){const t=new Ne.yr(`Ошибка добавления получателя в "частые контакты": ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}createDocCommand({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:{documentID:n}}=yield xn().post(`${e.config.apiPath()}instructions/document/`,t,{chainedWrite:!0});return new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка создания документа: ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}addFilesCommand({rootState:e},t){var n,i;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const{data:{value:n}}=yield xn().post(`${e.config.apiPath()}instructions/document/${t.documentId}/files`,t.data,{transformRequest:e=>e,headers:{"Content-Type":null},chainedWrite:!0});return new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка загрузки файлов: ${null!==(i=null===(n=null===e||void 0===e?void 0:e.response)||void 0===n?void 0:n.data)&&void 0!==i?i:e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}createMessageCommand({rootState:e,commit:t},n){var i,o;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const s=Object.assign({},messageToInstructionRequestBase(n.message)),r=`${e.config.apiPath()}instruction/`,a=e.container.get(Un.c),l=yield a.doSignableAction((e=>xn().post(r,e,{chainedWrite:!0})),s);let c={id:l.instructionId,folderId:n.message.mainInstruction.folder?n.message.mainInstruction.folder.id:null};const d=e.container.get(je.t.Application);let u=!1;return d.state===Oe.Z.Messages&&(u=!0),u&&([null===(i=e.currentFolder)||void 0===i?void 0:i.id,null===(o=e.currentFolder)||void 0===o?void 0:o.topLevelFolderId].includes(Bn.Ro.Projects)&&(c=null),t(Xn,c)),new Ne.$Q({value:l})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}editMessageCommand({commit:e,rootState:t},n){var i,o;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const s=Object.assign({},messageToInstructionRequestBase(n.message)),r=`${t.config.apiPath()}instruction/${n.message.instructionID||0}`,a=t.container.get(Un.c),l=yield a.doSignableAction((e=>xn().put(r,e,{chainedWrite:!0})),s);let c={id:l.instructionId,folderId:n.message.mainInstruction.folder?n.message.mainInstruction.folder.id:null};const d=t.container.get(je.t.Application);let u=!1;return d.state===Oe.Z.Messages&&(u=!0),u&&([null===(i=t.currentFolder)||void 0===i?void 0:i.id,null===(o=t.currentFolder)||void 0===o?void 0:o.topLevelFolderId].includes(Bn.Ro.Projects)&&(c=null),e(ei,c)),new Ne.$Q({value:l})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}sendMessageSimpleCommand({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n={request:Object.assign({},t.message)},{data:i}=yield xn().post(`${e.config.apiPath()}instruction/send/`,n);return new Ne.$Q({value:i})}catch(e){const t=new Ne.yr(`Ошибка отправки сообщения: ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}sendMessageCommand({commit:e,dispatch:t,rootState:n},i){var o,s,r,a,l,c,d,u,p,h,m,f,g;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const y=Object.assign(Object.assign({},messageToInstructionRequestBase(i.message)),{operationTypeId:i.message.instructionTypeInfo.instructionType.operationID,instructionId:i.message.instructionID,doEdit:i.saveBeforeSend,srcInstructionId:i.srcInstructionId,srcReportId:i.srcReportId}),v=`${n.config.apiPath()}instruction/send`,b=n.container.get(Un.c),C=yield b.doSignableAction((e=>xn().post(v,e)),y);let w=null===(r=null===(s=null===(o=i.message)||void 0===o?void 0:o.mainInstruction)||void 0===s?void 0:s.folder)||void 0===r?void 0:r.id;if([null===(a=n.currentFolder)||void 0===a?void 0:a.id,null===(l=n.currentFolder)||void 0===l?void 0:l.topLevelFolderId].includes(Bn.Ro.Outbox)&&(w=Number(null===(c=n.currentFolder)||void 0===c?void 0:c.id)),[null===(d=n.currentFolder)||void 0===d?void 0:d.id,null===(u=n.currentFolder)||void 0===u?void 0:u.topLevelFolderId].includes(Bn.Ro.Inbox)){let e=!1;for(const t of i.message.receivers)if(t.type===Nn.OP.User&&t.id===n.currentUser.id){e=!0;break}e&&(w=Number(null===(p=n.currentFolder)||void 0===p?void 0:p.id))}if(updateMessageOrClearFolder(n,t,e,null!==(h=i.srcInstructionId)&&void 0!==h?h:i.srcReportId,w),C){const e=(null===(m=null===i||void 0===i?void 0:i.message)||void 0===m?void 0:m.document)?i.message.document.id:null===(f=null===i||void 0===i?void 0:i.message)||void 0===f?void 0:f.documentId;if(e===n.activeDocumentId||e===n.previewDocumentId){const n=(null===(g=null===i||void 0===i?void 0:i.message)||void 0===g?void 0:g.document)?i.message.document.journalID:null;t("documents/fetchDocument",new He.U_(e,Ue.dS.View,n,!0),{root:!0})}}return new Ne.$Q({value:C})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}repeatMessageCommand({commit:e,dispatch:t,rootState:n},i){var o,s;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const r=singleMessageToSingleInstructionData(i.info),a=`${n.config.apiPath()}instruction/${i.reportId||0}/repeat`,l=n.container.get(Un.c),c=yield l.doSignableAction((e=>xn().post(a,e)),r);return updateMessageOrClearFolder(n,t,e,i.reportId,null===(s=null===(o=i.info)||void 0===o?void 0:o.folder)||void 0===s?void 0:s.id,i.reportId),new Ne.$Q({value:c})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}replaceMessageCommand({commit:e,dispatch:t,rootState:n},i){var o,s;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const r=singleMessageToSingleInstructionData(i.info),a=`${n.config.apiPath()}instruction/${i.id||0}/replace`,l=n.container.get(Un.c),c=yield l.doSignableAction((e=>xn().post(a,e)),r);return updateMessageOrClearFolder(n,t,e,i.id,null===(s=null===(o=i.info)||void 0===o?void 0:o.folder)||void 0===s?void 0:s.id,i.id),new Ne.$Q({value:c})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}replaceMessageOnlyCommand({commit:e,rootState:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const e=`${t.config.apiPath()}proxy/replace-instruction`,{data:i}=yield xn().post(e,n);return i}catch(e){return(0,Fn._o)(e)}}))}redirectMessageCommand({commit:e,dispatch:t,rootState:n},i){var o,s,r;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const a=Object.assign({},messageToInstructionRequestBase(i.message)),l=`${n.config.apiPath()}instruction/${i.id||0}/redirect`,c=n.container.get(Un.c),d=yield c.doSignableAction((e=>xn().post(l,e)),a);return updateMessageOrClearFolder(n,t,e,i.id,null===(r=null===(s=null===(o=i.message)||void 0===o?void 0:o.mainInstruction)||void 0===s?void 0:s.folder)||void 0===r?void 0:r.id,i.id),new Ne.$Q({value:d})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}sendReport({commit:e,dispatch:t,rootState:n},i){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const o=getReportSendRequestData(i.report,i.completionTypeId),s=`${n.config.apiPath()}instruction/${i.instructionId||0}/report/send`,r=n.container.get(Un.c),a=yield r.doSignableAction((e=>xn().post(s,e)),o);if(i.completionTypeId&&i.completionTypeId===En.g.Success&&o.operationDocumentId&&a.isDPOOperation){const e=`${n.config.apiPath()}instruction/${i.instructionId||0}/report/signDocs`,t=getSignDocSendData(i.instructionId,o,i.useLastVersion);yield r.doSignableAction((t=>xn().post(e,t)),t)}return e(di,{id:i.report.instructionId,folderId:i.folder?i.folder.id:null}),i.instructionId!==i.report.instructionId&&t("fetchInstruction",new Fe.oE(i.instructionId,null,!0)),new Ne.$Q({value:a})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}createReportProject({commit:e,rootState:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const e=getReportSendRequestData(n.report),i=`${t.config.apiPath()}instruction/${n.instructionId||0}/report/project`,o=t.container.get(Un.c),s=yield o.doSignableAction((e=>xn().post(i,e,{chainedWrite:!0})),e);return new Ne.$Q({value:s})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}updateReport({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=getReportSendRequestData(t.report),i=`${e.config.apiPath()}instruction/${t.report.reportId||0}/report/edit`,o=e.container.get(Un.c),s=yield o.doSignableAction((e=>xn().post(i,e,{chainedWrite:!0})),n);return new Ne.$Q({value:s})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}acceptReport({commit:e,rootState:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const i=`${t.config.apiPath()}instruction/${n.reportId||0}/operations/acceptReport`,o=t.container.get(Un.c),s=yield o.doSignableAction((e=>xn().put(i,e)),{reportId:n.reportId});return e(di,{id:s.reportId||s.instructionId,folderId:n.folder?n.folder.id:null}),new Ne.$Q({value:s})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn.og)(e)}}))}redirectReportAsMessageCommand({commit:e,dispatch:t,rootState:n},i){var o;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const s=Object.assign({},messageToInstructionRequestBase(i.message)),r=`${n.config.apiPath()}instruction/${i.reportId||0}/redirectreport`,a=n.container.get(Un.c),l=yield a.doSignableAction((e=>xn().post(r,e)),s);return updateMessageOrClearFolder(n,t,e,i.reportId,null===(o=i.folder)||void 0===o?void 0:o.id),new Ne.$Q({value:l})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}repeatReportAsMessageCommand({commit:e,dispatch:t,rootState:n},i){var o;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const s=Object.assign({},messageToInstructionRequestBase(i.message)),r=`${n.config.apiPath()}instruction/${i.reportId||0}/repeatchain`,a=n.container.get(Un.c),l=yield a.doSignableAction((e=>xn().post(r,e)),s);return updateMessageOrClearFolder(n,t,e,i.reportId,null===(o=i.folder)||void 0===o?void 0:o.id,i.reportId),new Ne.$Q({value:l})}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}setInstructionReadedCommand({commit:e,rootState:t,getters:n},i){var o,s;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const r=`${t.config.apiPath()}instruction/${i.id||0}/operations/readed`;yield xn().put(r,{isReaded:!0});const a=n.getInstruction(i.id,i.folder?i.folder.id:0,!1);if(a&&(setReaded(a,!0),e(Yn,{folderId:null===(o=i.folder)||void 0===o?void 0:o.id,queryFolderId:null===(s=i.folder)||void 0===s?void 0:s.id,item:a}),i.folder)){let t=n.getStat(i.folder.id);t?t.unreadItems--:t={folderID:i.folder.id,unreadItems:0},e(Gn,[t])}return new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}setInstructionUnreadedCommand({commit:e,rootState:t,getters:n},i){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const o=`${t.config.apiPath()}instruction/${i.id||0}/operations/readed`;yield xn().put(o,{isReaded:!1});const s=n.getInstruction(i.id,i.folder?i.folder.id:0,!1);if(s&&(setReaded(s,!1),e(Yn,{folderId:i.folder.id,queryFolderId:i.folder.id,item:s}),i.folder)){let t=n.getStat(i.folder.id);t?t.unreadItems++:t={folderID:i.folder.id,unreadItems:1},e(Gn,[t])}return new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}removeMessageCommand({commit:e,rootState:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const i=`${t.config.apiPath()}instruction/${n.id||0}`;return yield xn().delete(i),e(di,{id:n.id,folderId:n.folderId}),new Ne.$Q({value:{status:Te.Ao.NeedUpdateList,type:Te.uE.Completed}})}catch(e){return(0,Fn._o)(e)}}))}revokeCommand({commit:e,rootState:t},n){var i;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const o=`${t.config.apiPath()}instruction/${n.id||0}/operations/revoke`,s=yield xn().put(o,{revokeChain:n.revokeChain});if(s.data&&s.data.success)return e(di,{id:n.id,folderId:n.folderId}),new Ne.$Q({value:{status:Te.Ao.NeedUpdateList,type:Te.uE.Completed}});throw new Error(`Ошибка при отзыве сообщения ${(null===(i=null===s||void 0===s?void 0:s.data)||void 0===i?void 0:i.failMessage)?s.data.failMessage:""}`)}catch(e){return e.message=Un.c.getErrorMessage(e),(0,Fn._o)(e)}}))}toArchiveCommand({commit:e,rootState:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{if(!n.id)throw new Error("MessageToArchiveCommand - отсутствует id сообщения");const i=`${t.config.apiPath()}instruction/${n.id||0}/operations/archive`;return yield xn().put(i),e(di,{id:n.id,folderId:n.folderId}),new Ne.$Q({value:!0})}catch(e){return(0,Fn.og)(e)}}))}restoreCommand({commit:e,rootState:t},n){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{if(!n.id)throw new Error("RestoreMessageCommand - отсутствует id сообщения");const i=`${t.config.apiPath()}instruction/${n.id||0}/operations/restore`;return yield xn().put(i),e(di,{id:n.id,folderId:n.folderId}),new Ne.$Q({value:!0})}catch(e){return(0,Fn.og)(e)}}))}toWorkCommand({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}instruction/${t.id||0}/operations/towork`,i=yield xn().put(n);if(!i.data.isSuccessStatusCode)throw new Error(i.data.reasonPhrase);return new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}moveToFolderCommand({commit:e,rootState:t},n){var i;return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const o=`${t.config.apiPath()}instruction/${n.id||0}/operations/move`,{data:s}=yield xn().put(o,{srcFolderId:n.srcFolderId,destFolderId:n.destFolderId}),r="Ошибка перемещения сообщения в выбранную папку";return s?s.isSuccessStatusCode?(e(ai,{id:n.id,srcFolderId:n.srcFolderId,destFolderId:n.destFolderId}),new Ne.$Q({value:!0})):new Ne.$Q({error:new Ne.yr(null!==(i=s.reasonPhrase)&&void 0!==i?i:r)}):new Ne.$Q({error:new Ne.yr(r)})}catch(e){return(0,Fn._o)(e)}}))}createFolder({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}instructions/folder`,{data:i}=yield xn().post(n,{parentID:t.parentID,name:t.name,filterID:t.filterID});return new Ne.$Q({value:i})}catch(e){return(0,Fn._o)(e)}}))}deleteFolder({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}instructions/folder/${t.id}?removeChildren=${t.removeChildren}`;return yield xn().delete(n),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}renameFolder({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}instructions/folder/${t.id}`,{data:i}=yield xn().put(n,{filterID:t.filterID,name:t.name});return new Ne.$Q({value:i})}catch(e){return(0,Fn._o)(e)}}))}createFolderRule({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}instructions/folder/${t.folderId}/rules`,{data:i}=yield xn().post(n,{id:t.folderId,conditions:t.conditions,isEnabled:t.isEnabled,isExecuteNewAndInbox:t.isExecuteNewAndInbox,name:t.name});return new Ne.$Q({value:i})}catch(e){return(0,Fn._o)(e)}}))}editFolderRule({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}instructions/folder/${t.folderId}/rules/${t.ruleId}`,{data:i}=yield xn().put(n,{id:t.folderId,ruleId:t.ruleId,conditions:t.conditions,isEnabled:t.isEnabled,isExecuteNewAndInbox:t.isExecuteNewAndInbox,name:t.name,order:t.order});return new Ne.$Q({value:i})}catch(e){return(0,Fn._o)(e)}}))}deleteFolderRule({rootState:e},t){return actions_instructions_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}instructions/folder/${t.id}/rule/${t.ruleId}`,{data:i}=yield xn().delete(n);return new Ne.$Q({value:i})}catch(e){return(0,Fn._o)(e)}}))}}function updateMessageOrClearFolder(e,t,n,i,o,s){var r,a;const l=e.container.get(je.t.Application);let c=!1;[Oe.Z.Messages,Oe.Z.Kanban].includes(l.state)&&(c=!0),i&&i!==s&&t("fetchInstruction",new Fe.oE(i,(null===(r=e.currentFolder)||void 0===r?void 0:r.id)?Number(null===(a=e.currentFolder)||void 0===a?void 0:a.id):null,!0));let d=si;c&&o&&(s&&(d=di),n(d,{id:s,folderId:o}))}function messageToInstructionRequestBase(e){const t=messageToSingleInstructionData(e),n=e.receivers.filter((t=>t.id!==e.mainInstruction.receiver[0].id)),i=n.map((n=>{let i=null;return e.reportToExecutive?i=e.mainInstruction.receiver[0].id:Array.isArray(e.mainInstruction.reportReceiver)&&e.mainInstruction.reportReceiver.length&&(i=e.mainInstruction.reportReceiver[0].id),Object.assign(Object.assign({},t),{receiverID:n.id,reportReceiverID:i})})),o={instructionTypeId:e.instructionTypeInfo.instructionType.id,documentId:e.document?e.document.id:null,sendType:e.sendType,reportToExecutive:e.reportToExecutive,withExecutive:e.withExecutive,control:e.control,mainInstruction:t,coExecutorInstruction:i};return o}function messageToSingleInstructionData(e){const t=e.mainInstruction;let n=null;e.files&&e.files.length>0&&(n=[],e.files.forEach((e=>{n.push(e.id)})));const i={receiverID:t.receiver&&t.receiver[0]?t.receiver[0].id:0,text:t.text,subject:t.subject,comment:t.comment,fileIds:n,execAuditorID:Array.isArray(t.execAuditor)&&t.execAuditor.length?t.execAuditor[0].id:null,initiatorID:Array.isArray(t.initiator)&&t.initiator.length?t.initiator[0].id:null,reportReceiverID:Array.isArray(t.reportReceiver)&&t.reportReceiver.length?t.reportReceiver[0].id:null,startDate:t.startDate,executionDate:t.executionDate,execInterval:t.execInterval,execIntervalType:t.execIntervalType,workerID:t.workerID};return i}function singleMessageToSingleInstructionData(e){let t=null;return e.files&&e.files.length>0&&(t=[],e.files.forEach((e=>{t.push(e.id)}))),{receiverID:e.receiver&&e.receiver.length>0?e.receiver[0].id:0,text:e.text,subject:e.subject,comment:e.comment,fileIds:t,execAuditorID:Array.isArray(e.execAuditor)&&e.execAuditor.length?e.execAuditor[0].id:null,initiatorID:Array.isArray(e.initiator)&&e.initiator.length?e.initiator[0].id:null,reportReceiverID:Array.isArray(e.reportReceiver)&&e.reportReceiver.length?e.reportReceiver[0].id:null,startDate:e.startDate,executionDate:e.executionDate,execInterval:e.execInterval,control:e.control,workerID:e.workerID}}function getReportSendRequestData(e,t){const n=[];return e.files&&e.files.forEach((e=>{n.push(e.id)})),{reportId:e.reportId,initiatorId:e.creator.id,receiverId:e.receiver.id,subject:e.subject,executionDate:e.executionDate,text:e.text,documentId:e.document&&e.document.id,operationTypeId:e.operationTypeId,operationDocumentId:e.operationDocumentId,fileIds:n,comment:e.comment,completionTypeId:t,srcReportId:e.srcReportId,taskID:e.taskID}}function getSignDocSendData(e,t,n){return{instructionId:e,srcReportId:t.srcReportId,operationDocumentId:t.operationDocumentId,operationTypeId:t.operationTypeId,useLastVersion:n}}function fillCalculatedFields(e,t){t?(e.type=t.kind===Rt.Wy.Inbox?Mn.p0.Incoming:Mn.p0.Outcoming,e.folder={id:t.id,name:t.name}):e.type=Mn.p0.Incoming,e.iconList=Ot.C.getListIconInfo(e.stateNameResName),e.iconGrid=Ot.C.toStateSprite(e.stateNameResName),e.isReport=instructionIsReport(e.instructionTypeID),e.documentTypeName=getDocumentTypeName(e.instructionTypeID),e.textTypeName=getTextTypeName(e.instructionTypeID)}function getDocumentTypeName(e){return instructionIsReport(e)?"Ответный документ":"Документ-основание"}function getTextTypeName(e){return instructionIsReport(e)?"Текст отчета":"Текст сообщения"}function setReaded(e,t){e&&(e.instruction.viewFlag=t,e.permissions.canReadInstruction=!t,e.permissions.canUnreadInstruction=t)}function makeCustomAttributes(e,t={},n={},i={}){var o;const s=Object.keys(null===(o=e.instruction)||void 0===o?void 0:o.customAttributes);s.forEach((o=>{const s="$#"+o+"$#";let r=t[o];r||(r=function(e){this[s]=e,e!==this.customAttributes[o]&&(this.customAttributes[o]=e)},t[o]=r);let a=i[o];a||(a=function(){return this[s]},i[o]=a),Object.defineProperty(e.instruction,o,{configurable:!0,enumerable:!0,get:a,set:r}),e.instruction[o]=e.instruction.customAttributes[o];const l=e.instruction;let c=n[o];c||(c=function(e){this[s]=e,l[o]!==e&&(l[o]=e)},n[o]=c),Object.defineProperty(e.instruction.customAttributes,o,{configurable:!0,enumerable:!0,get:a,set:c})}))}actions_instructions_decorate([(0,Tn.Q)(Fe.KM,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.KM]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchFolders",null),actions_instructions_decorate([(0,Tn.Q)(Fe.u8,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.u8]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchSingleInstructionFolder",null),actions_instructions_decorate([(0,Tn.Q)(Fe.oY,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.oY]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchInstructions",null),actions_instructions_decorate([(0,Tn.Q)(Fe.z5,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.z5]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchStatistic",null),actions_instructions_decorate([(0,Tn.Q)(Fe.oE,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.oE]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchInstruction",null),actions_instructions_decorate([(0,Tn.Q)(Fe.I1,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.I1]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchFiles",null),actions_instructions_decorate([(0,Tn.Q)(Fe.c1,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.c1]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchFoldersToMove",null),actions_instructions_decorate([(0,Tn.Q)(Fe.jl,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.jl]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchTypes",null),actions_instructions_decorate([(0,Tn.Q)(Fe.tN,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.tN]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchTypesInfo",null),actions_instructions_decorate([(0,Tn.Q)(Fe.Oz,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.Oz]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchMessageResponse",null),actions_instructions_decorate([(0,Tn.Q)(Fe.Rr,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.Rr]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchExecEndDate",null),actions_instructions_decorate([(0,Tn.Q)(Fe.MV,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.MV]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchExecInterval",null),actions_instructions_decorate([(0,Tn.Q)(Fe.AK,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.AK]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchFavoriteReceivers",null),actions_instructions_decorate([(0,Tn.Q)(Fe.O6,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.O6]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchInstructionsTree",null),actions_instructions_decorate([(0,Tn.Q)(Fe.vw,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.vw]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchInstructionType",null),actions_instructions_decorate([(0,Tn.Q)(Fe.vW,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.vW]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchInstructionHistory",null),actions_instructions_decorate([(0,Tn.Q)(Fe.VZ,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.VZ]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchInstructionOperations",null),actions_instructions_decorate([(0,Tn.Q)(Fe.Wr,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.Wr]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchDocument",null),actions_instructions_decorate([(0,Tn.Q)(Fe.t9,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.t9]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchSingleMessage",null),actions_instructions_decorate([(0,Tn.Q)(Fe.et,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.et]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchReport",null),actions_instructions_decorate([(0,Tn.Q)(Fe.OU,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.OU]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchReport2",null),actions_instructions_decorate([(0,Tn.Q)(Fe.ZO,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.ZO]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchFoldersUpdate",null),actions_instructions_decorate([(0,Tn.Q)(Fe.fU,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,Fe.fU]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"fetchFolderRules",null),actions_instructions_decorate([Commandable(un.Hd,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Hd]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"addFavoriteReceiverCommand",null),actions_instructions_decorate([Commandable(un.SI,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.SI]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"deleteFavoriteReceiverCommand",null),actions_instructions_decorate([Commandable(un.R3,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.R3]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"createDocCommand",null),actions_instructions_decorate([Commandable(un.eY,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.eY]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"addFilesCommand",null),actions_instructions_decorate([Commandable(un.BN,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.BN]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"createMessageCommand",null),actions_instructions_decorate([Commandable(un.gR,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.gR]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"editMessageCommand",null),actions_instructions_decorate([Commandable(un.ud,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.ud]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"sendMessageSimpleCommand",null),actions_instructions_decorate([Commandable(un.AT,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.AT]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"sendMessageCommand",null),actions_instructions_decorate([Commandable(un.Ck,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Ck]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"repeatMessageCommand",null),actions_instructions_decorate([Commandable(un.Hp,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Hp]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"replaceMessageCommand",null),actions_instructions_decorate([Commandable(un.mH,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.mH]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"replaceMessageOnlyCommand",null),actions_instructions_decorate([Commandable(un.Ut,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Ut]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"redirectMessageCommand",null),actions_instructions_decorate([Commandable(un.Gm,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Gm]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"sendReport",null),actions_instructions_decorate([Commandable(un._S,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un._S]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"createReportProject",null),actions_instructions_decorate([Commandable(un.Vr,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Vr]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"updateReport",null),actions_instructions_decorate([Commandable(un.g$,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.g$]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"acceptReport",null),actions_instructions_decorate([Commandable(un.zv,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.zv]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"redirectReportAsMessageCommand",null),actions_instructions_decorate([Commandable(un.Id,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Id]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"repeatReportAsMessageCommand",null),actions_instructions_decorate([Commandable(un.Ub,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Ub]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"setInstructionReadedCommand",null),actions_instructions_decorate([Commandable(un.xd,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.xd]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"setInstructionUnreadedCommand",null),actions_instructions_decorate([Commandable(un.cu,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.cu]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"removeMessageCommand",null),actions_instructions_decorate([Commandable(un.y0,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.y0]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"revokeCommand",null),actions_instructions_decorate([Commandable(un.M3,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.M3]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"toArchiveCommand",null),actions_instructions_decorate([Commandable(un.xS,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.xS]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"restoreCommand",null),actions_instructions_decorate([Commandable(un.b9,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.b9]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"toWorkCommand",null),actions_instructions_decorate([Commandable(un.Xw,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.Xw]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"moveToFolderCommand",null),actions_instructions_decorate([Commandable(un.FO,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.FO]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"createFolder",null),actions_instructions_decorate([Commandable(un.W2,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.W2]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"deleteFolder",null),actions_instructions_decorate([Commandable(un.wX,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.wX]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"renameFolder",null),actions_instructions_decorate([Commandable(un.jM,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.jM]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"createFolderRule",null),actions_instructions_decorate([Commandable(un.BE,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.BE]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"editFolderRule",null),actions_instructions_decorate([Commandable(un.aX,mi),actions_instructions_metadata("design:type",Function),actions_instructions_metadata("design:paramtypes",[Object,un.aX]),actions_instructions_metadata("design:returntype",Promise)],actions_instructions_Actions.prototype,"deleteFolderRule",null);const fi=toActionTree(new actions_instructions_Actions),gi=toDict(new getters_instructions_Getters),yi={folders:null,folderDict:{0:null},instructionsByFolder:{0:null},instructions:{},filtered:{0:null},folderStat:{},files:{0:null},types:null,actions:{0:null},log:[],lastRemovedItem:null},vi=!0,bi={namespaced:vi,state:yi,getters:gi,actions:fi,mutations:hi};var Ci=n(4381),wi=n(95251),_i=n(25008),xi=n(23116),actions_kanban_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_kanban_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_kanban_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Si="kanban",Ii="kanban-settings";class actions_kanban_Actions{fetchBoards({dispatch:e,commit:t,state:n,rootState:i},o){return actions_kanban_awaiter(this,void 0,void 0,(function*(){let s=null;if(o.fromRemote||(s=n.folders),s)return s;let r=yield e("fetchViewState",new $e.Id(Ii),{root:!0});if(!r||(0,xi.n)(r)){let e=i.manifest["0"];if(!e)throw new Error("The main manifest is not found");e instanceof Promise&&(e=yield e),e["kanban"]||(r=null);const t=e["kanban"],n=yield xn().get(i.config.templatesLocation+t.settings);n.data&&!(0,xi.n)(n.data)||(r=null),r=n.data}return Ci.g.boards=r,t(_i.bZ,r),s=getFolders(r),t(_i.Ul,s),s}))}fetchTasks({dispatch:e},t){return actions_kanban_awaiter(this,void 0,void 0,(function*(){const t=yield e("fetchViewState",new $e.Id("kanban-tasks",!0),{root:!0});return t}))}addBoard({dispatch:e,commit:t,state:n},i){const o=Object.assign(Object.assign({},n.boards),{[i.board.id]:Object.assign({},i.board.toObjectForSend())});t(_i.bZ,o),Ci.g.boards=o,t(_i.Ul,getFolders(o)),e("saveViewState",new hn.xO(Ii,o),{root:!0})}addTask({dispatch:e,commit:t,state:n},i){e("saveViewState",new hn.xO("kanban-tasks",i.payload),{root:!0})}}function getFolders(e){return e?Object.keys(e).map((t=>Ci.g.createBoard(Object.assign({id:Number(t)},e[t])))).map((e=>e.toFolderInfo())).sort(((e,t)=>e.name<t.name?-1:1)):[]}actions_kanban_decorate([(0,Tn.Q)(At.H,Si),actions_kanban_metadata("design:type",Function),actions_kanban_metadata("design:paramtypes",[Object,At.H]),actions_kanban_metadata("design:returntype",Promise)],actions_kanban_Actions.prototype,"fetchBoards",null),actions_kanban_decorate([(0,Tn.Q)(At.O,Si),actions_kanban_metadata("design:type",Function),actions_kanban_metadata("design:paramtypes",[Object,At.O]),actions_kanban_metadata("design:returntype",Promise)],actions_kanban_Actions.prototype,"fetchTasks",null),actions_kanban_decorate([Commandable(wi.H,Si),actions_kanban_metadata("design:type",Function),actions_kanban_metadata("design:paramtypes",[Object,wi.H]),actions_kanban_metadata("design:returntype",void 0)],actions_kanban_Actions.prototype,"addBoard",null),actions_kanban_decorate([Commandable(wi.K,Si),actions_kanban_metadata("design:type",Function),actions_kanban_metadata("design:paramtypes",[Object,wi.K]),actions_kanban_metadata("design:returntype",void 0)],actions_kanban_Actions.prototype,"addTask",null);class getters_kanban_Getters{constructor(){this.getKanbanFolder=e=>t=>e.folders.find((e=>e.id===t))}}const Di={boards:null,folders:null,expandedPanels:[],previewEnabled:!0},Ri=!0,Ti=toActionTree(new actions_kanban_Actions),Pi=toDict(new getters_kanban_Getters),Oi={namespaced:Ri,state:Di,getters:Pi,actions:Ti,mutations:_i.P$};var ki=n(84258),Fi=n(81675),actions_filters_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_filters_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_filters_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Ai="filters";class actions_filters_Actions{init(){}fetchFilters({state:e,rootState:t,commit:n},i){return actions_filters_awaiter(this,void 0,void 0,(function*(){try{if(!i.fromRemote){if(i.filterType===Ue.zc.Instruction&&e.instructions[i.kind])return e.instructions[i.kind];if(i.filterType===Ue.zc.Document&&e.documents[i.journalId])return e.documents[i.journalId]}const{data:{items:o}}=yield xn().get(`${t.config.apiPath()}filters`,{params:{filterType:Ue.zc[i.filterType],kind:Rt.Wy[i.kind],journalId:i.journalId}}),s=i.filterType===Ue.zc.Instruction?Fi.Bu:Fi.ZM;return n(s,{kind:i.kind,journalId:i.journalId,data:o}),o}catch(e){(0,Fn.UZ)(e)}}))}fetchSearchFolderFilter({state:e,rootState:t,commit:n},i){return actions_filters_awaiter(this,void 0,void 0,(function*(){try{if(!i.fromRemote&&e.searchFolderFilters[i.searchFolderId])return e.searchFolderFilters[i.searchFolderId];const{data:o}=yield xn().get(`${t.config.apiPath()}folders/searchfolders/${i.searchFolderId}/filter`);return n(Fi.cN,{searchFolderId:i.searchFolderId,data:o}),o}catch(e){(0,Fn.UZ)(e)}}))}fetchFilterData({commit:e,state:t,rootState:n},i){return actions_filters_awaiter(this,void 0,void 0,(function*(){try{if(!i.fromRemote&&t.filters[Number(i.id)])return t.filters[Number(i.id)];const{data:{items:o}}=yield xn().get(`${n.config.apiPath()}filter/${i.id||0}/parameters`);return e(Fi.YA,{id:i.id,items:o}),o}catch(e){(0,Fn.UZ)(e)}}))}fetchFilterRawData({rootState:e},t){return actions_filters_awaiter(this,void 0,void 0,(function*(){try{const n={tableId:t.item.tableId||"",infoField:t.item.infoField||"",value:t.value,valueType:t.item.dataTypeId,skip:t.skip,take:t.take},{data:i}=yield xn().post(`${e.config.apiPath()}filter/${t.refId||0}/rawData`,n);return i}catch(e){(0,Fn.UZ)(e)}}))}}actions_filters_decorate([(0,Tn.Q)(ki.YX,Ai),actions_filters_metadata("design:type",Function),actions_filters_metadata("design:paramtypes",[Object,ki.YX]),actions_filters_metadata("design:returntype",Promise)],actions_filters_Actions.prototype,"fetchFilters",null),actions_filters_decorate([(0,Tn.Q)(ki.oN,Ai),actions_filters_metadata("design:type",Function),actions_filters_metadata("design:paramtypes",[Object,ki.oN]),actions_filters_metadata("design:returntype",Promise)],actions_filters_Actions.prototype,"fetchSearchFolderFilter",null),actions_filters_decorate([(0,Tn.Q)(ki.oV,Ai),actions_filters_metadata("design:type",Function),actions_filters_metadata("design:paramtypes",[Object,ki.oV]),actions_filters_metadata("design:returntype",Promise)],actions_filters_Actions.prototype,"fetchFilterData",null),actions_filters_decorate([(0,Tn.Q)(ki.aq,Ai),actions_filters_metadata("design:type",Function),actions_filters_metadata("design:paramtypes",[Object,ki.aq]),actions_filters_metadata("design:returntype",Promise)],actions_filters_Actions.prototype,"fetchFilterRawData",null);class getters_filters_Getters{constructor(){this.getFilterParams=e=>t=>{const{filters:n}=e;return n[Number(t)]},this.getAppliedFilter=({appliedFilters:e})=>t=>e[t],this.getAppliedDateRange=({appliedDateRange:e})=>t=>e[t],this.getAppliedSearchTerm=({appliedSearchTerm:e})=>t=>e[t]}}const $i={filters:{0:null},documents:{0:null},instructions:{0:null},appliedFilters:{0:null},appliedDateRange:{0:null},searchFolderFilters:{0:null},appliedSearchTerm:{0:""}},ji=!0,Ei=toActionTree(new actions_filters_Actions),Mi=toDict(new getters_filters_Getters),Ni={namespaced:ji,state:$i,getters:Mi,actions:Ei,mutations:Fi.P$};var Vi=n(45154),Bi=n(22337);const Li="SET_TYPE_FILES",Ui="SET_EDITED_FILES",Hi={[Li](e,t){e.types=t},[Ui](e,t){e.editedFiles=t}};var actions_files_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_files_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_files_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Qi="files";class actions_files_Actions{init({state:e,dispatch:t}){}fetchUrl({state:e,dispatch:t,rootState:n,commit:i},o){try{if(!o.fromRemote&&e.files[o.fileId])return e.files[o.fileId]}catch(e){(0,Fn.UZ)(e)}}fetchFileTypes({state:e,dispatch:t,rootState:n,commit:i},o){return actions_files_awaiter(this,void 0,void 0,(function*(){try{if(!o.fromRemote&&e.types)return e.types;const{data:{FILETYPE:t}}=yield xn().get(`${n.config.apiPath()}proxy/files/types`);return i(Li,t),t}catch(e){(0,Fn.UZ)(e)}}))}downloadFile({state:e,rootState:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().get(`${t.config.apiPath()}files/${n.fileId}?preview=${n.preview}`);return e}catch(e){(0,Fn.UZ)(e)}}))}fetchStampsFile({state:e,rootState:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().get(`${t.config.apiPath()}files/${n.versionId}/stamps`);return e}catch(e){(0,Fn.UZ)(e)}}))}getFileBytes({state:e,rootState:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().get(`${t.config.apiPath()}files/${n.fileId}`,{responseType:"arraybuffer",headers:{"Content-Type":"application/json"}});return e}catch(e){(0,Fn.UZ)(e)}}))}fileSearchQuery({state:e,rootState:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().post(`${t.config.searchConfig.searchApiPath}search`,n);return e}catch(e){(0,Fn.UZ)(e)}}))}FileSearchDetailQuery({state:e,rootState:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().post(`${t.config.searchConfig.getDetailDocumentApiPath}getDocument`,n);return e}catch(e){(0,Fn.UZ)(e)}}))}addFileToIndex({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.searchConfig.indexingApiPath}indexFile`,t);return new Ne.$Q({value:n})}catch(e){(0,Fn.UZ)(e)}}))}addFileToConvert({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().put(`${e.config.apiPath()}files/convert-pdf-start`,t);return new Ne.$Q({value:n})}catch(e){return(0,Fn.WI)(e)}}))}renameFile({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().put(`${e.config.apiPath()}files/${t.fileId}`,{name:t.name});return new Ne.$Q({value:Boolean(n)})}catch(e){(0,Fn.UZ)(e)}}))}unlockForceFile({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().put(`${e.config.apiPath()}files/${t.fileid}/unlock`);return new Ne.$Q({value:Boolean(n)})}catch(e){(0,Fn.UZ)(e)}}))}fetchFileConvert({state:e,rootState:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().get(`${t.config.apiPath()}files/convert-task/${n.taskId}/data`);return e}catch(e){(0,Fn.UZ)(e)}}))}saveStampsFile({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}files/${t.versionId}/stamps`,t.data);return new Ne.$Q({value:n})}catch(e){(0,Fn.UZ)(e)}}))}fetchFilesEdited({rootState:e,commit:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}files/editedfiles`);return t(Ui,n),n}catch(e){(0,Fn.UZ)(e)}}))}fetchFileStampSettings({rootState:e,commit:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}webstamp/settings`);return t}catch(e){(0,Fn.UZ)(e)}}))}fetchFileStampRegNumber({rootState:e,commit:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}webstamp/regnumber`,{params:{versionId:n.versionId,documentId:n.documentId}});return t}catch(e){(0,Fn.UZ)(e)}}))}fetchFileStampEsign({rootState:e,commit:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}WebStamp/esign`,{params:{versionId:n.versionId,documentId:n.documentId,operTypeId:n.operTypeId,userID:n.userID}});return t}catch(e){(0,Fn.UZ)(e)}}))}fetchFileVersions({state:e,rootState:t},n){return actions_files_awaiter(this,void 0,void 0,(function*(){try{let e=`${t.config.apiPath()}proxy/files/${n.id}/versions`;(n.attributes||n.members)&&(e+="?"),n.attributes&&(e+=`attributes=${n.attributes}`),n.members&&n.members.forEach((t=>{e+=`&member=${t}`}));const{data:i}=yield xn().get(e);return i.VERSION}catch(e){(0,Fn.UZ)(e)}}))}r7Auth({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){return Promise.resolve()}))}r7FetchFileInfo({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{let n="";t.r7FileId?n=`${e.config.apiPath()}R7/r7file/${t.r7FileId}`:t.fileId&&(n=`${e.config.apiPath()}R7/file/${t.fileId}`);const{data:i}=yield xn().get(n);return i}catch(e){(0,Fn.UZ)(e)}}))}r7FetchFileEditData({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}R7/r7file/${t.r7FileId}/openedit`);return n}catch(e){(0,Fn.UZ)(e)}}))}r7FetchFileConfig({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}R7/files/${t.fileId}/config`);return n}catch(e){(0,Fn.UZ)(e)}}))}deleteFileCommand({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().delete(`${e.config.apiPath()}proxy/documents/${t.documentId}/files/${t.fileId}`);return new Ne.$Q({value:Boolean(n)})}catch(e){let t=null;return e.response&&e.response.data?(t=new Ne.yr(`${e.response.data}`),Promise.reject(new Ne.$Q({error:t}))):(t=new Ne.yr(`Ошибка удаления версии файла: ${e.message}`,e),Promise.reject(new Ne.$Q({error:t})))}}))}deleteVersionFileCommand({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){let n;try{return n=yield xn().delete(`${e.config.apiPath()}proxy/documents/${t.documentId}/files/${t.fileId}/versions/${t.versionId}`),new Ne.$Q({value:Boolean(n.data)})}catch(e){let t=null;return e.response&&e.response.data?(t=new Ne.yr(`${e.response.data}`),Promise.reject(new Ne.$Q({error:t}))):(t=new Ne.yr(`Ошибка удаления версии файла: ${e.message}`,e),Promise.reject(new Ne.$Q({error:t})))}}))}addVersionFileCommand({rootState:e},t){var n,i,o;return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}proxy/files/${t.fileId}/versions`,t.data);return new Ne.$Q({value:Boolean(n)})}catch(e){const t=new Ne.yr(`Ошибка при загрузке версии файла: ${null!==(o=null===(i=null===(n=null===e||void 0===e?void 0:e.response)||void 0===n?void 0:n.data)||void 0===i?void 0:i.message)&&void 0!==o?o:e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}fetchFileTemplates({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{let n="";t.path&&(n=`?path=${t.path}`);const{data:i}=yield xn().get(`${e.config.apiPath()}files/templates${n}`);return i}catch(e){(0,Fn.UZ)(e)}}))}attachFileTemplateToDoc({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const n=`?path=${t.path}`;return yield xn().post(`${e.config.apiPath()}files/templates/attach-to-document${n}`,{documentId:t.documentId}),new Ne.$Q({value:!0})}catch(e){(0,Fn.UZ)(e)}}))}FromLdToR7({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}R7/file`,t);return new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка при открытии файла: ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}DownloadToR7({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}R7/r7file`,t);return new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка при загрузке файла в Р7: ${e.message}`,e);return Promise.reject(new Ne.$Q({error:t}))}}))}SaveFileViaR7Command({rootState:e},t){return actions_files_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}R7/CommandService`,{commandType:"ForceSave",key:t.key});return new Ne.$Q({value:n})}catch(e){(0,Fn.UZ)(e)}}))}}actions_files_decorate([(0,Tn.Q)(Bi.RO,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.RO]),actions_files_metadata("design:returntype",String)],actions_files_Actions.prototype,"fetchUrl",null),actions_files_decorate([(0,Tn.Q)(Bi.uL,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.uL]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchFileTypes",null),actions_files_decorate([(0,Tn.Q)(Bi.jn,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.jn]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"downloadFile",null),actions_files_decorate([(0,Tn.Q)(Bi.gD,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.gD]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchStampsFile",null),actions_files_decorate([(0,Tn.Q)(Bi.Je,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.Je]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"getFileBytes",null),actions_files_decorate([(0,Tn.Q)(Bi.sj,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.sj]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fileSearchQuery",null),actions_files_decorate([(0,Tn.Q)(Bi.cV,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.cV]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"FileSearchDetailQuery",null),actions_files_decorate([Commandable(Vi.lQ,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.lQ]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"addFileToIndex",null),actions_files_decorate([Commandable(Vi.Of,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.Of]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"addFileToConvert",null),actions_files_decorate([Commandable(Vi.xC,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.xC]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"renameFile",null),actions_files_decorate([Commandable(Vi.uO,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.uO]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"unlockForceFile",null),actions_files_decorate([(0,Tn.Q)(Bi.Ap,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.Ap]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchFileConvert",null),actions_files_decorate([Commandable(Vi.Eq,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.Eq]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"saveStampsFile",null),actions_files_decorate([(0,Tn.Q)(Bi.wp,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.wp]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchFilesEdited",null),actions_files_decorate([(0,Tn.Q)(Bi.jY,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.jY]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchFileStampSettings",null),actions_files_decorate([(0,Tn.Q)(Bi.m5,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.m5]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchFileStampRegNumber",null),actions_files_decorate([(0,Tn.Q)(Bi.O8,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.O8]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchFileStampEsign",null),actions_files_decorate([(0,Tn.Q)(Bi.MZ,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.MZ]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchFileVersions",null),actions_files_decorate([(0,Tn.Q)(Bi.SS,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.SS]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"r7Auth",null),actions_files_decorate([(0,Tn.Q)(Bi.fJ,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.fJ]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"r7FetchFileInfo",null),actions_files_decorate([(0,Tn.Q)(Bi.cR,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.cR]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"r7FetchFileEditData",null),actions_files_decorate([(0,Tn.Q)(Bi.s,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.s]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"r7FetchFileConfig",null),actions_files_decorate([Commandable(Vi.Hq,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.Hq]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"deleteFileCommand",null),actions_files_decorate([Commandable(Vi.gm,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.gm]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"deleteVersionFileCommand",null),actions_files_decorate([Commandable(Vi.gL,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.gL]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"addVersionFileCommand",null),actions_files_decorate([(0,Tn.Q)(Bi.G8,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Bi.G8]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"fetchFileTemplates",null),actions_files_decorate([Commandable(Vi.O_,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.O_]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"attachFileTemplateToDoc",null),actions_files_decorate([Commandable(Vi.de,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.de]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"FromLdToR7",null),actions_files_decorate([Commandable(Vi.oE,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.oE]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"DownloadToR7",null),actions_files_decorate([Commandable(Vi.GY,Qi),actions_files_metadata("design:type",Function),actions_files_metadata("design:paramtypes",[Object,Vi.GY]),actions_files_metadata("design:returntype",Promise)],actions_files_Actions.prototype,"SaveFileViaR7Command",null);class getters_files_Getters{constructor(){this.listEditedFiles=e=>e.editedFiles}}const zi={url:{0:""},types:null,editedFiles:null},Zi=!0,Wi=toActionTree(new actions_files_Actions),qi=toDict(new getters_files_Getters),Gi={namespaced:Zi,state:zi,getters:qi,actions:Wi,mutations:Hi};class actions_pages_Actions{init({state:e,dispatch:t}){}}class getters_pages_Getters{}const Ki={},Yi={workspace:null,reports:null,settings:null},Ji=!0,Xi=toActionTree(new actions_pages_Actions),eo=toDict(new getters_pages_Getters),to={namespaced:Ji,state:Yi,getters:eo,actions:Xi,mutations:Ki};var no=n(34170),io=n(44893);const oo="SET_CARDS_TREE",so="SET_CARD_VERSION",ro="UPDATE_CARD_VERSION",ao="DELETE_CARD_VERSION",lo="SET_ACTUAL_CARD_VERSION",co="COPY_CARD_VERSION",uo={[oo](e,t){e.cards=t.map((e=>Object.keys(Sn.e).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n.toLowerCase()]})),{cardId:e.cardId,name:e.name})))},[co](e,t){e.versionBuffer=t},[so](e,t){e.cards=e.cards.reduce(((e,n)=>n.cardId===t.cardId?[...e,Object.assign(Object.assign({},n),{[t.type]:[...n[t.type],t]})]:[...e,Object.assign({},n)]),[])},[ro](e,t){e.cards=e.cards.reduce(((e,n)=>n.cardId===t.cardId?[...e,Object.assign(Object.assign({},n),{[t.type]:n[t.type].reduce(((e,n)=>n.id===t.id?[...e,Object.assign(Object.assign({},n),t)]:[...e,n]),[])})]:[...e,n]),[])},[ao](e,{cardId:t,type:n,id:i}){e.cards=e.cards.reduce(((e,o)=>o.cardId===t?[...e,Object.assign(Object.assign({},o),{[n]:o[n].filter((e=>e.id!==i))})]:[...e,o]),[])},[lo](e,{cardId:t,type:n,id:i}){e.cards=e.cards.reduce(((e,o)=>o.cardId===t?[...e,Object.assign(Object.assign({},o),{[n]:o[n].reduce(((e,t)=>[...e,Object.assign(Object.assign({},t),{isActual:t.id===i})]),[])})]:[...e,o]),[])}};var actions_cards_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_cards_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_cards_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};class actions_cards_Actions{fetchCardsTree({commit:e,getters:t,rootState:n},i){return actions_cards_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){const e=t.cardTree;if(e.length>0)return e}try{const{data:i}=yield xn().get(`${n.config.apiPath()}cards/tree`);return e(oo,i),t.cardTree}catch(e){(0,Fn.UZ)(e)}}))}searchCards({rootState:e},t){return actions_cards_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}cards/search`,Object.assign({},t));return n}catch(e){(0,Fn.UZ)(e)}}))}cardsActual({rootState:e},t){return actions_cards_awaiter(this,void 0,void 0,(function*(){const{cardId:n,cardType:i}=t;try{const{data:t}=yield xn().get(`${e.config.apiPath()}cards/${n}/${i}/actual`);return t}catch(e){(0,Fn.UZ)(e)}}))}fetchCardVersion({rootState:e,getters:t},n){return actions_cards_awaiter(this,void 0,void 0,(function*(){if(!n.id)return t.getCardVersion(n);if(!n.fromRemote){const e=t.getCardVersion(n);if(e.data)return e}try{const{cardId:t,type:i,id:o}=n,{data:s}=yield xn().get(`${e.config.apiPath()}cards/${t}/${i}/${o}`);return s}catch(e){(0,Fn.UZ)(e)}}))}createCardVersion({commit:e,getters:t,rootState:n,dispatch:i},o){return actions_cards_awaiter(this,void 0,void 0,(function*(){try{const{data:s}=yield xn().post(`${n.config.apiPath()}cards`,Object.assign(Object.assign({},o),{data:JSON.stringify(o.data)}));e(so,s);const{id:r,cardId:a,type:l}=s,c=t.getCardById(a);return c&&1===c[l].length&&(yield i("activateCardVersion",new no.IQ({id:r,cardId:a,type:l}))),new Ne.$Q({value:s})}catch(e){const t=new Ne.yr(`Ошибка создания карточки документа: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}updateCardVersion({commit:e,rootState:t},n){return actions_cards_awaiter(this,void 0,void 0,(function*(){try{const{data:i}=yield xn().put(`${t.config.apiPath()}cards`,Object.assign(Object.assign({},n),{data:JSON.stringify(n.data)}));return e(ro,i),new Ne.$Q({value:i})}catch(e){const t=new Ne.yr(`Ошибка обновления карточки документа: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}deleteCardVersion({commit:e,rootState:t},n){return actions_cards_awaiter(this,void 0,void 0,(function*(){try{const{cardId:i,type:o,id:s}=n.version;return yield xn().post(`${t.config.apiPath()}cards/delete`,{cardId:i,type:o,id:s}),e(ao,n.version),new Ne.$Q({value:!0})}catch(e){const t=new Ne.yr(`Ошибка удаления карточки документа: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}activateCardVersion({commit:e,rootState:t},n){return actions_cards_awaiter(this,void 0,void 0,(function*(){try{const{cardId:i,type:o,id:s}=n.version;return yield xn().post(`${t.config.apiPath()}cards/actual`,{cardId:i,type:o,id:s}),e(lo,n.version),new Ne.$Q({value:!0})}catch(e){const t=new Ne.yr(`Ошибка активации карточки документа: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}unzipFiles({rootState:e},t){return actions_cards_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}cards/import`,t.getFormData(),{headers:{"Content-Type":"multipart/form-data"}});return new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка чтения файла: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}exportCards({rootState:e},t){return actions_cards_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}cards/export`,t.data,{responseType:"blob"});return new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка экспорта в файл: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}importCards({rootState:e,commit:t},n){return actions_cards_awaiter(this,void 0,void 0,(function*(){try{const{data:i}=yield xn().post(`${e.config.apiPath()}cards/list`,n.data);return t(oo,i),new Ne.$Q({value:i})}catch(e){const t=new Ne.yr(`Ошибка импорта из файла: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}}actions_cards_Actions.namespace="cards",actions_cards_decorate([(0,Tn.Q)(io.lQ,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,io.lQ]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"fetchCardsTree",null),actions_cards_decorate([(0,Tn.Q)(io.$$,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,io.$$]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"searchCards",null),actions_cards_decorate([(0,Tn.Q)(io.J2,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,io.J2]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"cardsActual",null),actions_cards_decorate([(0,Tn.Q)(io.dw,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,io.dw]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"fetchCardVersion",null),actions_cards_decorate([Commandable(no.FJ,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,no.FJ]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"createCardVersion",null),actions_cards_decorate([Commandable(no.ji,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,no.ji]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"updateCardVersion",null),actions_cards_decorate([Commandable(no.Mu,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,no.Mu]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"deleteCardVersion",null),actions_cards_decorate([Commandable(no.IQ,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,no.IQ]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"activateCardVersion",null),actions_cards_decorate([Commandable(no.E3,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,no.E3]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"unzipFiles",null),actions_cards_decorate([Commandable(no.sH,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,no.sH]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"exportCards",null),actions_cards_decorate([Commandable(no.xr,actions_cards_Actions.namespace),actions_cards_metadata("design:type",Function),actions_cards_metadata("design:paramtypes",[Object,no.xr]),actions_cards_metadata("design:returntype",Promise)],actions_cards_Actions.prototype,"importCards",null);class getters_cards_Getters{constructor(){this.getCardById=e=>t=>e.cards.find((e=>e.cardId===t)),this.versionBuffer=e=>e.versionBuffer,this.getCardVersion=(e,t)=>({cardId:e,type:n,id:i})=>{const o=t.getCardById(e);return o&&i?o[n].find((({id:e})=>i===e)):{cardId:e,type:n}}}cardTree(e){return e.cards}}const po={cards:[],versionBuffer:null},ho=!0,mo=toActionTree(new actions_cards_Actions),fo=toDict(new getters_cards_Getters),go={namespaced:ho,state:po,getters:fo,actions:mo,mutations:uo};var yo=n(66422),vo=n(54235);const bo="SET_COMPONENT",Co="UPDATE_COMPONENT",wo="DELETE_COMPONENT",_o="SET_COMPONENT_LIST",xo="SET_COMPONENT_VERSION",So="UPDATE_COMPONENT_VERSION",Io="DELETE_COMPONENT_VERSION",Do="COPY_COMPONENT_VERSION",Ro={[_o](e,t){e.components=t},[bo](e,t){e.components=[...e.components,t]},[Do](e,t){e.versionBuffer=t},[Co](e,t){e.components=e.components.map((e=>e.component.code===t.component.code?t:e))},[wo](e,t){e.components=e.components.filter((({component:e})=>e.code!==t))},[xo](e,t){e.components=e.components.map((e=>e.component.code===t.code?{component:Object.assign(Object.assign({},e.component),{lastVersion:t.version}),versions:[...e.versions,t]}:e))},[So](e,t){e.components=e.components.map((e=>e.component.code===t.code?Object.assign(Object.assign({},e),{versions:e.versions.map((e=>e.id===t.id?t:e))}):e))},[Io](e,t){e.components=e.components.map((e=>e.component.code===t.code?Object.assign(Object.assign({},e),{versions:e.versions.filter((({id:e})=>e!==t.id))}):e))}};var actions_components_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_components_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_components_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))},__rest=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};class actions_components_Actions{fetchComponentList({commit:e,getters:t,rootState:n},i){return actions_components_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){const e=t.components;if(e.length>0)return e}try{const{data:i}=yield xn().get(`${n.config.apiPath()}cards/components`);return e(_o,i),t.components}catch(e){(0,Fn.UZ)(e)}}))}fetchComponentVersion({rootState:e,getters:t},n){return actions_components_awaiter(this,void 0,void 0,(function*(){const i=t.getComponentVersion(n);if(!n.id)return i;if(!n.fromRemote&&i.data)return i;try{const{code:t,id:i}=n,{data:o}=yield xn().get(`${e.config.apiPath()}cards/components/${t}/versions/${i}`);return o}catch(e){(0,Fn.UZ)(e)}}))}createComponent({commit:e,getters:t,rootState:n},i){return actions_components_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().post(`${n.config.apiPath()}cards/components`,i);return e(bo,t),new Ne.$Q({value:t})}catch(e){const t=new Ne.yr(`Ошибка создания общего элемента: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}updateComponent({commit:e,getters:t,rootState:n},{component:i}){return actions_components_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().put(`${n.config.apiPath()}cards/components/${i.code}`,i);return e(Co,t),new Ne.$Q({value:t})}catch(e){const t=new Ne.yr(`Ошибка обновления общего элемента: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}deleteComponent({commit:e,getters:t,rootState:n},i){return actions_components_awaiter(this,void 0,void 0,(function*(){try{return yield xn().delete(`${n.config.apiPath()}cards/components/${i.code}`),e(wo,i.code),new Ne.$Q({value:!0})}catch(e){const t=new Ne.yr(`Ошибка удаления общего элемента: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}createComponentVersion({commit:e,getters:t,rootState:n,dispatch:i},o){var{code:s}=o,r=__rest(o,["code"]);return actions_components_awaiter(this,void 0,void 0,(function*(){try{const{data:o}=yield xn().post(`${n.config.apiPath()}cards/components/${s}/versions`,Object.assign(Object.assign({},r),{data:JSON.stringify(r.data)}));e(xo,o);const{component:a,versions:l}=t.getComponentByCode(o.code);return 1===l.length&&(yield i("updateComponent",new yo.MT(Object.assign(Object.assign({},a),{actualId:o.id})))),new Ne.$Q({value:o})}catch(e){const t=new Ne.yr(`Ошибка создания версии общего элемента: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}updateComponentVersion({commit:e,rootState:t},n){var{id:i,code:o}=n,s=__rest(n,["id","code"]);return actions_components_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().put(`${t.config.apiPath()}cards/components/${o}/versions/${i}`,Object.assign(Object.assign({},s),{data:JSON.stringify(s.data)}));return e(So,n),new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка обновления общего элемента: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}deleteComponentVersion({commit:e,rootState:t},n){return actions_components_awaiter(this,void 0,void 0,(function*(){try{const{id:i,code:o}=n.version;return yield xn().delete(`${t.config.apiPath()}cards/components/${o}/versions/${i}`),e(Io,n.version),new Ne.$Q({value:!0})}catch(e){const t=new Ne.yr(`Ошибка удаления общего элемента: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}unzipFiles({rootState:e},t){return actions_components_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}cards/components/import`,t.getFormData(),{headers:{"Content-Type":"multipart/form-data"}});return new Ne.$Q({value:n.map((({version:e})=>e))})}catch(e){const t=new Ne.yr(`Ошибка чтения файла: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}exportComponents({rootState:e},t){return actions_components_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}cards/components/export`,t.data,{responseType:"blob"});return new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка экспорта в файл: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}importComponents({rootState:e,commit:t},n){return actions_components_awaiter(this,void 0,void 0,(function*(){try{const{data:i}=yield xn().post(`${e.config.apiPath()}cards/components/list`,n.data);return t(_o,i),new Ne.$Q({value:i})}catch(e){const t=new Ne.yr(`Ошибка импорта из файла: ${e.message}`,e);return new Ne.$Q({value:e.data,error:t})}}))}}actions_components_Actions.namespace="components",actions_components_decorate([(0,Tn.Q)(vo.K,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,vo.K]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"fetchComponentList",null),actions_components_decorate([(0,Tn.Q)(vo.y,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,vo.y]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"fetchComponentVersion",null),actions_components_decorate([Commandable(yo.fG,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.fG]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"createComponent",null),actions_components_decorate([Commandable(yo.MT,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.MT]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"updateComponent",null),actions_components_decorate([Commandable(yo.l1,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.l1]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"deleteComponent",null),actions_components_decorate([Commandable(yo.QM,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.QM]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"createComponentVersion",null),actions_components_decorate([Commandable(yo.QQ,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.QQ]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"updateComponentVersion",null),actions_components_decorate([Commandable(yo.oc,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.oc]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"deleteComponentVersion",null),actions_components_decorate([Commandable(yo.$H,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.$H]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"unzipFiles",null),actions_components_decorate([Commandable(yo.Aq,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.Aq]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"exportComponents",null),actions_components_decorate([Commandable(yo.CF,actions_components_Actions.namespace),actions_components_metadata("design:type",Function),actions_components_metadata("design:paramtypes",[Object,yo.CF]),actions_components_metadata("design:returntype",Promise)],actions_components_Actions.prototype,"importComponents",null);class getters_components_Getters{constructor(){this.getComponentByCode=e=>t=>e.components.find((({component:e})=>e.code===t)),this.getComponentVersion=(e,t)=>({id:e,code:n})=>{const i=t.getComponentByCode(n);return i&&e?i.versions.find((({id:t})=>e===t)):{code:n}}}components(e){return e.components}versionBuffer(e){return e.versionBuffer}}const To={components:[],versionBuffer:null},Po=!0,Oo=toActionTree(new actions_components_Actions),ko=toDict(new getters_components_Getters),Fo={namespaced:Po,state:To,getters:ko,actions:Oo,mutations:Ro};var Ao=n(69927);const $o="SET_FOLDERS",jo="CLEAR_FOLDER",Eo="SET_MENU_ACTIONS",Mo="SET_REPORTS_LIST",No={[$o](e,t){e.folders=t,e.folderDict=(0,Qn.F)(t,"id")},[Eo](e,t){e.actions=t.items},[Mo](e,t){e.reports[t.folderId]=t.items},[jo](e,t){mutations_reports_clearFolder(e,t)}};function mutations_reports_clearFolder(e,t){t&&t.folderId?(e.reports[t.folderId]=null,e.actions[t.folderId]=null,e.reports=Object.assign({},e.reports)):e.reports={0:null}}var actions_reports_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_reports_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_reports_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Vo="reports";class actions_reports_Actions{fetchFolders({commit:e,state:t,rootState:n},i){return actions_reports_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote&&t.folders)return t.folders;try{const{data:t}=yield xn().get(`${n.config.apiPath()}fast-report/folder-tree`),i=t.map((e=>({id:e.id,name:e.name,parentId:e.parentId,kind:e.folderKind,topLevelFolderId:e.topLevelFolderId,type:e.type,comments:e.comments,creator:e.creator,createdDateTime:e.createdDateTime,isConsolidated:e.isConsolidated,nodeType:Tt.J.InstructionFolder,compositeId:null,contentType:Ue.zc.FastReport})));return e($o,i),i}catch(e){(0,Fn.UZ)(e)}}))}fetchReports({commit:e,rootState:t},n){return actions_reports_awaiter(this,void 0,void 0,(function*(){try{let i=`${t.config.apiPath()}fast-report/folder-tree/${n.folderId}/reports`;if((n.skip||n.take||n.order&&n.order.length>0||n.where&&n.where.length>0)&&(i+="?"),n.skip&&(i+=encodeURI(`skip=${n.skip}`)),n.take&&(i+=encodeURI(`take=${n.take}`)),n.order)for(const e of n.order)i+=encodeURI(`order=${e}`);if(n.where)for(const e of n.where)i+=encodeURI(`where=${e}`);const{data:o}=yield xn().get(i),s={items:[],totalCount:o.length};return Array.isArray(o)&&o.forEach((e=>{var t,n,i;e.fastReportInfo&&(e.fastReportInfo.id=e.fastReportInfo.uid),e.id=null!==(n=null===(t=e.fastReportTaskInfo)||void 0===t?void 0:t.taskId)&&void 0!==n?n:null===(i=e.fastReportInfo)||void 0===i?void 0:i.uid,s.items.push(e)})),e(Mo,{folderId:n.folderId,items:s}),s}catch(e){(0,Fn.UZ)(e)}}))}fetchLastParams({rootState:e},t){return actions_reports_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}fast-report/report/${t.id}/last-params`);return n}catch(e){(0,Fn.UZ)(e)}}))}fetchReportTask({rootState:e},t){var n,i,o;return actions_reports_awaiter(this,void 0,void 0,(function*(){try{const{data:s}=yield xn().get(`${e.config.apiPath()}fast-report/task/${t.id}`);return s.fastReportInfo&&(s.fastReportInfo.id=s.fastReportInfo.uid),s.id=null!==(i=null===(n=s.fastReportTaskInfo)||void 0===n?void 0:n.taskId)&&void 0!==i?i:null===(o=s.fastReportInfo)||void 0===o?void 0:o.uid,s}catch(e){(0,Fn.UZ)(e)}}))}putReportTask({commit:e,getters:t,rootState:n},i){return actions_reports_awaiter(this,void 0,void 0,(function*(){try{const o=`${n.config.apiPath()}fast-report/task`,{data:s}=yield xn().put(o,i);return t.folderExist(2)&&e(jo,{folderId:2}),new Ne.$Q({value:s.taskId})}catch(e){return(0,Fn.WI)(e)}}))}attachResultToDoc({rootState:e},t){return actions_reports_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}fast-report/task/${t.taskId}/attach-to-document`;return yield xn().post(n,{documentId:t.documentId}),new Ne.$Q({value:!0})}catch(e){return new Ne.$Q({error:e})}}))}}actions_reports_decorate([(0,Tn.Q)($t.qN,Vo),actions_reports_metadata("design:type",Function),actions_reports_metadata("design:paramtypes",[Object,$t.qN]),actions_reports_metadata("design:returntype",Promise)],actions_reports_Actions.prototype,"fetchFolders",null),actions_reports_decorate([(0,Tn.Q)($t.K$,Vo),actions_reports_metadata("design:type",Function),actions_reports_metadata("design:paramtypes",[Object,$t.K$]),actions_reports_metadata("design:returntype",Promise)],actions_reports_Actions.prototype,"fetchReports",null),actions_reports_decorate([(0,Tn.Q)($t.CQ,Vo),actions_reports_metadata("design:type",Function),actions_reports_metadata("design:paramtypes",[Object,$t.CQ]),actions_reports_metadata("design:returntype",Promise)],actions_reports_Actions.prototype,"fetchLastParams",null),actions_reports_decorate([(0,Tn.Q)($t._R,Vo),actions_reports_metadata("design:type",Function),actions_reports_metadata("design:paramtypes",[Object,$t._R]),actions_reports_metadata("design:returntype",Promise)],actions_reports_Actions.prototype,"fetchReportTask",null),actions_reports_decorate([Commandable(Ao.c,Vo),actions_reports_metadata("design:type",Function),actions_reports_metadata("design:paramtypes",[Object,Ao.c]),actions_reports_metadata("design:returntype",Promise)],actions_reports_Actions.prototype,"putReportTask",null),actions_reports_decorate([Commandable(Ao.w,Vo),actions_reports_metadata("design:type",Function),actions_reports_metadata("design:paramtypes",[Object,Ao.w]),actions_reports_metadata("design:returntype",Promise)],actions_reports_Actions.prototype,"attachResultToDoc",null);class getters_reports_Getters{constructor(){this.getReportsFolder=e=>t=>e.folderDict[t]?e.folderDict[t]:null,this.folderExist=e=>t=>!(null===e.reports[t]||!e.reports[t])}getReportsFolders(e){return e.folderDict}getReports(e){return e.reports}}const Bo=!0,Lo=toActionTree(new actions_reports_Actions),Uo=toDict(new getters_reports_Getters),Ho=resetReportsState(),Qo={namespaced:Bo,state:Ho,getters:Uo,actions:Lo,mutations:No};function resetReportsState(){return{folderDict:{0:null},reports:{0:null},folders:null,actions:null}}function effectiveUserId(e){return e.deputyUserId||e.id}function effectiveUserName(e){return e.deputyUserId?e.deputyUserName:e.name}var zo=n(66860);const Zo="SET_USER_SETTINGS",Wo="SET_PUBLIC_SETTINGS",qo="SET_ADMIN_SETTINGS",Go="SET_COLUMN_TEMPLATES",Ko="SET_SIDEBAR_SETTINGS",Yo="SET_CONTENT_SETTINGS",Jo="SET_TABLE_SETTINGS",Xo="SET_SORT_SETTINGS",es="SET_VIEW_STATE",ts="SET_FOLDER_SETTINGS",ns="SET_FOLDERS",os={[Zo](e,t){e.userSettings=t,t&&o().set(e.userSettings,"instrUseCache",!0)},[ts](e,t){Object.keys(t).forEach((n=>{const i=e.userSettings[n];if(i){const e=t[n];"number"===typeof e?o().set(i,n,e):Object.keys(e).forEach((t=>{o().set(i,t,e[Number(t)])}))}else o().set(e.userSettings,n,t)}))},[Wo](e,t){e.publicSettings=t},[qo](e,t){"msgExecDateUnlimited"in t||o().set(t,"msgExecDateUnlimited",!1),t.journalsColumnSettings&&Object.keys(t.journalsColumnSettings).forEach((e=>{t.journalsColumnSettings[Number(e)]=t.journalsColumnSettings[Number(e)].filter((e=>e.caption))})),e.adminSettings=t},[Go](e,t){e.columnTemplates=t},[Ko](e,t){e.sidebarSettings=t},[Yo](e,t){e.contentSettings.setValue(t.query,t.settings)},[Jo](e,t){e.tableSettings.setValue(t.query,t.settings)},[Xo](e,t){e.sortSetting.setValue(t.query,t.settings)},[es](e,t){e.viewState[t.key]=t.data},[ns](e,t){e.folders=t}},ss="SET_AUTH_STATE",rs="SET_AUTH_DATA",as={[ss](e,t){e.loggedIn=t},[rs](e,t){e.authData=t}};var actions_auth_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_auth_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_auth_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const ls="auth",cs="settings";class actions_auth_Actions{init(){}fetchCurrentuser({commit:e,getters:t,rootState:n},i){return actions_auth_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote&&t.isAuthenticated)return n.currentUser;const{data:o}=yield xn().get(`${n.config.apiPath()}me`),s=Object.assign(Object.assign({},o),{effectiveName:effectiveUserName(o),effectiveId:effectiveUserId(o)});return e(On.uC,s,{root:!0}),s}))}logIn({commit:e,getters:t,dispatch:n,rootState:i,state:o},s){return actions_auth_awaiter(this,void 0,void 0,(function*(){if(t.isAuthenticated&&o.authData&&o.authData.currentUser){const e=yield n("validate",o.authData.currentUser.name);if(e)return o.authData}const r={headers:{Authorization:"Basic "+btoa(s.username+":"+s.password)}},{data:a}=yield xn().get(`${i.config.apiPath()}auth/basic`,r);if(!a.currentUser){const e=[];e.push(xn().get(`${i.config.apiPath()}me`)),e.push(xn().get(`${i.config.apiPath()}me/settings`));const t=yield Promise.all(e);a.currentUser=t[0].data,a.userSettings=t[1].data}return commitResult(e,a),a}))}logInWin({commit:e,state:t,dispatch:n,getters:i,rootState:o},s){return actions_auth_awaiter(this,void 0,void 0,(function*(){if(i.isAuthenticated&&t.authData&&t.authData.currentUser){const e=yield n("validate",t.authData.currentUser.name);if(e)return t.authData}const{data:s}=yield xn().get(`${o.config.apiPath()}auth/ntlm`);if(!s.currentUser){const e=[];e.push(xn().get(`${o.config.apiPath()}me`)),e.push(xn().get(`${o.config.apiPath()}me/settings`));const t=yield Promise.all(e);s.currentUser=t[0].data,s.userSettings=t[1].data}return commitResult(e,s),s}))}logInCert({commit:e,state:t,dispatch:n,getters:i,rootState:o},s){return actions_auth_awaiter(this,void 0,void 0,(function*(){if(i.isAuthenticated&&t.authData&&t.authData.currentUser){const e=yield n("validate",t.authData.currentUser.name);if(e)return t.authData}const{data:s}=yield xn().get(`${o.config.apiPath()}auth/cert`);if(!s.currentUser){const e=[];e.push(xn().get(`${o.config.apiPath()}me`)),e.push(xn().get(`${o.config.apiPath()}me/settings`));const t=yield Promise.all(e);s.currentUser=t[0].data,s.userSettings=t[1].data}return commitResult(e,s),s}))}logged({commit:e},{authData:t}){commitResult(e,t)}logOut({commit:e,rootState:t},n){return actions_auth_awaiter(this,void 0,void 0,(function*(){try{commitResult(e,null);const n=`${t.config.apiPath()}unauth`;yield xn().get(n).then((e=>e.data))}catch(e){}finally{Mr()}}))}checkUser({rootState:e},t){return actions_auth_awaiter(this,void 0,void 0,(function*(){const{data:n}=yield xn().get(`${e.config.apiPath()}auth/check`,{params:{userName:t.username}});return n}))}validate({dispatch:e,getters:t},n){return t.isAuthenticated?e("checkUser",new zo.fu(n)):Promise.resolve(!1)}pingUser({rootState:e}){return actions_auth_awaiter(this,void 0,void 0,(function*(){try{yield xn().get(`${e.config.apiPath()}proxy/ping`)}catch(e){}}))}}function commitResult(e,t){t&&t.currentUser&&(t.currentUser.effectiveName=effectiveUserName(t.currentUser),t.currentUser.effectiveId=effectiveUserId(t.currentUser)),e(`${ls}/${rs}`,t,{root:!0}),e(On.uC,t?t.currentUser:null,{root:!0}),e(`${cs}/${Zo}`,t?t.userSettings:null,{root:!0})}actions_auth_decorate([(0,Tn.Q)(Ze.by,ls),actions_auth_metadata("design:type",Function),actions_auth_metadata("design:paramtypes",[Object,Ze.by]),actions_auth_metadata("design:returntype",Promise)],actions_auth_Actions.prototype,"fetchCurrentuser",null),actions_auth_decorate([(0,Tn.Q)(zo.iA,ls),actions_auth_metadata("design:type",Function),actions_auth_metadata("design:paramtypes",[Object,zo.iA]),actions_auth_metadata("design:returntype",Promise)],actions_auth_Actions.prototype,"logIn",null),actions_auth_decorate([(0,Tn.Q)(zo.U2,ls),actions_auth_metadata("design:type",Function),actions_auth_metadata("design:paramtypes",[Object,zo.U2]),actions_auth_metadata("design:returntype",Promise)],actions_auth_Actions.prototype,"logInWin",null),actions_auth_decorate([(0,Tn.Q)(zo.Lv,ls),actions_auth_metadata("design:type",Function),actions_auth_metadata("design:paramtypes",[Object,zo.Lv]),actions_auth_metadata("design:returntype",Promise)],actions_auth_Actions.prototype,"logInCert",null),actions_auth_decorate([(0,Tn.Q)(zo.RU,ls),actions_auth_metadata("design:type",Function),actions_auth_metadata("design:paramtypes",[Object,zo.RU]),actions_auth_metadata("design:returntype",Promise)],actions_auth_Actions.prototype,"logOut",null),actions_auth_decorate([(0,Tn.Q)(zo.fu,ls),actions_auth_metadata("design:type",Function),actions_auth_metadata("design:paramtypes",[Object,zo.fu]),actions_auth_metadata("design:returntype",Promise)],actions_auth_Actions.prototype,"checkUser",null),actions_auth_decorate([(0,Tn.Q)(zo.SE,ls),actions_auth_metadata("design:type",Function),actions_auth_metadata("design:paramtypes",[Object]),actions_auth_metadata("design:returntype",Promise)],actions_auth_Actions.prototype,"pingUser",null);class getters_auth_Getters{isAuthenticated(e,t,n){const{currentUser:i}=n;return Boolean(i)}lastVisitedUrl(e){return e.authData?e.authData.lastVisitedUrl:null}isFirstStart(e){return!!e.authData&&e.authData.isFirstStart}getIdleTimeout(e){return e.authData?String(e.authData.sendTimeout):null}}const ds=!0,us=toActionTree(new actions_auth_Actions),ps={authData:null,loggedIn:!1},hs=toDict(new getters_auth_Getters),ms={namespaced:ds,state:ps,getters:hs,actions:us,mutations:as};var fs=n(16273);const gs="SET_DOC_FOLDERS",ys="SET_SHORTCUT_FOLDERS",vs="SET_DOC",bs="SET_DOC_ATTR",Cs="SET_DOCS_LIST",ws="SET_METADATA",_s="SET_NEW_DOC_PARAMS",xs="SET_MENU_ACTIONS",Ss="RESET_ACTIONS",Is="UPDATE_ACTIONS",Ds="CLEAR_FOLDER",Rs="REMOVE_FROM_FOLDER",Ts="REMOVE_ARCHIVE_DOC",Ps="SET_BUSINESS_OBJ",Os="SET_JOURNALS",ks="SET_JOURNAL",Fs="SET_DOC_READED",As="ADD_TO_FAV",$s="REMOVE_FROM_FAV",js="UPDATE_DOC_FILES",Es=1,Ms=10,Ns={[gs](e,t){e.folders=t,e.folderDict=(0,Qn.F)(t,"id")},[As](e,t){const n=e.folders.find((e=>e.id===t&&e.topLevelFolderId===Es));n.isFavourite=!0;const i=Object.assign(Object.assign({},n),{parentId:Ms,__originalParent:Ms,topLevelFolderId:Ms,topLevelParentId:Ms});e.folders.push(i),e.folderDict=(0,Qn.F)(e.folders,"id")},[$s](e,t){const n=e.folders.findIndex((e=>e.id===t&&e.topLevelFolderId===Ms));n>=0&&e.folders.splice(n,1);const i=e.folders.find((e=>e.id===t&&e.topLevelFolderId===Es));i.isFavourite=!1,e.folderDict=(0,Qn.F)(e.folders,"id")},[ys](e,t){e.shortcutFolders=t},[Cs](e,t){t.list.readDateTime=new Date,t.list.filtered=t.isFilterApplied,t.isArchive?e.archiveDocs[t.journalId]=null===t||void 0===t?void 0:t.list:e.docs[t.journalId]=null===t||void 0===t?void 0:t.list,mutations_documents_setActionsEnabled(e,null===t||void 0===t?void 0:t.journalId),t.list.items.forEach(((n,i)=>{n.id===t.activeDocumentId&&e.documents[t.activeDocumentId]&&(t.list.items[i]=e.documents[t.activeDocumentId]),e.documents[n.id]&&n.id!==t.activeDocumentId&&(o().set(e.documents,n.id,null),delete e.documents[n.id])}))},[ws](e,t){e.metadata[t.name]=t.data},[_s](e,t){e.newDocsParams[t.journalId]=t.data},[xs](e,t){let n=e.actions[t.journalId];n||(n={},e.actions[t.journalId]=n),n[t.id]=t.items},[Ss](e,t){mutations_documents_setActionsEnabled(e,t)},[Is](e,t){mutations_documents_updateActions(e,t.folderId,t.id,t.status,t.disabledItems,t.loadingItems)},[Ds](e,t){e.docs[t]=null,e.archiveDocs[t]=null,e.actions[t]=null,e.actions=Object.assign({},e.actions),e.docs=Object.assign({},e.docs),e.archiveDocs=Object.assign({},e.archiveDocs)},[Rs](e,t){mutations_documents_removeFromFolder(e,t.journalId,t.id)},[Ts](e,t){removeArchiveDoc(e,t.journalId,t.id)},[Fs](e,t){let n=e.documents[t.id];n?(n.viewFlag=t.readed,n.attributes.viewFlag=t.readed):[e.docs,e.archiveDocs].forEach((e=>{var i;const o=Object.keys(e);for(const s of o){const o=e[Number(s)],r=null===(i=null===o||void 0===o?void 0:o.items)||void 0===i?void 0:i.findIndex((e=>e.id===t.id));r>=0&&(n=o.items[r],n.viewFlag=t.readed,n.attributes.viewFlag=t.readed)}}))},[bs](e,t){const n=e.documents[t.id];n&&Object.keys(t.attributes).forEach((e=>{n.attributes[e]=t.attributes[e]}))},[vs](e,t){var n,i;if(!t||!t.item)return;t.metadata&&setAttrTypesForDocument(t.item,t.metadata),setDocToState(e,t.item);const s=null!==(n=t.journalId)&&void 0!==n?n:null===(i=t.item)||void 0===i?void 0:i.journalID,r=e.docs[s]||e.archiveDocs[s];if(!r)return;const a=r.items.findIndex((e=>e.id===t.item.id));a>=0&&o().set(r.items,a,t.item)},[Ps](e,t){e.businessObjects[t.id]=t.data},[Os](e,t){e.journalsByTypes[t.journalType]=t.data,e.journals||(e.journals={}),Array.isArray(t.data)&&t.data.forEach((t=>{e.journals[t.id]=t}))},[ks](e,t){e.journals[t.id]=t},[js](e,t){var n,i;let o=e.documents[null===(n=null===t||void 0===t?void 0:t.document)||void 0===n?void 0:n.id];if(!o){const n=null===(i=null===t||void 0===t?void 0:t.document)||void 0===i?void 0:i.journalID,s=e.docs[n];if(s){const e=s.items.findIndex((e=>e.id===t.document.id));e>-1&&(o=s.items[e])}}o&&(o.files=t.files)}};function mutations_documents_setActionsEnabled(e,t){const n=e.actions[t];n&&Object.keys(n).forEach((e=>{const t=n[Number(e)];(t||[]).forEach((e=>{e.disabled=!1,e.loading=!1}))}))}function mutations_documents_updateActions(e,t,n,i,o,s){const r=e.actions[t];if(!r)return;const a=r[n];Array.isArray(a)&&a.forEach((e=>{if(Array.isArray(o)){const t=o.find((t=>t===e.actionInfo.id));t&&(e.disabled=i)}if(Array.isArray(s)){const t=s.find((t=>t===e.actionInfo.id));t&&(e.loading=i)}}))}function mutations_documents_removeFromFolder(e,t,n){mutations_documents_removeFrom(e,"docs",t,n),mutations_documents_removeFrom(e,"filtered",t,n),delete e.documents[n],e.documents=Object.assign({},e.documents)}function removeArchiveDoc(e,t,n){mutations_documents_removeFrom(e,"archiveDocs",t,n)}function mutations_documents_removeFrom(e,t,n,i){const o=e[t][n];if(o){const s=o.items.findIndex((e=>e.id===i));if(s>=0){const r=o.items.splice(s,1);o.totalCount=o.items.length,e[t]=Object.assign({},e[t]),e.lastRemovedItem={folderId:n,id:i,index:s,item:r[0]}}}}function setDocToState(e,t){t&&(t.readDateTime=new Date,delete e.documents[t.id],o().set(e.documents,t.id,t))}var actions_documents_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_documents_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_documents_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Vs="documents",Bs=5;class actions_documents_Actions{init({state:e,commit:t}){}fetchFolders({commit:e,getters:t,rootState:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){const e=t.getFolders(i.withDepartments);if(Array.isArray(e))return e}const{data:o}=yield xn().get(`${n.config.apiPath()}folders/tree`);if(o&&o.items){const e=[9],t=[],i=[];o.items.forEach((n=>{e.includes(n.id)||e.includes(n.parentId)||(n.contentType=Ue.zc.Document,n.topLevelFolderId=n.topLevelParentId,n.__originalParent=n.parentId,t.push(n),1===n.parentId&&(i.push(Object.assign(Object.assign({},n),{archive:!0})),n.canBeFavorite=!0),10===n.parentId&&10!==n.topLevelFolderId&&(n.topLevelFolderId=10,n.topLevelParentId=10),!n.canBeFavorite&&n.isFavourite&&(n.canBeFavorite=!0))})),o.items=t,n.docArchiveResolve(i)}return e(gs,null===o||void 0===o?void 0:o.items),t.getFolders(i.withDepartments)}))}fetchJournalsList({commit:e,getters:t,rootState:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{return yield promisifyFetch2(i,(t=>{e(Os,{journalType:i.journalType,data:t})}),(()=>t.getJournals(i.journalType)),(()=>actions_documents_awaiter(this,void 0,void 0,(function*(){const{data:e}=yield xn().post(`${n.config.apiPath()}journals/list`,i);return e.items}))),(t=>e(Os,{journalType:i.journalType,data:t})))}catch(e){(0,Fn.UZ)(e)}}))}getSingleJournal({rootState:e,state:t,commit:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{return yield promisifyFetch2(i,(e=>{t.journals||(t.journals={}),t.journals[i.id]=e}),(()=>{const e=t.journals?t.journals[i.id]:null;return e||null}),(()=>xn().get(`${e.config.apiPath()}journals/${i.id}`)),(e=>n(ks,e)))}catch(e){(0,Fn.UZ)(e)}}))}fetchDocumentRights({dispatch:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){let n=null;try{n=yield e("fetchRights",{objectIds:[t.journalId],fromRemote:t.fromRemote},{root:!0})}catch(e){}let i=null;if(t.folderType===Tt.J.Journal)try{i=yield e("getSingleJournal",{id:t.journalId,fromRemote:t.fromRemote})}catch(e){}let o=[];return n&&Array.isArray(n[t.journalId])&&(o=o.concat(n[t.journalId])),i&&Array.isArray(i.rights)&&i.rights.forEach((e=>{o.includes(e)||o.push(e)})),o}))}fetchDocumentOperations({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){const{data:n}=yield xn().get(`${e.config.apiPath()}document/${t.id}/docoperations`);return n}))}fetchDocuments({commit:e,state:t,rootState:n,dispatch:i},o){return actions_documents_awaiter(this,void 0,void 0,(function*(){if(!o.fromRemote&&!o.listInfo.searchText&&!o.listInfo.filter){if(!o.archive&&t.docs[o.journalId]&&!t.docs[o.journalId].filtered)return t.docs[o.journalId];if(o.archive&&t.archiveDocs[o.journalId]&&!t.archiveDocs[o.journalId].filtered)return t.archiveDocs[o.journalId]}try{const{data:t}=yield xn().post(`${n.config.apiPath()}journals/${o.journalId}/documents`,o,{cancelable:o.cancelable}),s={items:t.items,totalCount:t.totalCount};if(Array.isArray(s.items)&&s.items.length){const e=yield i("fetchDocumentMetadata",{name:s.items[0].type});setAttrTypes(s.items,e)}return o.isTemp||e(Cs,{journalId:o.journalId,list:s,activeDocumentId:n.activeDocumentId||n.previewDocumentId,isArchive:o.archive,isFilterApplied:o.listInfo.searchText||o.listInfo.filter}),s}catch(e){(0,Fn.UZ)(e)}}))}fetchFolderDocuments({commit:e,state:t,rootState:n,dispatch:i},o){return actions_documents_awaiter(this,void 0,void 0,(function*(){if(!o.fromRemote&&t.docs[o.folderId])return t.docs[o.folderId];try{const{data:t}=yield xn().get(`${n.config.apiPath()}folders/${o.folderId}/documents`),s=[];if(t&&t.items)for(const e of t.items){const t=yield i("fetchDocumentMetadata",{name:e.document.type});setAttrTypesForDocument(e.document,t),s.push(Object.assign(Object.assign(Object.assign({},e.document),e),{attributes:Object.assign(Object.assign({},e.attributes),e.document.attributes),folderId:o.folderId}))}const r={items:s,totalCount:t.totalCount};return o.isTemp||e(Cs,{journalId:o.folderId,list:r,activeDocumentId:n.activeDocumentId||n.previewDocumentId}),r}catch(e){(0,Fn.UZ)(e)}}))}fetchDocument({commit:e,getters:t,dispatch:n,state:i,rootState:o},s){var r,a,l;return actions_documents_awaiter(this,void 0,void 0,(function*(){if(!s.fromRemote){let e=t.getDocument(s.documentId,s.mode);if(e){const t=i.docs[e.journalID];(null===(r=null===t||void 0===t?void 0:t.readDateTime)||void 0===r?void 0:r.getTime())>(null===(a=null===e||void 0===e?void 0:e.readDateTime)||void 0===a?void 0:a.getTime())&&(e=null)}if(e&&e.fullyRead)return e}try{const{data:i}=yield xn().get(`${o.config.apiPath()}document/${s.documentId||0}`);i.fullyRead=!0,i.archive=(null===(l=i.attributes)||void 0===l?void 0:l.State)===Bs;const r=yield n("fetchDocumentMetadata",{name:i.type});return e(vs,{journalId:s.journalId?s.journalId:i.journalID,item:i,metadata:r}),t.getDocument(s.documentId,s.mode)}catch(e){(0,Fn.UZ)(e)}}))}fetchNewDocumentParams({commit:e,state:t,rootState:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){const e=t.newDocsParams[i.journalId];if(e)return e}try{const{data:t}=yield xn().post(`${n.config.apiPath()}document/new-document-params`,i);return e(_s,{journalId:i.journalId,data:t}),t}catch(e){(0,Fn.UZ)(e)}}))}fetchDocumentFiles({commit:e,state:t,rootState:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().get(`${n.config.apiPath()}document/${i.documentId||0}/files`,{params:{cardId:i.cardId},canceler:i.cancelable?{id:Ae.M.DocumentFilesQuery}:null});return e}catch(e){(0,Fn.UZ)(e)}}))}fetchDocInstructionsTree({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}document/${t.docId||0}/instructions`,{params:{withDeleted:t.withDeleted},canceler:t.cancelable?{id:Ae.M.DocumentInstructionsQuery,uid:t.uid}:null});return n}catch(e){(0,Fn.UZ)(e)}}))}fetchDocumentMetadata({state:e,rootState:t,commit:n,getters:i},o){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{return yield promisifyFetch2(o,(e=>n(ws,{name:o.name,data:e})),(()=>e.metadata[o.name]),(()=>xn().get(`${t.config.apiPath()}dictionary/metadata`,{params:{key:o.name}})),(e=>e?(n(ws,{name:o.name,data:e}),i.getMetadata(o.name)):(n(ws,{name:o.name,data:null}),null)))}catch(e){(0,Fn.UZ)(e)}}))}fetchObjects({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}proxy/objects`,{params:t});return n}catch(e){(0,Fn.UZ)(e)}}))}fetchDocOperations({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}document/${t.id}/operations`);return n}catch(e){(0,Fn.UZ)(e)}}))}fetchDocFolders({rootState:e,state:t,commit:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote&&t.shortcutFolders)return[...t.shortcutFolders];const{data:o}=yield xn().get(`${e.config.apiPath()}folders`);return n(ys,o),o}))}fetchDocChainsheaves({rootState:e,commit:t,getters:n,dispatch:i},o){var s,r,a;return actions_documents_awaiter(this,void 0,void 0,(function*(){const{data:l}=yield xn().get(`${e.config.apiPath()}document/${o.id}/chainsheaves`,{params:{chainsheafs:o.chainsheafs}});if(Array.isArray(null===l||void 0===l?void 0:l.chainSheafDocuments)){for(const e of l.chainSheafDocuments)if(e.document&&e.document.id!==o.id){const o=n.getDocument(e.document.id,Ue.dS.View);if(o)e.document=o;else{e.document.archive=(null===(s=e.document.attributes)||void 0===s?void 0:s.State)===Bs;const o=yield i("fetchDocumentMetadata",{name:e.document.type});t(vs,{journalId:e.document.journalID,item:e.document,metadata:o}),e.document=n.getDocument(e.document.id,Ue.dS.View)}}for(const e of l.childDocuments)if(e.document&&e.document.id!==o.id){const o=n.getDocument(e.document.id,Ue.dS.View);if(o)e.document=o;else{e.document.archive=(null===(r=e.document.attributes)||void 0===r?void 0:r.State)===Bs;const o=yield i("fetchDocumentMetadata",{name:e.document.type});t(vs,{journalId:e.document.journalID,item:e.document,metadata:o}),e.document=n.getDocument(e.document.id,Ue.dS.View)}}for(const e of l.parentDocuments)if(e.document&&e.document.id!==o.id){const o=n.getDocument(e.document.id,Ue.dS.View);if(o)e.document=o;else{e.document.archive=(null===(a=e.document.attributes)||void 0===a?void 0:a.State)===Bs;const o=yield i("fetchDocumentMetadata",{name:e.document.type});t(vs,{journalId:e.document.journalID,item:e.document,metadata:o}),e.document=n.getDocument(e.document.id,Ue.dS.View)}}}return l}))}fetchChainsheavesTypes({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}documents/sheaftypes`);return t}catch(e){(0,Fn.UZ)(e)}}))}fetchdDocumentSearch({commit:e,state:t,rootState:n,dispatch:i},o){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().post(`${n.config.apiPath()}documents`,o,{cancelable:o.cancelable}),s={items:t.items,totalCount:t.totalCount};if(Array.isArray(s.items)&&s.items.length){const e=yield i("fetchDocumentMetadata",{name:s.items[0].type});setAttrTypes(s.items,e)}return o.isTemp||e(Cs,{journalId:o.folderId,list:s,activeDocumentId:n.activeDocumentId||n.previewDocumentId}),s}catch(e){(0,Fn.UZ)(e)}}))}fetchBusinessObject({rootState:e,state:t,commit:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{return yield promisifyFetch2(i,(e=>{t.businessObjects[i.id]=e}),(()=>t.businessObjects[i.id]),(()=>xn().get(`${e.config.apiPath()}proxy/businessobject/${i.id}/structure`)),(e=>n(Ps,{id:i.id,data:e})))}catch(e){(0,Fn.UZ)(e)}}))}documentSave({rootState:e,commit:t,getters:n,dispatch:i},o){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{let s;if(o.id){const t=`${e.config.apiPath()}document/${o.id}`;s=yield xn().put(t,o)}else{const t=`${e.config.apiPath()}document`;s=yield xn().post(t,o)}let r=null===s||void 0===s?void 0:s.data;if(!r||!r.attributes)return new Ne.$Q({error:new Ne.yr("Запрос не вернул сохранённый документ")});r.fullyRead=!0,r.__saved=!0;const a=yield i("fetchDocumentMetadata",{name:r.type});return t(vs,{journalId:o.journalId,item:r,metadata:a}),r=n.getDocument(r.id,o.mode),new Ne.$Q({value:r})}catch(e){return(0,Fn._o)(e)}}))}documentPartialSave({rootState:e,commit:t,getters:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{if(!i.id)throw new Error("Для команды DocumentPartialSaveCommand требуется id");const o=`${e.config.apiPath()}document/${i.id}`;yield xn().put(o,Object.assign(Object.assign({},i),{referencesToAdd:{},referencesToDelete:{}}));const s=n.getDocument(i.id,i.mode);return s&&(Object.keys(i.attributes).forEach((e=>{s.attributes[e]=i.attributes[e]})),t(vs,{journalId:s.journalID,item:s})),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}documentEdit({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}proxy/documents/${t.id}`;return yield xn().put(n,t.document),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}documentCreate({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}proxy/journals/${t.journalId}/documents`,i=yield xn().post(n,t.document);return new Ne.$Q({value:i.data})}catch(e){return(0,Fn._o)(e)}}))}ldObjectCreate({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}proxy/objects`,{data:i}=yield xn().post(n,{operationTypeId:0,objectType:t.objectName,Names:t.names,Values:t.values});return new Ne.$Q({value:i})}catch(e){return(0,Fn._o)(e)}}))}ldObjectDelete({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}proxy/objects/${t.objectName}/delete`;return yield xn().put(n,{Names:t.names,Values:t.values}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}ldObjectUpdate({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}proxy/objects/${t.objectId}`;return yield xn().post(n,{memberNames:t.names,memberValues:t.values}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}addFileCommand({rootState:e,dispatch:t},n){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{if(!n.file){const e=new Ne.yr("Ошибка загрузки файла: отсутствует file");return Promise.reject(new Ne.$Q({value:null,error:e}))}let i=n.name;if(!n.typeId){const e=yield t("files/fetchFileTypes",{},{root:!0}),o=(0,fs.mD)(n.file.name),s=e.find((e=>e.Extension.toLowerCase()===o));if(!s){const e=new Ne.yr(`Загрузка файла с расширением ${o} невозможна:  не найден тип файла`);return Promise.reject(new Ne.$Q({value:null,error:e}))}n.typeId=s.ID,i=i.replace(`.${o}`,"")}const toBase64=e=>new Promise(((t,n)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=()=>t(i.result.toString()),i.onerror=e=>n(e)}));let o=yield toBase64(n.file);o.includes(",")&&(o=o.split(",")[1]);const{data:s}=yield xn().post(`${e.config.apiPath()}proxy/documents/${n.docId}/files`,{name:i,typeId:n.typeId,content:o});return new Ne.$Q({value:s})}catch(e){const t=new Ne.yr(`Ошибка загрузки файлов: ${e.message}`,e);return Promise.reject(new Ne.$Q({value:e.data,error:t}))}}))}createShortcut({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}folders/shortcut`,t);return new Ne.$Q({value:n})}catch(e){const t=new Ne.yr(`Ошибка создания ярлыка: ${e.message}`,e);return Promise.reject(new Ne.$Q({value:e.data,error:t}))}}))}removeShortcut({rootState:e,commit:t},n){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const{data:i}=yield xn().delete(`${e.config.apiPath()}folders/shortcut/delete`,{data:n});return t(Rs,{id:n.documentId,journalId:n.folderId?n.folderId:0}),new Ne.$Q({value:i})}catch(e){const t=new Ne.yr(`Ошибка удаления ярлыка: ${e.message}`,e);return Promise.reject(new Ne.$Q({value:e.data,error:t}))}}))}setDocumentReadedCommand({commit:e,rootState:t},n){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const i=`${t.config.apiPath()}document/${n.id||0}/readed`;return yield xn().put(i,{IsReaded:!0}),e(Fs,{id:n.id,journalId:n.journalId,readed:!0}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}setDocumentUnreadedCommand({commit:e,rootState:t},n){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const i=`${t.config.apiPath()}document/${n.id||0}/readed`;return yield xn().put(i,{IsReaded:!1}),e(Fs,{id:n.id,journalId:n.journalId,readed:!1}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}deleteDocumentLogic({commit:e,rootState:t},n){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const i=`${t.config.apiPath()}document/${n.id||0}/logicaldelete`;return yield xn().put(i,{id:n.id}),e(Rs,{id:n.id,journalId:n.journalId?n.journalId:0}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}createSheafCommand({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{return yield xn().post(`${e.config.apiPath()}document/sheaf`,t),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}deleteSheafCommand({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{return yield xn().delete(`${e.config.apiPath()}document/sheaf/${t.id}`),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}copyFilesCommand({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{return yield xn().post(`${e.config.apiPath()}files/copy`,t),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}copyOperationsCommand({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{return yield xn().put(`${e.config.apiPath()}document/${t.recepientId}/copy-operations`,{sourceDocId:t.sourceDocId}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}archiveDoc({commit:e,rootState:t},n){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{if(!n.docId)throw new Error("ArchiveDocCommand - отсутствует id документа");return yield xn().put(`${t.config.apiPath()}document/${n.docId}/operations/archive`,{isArchive:n.isArchive}),e(n.isArchive?Rs:Ts,{id:n.docId,journalId:n.journalId}),new Ne.$Q({value:!0})}catch(e){return(0,Fn.og)(e)}}))}setJournalNumeration({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{yield xn().put(`${e.config.apiPath()}journals/${t.journalId}/numeration`,{number:t.currentNumber,year:t.year})}catch(e){return(0,Fn._o)(e)}}))}createNewDocumentFolder({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}folders`,{data:i}=yield xn().post(n,{parentID:t.parentID,name:t.name});return new Ne.$Q({value:i})}catch(e){return(0,Fn._o)(e)}}))}deleteDocumentFolder({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}folders/${t.folderId}`;return yield xn().delete(n),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}editNewDocumentFolder({rootState:e},t){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}folders/${t.folderId}`,{data:i}=yield xn().put(n,{parentId:t.parentID,name:t.name});return new Ne.$Q({value:i})}catch(e){return(0,Fn._o)(e)}}))}addToFavouriteFolder({rootState:e,commit:t,dispatch:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}journals/favourites`,{data:o}=yield xn().post(n,i);return t(As,i.journalId),new Ne.$Q({value:o})}catch(e){return(0,Fn._o)(e)}}))}removeFromFavouriteFolder({rootState:e,dispatch:t,commit:n},i){return actions_documents_awaiter(this,void 0,void 0,(function*(){try{const t=`${e.config.apiPath()}journals/favourites/${i.journalId}`,{data:o}=yield xn().delete(t);return n($s,i.journalId),new Ne.$Q({value:o})}catch(e){return(0,Fn._o)(e)}}))}}function setAttrTypes(e,t){if(Array.isArray(e)){if(!t)throw new Error(`Отсутствуют метаданные для документа ${e[0].type}`);e.forEach((e=>{setAttrTypesForDocument(e,t)}))}}function setAttrTypesForDocument(e,t){if(e){if(!t)throw new Error(`Отсутствуют метаданные для документа ${e.type}`);Object.keys(e.attributes).forEach((n=>{const i=t.attributes.find((e=>e.fieldName===n));if(i)switch(i.columnType){case Bn.cV.Date:case Bn.cV.DateTime:if(e.attributes[n]&&!(e.attributes[n]instanceof Date))try{e.attributes[n]=new Date(e.attributes[n])}catch(e){this.$log.error(e)}break;case Bn.cV.Number:e.attributes[n]&&"number"!==typeof e.attributes[n]&&(e.attributes[n]=Number(e.attributes[n]));break;default:break}}))}}actions_documents_decorate([(0,Tn.Q)(He.u9,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.u9]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchFolders",null),actions_documents_decorate([(0,Tn.Q)(He.PS,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.PS]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchJournalsList",null),actions_documents_decorate([(0,Tn.Q)(He.RF,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.RF]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"getSingleJournal",null),actions_documents_decorate([(0,Tn.Q)(He.Ml,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.Ml]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocumentRights",null),actions_documents_decorate([(0,Tn.Q)(He.k9,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.k9]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocumentOperations",null),actions_documents_decorate([(0,Tn.Q)(He.m$,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.m$]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocuments",null),actions_documents_decorate([(0,Tn.Q)(He.N8,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.N8]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchFolderDocuments",null),actions_documents_decorate([(0,Tn.Q)(He.U_,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.U_]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocument",null),actions_documents_decorate([(0,Tn.Q)(He.VX,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.VX]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchNewDocumentParams",null),actions_documents_decorate([(0,Tn.Q)(He.G4,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.G4]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocumentFiles",null),actions_documents_decorate([(0,Tn.Q)(He.kb,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.kb]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocInstructionsTree",null),actions_documents_decorate([(0,Tn.Q)(He.XS,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.XS]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocumentMetadata",null),actions_documents_decorate([(0,Tn.Q)(He.Ip,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.Ip]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchObjects",null),actions_documents_decorate([(0,Tn.Q)(He.LU,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.LU]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocOperations",null),actions_documents_decorate([(0,Tn.Q)(He.Zc,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.Zc]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocFolders",null),actions_documents_decorate([(0,Tn.Q)(He.Hx,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.Hx]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchDocChainsheaves",null),actions_documents_decorate([(0,Tn.Q)(He.hj,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.hj]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchChainsheavesTypes",null),actions_documents_decorate([(0,Tn.Q)(He.rP,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.rP]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchdDocumentSearch",null),actions_documents_decorate([(0,Tn.Q)(He.pV,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,He.pV]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"fetchBusinessObject",null),actions_documents_decorate([Commandable(Dt.Lt,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.Lt]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"documentSave",null),actions_documents_decorate([Commandable(Dt.WX,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.WX]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"documentPartialSave",null),actions_documents_decorate([Commandable(Dt.Ae,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.Ae]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"documentEdit",null),actions_documents_decorate([Commandable(Dt.p2,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.p2]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"documentCreate",null),actions_documents_decorate([Commandable(Dt.j2,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.j2]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"ldObjectCreate",null),actions_documents_decorate([Commandable(Dt.wp,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.wp]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"ldObjectDelete",null),actions_documents_decorate([Commandable(Dt.Ff,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.Ff]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"ldObjectUpdate",null),actions_documents_decorate([Commandable(Dt.gZ,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.gZ]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"addFileCommand",null),actions_documents_decorate([Commandable(Dt.ek,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.ek]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"createShortcut",null),actions_documents_decorate([Commandable(Dt.Qy,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.Qy]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"removeShortcut",null),actions_documents_decorate([Commandable(Dt.$6,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.$6]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"setDocumentReadedCommand",null),actions_documents_decorate([Commandable(Dt.ng,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.ng]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"setDocumentUnreadedCommand",null),actions_documents_decorate([Commandable(Dt.Yb,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.Yb]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"deleteDocumentLogic",null),actions_documents_decorate([Commandable(Dt.OH,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.OH]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"createSheafCommand",null),actions_documents_decorate([Commandable(Dt.CS,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.CS]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"deleteSheafCommand",null),actions_documents_decorate([Commandable(Dt.cS,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.cS]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"copyFilesCommand",null),actions_documents_decorate([Commandable(Dt.m3,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.m3]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"copyOperationsCommand",null),actions_documents_decorate([Commandable(Dt.eC,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.eC]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"archiveDoc",null),actions_documents_decorate([Commandable(Dt.b1,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.b1]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"setJournalNumeration",null),actions_documents_decorate([Commandable(Dt.DS,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.DS]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"createNewDocumentFolder",null),actions_documents_decorate([Commandable(Dt.eS,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.eS]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"deleteDocumentFolder",null),actions_documents_decorate([Commandable(Dt.YS,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.YS]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"editNewDocumentFolder",null),actions_documents_decorate([Commandable(Dt.Ml,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.Ml]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"addToFavouriteFolder",null),actions_documents_decorate([Commandable(Dt.Wl,Vs),actions_documents_metadata("design:type",Function),actions_documents_metadata("design:paramtypes",[Object,Dt.Wl]),actions_documents_metadata("design:returntype",Promise)],actions_documents_Actions.prototype,"removeFromFavouriteFolder",null);class getters_documents_Getters{constructor(){this.getDocumentFolder=e=>t=>(0,$n.Z)(e.folderDict[t]),this.getDocument=e=>(t,n)=>e.documents[t],this.getDocActionMenuItems=e=>(t,n)=>{const i=e.actions[t];return i?i[n]:null},this.getJournals=e=>t=>{var n;return null===(n=null===e||void 0===e?void 0:e.journalsByTypes[t])||void 0===n?void 0:n.sort((0,it.rR)("name"))},this.getMetadata=e=>t=>(0,$n.Z)(e.metadata[t]),this.getFolders=e=>(t=!1)=>processDocumentFolders(e.folders,t)}}const Ls={folders:null,shortcutFolders:null,folderDict:{0:null},docs:{0:null},archiveDocs:{0:null},documents:{},filtered:{0:null},metadata:{},actions:{0:null},newDocsParams:{},businessObjects:{},journals:{},journalsByTypes:{},lastRemovedItem:null},Us=!0,Hs=toActionTree(new actions_documents_Actions),Qs=toDict(new getters_documents_Getters),zs={namespaced:Us,state:Ls,getters:Qs,actions:Hs,mutations:Ns};class ComplexKeyDict{constructor(e){this.createKeyFunc=e,this._map=new Map}setValue(e,t){const n=this.createKeyFunc(e);this._map.set(n,t)}getValue(e){const t=this.createKeyFunc(e);return this._map.get(t)}}var Zs=n(50633),Ws=n(81086);function settingsFolders(e,t,n,i){let o=[{id:"user",name:"Настройки пользователя",parentId:"",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings}];if(t&&(null===n||void 0===n?void 0:n.monitor)){o.unshift({id:"monitor",name:"Мониторинг",parentId:"",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings});const e=Object.keys(n.monitor);e.forEach((e=>{"default"!==e&&o.push({id:e,name:e,parentId:"monitor",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings,baseUrl:"monitor"})}))}return e.id===e.effectiveId&&o.push({id:"user-instruction-folders",name:"Папки сообщений",parentId:"user",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"user-documents-folders",name:"Папки документов",parentId:"user",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"user-instruction-folder-rules",name:"Правила заполнения папок сообщений",parentId:"user",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"user-deputies",name:"Заместители",parentId:"user",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"user-reset-settings",name:"Сброс настроек",parentId:"user",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings}),e.isAdmin&&(o=o.concat(...adminSettingsFolder()),i&&(o=o.concat([{id:"development",name:"Элементы кастомизации",parentId:"",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"card-development",name:"Карточки",parentId:"development",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"component-development",name:"Общие элементы карточек",parentId:"development",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings}]))),o}function adminSettingsFolder(){return[{id:"admin",name:"Настройки администратора",parentId:"",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"instructions-folders-view",name:"Отображение папок сообщений",parentId:"admin",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"documents-view",name:"Отображение документов",parentId:"admin",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"cache",name:"Кэширование",parentId:"admin",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"vocabularies-cache",name:"Кэш справочников",parentId:"cache",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"default-message",name:"Поля по умолчанию",parentId:"admin",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings},{id:"repo",name:"Репозиторий",parentId:"admin",kind:Rt.Wy.Inbox,topLevelFolderId:"0",nodeType:Tt.J.SettingsFolder,compositeId:null,contentType:Ue.zc.Settings}]}var actions_settings_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_settings_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_settings_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const qs="DD.MM.YYYY",Gs="settings",Ks=270;class actions_settings_Actions{init({state:e,commit:t}){}fetchLastVisitedUrl({rootState:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){const{data:t}=yield xn().get(`${e.config.apiPath()}me/lasturl`);return t}))}fetchUserSettings({commit:e,state:t,rootState:n,getters:i},o){return actions_settings_awaiter(this,void 0,void 0,(function*(){if(!o.fromRemote&&t.userSettings)return i.userSettings;try{const{data:t}=yield xn().get(`${n.config.apiPath()}me/settings`);return t.journalsColumnSettings&&Object.keys(t.journalsColumnSettings).forEach((e=>{t.journalsColumnSettings[Number(e)]=t.journalsColumnSettings[Number(e)].filter((e=>e.caption))})),e(Zo,t),i.userSettings}catch(e){(0,Fn.UZ)(e)}}))}fetchFolders({rootState:e,dispatch:t,commit:n},i){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const o=yield t("fetchCommonManifest",new tt.Yf,{root:!0}),s=settingsFolders(i.currentUser,e.config.monitor,o,e.config.cardDevelop);return n(ns,s),Promise.resolve(s)}catch(e){(0,Fn.UZ)(e)}}))}fetchPublicSettings({commit:e,state:t,rootState:n,getters:i},o){return actions_settings_awaiter(this,void 0,void 0,(function*(){if(!o.fromRemote&&t.publicSettings)return i.publicSettings;try{const{data:t}=yield xn().get(`${n.config.apiPath()}publicSettings`);return e(Wo,t),i.publicSettings}catch(e){(0,Fn.UZ)(e)}}))}fetchAdminSettings({commit:e,state:t,getters:n,rootState:i},o){return actions_settings_awaiter(this,void 0,void 0,(function*(){if(!o.fromRemote&&t.adminSettings)return n.adminSettings;try{const{data:t}=yield xn().get(`${i.config.apiPath()}admin/settings`);return e(qo,t),n.adminSettings}catch(e){(0,Fn.UZ)(e)}}))}fetchTopLevelAdminSettings({dispatch:e},t){var n;return actions_settings_awaiter(this,void 0,void 0,(function*(){const i=yield e("fetchAdminSettings",t),o={topLevelParentId:t.topLevelParentId,useTaskFunctionality:i.useTaskFunctionality,columnSettings:null,sortSettings:null,multipleSorting:null};let s,r;switch(t.contentType){case Ue.zc.Instruction:s=i.foldersColumnSettings,r=i.foldersSortSettings;break;case Ue.zc.Document:s=i.journalsColumnSettings,r=i.journalsSortSettings;break;default:throw new Error(`Not implemented ${t.contentType.toString()}`)}const a=i.gridMultipleSorting;if(o.columnSettings=selectNotEmptyArray(s[t.folderId],s[t.cardId]),o.sortSettings=r[t.folderId]||r[t.cardId],a&&(o.multipleSorting=null!==(n=a[t.folderId])&&void 0!==n?n:a[t.cardId]),!o.columnSettings){const e=Object.keys(s)[0];o.columnSettings=s[Number(e)],o.sortSettings=r[Number(e)]}return o}))}fetchUserSettingsForNode({dispatch:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){const n=yield e("fetchUserSettings",t),i={parentId:t.folderId,columnSettings:null,sortSettings:null,multipleSorting:null};let o,s;switch(t.contentType){case Ue.zc.Instruction:o=n.foldersColumnSettings,s=n.foldersSortSettings;break;case Ue.zc.Document:o=n.journalsColumnSettings,s=n.journalsSortSettings;break;default:throw new Error(`Not implemented ${t.contentType.toString()}`)}return i.columnSettings=o?selectNotEmptyArray(o[t.folderId],o[t.cardId]):null,i.sortSettings=s?s[t.folderId]||s[t.cardId]:null,n.gridMultipleSorting&&(i.multipleSorting=n.gridMultipleSorting[t.folderId]||n.gridMultipleSorting[t.cardId]),i}))}fetchColumnTemplates({commit:e,state:t,rootState:n},i){return actions_settings_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote&&t.columnTemplates)return t.columnTemplates;try{const{data:t}=yield xn().get("assets/resources/column-templates.json");return e(Go,t),t}catch(e){(0,Fn.UZ)(e)}}))}fetchUserGridSettings({dispatch:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){const n=new $e.bM(t.fromRemote),i=new $e.pk(t.settings.contentType,t.settings.folderId,t.settings.topLevelParentId,t.settings.cardId,t.fromRemote),o=new $e.fZ(t.settings.contentType,t.settings.folderId,t.settings.cardId,t.fromRemote),s=yield e("fetchColumnTemplates",n),r=yield e("fetchTopLevelAdminSettings",i),a=yield e("fetchUserSettingsForNode",o);return getColumnSettings(t.settings.contentType,r,a,s,t.settings.folderId,t.settings.removeColumns,t.settings.addColumns,t.settings.nestedPrefix,t.settings.templateType)}))}fetchSidebarSettings({commit:e,state:t,rootState:n},i){return actions_settings_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote&&t.sidebarSettings)return t.sidebarSettings;try{const{data:t}=yield xn().get(`${n.config.apiPath()}viewstate?key=sidebar`);return e(Ko,t),t}catch(e){(0,Fn.UZ)(e)}}))}fetchContentSettings({commit:e,state:t,rootState:n},i){return actions_settings_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){const e=t.contentSettings.getValue(i);if(e)return e}try{let t=`${n.config.apiPath()}viewstate?key=content`;i.contentType&&(t+=`.${Ue.zc[i.contentType]}`),i.folderId>0&&(t+=`.${i.folderId}`);const{data:o}=yield xn().get(t);return e(Yo,{query:i,data:o}),o}catch(e){(0,Fn.UZ)(e)}}))}fetchTableSettings({commit:e,state:t,rootState:n},i){return actions_settings_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){const e=t.tableSettings.getValue(i);if(e)return e}try{let t=`${n.config.apiPath()}viewstate?key=grid`;i.contentType&&(t+=`.${Ue.zc[i.contentType]}`),i.folderId>0&&(t+=`.${i.folderId}`);const{data:o}=yield xn().get(t);return e(Jo,{query:i,data:o}),o}catch(e){(0,Fn.UZ)(e)}}))}fetchSortSettings({commit:e,state:t,rootState:n},i){return actions_settings_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote){const e=t.sortSetting.getValue(i);if(e)return e}try{let t=`${n.config.apiPath()}viewstate?key=sort`;i.contentType&&(t+=`.${Ue.zc[i.contentType]}`),i.folderId>0&&(t+=`.${i.folderId}`);const{data:o}=yield xn().get(t);return e(Xo,{query:i,data:o}),o}catch(e){(0,Fn.UZ)(e)}}))}fetchCacheItems({rootState:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}admin/cache`);return t}catch(e){(0,Fn.UZ)(e)}}))}exportAdminSettings({rootState:e},{key:t}){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}admin/settings/file`,{params:{key:t},responseType:"blob"});return n}catch(e){(0,Fn.UZ)(e)}}))}saveAdminSettings({rootState:e,commit:t},n){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{t(qo,n.adminSettings);const{data:i}=yield xn().put(`${e.config.apiPath()}admin/settings`,n.adminSettings);return new Ne.$Q({value:null!==i})}catch(e){return(0,Fn.WI)(e)}}))}saveUserSettings({rootState:e,commit:t},n){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{t(Zo,n.userSettings);const{data:i}=yield xn().put(`${e.config.apiPath()}me/settings`,n.userSettings);return new Ne.$Q({value:null!==i})}catch(e){return(0,Fn.WI)(e)}}))}saveUserSettingsPartially({rootState:e,commit:t},n){try{return t(ts,n.userSettings),xn().patch(`${e.config.apiPath()}me/settings`,n.userSettings),new Ne.$Q({value:!0})}catch(e){return(0,Fn.WI)(e)}}processRepository({rootState:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}admin/repository`,t.repositoryModulesNames);return new Ne.$Q({value:null!==n})}catch(e){return(0,Fn.WI)(e)}}))}cacheWhiteLists({rootState:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}users/cacheWhiteLists`);return new Ne.$Q({value:null!==t})}catch(e){const t=new Ne.yr("Ошибка при сохранении настроек пользователя: ",e);return Promise.reject(new Ne.$Q({value:e.data,error:t}))}}))}dropCacheSection({rootState:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().get(`${e.config.apiPath()}admin/cache/flush/${t.cacheTypename}`);return new Ne.$Q({value:null!==n})}catch(e){return(0,Fn.WI)(e)}}))}dropAllCache({rootState:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().get(`${e.config.apiPath()}admin/cache/flushall`);return new Ne.$Q({value:null!==t})}catch(e){return(0,Fn.WI)(e)}}))}resetSettings({rootState:e},t){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().delete(`${e.config.apiPath()}me/settings`);return new Ne.$Q({value:null!==t})}catch(e){return(0,Fn.WI)(e)}}))}uploadAdminSettings({rootState:e,getters:t,commit:n},i){return actions_settings_awaiter(this,void 0,void 0,(function*(){try{const{data:t}=yield xn().put(`${e.config.apiPath()}admin/settings/file`,i.getFormData());return n(qo,t),new Ne.$Q({value:t})}catch(e){return(0,Fn.WI)(e)}}))}}function getColumnSettings(e,t,n,i,o,s,r,a,l){var c;let d;const u=[],p={};a=a||"";const h=getUserColumnSettings(t,n,o);h&&h.columnSettings&&h.columnSettings.forEach((t=>{if(d=e!==Ue.zc.Document?t.fieldName.charAt(0).toLowerCase()+t.fieldName.slice(1):t.fieldName,(!s||!s.includes(d))&&(h.useTaskFunctionality||"taskName"!==d)){p[d]={type:getColumnType(t.columnType)||"string",from:a+d};const e=getColumnComponent(d,t.columnType,i,l);u.push({resizable:!0,sortable:!0,groupBy:!1,columnType:t.columnType,visible:t.enabled,sortOrder:t.sortOrder,sortDir:t.sortDir,groupLevel:t.groupLevel,groupOrder:t.groupLevel,width:t.width,prop:d,name:t.caption,groupFormatter:null===e||void 0===e?void 0:e.groupFormatter,formatter:(null===e||void 0===e?void 0:e.formatter)?e.formatter:null,component:(null===e||void 0===e?void 0:e.formatter)?null:e,frozen:t.frozen})}})),r&&r.length>0&&r.forEach((e=>{p[e.fieldName]={type:getColumnType(e.columnType)||"string",from:a+e.fieldName};const t=getColumnComponent(d,e.columnType,i,l);u.push({resizable:!0,sortable:!0,groupBy:!1,visible:e.enabled,columnType:e.columnType,sortOrder:e.sortOrder,sortDir:e.sortDir,groupLevel:e.groupLevel,groupOrder:e.groupLevel,width:e.width,prop:e.fieldName,name:e.caption,groupFormatter:null===t||void 0===t?void 0:t.groupFormatter,formatter:(null===t||void 0===t?void 0:t.formatter)?t.formatter:null,component:(null===t||void 0===t?void 0:t.formatter)?null:t})}));const m=null!==(c=n.multipleSorting)&&void 0!==c?c:t.multipleSorting;return{columns:u,modelFields:p,canEdit:!0,width:Ks,nestedPrefix:a,multipleSorting:m}}function getUserColumnSettings(e,t,n){let i;if(n){const n=t&&t.columnSettings;if(i=n||e.columnSettings,n&&n.length<e.columnSettings.length)for(const t of e.columnSettings)n.find((e=>e.fieldName===t.fieldName))||n.push(t)}else i=e.columnSettings;return{useTaskFunctionality:e.useTaskFunctionality,columnSettings:i}}function getColumnType(e){switch(e){case Bn.cV.String:return"string";case Bn.cV.Date:return"date";case Bn.cV.DateTime:return"date";case Bn.cV.Other:return"string";default:return null}}function getColumnComponent(e,t,n,i){return(null!==i?getSpecificColumnComponent(i,e,n):null)||getDefaultColumnComponent(e,t)}function getSpecificColumnComponent(e,t,n){const i=Zs.ET[e].toString().toLowerCase();if(!n||!n[i])return null;const o=n[i][t];return o}function getDefaultColumnComponent(e,t){switch(t){case Bn.cV.String:return null;case Bn.cV.Date:return{name:e,props:null,formatter:e=>(0,Ws.v)(e,qs),groupFormatter:e=>(0,Ws.v)(e,qs)};case Bn.cV.DateTime:return{name:e,props:null,formatter:e=>(0,Ws.v)(e),groupFormatter:e=>(0,Ws.v)(e,qs)};default:return null}}function selectNotEmptyArray(e,t){return Array.isArray(e)&&e.length?e:Array.isArray(t)&&t.length?t:null}actions_settings_decorate([(0,Tn.Q)($e.FD,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.FD]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchLastVisitedUrl",null),actions_settings_decorate([(0,Tn.Q)($e.n7,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.n7]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchUserSettings",null),actions_settings_decorate([(0,Tn.Q)($e.wq,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.wq]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchFolders",null),actions_settings_decorate([(0,Tn.Q)($e.u1,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.u1]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchPublicSettings",null),actions_settings_decorate([(0,Tn.Q)($e.v2,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.v2]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchAdminSettings",null),actions_settings_decorate([(0,Tn.Q)($e.pk,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.pk]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchTopLevelAdminSettings",null),actions_settings_decorate([(0,Tn.Q)($e.fZ,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.fZ]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchUserSettingsForNode",null),actions_settings_decorate([(0,Tn.Q)($e.bM,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.bM]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchColumnTemplates",null),actions_settings_decorate([(0,Tn.Q)($e.Pn,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.Pn]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchUserGridSettings",null),actions_settings_decorate([(0,Tn.Q)($e.K,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.K]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchSidebarSettings",null),actions_settings_decorate([(0,Tn.Q)($e.mo,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.mo]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchContentSettings",null),actions_settings_decorate([(0,Tn.Q)($e.Wd,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.Wd]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchTableSettings",null),actions_settings_decorate([(0,Tn.Q)($e.e6,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.e6]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchSortSettings",null),actions_settings_decorate([(0,Tn.Q)($e.Lh,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.Lh]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"fetchCacheItems",null),actions_settings_decorate([(0,Tn.Q)($e.Eo,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,$e.Eo]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"exportAdminSettings",null),actions_settings_decorate([Commandable(hn.On,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.On]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"saveAdminSettings",null),actions_settings_decorate([Commandable(hn.gY,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.gY]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"saveUserSettings",null),actions_settings_decorate([Commandable(hn.Wj,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.Wj]),actions_settings_metadata("design:returntype",Ne.$Q)],actions_settings_Actions.prototype,"saveUserSettingsPartially",null),actions_settings_decorate([Commandable(hn.If,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.If]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"processRepository",null),actions_settings_decorate([Commandable(hn.un,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.un]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"cacheWhiteLists",null),actions_settings_decorate([Commandable(hn.Qe,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.Qe]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"dropCacheSection",null),actions_settings_decorate([Commandable(hn.QM,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.QM]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"dropAllCache",null),actions_settings_decorate([Commandable(hn.dr,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.dr]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"resetSettings",null),actions_settings_decorate([Commandable(hn.NK,Gs),actions_settings_metadata("design:type",Function),actions_settings_metadata("design:paramtypes",[Object,hn.NK]),actions_settings_metadata("design:returntype",Promise)],actions_settings_Actions.prototype,"uploadAdminSettings",null);var Ys=n(24578);class getters_settings_Getters{constructor(){this.eSignMode=e=>e.userSettings?e.userSettings.esignMode:Ys.Ky.Disabled,this.checkSessionUserParams=e=>{if(e.userSettings){const{checkSessionUserMode:t,timeoutCheckUserSession:n}=e.userSettings;return{checkSessionUserMode:t,timeoutCheckUserSession:n}}return{checkSessionUserMode:!1,timeoutCheckUserSession:0}},this.userSettings=e=>(0,$n.Z)(e.userSettings),this.adminSettings=e=>(0,$n.Z)(e.adminSettings),this.publicSettings=e=>(0,$n.Z)(e.publicSettings),this.getSettingsFolder=e=>t=>{const n=e.folders.find((e=>e.id===t));return n?o().observable((0,$n.Z)(n)):null}}}const Js=!0,Xs=toActionTree(new actions_settings_Actions),er=toDict(new getters_settings_Getters),tr=resetSettingsState(),nr={namespaced:Js,state:tr,getters:er,actions:Xs,mutations:os};function resetSettingsState(){return{userSettings:null,publicSettings:null,adminSettings:null,columnTemplates:null,sidebarSettings:null,contentSettings:new ComplexKeyDict((e=>`${e.contentType}&${e.folderId}`)),tableSettings:new ComplexKeyDict((e=>`${e.contentType}&${e.folderId}`)),sortSetting:new ComplexKeyDict((e=>`${e.contentType}&${e.folderId}`)),viewState:{},folders:null}}var ir=n(81695);class Expression{constructor(e,t){this.name=e,this.token=t}compose(){return`@${this.name}:${this.token}`}}class NotExpression{constructor(e){this.expression=e}compose(){return`-${this.expression.compose()}`}}class OrExpression{constructor(e){this.expression=e}compose(){return`| ${this.expression.compose()}`}}class ExpressionProvider{constructor(e){this.range=e}getWhere(e,t){return new Expression(e,t)}getWhereNot(e,t){return new NotExpression(this.getWhere(e,t))}getWhereIn(e,t){return this.getWhere(e,`(${t.join("|")})`)}getWhereNotIn(e,t){return new NotExpression(this.getWhereIn(e,t))}getWhereBetween(e,[t,n]){return this.getWhere(e,this.range.getBetween(t,n))}getWhereGreaterThenOrEqual(e,t){return this.getWhere(e,this.range.getGreaterThenOrEqual(t))}getWhereGreaterThen(e,t){return this.getWhere(e,this.range.getGreaterThen(t))}getWhereLessThen(e,t){return this.getWhere(e,this.range.getLessThen(t))}getWhereLessThenOrEqual(e,t){return this.getWhere(e,this.range.getLessThenOrEqual(t))}getWhereLike(e,t){return this.getWhere(e,`${t}*`)}getOrWhere(e,t){return new OrExpression(this.getWhere(e,t))}getOrWhereNot(e,t){return new OrExpression(this.getWhereNot(e,t))}getOrWhereIn(e,t){return new OrExpression(this.getWhereIn(e,t))}getOrWhereNotIn(e,t){return new OrExpression(this.getWhereNotIn(e,t))}getOrWhereBetween(e,t){return new OrExpression(this.getWhereBetween(e,t))}getOrWhereGreaterThenOrEqual(e,t){return new OrExpression(this.getWhereGreaterThenOrEqual(e,t))}getOrWhereGreaterThen(e,t){return new OrExpression(this.getWhereGreaterThen(e,t))}getOrWhereLessThen(e,t){return new OrExpression(this.getWhereLessThen(e,t))}getOrWhereLessThenOrEqual(e,t){return new OrExpression(this.getWhereLessThenOrEqual(e,t))}getOrWhereLike(e,t){return new OrExpression(this.getWhereLike(e,t))}}class RangeProvider{getBetween(e,t){return`[${e} ${t}]`}getGreaterThenOrEqual(e){return this.getBetween(e,RangeProvider.POSITIVE_INFINITY)}getGreaterThen(e){return this.getBetween(`(${e}`,RangeProvider.POSITIVE_INFINITY)}getLessThen(e){return this.getBetween(RangeProvider.NEGATIVE_INFINITY,`(${e}`)}getLessThenOrEqual(e){return this.getBetween(RangeProvider.NEGATIVE_INFINITY,e)}}RangeProvider.POSITIVE_INFINITY="+inf",RangeProvider.NEGATIVE_INFINITY="-inf";class QueryBuilder{constructor(e,t=[]){this.provider=e,this.expressions=t}get(){return this.expressions.map((e=>e.compose())).join(" ")}where(e,t){return this.getInstance(this.provider.getWhere(e,t))}whereNot(e,t){return this.getInstance(this.provider.getWhereNot(e,t))}whereIn(e,t){return this.getInstance(this.provider.getWhereIn(e,t))}whereNotIn(e,t){return this.getInstance(this.provider.getWhereNotIn(e,t))}whereBetween(e,t){return this.getInstance(this.provider.getWhereBetween(e,t))}whereGreaterThenOrEqual(e,t){return this.getInstance(this.provider.getWhereGreaterThenOrEqual(e,t))}whereGreaterThen(e,t){return this.getInstance(this.provider.getWhereGreaterThen(e,t))}whereLessThen(e,t){return this.getInstance(this.provider.getWhereLessThen(e,t))}whereLessThenOrEqual(e,t){return this.getInstance(this.provider.getWhereLessThenOrEqual(e,t))}whereLike(e,t){return this.getInstance(this.provider.getWhereLike(e,t))}orWhere(e,t){return this.getInstance(this.provider.getOrWhere(e,t))}orWhereNot(e,t){return this.getInstance(this.provider.getOrWhereNot(e,t))}orWhereIn(e,t){return this.getInstance(this.provider.getOrWhereIn(e,t))}orWhereNotIn(e,t){return this.getInstance(this.provider.getOrWhereNotIn(e,t))}orWhereBetween(e,t){return this.getInstance(this.provider.getOrWhereBetween(e,t))}orWhereGreaterThenOrEqual(e,t){return this.getInstance(this.provider.getOrWhereGreaterThenOrEqual(e,t))}orWhereGreaterThen(e,t){return this.getInstance(this.provider.getOrWhereGreaterThen(e,t))}orWhereLessThen(e,t){return this.getInstance(this.provider.getOrWhereLessThen(e,t))}orWhereLessThenOrEqual(e,t){return this.getInstance(this.provider.getOrWhereLessThenOrEqual(e,t))}orWhereLike(e,t){return this.getInstance(this.provider.getOrWhereLike(e,t))}getInstance(e){return new QueryBuilder(this.provider,[...this.expressions,e])}}class QueryBuilderError extends Error{constructor(e,t){super(e),this.name=t,Object.setPrototypeOf(this,new.target.prototype)}}class UnknownQueryBuilderError extends QueryBuilderError{constructor(e){super(e,UnknownQueryBuilderError.name)}}class QueryBuilderFactory{builder(e=QueryBuilderFactory.RediSearch){if(e===QueryBuilderFactory.RediSearch)return new QueryBuilder(new ExpressionProvider(new RangeProvider));throw new UnknownQueryBuilderError(e)}}QueryBuilderFactory.RediSearch="RediSearch";const or="SET_VOCABULARY",sr="SET_FOLDERS",rr="SET_CATALOGUE",ar="SET_CATALOGUE_ITEM",lr="REMOVE_CATALOGUE_ITEM",cr="CLEAR_CATALOGUE",dr="SET_VOCABULARY_RIGHTS",ur={[or](e,t){e.vocabulary[t.name]=t.data,Array.isArray(t.data)&&(e.sortedVocabulary[t.name]=t.data.concat().sort(((e,t)=>e.id-t.id)))},[sr](e,t){e.folders=t,e.folderDict=(0,Qn.F)(t,"id")},[rr](e,t){e.catalogue[t.name]=t.data},[lr](e,t){e.catalogue[t.name]=null,e.catalogue=Object.assign({},e.catalogue)},[cr](e,t){mutations_vocabulary_clearFolder(e,{name:t.name})},[ar](e,t){if(!(null===t||void 0===t?void 0:t.item))return;let n=e.catalogue[t.name];n||(n={name:t.name,id:0,items:[],totalCount:1,caption:""},o().set(e.catalogue,t.name,n));const i=n.items.findIndex((e=>{var n;return e.id===(null===(n=null===t||void 0===t?void 0:t.item)||void 0===n?void 0:n.id)}));if(i>=0){const e=n.items[i];Object.keys(t.item).forEach((n=>{!e[n]||"object"!==typeof e[n]||e[n]instanceof Promise?e[n]=t.item[n]:Object.assign(e[n],t.item[n])}))}else n.items.unshift(t.item),e.catalogue=Object.assign({},e.catalogue)},[dr](e,{name:t,rights:n}){e.rights=Object.assign(Object.assign({},e.rights),{[t]:n})}};function mutations_vocabulary_clearFolder(e,t){t&&t.name?(e.catalogue[t.name]=null,e.catalogue=Object.assign({},e.catalogue)):e.catalogue={0:null}}var actions_vocabulary_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_vocabulary_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_vocabulary_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const pr="vocabulary";class actions_vocabulary_Actions{init(){}fetchVocabulary({commit:e,state:t,rootState:n},i){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){const o={fullInfo:i.fullInfo};i.take&&(o.take=i.take),i.skip&&(o.skip=i.skip);const s=yield promisifyFetch1(t,"vocabulary",i.name,i,(()=>actions_vocabulary_awaiter(this,void 0,void 0,(function*(){const{data:e}=yield xn().get(`${n.config.apiPath()}vocabulary/${i.name}`,{params:o}),t=processVocabularyList(e);return t}))),(t=>{i.fullInfo||e(or,{name:i.name,data:t})}));return s}))}fetchVocabularyFull({commit:e,state:t,rootState:n},i){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){if(!i.fromRemote&&t.catalogue[i.name])return t.catalogue[i.name];const o=new URLSearchParams;o.append("fullInfo","true"),i.take&&o.append("take",i.take.toString()),i.skip&&o.append("skip",i.skip.toString()),Array.isArray(i.states)&&i.states.forEach((e=>o.append("states",e.toString())));try{const{data:t}=yield xn().get(`${n.config.apiPath()}vocabulary/${i.name}`,{params:o,cancelable:i.cancelable}),s=processVocabularyList(t);return e(rr,{name:i.name,data:s}),s}catch(e){(0,Fn.UZ)(e)}}))}fetchVocabularyItem({commit:e,state:t,getters:n,rootState:i},o){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const t=`${i.config.apiPath()}vocabulary/${o.name}/${o.id}`;let s=yield promisifyFetch2(o,(t=>{let n=t;t instanceof Promise&&(n={id:o.id,data:t}),e(ar,{name:o.name,item:n})}),(()=>{const e=n.getItem(o.name,o.id);return e&&e.data instanceof Promise?e.data:e}),(()=>xn().get(t)),(t=>(t&&(t.fullyRead=!0,processVocabularyItem(t),e(ar,{name:o.name,item:t})),t)));return s=n.getItem(o.name,o.id),s}catch(e){(0,Fn.UZ)(e)}}))}fetchVocabularyTree({commit:e,state:t,rootState:n},i){const o=`${n.config.apiPath()}vocabulary/tree`;return promisifyFetch1(t,"folders",null,i,(()=>actions_vocabulary_awaiter(this,void 0,void 0,(function*(){const{data:t}=yield xn().get(o,{cancelable:i.cancelable}),n=t.find((e=>0===e.parentID)),s=n?n.id:0;let r=t.filter((e=>e.parentID>0)).map((e=>({id:e.id,name:e.caption,systemName:e.sysName,entityName:e.sysName,contentType:Ue.zc.Vocabulary,parentId:e.parentID===s?0:e.parentID,comments:e.hint,order:e.order,compositeId:"",topLevelFolderId:null!==s&&void 0!==s?s:0})));return r=r.sort(((e,t)=>e.name.localeCompare(t.name))),e(sr,r),r}))))}fetchVocabularySearch({rootState:e},t){var n;return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const i={isReturnActual:!!t.isReturnActual&&t.isReturnActual,redisWhere:[],pagingInfo:{},states:[]};t.redisWhere&&t.redisWhere.length>0&&(i.redisWhere=t.redisWhere),t.pagingInfo&&(i.pagingInfo=Object.assign({},t.pagingInfo)),t.states&&(i.states=t.states),Array.isArray(null===(n=t.pagingInfo)||void 0===n?void 0:n.order)&&(i.pagingInfo.order=t.pagingInfo.order.map((e=>`Attributes["${e.prop}"] ${e.dir}`)));{const{data:n}=yield xn().post(`${e.config.apiPath()}vocabulary/${t.name}/search`,i,{cancelable:t.cancelable});return processVocabularyList(n)}}catch(e){(0,Fn.UZ)(e)}}))}fetchVocabularyV2Search({rootState:e},t){var n,i,o;return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const s=(new QueryBuilderFactory).builder(),r={isReturnActual:t.isReturnActual,pagingInfo:{where:[],order:[]}};if(t.pagingInfo&&(r.pagingInfo=Object.assign(Object.assign({},r.pagingInfo),t.pagingInfo)),t.searchTerm&&Array.isArray(null===(n=t.searchV2)||void 0===n?void 0:n.attributes)&&(r.pagingInfo.where=[...r.pagingInfo.where,...t.searchV2.attributes.map((e=>`${s.whereLike(e,t.searchTerm).get()}`))]),Array.isArray(null===(i=t.searchV2)||void 0===i?void 0:i.conditions)&&(r.pagingInfo.where=[...r.pagingInfo.where,...t.searchV2.conditions.map((({attribute:e,value:t})=>`${s.where(e,t).get()}`))]),t.states.length){const e=t.states.join("|");r.pagingInfo.where=[...r.pagingInfo.where,`${s.where("State",e).get()}`]}Array.isArray(null===(o=t.pagingInfo)||void 0===o?void 0:o.order)&&(t.pagingInfo.order=[...t.pagingInfo.order,...t.pagingInfo.order.map((e=>`@${e.prop}-${Pt.Ox.ORDER[e.dir]}`))]);const{data:a}=yield xn().post(`${e.config.apiPath(2)}vocabulary/${t.name}/search`,r,{cancelable:t.cancelable});return processVocabularyList(a)}catch(e){(0,Fn.UZ)(e)}}))}fetchVocabularyByIds({rootState:e},t){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}vocabulary/items-by-ids`,t instanceof Array?t:[t]);return n}catch(e){(0,Fn.UZ)(e)}}))}fetchVocabularyRights({rootState:e,commit:t,state:n},i){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{if(!i.fromRemote&&n.rights[i.vocabularyName])return n.rights[i.vocabularyName];const o=`${e.config.apiPath()}vocabulary/${i.vocabularyName}/rights`,{data:s}=yield xn().get(o);return t(dr,{name:i.vocabularyName,rights:s}),s}catch(e){(0,Fn.UZ)(e)}}))}vocabularyItemSave({rootState:e,commit:t,getters:n},i){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{let o;const s=`${e.config.apiPath()}vocabulary/${i.name}`;o=i.id?yield xn().put(`${s}/${i.id}`,i):yield xn().post(s,i);const r=o.data;processVocabularyItem(r),t(ar,{name:i.name,item:r});const a=n.getItem(i.name,r.id);return new Ne.$Q({value:a})}catch(e){return(0,Fn._o)(e)}}))}vocabularyItemCreateCreate({rootState:e,commit:t},n){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const i=`${e.config.apiPath()}vocabulary/${n.name}`,o=yield xn().post(i,n.item);return t(cr,{name:n.name}),processVocabularyItem(o.data),new Ne.$Q({value:o.data})}catch(e){return(0,Fn._o)(e)}}))}vocabularyItemUpdate({rootState:e},t){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}vocabulary/${t.name}/${t.id}`;return yield xn().put(n,t.item),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}vocabularyItemDelete({rootState:e,commit:t},n){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const i=`${e.config.apiPath()}vocabulary/${n.name}/${n.id}`;return yield xn().delete(i),t(lr,{name:n.name,id:n.id}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}vocabularyItemLogicalDelete({rootState:e,commit:t},n){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const i=`${e.config.apiPath()}vocabulary/${n.name}/${n.id}/delete`;return yield xn().post(i,{withChildren:n.withChildren}),t(lr,{name:n.name,id:n.id}),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}vocabularyItemCacheRefresh({rootState:e},t){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}vocabulary/${t.name}/refresh`;return yield xn().post(n,t),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}vocabularyCacheFlush({rootState:e},t){return actions_vocabulary_awaiter(this,void 0,void 0,(function*(){try{const n=`${e.config.apiPath()}admin/cache/flush/${t.type}`;return yield xn().get(n),new Ne.$Q({value:!0})}catch(e){return(0,Fn._o)(e)}}))}}function processVocabularyList(e){return e&&Array.isArray(e.items)?(e.items.forEach((e=>{processVocabularyItem(e)})),e):e}function processVocabularyItem(e){var t,n;e&&(e.vocabularyValue?(e.id=e.vocabularyValue.id,e.value=e.vocabularyValue.value,e.parentID=e.vocabularyValue.parentID):e.attributes&&(e.id=e.attributes.ID||e.attributes.id||e.attributes.Id,e.value=e.attributes.Name||e.attributes.name,e.parentID=null!==(t=e.attributes.parentID)&&void 0!==t?t:e.attributes.parentId),e.createDateTime=null===(n=e.attributes)||void 0===n?void 0:n.CreateDateTime)}function binarySearchByProp(e,t,n,i){let o=0,s=e.length-1;while(o<=s){const r=s+o>>1,a=i(t,n(e[r]));if(a>0)o=r+1;else{if(!(a<0))return e[r];s=r-1}}return e[-o-1]}function filterSortedArray(e,t,n,i){const o=[];return e&&Array.isArray(e)&&t&&Array.isArray(t)&&t.forEach((t=>{const s=binarySearchByProp(e,t,n,i);s&&o.push(s)})),o}actions_vocabulary_decorate([(0,Tn.Q)(Pt.Yi,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,Pt.Yi]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"fetchVocabulary",null),actions_vocabulary_decorate([(0,Tn.Q)(Pt.Aj,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,Pt.Aj]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"fetchVocabularyFull",null),actions_vocabulary_decorate([(0,Tn.Q)(Pt.AG,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,Pt.AG]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"fetchVocabularyItem",null),actions_vocabulary_decorate([(0,Tn.Q)(Pt.t,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,Pt.t]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"fetchVocabularyTree",null),actions_vocabulary_decorate([(0,Tn.Q)(Pt.j_,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,Pt.j_]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"fetchVocabularySearch",null),actions_vocabulary_decorate([(0,Tn.Q)(Pt.Ox,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,Pt.Ox]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"fetchVocabularyV2Search",null),actions_vocabulary_decorate([(0,Tn.Q)(Pt.hu,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,Object]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"fetchVocabularyByIds",null),actions_vocabulary_decorate([(0,Tn.Q)(Pt.Uw,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,Pt.Uw]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"fetchVocabularyRights",null),actions_vocabulary_decorate([Commandable(ir.ny,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,ir.ny]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"vocabularyItemSave",null),actions_vocabulary_decorate([Commandable(ir.nS,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,ir.nS]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"vocabularyItemCreateCreate",null),actions_vocabulary_decorate([Commandable(ir.ZG,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,ir.ZG]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"vocabularyItemUpdate",null),actions_vocabulary_decorate([Commandable(ir.Gv,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,ir.Gv]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"vocabularyItemDelete",null),actions_vocabulary_decorate([Commandable(ir.sB,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,ir.sB]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"vocabularyItemLogicalDelete",null),actions_vocabulary_decorate([Commandable(ir.Fl,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,ir.Fl]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"vocabularyItemCacheRefresh",null),actions_vocabulary_decorate([Commandable(ir.tF,pr),actions_vocabulary_metadata("design:type",Function),actions_vocabulary_metadata("design:paramtypes",[Object,ir.tF]),actions_vocabulary_metadata("design:returntype",Promise)],actions_vocabulary_Actions.prototype,"vocabularyCacheFlush",null);class getters_vocabulary_Getters{constructor(){this.filterItemsById=e=>(t,n)=>{const i=e.sortedVocabulary[t];return i?filterSortedArray(i,n,(e=>e.id),((e,t)=>e-t)):[]},this.getFolder=e=>t=>e.folderDict[t]?e.folderDict[t]:null,this.getItem=e=>(t,n)=>{const i=e.catalogue[t];return i&&i.items?i.items.find((e=>(null===e||void 0===e?void 0:e.id)===n)):null},this.getRights=e=>t=>e.rights[t]||[]}}const hr={vocabulary:{},sortedVocabulary:{},folders:null,folderDict:{},catalogue:{},rights:{}},mr=!0,fr=toActionTree(new actions_vocabulary_Actions),gr=toDict(new getters_vocabulary_Getters),yr={namespaced:mr,state:hr,getters:gr,actions:fr,mutations:ur};var vr=n(77312);const br="SET_ALL_USERS",Cr="SET_SOME_USERS",wr="SET_DEPARTMENTS",_r="SET_DEPARTMENT_USERS",xr="SET_ROLES",Sr="SET_USER_INFO",Ir={[br](e,t){e.users=t},[Cr](e,t){for(const n of t)e.users[n.id]=n},[wr](e,t){e.departments=t},[_r](e,t){e.departmentUsers[t.id]=t.users},[xr](e,t){e.roles=t},[Sr](e,t){e.users=Object.assign(Object.assign({},e.users),{[t.id]:t})}};var actions_users_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},actions_users_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},actions_users_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Dr="users";class actions_users_Actions{init({state:e,dispatch:t}){}getUserInfo({state:e,dispatch:t},n){return actions_users_awaiter(this,void 0,void 0,(function*(){try{if(!n)return null;const i=new vr.zD([n]),o=yield promisifyFetch1(e,"users",n,i,(()=>t("fetchSomeUsers",i)));return o}catch(e){console.error(`Ошибка получения userInfo: ${e}`)}}))}fetchSearchUsers({commit:e,state:t,rootState:n},i){return actions_users_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().post(`${n.config.apiPath()}users/search`,i);return e}catch(e){(0,Fn.UZ)(e)}}))}fetchSomeUsers({commit:e,state:t,rootState:n},i){return actions_users_awaiter(this,void 0,void 0,(function*(){try{let o=[],s=[];if(!i.fromRemote&&t.users)for(const e of i.userIds){const n=t.users[Number(e)];n?s.push(n):o.push(e)}else o=i.userIds;if(o.length){const t=o.filter(((e,t,n)=>e&&n.indexOf(e)===t));if(t&&t.length){const{data:i}=yield xn().post(`${n.config.apiPath()}users`,{userIds:t});e(Cr,i.items),s=s.concat(i.items)}}return s}catch(e){console.error(`Ошибка fetchSomeUsers: ${e}`)}}))}fetchDepartments({commit:e,state:t,rootState:n},i){return actions_users_awaiter(this,void 0,void 0,(function*(){try{if(!i.fromRemote&&t.departments)return t.departments;const{data:o}=yield xn().post(`${n.config.apiPath()}departments`,{parentId:i.parentId});return e(wr,o),o}catch(e){(0,Fn.UZ)(e)}}))}searchDepartments({commit:e,state:t,rootState:n},i){return actions_users_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().post(`${n.config.apiPath()}departments/search`,i);return e}catch(e){(0,Fn.UZ)(e)}}))}fetchDepartmentUsers({commit:e,state:t,rootState:n},i){return actions_users_awaiter(this,void 0,void 0,(function*(){try{const o=i.departmentId?i.departmentId:0;if(!i.fromRemote&&t.departmentUsers[Number(o)])return t.departmentUsers[o];const{data:s}=yield xn().post(`${n.config.apiPath()}departments/users/search`,i);return i.canReceiveInstruction||e(_r,{id:o,users:s}),s}catch(e){(0,Fn.UZ)(e)}}))}fetchRoles({commit:e,state:t,rootState:n},i){return actions_users_awaiter(this,void 0,void 0,(function*(){try{if(!i.fromRemote&&t.roles)return t.roles;const{data:o}=yield xn().post(`${n.config.apiPath()}users/roles/search`,i);return e(xr,o),o}catch(e){(0,Fn.UZ)(e)}}))}fetchGroupUsers({commit:e,state:t,rootState:n},i){return actions_users_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().post(`${n.config.apiPath()}users/groups/search`,i);return e}catch(e){(0,Fn.UZ)(e)}}))}fetchUserReceiversByGroups({commit:e,state:t,rootState:n},i){return actions_users_awaiter(this,void 0,void 0,(function*(){try{const{data:e}=yield xn().post(`${n.config.apiPath()}users/by-groups`,i);return e}catch(e){(0,Fn.UZ)(e)}}))}fetchSearchReceiversByInstructionType({rootState:e},t){return actions_users_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}instruction/receivers/search/by-instruction-type`,t,{canceler:{id:Ae.M.SearchReceiversByInstructionTypeQuery}});return n&&n.forEach((e=>{e.type=toCorrectReceiverType(e.type)})),n}catch(e){(0,Fn.UZ)(e)}}))}fetchSearchReceiversByTypes({rootState:e},t){return actions_users_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}instruction/receivers/search/by-receiver-types`,t);return n&&n.forEach((e=>{e.type=toCorrectReceiverType(e.type)})),n}catch(e){(0,Fn.UZ)(e)}}))}fetchSearchReceiversById({rootState:e},t){return actions_users_awaiter(this,void 0,void 0,(function*(){try{const{data:n}=yield xn().post(`${e.config.apiPath()}instruction/receivers`,t);return n&&n.forEach((e=>{e.type=toCorrectReceiverType(e.type)})),n}catch(e){(0,Fn.UZ)(e)}}))}fetchUserInfo({rootState:e,getters:t,commit:n},{userId:i,fromRemote:o}){return actions_users_awaiter(this,void 0,void 0,(function*(){const s=t.getUserInfoById(i);if(!o&&s)return s;try{const{data:t}=yield xn().get(`${e.config.apiPath()}user/${i}`);return n(Sr,t),t}catch(e){(0,Fn.UZ)(e)}}))}}function toCorrectReceiverType(e){switch(e){case Nn.OP.User:case Nn.OP.User.toString():case"User":return Nn.OP.User;case Nn.OP.Role:case Nn.OP.Role.toString():case"Role":return Nn.OP.Role;case Nn.OP.GroupUser:case Nn.OP.GroupUser.toString():case"GroupUser":return Nn.OP.GroupUser;case Nn.OP.Department:case Nn.OP.Department.toString():case"Department":return Nn.OP.Department;default:return null}}actions_users_decorate([(0,Tn.Q)(vr.ty,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.ty]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchSearchUsers",null),actions_users_decorate([(0,Tn.Q)(vr.zD,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.zD]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchSomeUsers",null),actions_users_decorate([(0,Tn.Q)(vr.fd,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.fd]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchDepartments",null),actions_users_decorate([(0,Tn.Q)(vr.QB,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.QB]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"searchDepartments",null),actions_users_decorate([(0,Tn.Q)(vr.xZ,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.xZ]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchDepartmentUsers",null),actions_users_decorate([(0,Tn.Q)(vr.TB,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.TB]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchRoles",null),actions_users_decorate([(0,Tn.Q)(vr.Uv,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.Uv]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchGroupUsers",null),actions_users_decorate([(0,Tn.Q)(vr.c0,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.c0]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchUserReceiversByGroups",null),actions_users_decorate([(0,Tn.Q)(vr.qv,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.qv]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchSearchReceiversByInstructionType",null),actions_users_decorate([(0,Tn.Q)(vr.NF,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.NF]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchSearchReceiversByTypes",null),actions_users_decorate([(0,Tn.Q)(vr.uR,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,vr.uR]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchSearchReceiversById",null),actions_users_decorate([(0,Tn.Q)(Ze.O7,Dr),actions_users_metadata("design:type",Function),actions_users_metadata("design:paramtypes",[Object,Ze.O7]),actions_users_metadata("design:returntype",Promise)],actions_users_Actions.prototype,"fetchUserInfo",null);class getters_users_Getters{constructor(){this.getUserInfoById=e=>t=>e.users[t]}}const Rr={users:{0:null},departments:null,departmentUsers:{},roles:null},Tr=!0,Pr=toActionTree(new actions_users_Actions),Or=toDict(new getters_users_Getters),kr={namespaced:Tr,state:Rr,getters:Or,actions:Pr,mutations:Ir};xn().CancelToken;o().use(cn.ZP);const Fr={helpAutoStart:!1,config:null,container:null,currentUser:null,deputyList:null,historyList:null,notifications:{},rights:{},rightObjects:{},memberRights:{},cancelRegister:null,archiveDocFolders:null,archiveInstrFolders:null,archiveFolderDict:{0:null},docArchiveResolve:null,msgArchiveResolve:null,actions:{0:null},cert:null,templates:{},mixins:{},mixinDependencies:{},manifest:{},ldOptions:null,favouriteFolder:null,activeMessageId:null,activeDocumentId:null,previewDocumentId:null,currentFolder:null,viewState:{},extCompPatches:null,proxyResults:{}},Ar=toActionTree(new Actions),$r=[],myPlugin=e=>{e.subscribe(((t,n)=>{const i=t.type.split("/");i&&i.length>=2&&"instructions"===i[0]&&$r.includes(i[1])&&e.commit("instructions/SET_LOG",t)}))},jr=toDict(new Getters);let Er,Mr,Nr,Vr;function initArchiveFolders(e){const t=new Promise((t=>e.msgArchiveResolve=t)),n=new Promise((t=>e.docArchiveResolve=t)),i=Promise.all([t,n]);e.archiveInstrFolders=i}const createStore=(e,t=null)=>{let n;n={auth:ms,settings:nr,instructions:bi,documents:zs,users:kr,filters:Ni,files:Gi,pages:to,reports:Qo,vocabulary:yr,cards:go,components:Fo,kanban:Oi};const i={plugins:[myPlugin],state:Fr,actions:Ar,mutations:On.P$,getters:jr,modules:n},o=new cn.yh(i);Er=JSON.parse(JSON.stringify(o.state)),initArchiveFolders(o.state);for(const e of Object.keys(n))n[e].actions.init&&o.dispatch(`${e}/init`,$r);return Mr=()=>{const t=o.state.config,n=o.state.cancelRegister,i=o.state.manifest,s=o.state.templates;o.replaceState(JSON.parse(JSON.stringify(Er))),o.state.currentUser=null,o.state.config=t,o.state.cancelRegister=n,o.state.container=e,o.state.manifest=i,o.state.templates=s,initArchiveFolders(o.state),o.state.settings=resetSettingsState()},Nr=(e,t,n)=>{if(o.state.currentUser){const i={[t]:n};_saveInLocalStorage(o.state.currentUser.id,e,i)}},Vr=e=>{const t=_readLocalStorage(e);_restoreFromLocalStorage(o.state,t)},null!==t&&o.dispatch("auth/logged",{authData:t}),o};function _saveInLocalStorage(e,t,n){localStorage.setItem(`${e}&${t}`,JSON.stringify(n))}function _readLocalStorage(e){const t={};for(const n in localStorage)if(n.includes(`${e}&`)){const e=localStorage.getItem(n),i=e?JSON.parse(e):null;if(i){const e=n.split("&")[1];t[e]=i}}return t}function _restoreFromLocalStorage(e,t){t&&(0,jn.Z)(e,t)}const Br=JSON.parse('{"indexingApiPath":"http://172.19.90.53:61200/api/v1/","searchApiPath":"http://172.19.90.53:61204/v1/","getDetailDocumentApiPath":"http://172.19.90.53:61204/v1/","count":1000,"from":0,"searchField":"content","searchTemplate":"default","resultFields":["contentId","CSID","contentTicketId","contentExtension","jobId","ownerObjectType","ownerObjectId","Annotation","CreateDateTime","DocName","Extension","ObjectID","Size","FileCreatorName","OwnerID","document_ClientId","Name"],"hlFields":["content"],"aggsNames":{"FileCreatorName":"Создатель файла","DocumentType":"Тип документа","JournalName":"Журнал регистрации","DocumentStateName":"Статус документа","ContragentName":"Контрагент","Extension":"Тип файла"},"sortNames":{"_score":"Релевантности"},"sortOrder":"desc"}');var breadcrumbsvue_type_template_id_5ec3960c_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-breadcrumbs",{staticClass:"py-0 pl-2 mt-1 sm-text font-weight-regular white--text",attrs:{dark:"",divider:"/",items:e.breadcrumbs},scopedSlots:e._u([{key:"item",fn:function(t){return["home"===t.item.text?n("v-breadcrumbs-item",[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-icon",e._g({attrs:{color:"white"},on:{click:e.toHome}},i),[e._v(" home ")])]}}],null,!0)},[e._v(" "),n("translate",[e._v("Домашняя страница")])],1)],1):n("v-breadcrumbs-item",{staticStyle:{color:"white"},attrs:{disabled:t.item.disabled||!t.item.route},on:{click:function(n){return e.go(t.item)}}},[n("span",{staticClass:"white--text"},[e._v(e._s(t.item.text)+"  ")]),t.item.remark?n("span",{staticClass:"white--text"},[e._v("("+e._s(t.item.remark)+")")]):e._e()])]}}])})},Lr=[],breadcrumbsvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},breadcrumbsvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ur=class BreadcrumbsComponent extends rt.Vue{onBreadcrumbsChanged(){this.breadcrumbs&&this.breadcrumbs.length&&("home"!==this.breadcrumbs[0].text&&this.breadcrumbs.unshift({text:"home",route:{name:"home",path:"/"}}),this.breadcrumbs.forEach((e=>e.disabled=!1)),this.breadcrumbs[this.breadcrumbs.length-1].disabled=!0)}toHome(){this.$app.goHome()}go(e){if(e.route){const t=e.route.params?e.route.params.context:null;t&&t.breadcrumbs&&(t.breadcrumbs=t.breadcrumbs.itemsBefore(e.route.path)),this.$router.push(e.route)}}};breadcrumbsvue_type_script_lang_js_decorate([(0,rt.Prop)(),breadcrumbsvue_type_script_lang_js_metadata("design:type",Array)],Ur.prototype,"breadcrumbs",void 0),breadcrumbsvue_type_script_lang_js_decorate([(0,rt.Watch)("breadcrumbs",{immediate:!0}),breadcrumbsvue_type_script_lang_js_metadata("design:type",Function),breadcrumbsvue_type_script_lang_js_metadata("design:paramtypes",[]),breadcrumbsvue_type_script_lang_js_metadata("design:returntype",void 0)],Ur.prototype,"onBreadcrumbsChanged",null),Ur=breadcrumbsvue_type_script_lang_js_decorate([rt.Component],Ur);const Hr=Ur,Qr=Hr;var zr=(0,Ct.Z)(Qr,breadcrumbsvue_type_template_id_5ec3960c_scoped_true_render,Lr,!1,null,"5ec3960c",null);const Zr=zr.exports;_t()(zr,{VBreadcrumbs:$.Z,VBreadcrumbsItem:j.Z,VIcon:y.Z,VTooltip:_.Z});var buttonvue_type_template_id_168d8984_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"responsive-btn"},[e.isDesktop||e.isMobile?n("v-btn",{staticClass:"rounded-button elevation-0",class:{"small-button":e.isDesktop,"square-sm-button":e.isMobile},attrs:{"data-testid":e.testid,outlined:e.outlined,color:e.color,disabled:e.disabled},on:{click:function(t){return e.$emit("click",t)}}},[e._t("icon"),e._v(" "),e.isDesktop?e._t("text"):e._e(),e._v(" "),e._t("hidden")],2):n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"rounded-button square-sm-button elevation-0",attrs:{"data-testid":e.testid,outlined:e.outlined,color:e.color,disabled:e.disabled},on:{click:function(t){return e.$emit("click",t)}}},i),[e._t("icon"),e._v(" "),e._t("hidden")],2)]}}],null,!0)},[e._v(" "),e._t("text")],2)],1)},Wr=[],buttonvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},buttonvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let qr=class ResponsiveButtonComponent extends rt.Vue{};buttonvue_type_script_lang_ts_decorate([(0,rt.Prop)(),buttonvue_type_script_lang_ts_metadata("design:type",String)],qr.prototype,"tooltip",void 0),buttonvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1}),buttonvue_type_script_lang_ts_metadata("design:type",Boolean)],qr.prototype,"outlined",void 0),buttonvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:"primary"}),buttonvue_type_script_lang_ts_metadata("design:type",String)],qr.prototype,"color",void 0),buttonvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:""}),buttonvue_type_script_lang_ts_metadata("design:type",String)],qr.prototype,"testid",void 0),buttonvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),buttonvue_type_script_lang_ts_metadata("design:type",Boolean)],qr.prototype,"disabled",void 0),qr=buttonvue_type_script_lang_ts_decorate([rt.Component],qr);const Gr=qr,Kr=Gr;var Yr=(0,Ct.Z)(Kr,buttonvue_type_template_id_168d8984_scoped_true_render,Wr,!1,null,"168d8984",null);const Jr=Yr.exports;_t()(Yr,{VBtn:g.Z,VTooltip:_.Z});var buttonsvue_type_template_id_06e82b9f_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-flex align-center"},[e.mobile?[e._l(e.sendTypes,(function(t,i){return[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(o){var s=o.on;return[e.checkShowBtn(t)?n("v-btn",e._g({key:i,staticClass:"square-sm-button rounded-button elevation-0 mr-2",attrs:{color:"primary",outlined:e.value.sendType!==t,disabled:e.disabled},on:{click:function(n){e.value.sendType=t}}},s),[n("v-icon",{attrs:{small:"",color:e.value.sendType===t?"white":"primary",size:"18"}},[e._v("\n              "+e._s(t?"reorder":"view_week")+"\n            ")])],1):e._e()]}}],null,!0)},[e._v(" "),n("translate",t?[e._v("Последовательная")]:[e._v("Параллельная")])],1)]}))]:e._l(e.sendTypes,(function(t,i){return e.checkShowBtn(t)?n("v-btn",{key:i,staticClass:"rounded-button small-button elevation-0 mr-2 type-btn",class:{grey:e.disabled&&e.value.sendType===t},attrs:{color:"primary",outlined:e.value.sendType!==t,disabled:e.disabled},on:{click:function(n){e.value.sendType=t}}},[n("v-icon",{attrs:{small:"",color:e.value.sendType===t?"white":"primary",size:"18"}},[e._v("\n        "+e._s(t?"reorder":"view_week")+"\n      ")]),e._v(" "),n("div",{staticClass:"body-1",class:{"white--text":e.value.sendType===t}},[n("translate",t?[e._v("Последовательная")]:[e._v("Параллельная")])],1)],1):e._e()}))],2)},Xr=[],ea=n(73043),buttonsvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},buttonsvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let ta=class SendTypesButtonsComponent extends rt.Vue{constructor(){super(...arguments),this.sendTypes=[ea.a.Fan,ea.a.Chain]}checkShowBtn(e){switch(e){case ea.a.Fan:return!0;case ea.a.Chain:return this.useControl}}};buttonsvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),buttonsvue_type_script_lang_ts_metadata("design:type",Boolean)],ta.prototype,"disabled",void 0),buttonsvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),buttonsvue_type_script_lang_ts_metadata("design:type",Boolean)],ta.prototype,"useControl",void 0),buttonsvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),buttonsvue_type_script_lang_ts_metadata("design:type",Boolean)],ta.prototype,"mobile",void 0),buttonsvue_type_script_lang_ts_decorate([(0,rt.Model)("input"),buttonsvue_type_script_lang_ts_metadata("design:type",Object)],ta.prototype,"value",void 0),ta=buttonsvue_type_script_lang_ts_decorate([rt.Component],ta);const na=ta,ia=na;var oa=(0,Ct.Z)(ia,buttonsvue_type_template_id_06e82b9f_scoped_true_render,Xr,!1,null,"06e82b9f",null);const sa=oa.exports;_t()(oa,{VBtn:g.Z,VIcon:y.Z,VTooltip:_.Z});var cardCheckboxvue_type_template_id_accc3848_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"card-checkbox-wrapper",attrs:{"no-gutters":""}},[n("label",{staticClass:"card-checkbox-input-wrapper justify"},[n("input",{ref:"checkbox",attrs:{type:"checkbox","data-testid":e.dataTestid,tabindex:e.tabIndex,disabled:e.disabled},domProps:{value:e.value,checked:e.shouldBeChecked},on:{change:e.onChange}})]),e._v(" "),e.label?n("div",{on:{click:e.onLabelClick}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"checkbox-label font-weight-bold sm-text ml-2",class:e.colorClass},i),[e._v("\n          "+e._s(e.label)+"\n        ")])]}}],null,!1,366146176)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.labelHint))])]):n("span",{staticClass:"checkbox-label font-weight-bold sm-text ml-2",class:e.colorClass},[e._v("\n      "+e._s(e.label)+"\n    ")])],1):e._e()])},ra=[],cardInputs_mixin_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardInputs_mixin_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let aa=class CardInputsMixin extends(o()){};cardInputs_mixin_decorate([(0,rt.Prop)({default:!1,type:Boolean}),cardInputs_mixin_metadata("design:type",Boolean)],aa.prototype,"disabled",void 0),cardInputs_mixin_decorate([(0,rt.Prop)({default:!1,type:Boolean}),cardInputs_mixin_metadata("design:type",Boolean)],aa.prototype,"required",void 0),cardInputs_mixin_decorate([(0,rt.Prop)({default:!1,type:Boolean}),cardInputs_mixin_metadata("design:type",Boolean)],aa.prototype,"readonly",void 0),cardInputs_mixin_decorate([(0,rt.Prop)({default:!1,type:Boolean}),cardInputs_mixin_metadata("design:type",Boolean)],aa.prototype,"labelOnTop",void 0),cardInputs_mixin_decorate([(0,rt.Prop)(),cardInputs_mixin_metadata("design:type",String)],aa.prototype,"labelHint",void 0),cardInputs_mixin_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardInputs_mixin_metadata("design:type",Boolean)],aa.prototype,"alignLabelToRight",void 0),cardInputs_mixin_decorate([(0,rt.Prop)(),cardInputs_mixin_metadata("design:type",Object)],aa.prototype,"tabIndex",void 0),cardInputs_mixin_decorate([(0,rt.Prop)(),cardInputs_mixin_metadata("design:type",String)],aa.prototype,"label",void 0),cardInputs_mixin_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardInputs_mixin_metadata("design:type",Boolean)],aa.prototype,"autofocus",void 0),aa=cardInputs_mixin_decorate([gt.default],aa);const la=aa;var cardCheckboxvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardCheckboxvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let ca=class CardCheckboxComponent extends((0,gt.mixins)(la)){constructor(){super(...arguments),this.internalValue=!1}onValueChanged(){this.internalValue=this.value}created(){this.internalValue=this.value}onChange(e){"boolean"===typeof this.value&&!this.checkedValue||!this.uncheckedValue?this.fireinputEvent(e.target.checked):e.target.checked?this.fireinputEvent(this.checkedValue):this.fireinputEvent(this.uncheckedValue)}onLabelClick(){this.$refs.checkbox.click()}get shouldBeChecked(){return this.value===this.checkedValue||this.internalValue===this.checkedValue}get colorClass(){return this.color&&this.shouldBeChecked&&this.labelHighlight?`${this.color}--text`:""}fireinputEvent(e){this.internalValue=e,this.$emit("input",e)}};cardCheckboxvue_type_script_lang_ts_decorate([(0,rt.Model)("input"),cardCheckboxvue_type_script_lang_ts_metadata("design:type",Object)],ca.prototype,"value",void 0),cardCheckboxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardCheckboxvue_type_script_lang_ts_metadata("design:type",Object)],ca.prototype,"checkedValue",void 0),cardCheckboxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardCheckboxvue_type_script_lang_ts_metadata("design:type",Object)],ca.prototype,"uncheckedValue",void 0),cardCheckboxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardCheckboxvue_type_script_lang_ts_metadata("design:type",String)],ca.prototype,"dataTestid",void 0),cardCheckboxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardCheckboxvue_type_script_lang_ts_metadata("design:type",String)],ca.prototype,"color",void 0),cardCheckboxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardCheckboxvue_type_script_lang_ts_metadata("design:type",Boolean)],ca.prototype,"labelHighlight",void 0),cardCheckboxvue_type_script_lang_ts_decorate([(0,rt.Watch)("value"),cardCheckboxvue_type_script_lang_ts_metadata("design:type",Function),cardCheckboxvue_type_script_lang_ts_metadata("design:paramtypes",[]),cardCheckboxvue_type_script_lang_ts_metadata("design:returntype",void 0)],ca.prototype,"onValueChanged",null),ca=cardCheckboxvue_type_script_lang_ts_decorate([gt.default],ca);const da=ca,ua=da;var pa=(0,Ct.Z)(ua,cardCheckboxvue_type_template_id_accc3848_render,ra,!1,null,null,null);const ha=pa.exports;_t()(pa,{VRow:a.Z,VTooltip:_.Z});var cardComboBoxvue_type_template_id_97c197d2_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-combobox-wrapper",class:{column:e.mobile||e.labelOnTop}},[e.label?n("v-col",{staticClass:"pr-2 pa-0",class:e.labelSizeClasses},[n("v-row",{staticClass:"no-gutters"},[n("v-row",{staticClass:"label-wrapper no-gutters",class:{"justify-end":e.alignLabelToRight},attrs:{align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label",class:{help:e.labelHint}},i),[e._v("\n              "+e._s(e.label)+"\n              "),e.required?n("span",{staticClass:"require"}):e._e()])]}}],null,!1,3576859611)},[e._v(" "),n("span",{staticClass:"text-body-1"},[e._v(e._s(e.labelHint))])]):[n("span",{staticClass:"label font-weight-bold sm-text"},[e._v("\n            "+e._s(e.label)+"\n            "),e.required?n("span",{staticClass:"require"}):e._e()])]],2)],1)],1):e._e(),e._v(" "),n("v-col",{staticClass:"ld-combobox pa-0",class:[{"only-view":e.readonly},e.inputSizeClasses]},[n("v-combobox",{ref:"combobox",staticClass:"small-input text-body-1 font-weight-light",attrs:{flat:"",solo:"","single-line":"",outlined:"","append-icon":"arrow_drop_down","item-value":"id","item-text":"value",tabindex:e.tabIndex,items:e.myItems,loading:e.loading,rules:e.validRules,"validate-on-blur":e.validateOnBlur,"no-data-text":e.noDataText,readonly:e.readonly,multiple:e.multiselect,chips:e.multiselect,"deletable-chips":e.multiselect,disabled:e.disabled,hint:e.inputHint,"tab-index":e.tabIndex,"persistent-hint":e.persistentHint,placeholder:e.placeholder,"hide-details":e.hideDetails},on:{input:e.onItemSelected,mouseup:e.onMouseUp,blur:function(t){return e.$emit("blur",t)},click:function(t){return e.$emit("click",t)}},scopedSlots:e._u([e.chip||e.multiselect?{key:"selection",fn:function(t){var i=t.item,o=t.index;return[!e.selectionShowCount||o<e.selectionShowCount?n("v-chip",{key:JSON.stringify(i),staticClass:"v-chip--select-multi white--text",class:{"multiselect-chip":e.multiselect},attrs:{color:"primary_light",small:"",close:e.multiselect&&(!e.readonly||!e.disabled)},on:{"click:close":function(t){return e.removeItem(i)}}},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("span",e._g({},o),[e._v(e._s(i.value))])]}}],null,!0)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(i.value))])])],1):e._e(),e._v(" "),o===e.selectionShowCount?n("span",{staticClass:"grey--text text-caption"},[e._v("(+"+e._s(e.value.length-e.selectionShowCount)+" элемента)")]):e._e()]}}:null],null,!0),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1)},ma=[],fa=n(18220),grid_mixin_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},grid_mixin_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let ga=class GridMixin extends(o()){constructor(){super(...arguments),this.labelSizeClasses=null,this.inputSizeClasses=null}created(){this.labelSizeClasses={"col-xs-1 col-sm-1 col-md-1 col-lg-1 col-xl-1":1==this.labelSize,"col-xs-2 col-sm-2 col-md-2 col-lg-2 col-xl-2":2==this.labelSize,"col-xs-3 col-sm-3 col-md-3 col-lg-3 col-xl-3":3==this.labelSize,"col-xs-4 col-sm-4 col-md-4 col-lg-4 col-xl-4":4==this.labelSize,"col-xs-5 col-sm-5 col-md-5 col-lg-5 col-xl-5":5==this.labelSize,"col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6":6==this.labelSize,"col-xs-7 col-sm-7 col-md-7 col-lg-7 col-xl-7":7==this.labelSize,"col-xs-8 col-sm-8 col-md-8 col-lg-8 col-xl-8":8==this.labelSize,"col-xs-9 col-sm-9 col-md-9 col-lg-9 col-xl-9":9==this.labelSize,"col-xs-10 col-sm-10 col-md-10 col-lg-10 col-xl-10":10==this.labelSize,"col-xs-11 col-sm-11 col-md-11 col-lg-11 col-xl-11":11==this.labelSize,"col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12":12==this.labelSize},this.inputSizeClasses={"col-xs-1 col-sm-1 col-md-1 col-lg-1 col-xl-1":this.inputSize&&1==this.inputSize,"col-xs-2 col-sm-2 col-md-2 col-lg-2 col-xl-2":this.inputSize&&2==this.inputSize,"col-xs-3 col-sm-3 col-md-3 col-lg-3 col-xl-3":this.inputSize&&3==this.inputSize,"col-xs-4 col-sm-4 col-md-4 col-lg-4 col-xl-4":this.inputSize&&4==this.inputSize,"col-xs-5 col-sm-5 col-md-5 col-lg-5 col-xl-5":this.inputSize&&5==this.inputSize,"col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6":this.inputSize&&6==this.inputSize,"col-xs-7 col-sm-7 col-md-7 col-lg-7 col-xl-7":this.inputSize&&7==this.inputSize,"col-xs-8 col-sm-8 col-md-8 col-lg-8 col-xl-8":this.inputSize&&8==this.inputSize,"col-xs-9 col-sm-9 col-md-9 col-lg-9 col-xl-9":this.inputSize&&9==this.inputSize,"col-xs-10 col-sm-10 col-md-10 col-lg-10 col-xl-10":this.inputSize&&10==this.inputSize,"col-xs-11 col-sm-11 col-md-11 col-lg-11 col-xl-11":this.inputSize&&11==this.inputSize,"col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12":this.inputSize&&12==this.inputSize}}};grid_mixin_decorate([(0,rt.Prop)({default:null}),grid_mixin_metadata("design:type",Object)],ga.prototype,"inputSize",void 0),grid_mixin_decorate([(0,rt.Prop)({default:3}),grid_mixin_metadata("design:type",Object)],ga.prototype,"labelSize",void 0),ga=grid_mixin_decorate([gt.default],ga);const ya=ga;var va=n(25298),ba=n(73718),cardComboBoxvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardComboBoxvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardComboBoxvue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Ca=class CardComboBoxComponent extends((0,gt.mixins)(la,ya,va.Z)){constructor(){super(...arguments),this.selected=null,this.myItems=[],this.loading=!1,this.noDataText=this.$gettext("Нет данных"),this.myRules=[this.inputValidate.bind(this)]}onValueChanged(e,t){(e||t)&&((0,ba.Z)(e,t)||this.setValue())}onRulesChanged(e){Array.isArray(e)&&e.length?this.myRules=[this.inputValidate.bind(this),...e]:this.myRules=[this.inputValidate.bind(this)]}onSelectedChanged(){let e=[];if(this.validateSelected(),this.selected){const t=Array.isArray(this.selected)?this.selected:[this.selected];e=t.map((e=>e.id)).filter((e=>e))}this.multiselect?(0,ba.Z)(e,this.value)||this.fireInputEvent(e):0!==e.length&&this.value!==e[0]?this.fireInputEvent(e[0]):0===e.length&&this.fireInputEvent(null),this.fireUpdateSelectedEvent()}onInitialItemsChanged(e){this.checkInputType(e),this.onValueChanged(this.value,null)}onItemsChanged(e){this.checkInputType(e),this.myItems=this.items,this.onValueChanged(this.value,null)}created(){this.lazyLoad||this.initialItems||this.fetchData()}onMouseUp(){this.myItems&&0!==this.myItems.length||this.fetchData()}onItemSelected(){this.multiselect&&Array.isArray(this.selected)&&this.selected.length&&(this.selected=this.getSelectedWithoutUserInputString(this.selected))}removeItem(e){if(!Array.isArray(this.selected))return;const t=this.selected.indexOf(e);t<0||this.selected.splice(t,1)}inputValidate(e){const t=Array.isArray(this.initialItems)?this.initialItems:[],n=Array.isArray(this.myItems)?this.myItems:[],i=this.mergeArrays(n,t);let o=!1;if(e&&i.length){let t="";if(t=e,this.multiselect)Array.isArray(t)?t.forEach((e=>{if(!e.value||!e.id)return o;o=!!i.find((t=>t.value.toLowerCase()===e.value.toLowerCase()))||this.$gettext("Выберите значение из списка")})):o=!0;else{if(!t.value)return o;o=!!i.find((e=>e.value.toLowerCase()===t.value.toLowerCase()))||this.$gettext("Выберите значение из списка")}}else o=!0;return o}setValue(){let e;const t=Array.isArray(this.initialItems)?this.initialItems:[],n=Array.isArray(this.myItems)?this.myItems:[],i=this.mergeArrays(n,t);if(this.value&&i&&i.length){e=Array.isArray(this.value)?this.value:[this.value];const t=i.filter((({id:t})=>e.includes(t)));t.length?this.selected=this.multiselect?t:t[0]:this.selected=null}else this.selected=null}fireInputEvent(e){this.$emit("input",e)}fireUpdateSelectedEvent(){this.$emit("update-selected-items",this.selected)}fetchData(){return cardComboBoxvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{if(this.items)this.myItems=this.items;else if(this.vocabularyName){const e=this.constrains.length>0||this.searchV2?yield this.fetchVocabularySearch(null===this.searchV2?this.getVocabularySearchQuery():this.getVocabularySearchV2Query()):yield this.fetchVocabulary(new Pt.Yi(this.vocabularyName,!1));this.myItems=this.constrains.length>0?e.items.map((({vocabularyValue:e})=>e)):e.values}this.checkInputType(this.myItems),this.onValueChanged(this.value,null),this.$emit("on-data-received",this.myItems)}finally{this.loading=!1}}))}mergeArrays(e,t){e=Array.isArray(e)?e:[],t=Array.isArray(t)?t:[];const n=e.concat(t),i=[],o={};for(const e of n)o[e.id]||(o[e.id]=!0,i.push(e));return i}getSelectedWithoutUserInputString(e){return e.filter((e=>"string"!==typeof e))}validateSelected(){if(this.selected&&"string"===typeof this.selected)if(this.multiselect){const e=this.myItems.filter((e=>e.value.match(String(this.selected))))[0];this.selected.includes(e)||this.selected.push(e)}else this.selected=this.myItems.filter((e=>e.value.toLowerCase().match(String(this.selected).toLowerCase())))[0],this.selected||(this.selected=this.myItems[0]),this.$refs.combobox.lazyValue=this.$refs.combobox.value}checkInputType(e){if(e){Array.isArray(e)||(e=[e]);for(const t of e){if(!("id"in t))throw new Error('CardCombobox item must have "id" property');if(!("value"in t))throw new Error('CardCombobox item must have "value" property')}}}getVocabularySearchQuery(){return new Pt.j_(this.vocabularyName,[],this.isReturnActual,[],{where:this.constrains})}getVocabularySearchV2Query(){return new Pt.Ox(this.vocabularyName,this.searchV2,null,[],this.isReturnActual)}};cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Model)("input"),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Object)],Ca.prototype,"value",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Ca.prototype,"mobile",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:""}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",String)],Ca.prototype,"vocabularyName",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Array)],Ca.prototype,"items",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Array)],Ca.prototype,"initialItems",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1,type:Boolean}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Ca.prototype,"multiselect",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Ca.prototype,"persistentHint",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Ca.prototype,"lazyLoad",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Ca.prototype,"returnObject",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Object,default:null}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Object)],Ca.prototype,"searchV2",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardComboBoxvue_type_script_lang_ts_metadata("design:type",String)],Ca.prototype,"inputHint",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Number,default:100}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Number)],Ca.prototype,"limit",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Number)],Ca.prototype,"selectionShowCount",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:""}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",String)],Ca.prototype,"placeholder",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!0}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Ca.prototype,"chip",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:()=>[]}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Array)],Ca.prototype,"constrains",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!0}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Ca.prototype,"isReturnActual",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Ca.prototype,"hideDetails",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,fa.eI)("fetchVocabulary"),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Object)],Ca.prototype,"fetchVocabulary",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,fa.eI)("fetchVocabularySearch"),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Object)],Ca.prototype,"fetchVocabularySearch",void 0),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Watch)("value",{deep:!0,immediate:!0}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Function),cardComboBoxvue_type_script_lang_ts_metadata("design:paramtypes",[Object,Object]),cardComboBoxvue_type_script_lang_ts_metadata("design:returntype",void 0)],Ca.prototype,"onValueChanged",null),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Watch)("rules",{immediate:!0}),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Function),cardComboBoxvue_type_script_lang_ts_metadata("design:paramtypes",[Array]),cardComboBoxvue_type_script_lang_ts_metadata("design:returntype",void 0)],Ca.prototype,"onRulesChanged",null),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Watch)("selected"),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Function),cardComboBoxvue_type_script_lang_ts_metadata("design:paramtypes",[]),cardComboBoxvue_type_script_lang_ts_metadata("design:returntype",void 0)],Ca.prototype,"onSelectedChanged",null),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Watch)("initialItems"),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Function),cardComboBoxvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),cardComboBoxvue_type_script_lang_ts_metadata("design:returntype",void 0)],Ca.prototype,"onInitialItemsChanged",null),cardComboBoxvue_type_script_lang_ts_decorate([(0,rt.Watch)("items"),cardComboBoxvue_type_script_lang_ts_metadata("design:type",Function),cardComboBoxvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),cardComboBoxvue_type_script_lang_ts_metadata("design:returntype",void 0)],Ca.prototype,"onItemsChanged",null),Ca=cardComboBoxvue_type_script_lang_ts_decorate([gt.default],Ca);const wa=Ca,_a=wa;var xa=(0,Ct.Z)(_a,cardComboBoxvue_type_template_id_97c197d2_scoped_true_render,ma,!1,null,"97c197d2",null);const Sa=xa.exports;_t()(xa,{VChip:P.Z,VCol:r.Z,VCombobox:O.Z,VRow:a.Z,VTooltip:_.Z});var cardDatepickervue_type_template_id_47588cf6_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"card-datepicker-wrapper column",attrs:{"no-gutters":""}},[n("v-row",{class:{columnLabel:e.mobile||e.labelOnTop},attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label font-weight-bold sm-text",class:{help:e.labelHint}},i),[e._v(e._s(e.label))])]}}],null,!1,495005635)},[e._v(" "),n("span",[e._v(e._s(e.labelHint))])]):n("span",{staticClass:"label font-weight-bold sm-text"},[e._v(e._s(e.label))])],1),e._v(" "),e.required?n("div",{class:{require:e.required}}):e._e()],1)],1):e._e(),e._v(" "),n("v-col",{key:"menu",staticClass:"d-flex",class:e.inputSizeClasses},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("div",e._g({ref:"dtInput",staticClass:"dt-input",on:{click:function(e){e.stopPropagation()}}},i),[n("div",{staticClass:"dt-text-field__slot"},[n("input",{ref:"inputDate",staticClass:"date-input",class:{disabled:e.disabled||e.readonly},attrs:{id:e.inputDateId,"aria-label":"",type:"text",placeholder:e.placeholder,disabled:e.disabled||e.readonly,tabindex:e.tabIndex,autofocus:e.autofocus},on:{click:e.onInputClick,focus:e.onInputDateFocus}})]),e._v(" "),!e.canClear||e.disabled||e.readonly?e._e():n("div",{staticClass:"dt-input__icon"},[n("v-btn",{staticClass:"xs-button",attrs:{icon:"",ripple:!1},on:{click:function(t){return t.stopPropagation(),e.clear(t)}}},[n("v-icon",{attrs:{color:"grey"}},[e._v("close")])],1)],1),e._v(" "),n("div",{staticClass:"dt-input__icon"},[n("v-btn",{staticClass:"xs-button",attrs:{icon:"",ripple:!1},on:{click:function(t){return t.stopPropagation(),e.onPickerClick(t)}}},[n("svg-icon",{staticClass:"mr-1 svg-icon primary--text",attrs:{icon:"mdi_event"}})],1)],1)])]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),n("v-date-picker",{ref:"picker",attrs:{"no-title":"",scrollable:"",min:e.minDateString,max:e.maxDateString,disabled:e.disabled||e.readonly,color:"primary","first-day-of-week":e.firstDayOfWeek,locale:e.locale,"allowed-dates":e.allowedDates},on:{input:e.onSelectDate,change:function(t){e.menu=!1}},model:{value:e.dateString,callback:function(t){e.dateString=t},expression:"dateString"}},[n("v-spacer"),e._v(" "),n("v-btn",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v(" Отмена ")])],1)],1)],1),e._v(" "),e.dateonly?e._e():n("v-col",{staticClass:"d-flex px-0 pt-0",class:{"ml-2":!e.mobile&&!e.labelOnTop,"mt-2":e.mobile||e.labelOnTop}},[n("div",{ref:"timeInput",staticClass:"dt-input"},[n("div",{staticClass:"dt-text-field__slot"},[n("input",{ref:"inputTime",staticClass:"time-input",class:{"time-picker-empty":!e.timeString},attrs:{id:e.inputTimeId,"aria-label":"",type:"text",tabindex:e.timeTabIndex,disabled:e.isDateEmpty,placeholder:e.$gettext("ЧЧ:ММ")},on:{focus:e.onInputTimeFocus}})]),e._v(" "),n("div",{staticClass:"pr-2"},[n("div",{staticClass:"dt-input__icon time-input-btn"},[n("v-btn",{staticClass:"xs-button",attrs:{icon:"",ripple:!1},on:{click:function(t){return t.stopPropagation(),e.clearTimeValue(t)}}},[n("v-icon",{attrs:{color:"grey"}},[e._v("close")])],1),e._v(" "),n("v-btn",{staticClass:"xs-button",attrs:{icon:"",ripple:!1},on:{click:function(e){e.stopPropagation()}}},[n("v-icon",{staticClass:"primary--text",attrs:{size:"21"}},[e._v("access_time")])],1)],1)])]),e._v(" "),e.disabled||e.readonly?n("v-text-field",{staticClass:"small-input custom-time-picker",staticStyle:{"background-color":"white"},attrs:{slot:"activator",label:"",placeholder:e.$gettext("ЧЧ:ММ"),"prepend-inner-icon":"access_time",flat:"",solo:"","hide-details":"","single-line":"",outlined:"",readonly:"",disabled:e.disabled},slot:"activator",model:{value:e.timeString,callback:function(t){e.timeString=t},expression:"timeString"}}):e._e()],1)],1),e._v(" "),e.showError?n("v-row",{staticClass:"card-datepicker-validate",attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses}):e._e(),e._v(" "),n("v-col",[n("transition",{attrs:{name:"squash"}},[n("span",{staticClass:"text-body-1 font-weight-light",class:{"error--text":e.warningHint,"grey--text lighten-1":!e.validationMesssage}},[e._v(e._s(e.validationMesssage))])])],1)],1):e._e()],1)},Ia=[],Da=n(40395),cardDatepickervue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardDatepickervue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardDatepickervue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Ra="dt-input--is-focused";let Ta=0,Pa=class CardDatepickerComponent extends((0,gt.mixins)(la,ya,va.Z)){constructor(){super(...arguments),this.date=null,this.dateString=null,this.timeString=null,this.defaultHour="09",this.defaultMinuts="00",this.menu=!1,this.dateMask=null,this.timeMask=null,this.imaskOnChange=null,this.imaskTimeOnChange=null,this.event=null,this.validationMesssage="",this.errorBucket=[],this.errorsHandler=[],this.inputDateId="inputDate"+Ta++,this.inputTimeId="inputTime"+Ta++}onValueChanged(e,t){if(!(e==t||e instanceof Date&&t instanceof Date&&e.getTime()===t.getTime()||e instanceof Date&&this.date&&e.getTime()===this.date.getTime())){if(e?(this.date=new Date(e),this.dateString=this.date.toISOString()):(this.dateString="",this.date=null),this.date){const e=this.$refs.inputDate;e&&(e.value=this.formattedDate);let t=`0${this.date.getHours()}`,n=`0${this.date.getMinutes()}`;t=t.substring(t.length-2,t.length),n=n.substring(n.length-2,n.length),this.timeString=`${t}:${n}`}else this.timeString="",this.clear();setTimeout((()=>{this.dateMask.updateValue(),this.timeMask&&this.timeMask.updateValue();const e=this.$refs.inputTime;e&&e.value!==this.timeString&&(e.value=this.timeString)}),100)}}onDateonlyChanged(){this.dateonly||this.setTimeMask()}created(){this.form&&this.form.register(this,null),this.fullErrorBucket()}destroyed(){this.form&&this.form.unregister(this,null)}mounted(){const e=this.$refs.inputDate;if(!e)throw new Error("Не найден элемент input для ввода даты");e.value=this.formattedDate;const t={mask:Date,lazy:!0,overwrite:!0,autofix:!0,blocks:{d:{mask:Da.ZP.MaskedRange,placeholderChar:"_",from:1,to:31,maxLength:2},m:{mask:Da.ZP.MaskedRange,placeholderChar:"_",from:1,to:12,maxLength:2},Y:{mask:Da.ZP.MaskedRange,placeholderChar:"_",from:1900,to:2999,maxLength:4}},min:null,max:null};this.minDate&&(t.min=this.minDate),this.maxDate&&(t.max=this.maxDate),this.dateMask=(0,Da.ZP)(e,t),this.imaskOnChange=this.dateMask._onChange,this.dateMask._onChange=this.onDateMaskChange.bind(this),this.dateMask._unbindEvents(),this.dateMask._bindEvents(),this.dateMask.on("complete",(()=>this.onMaskedValueChanged(this.dateMask.value))),this.setTimeMask()}beforeDestroy(){this.dateMask.off("complete",null),this.timeMask&&this.timeMask.off("complete",null)}onDateMaskChange(e){try{this.$refs.dtInput&&this.$refs.dtInput.classList.remove(Ra);const t=e.target.value;if(t){const e=this.parseDate(t);if(!e||e instanceof Date&&isNaN(e.getDate()))return this.menu=!1,this.clear(),this.dateMask.el.value="",void this.dateMask.updateValue()}else this.clear();this.menu?this.event=e:this.imaskOnChange(e)}finally{this.validateOnBlur&&this.$nextTick((()=>this.validate()))}}onTimeMaskChange(e){this.$refs.timeInput&&this.$refs.timeInput.classList.remove(Ra);const t=e.target.value,n=this.parseTime(t);n!==t&&(this.timeString=n,e.target.value=n),this.imaskTimeOnChange(e)}onMaskedValueChanged(e){let t=this.parseDate(e);this.dateonly?t.setHours(0,0,0,0):t=this.addTimeToDate(t),this.onValueChanged(t,this.date),this.emitInput(t),this.$nextTick((()=>this.validate()))}onTimeMaskedValueChanged(e){if(!this.dateString)return;const[t=this.defaultHour,n=this.defaultMinuts]=e?e.split(":"):[],i=new Date(this.dateString);i.setHours(Number(t)),i.setMinutes(Number(n)),this.onValueChanged(i,this.date),this.emitInput(i),this.$nextTick((()=>this.validate()))}onSelectDate(e){this.dateMask.el.value=new Date(e).toLocaleDateString(this.locale),this.imaskOnChange(this.event),this.event=null}onInputClick(){setTimeout((()=>this.menu=!1))}onInputDateFocus(){this.$refs.dtInput&&this.$refs.dtInput.classList.add(Ra)}onInputTimeFocus(){this.$refs.timeInput&&this.$refs.timeInput.classList.add(Ra)}onPickerClick(){(this.disabled||this.readonly)&&this.canClear||(this.menu=!this.menu)}clear(){this.dateMask&&(this.dateMask.el.value=""),this.imaskOnChange&&this.imaskOnChange(this.event),this.dateString="",this.date=null,this.timeMask&&this.clearTimeValue(),this.emitInput(null),this.validate()}clearTimeValue(){this.timeMask.el.value="",this.imaskTimeOnChange(this.event),this.timeString=""}validate(){this.errorBucket=[];let e=null;return this.validationMesssage="",this.validRules.forEach((t=>{e=t(this.date),!0!==e&&(this.validationMesssage=e,this.errorBucket.push(e))})),!this.validationMesssage}fullErrorBucket(){this.errorBucket=[];let e=null;this.validRules.forEach((t=>{e=t(this.date),!0!==e&&this.errorBucket.push(e)}))}setTimeMask(){return cardDatepickervue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){yield this.$nextTick();const e=this.$refs.inputTime;if(e){const t={mask:"HH:mm",lazy:!1,overwrite:!0,autofix:!0,blocks:{HH:{mask:Da.ZP.MaskedRange,placeholderChar:"Ч",from:0,to:23,maxLength:2},mm:{mask:Da.ZP.MaskedRange,placeholderChar:"М",from:0,to:59,maxLength:2}}};this.timeMask=(0,Da.ZP)(e,t),this.imaskTimeOnChange=this.timeMask._onChange,this.timeMask._onChange=this.onTimeMaskChange,this.timeMask._unbindEvents(),this.timeMask._bindEvents(),this.timeMask.on("complete",(()=>this.onTimeMaskedValueChanged(this.timeMask.value)))}}))}parseDate(e){if(!e||e.length<10)return null;try{const t=e.split(".");let n;return n=this.locale.includes("ru")?new Date(Number(t[2]),Number(t[1])-1,Number(t[0])):new Date(Number(t[2]),Number(t[0])-1,Number(t[1])),n}catch(e){return this.$log.error(e),null}}emitInput(e){this.$emit("input",e)}parseTime(e){let[t=this.defaultHour,n=this.defaultMinuts]=e?e.split(":"):[];return(!/^\d+$/.test(t)||Number(t)<0||Number(t)>23)&&(t=this.defaultHour),(!/^\d+$/.test(n)||Number(n)<0||Number(n)>59)&&(n=this.defaultMinuts),`${t}:${n}`}addTimeToDate(e){if(!e)return;const[t=this.defaultHour,n=this.defaultMinuts]=this.timeString?this.timeString.split(":"):[];return e.setHours(Number(t),Number(n),0,0),e}get isDateEmpty(){return!this.date}get formattedDate(){return this.date?this.date.toLocaleDateString(this.locale):""}get minDateString(){return this.minDate?this.minDate.toISOString():""}get maxDateString(){return this.maxDate?this.maxDate.toISOString():""}get locale(){return this.$language.current}get firstDayOfWeek(){return this.locale.includes("en")?0:1}get timeTabIndex(){return this.tabIndex?Number(this.tabIndex)+1:-1}get showError(){return!!this.validRules.length&&Boolean(this.validationMesssage)}get warningHint(){return Boolean(this.validationMesssage)||this.errorsHandler.length>0}};cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDatepickervue_type_script_lang_ts_metadata("design:type",Object)],Pa.prototype,"value",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDatepickervue_type_script_lang_ts_metadata("design:type",Boolean)],Pa.prototype,"mobile",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardDatepickervue_type_script_lang_ts_metadata("design:type",Boolean)],Pa.prototype,"alignLabelToRight",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardDatepickervue_type_script_lang_ts_metadata("design:type",Boolean)],Pa.prototype,"persistentHint",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDatepickervue_type_script_lang_ts_metadata("design:type",String)],Pa.prototype,"inputHint",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:"ДД.ММ.ГГГГ"}),cardDatepickervue_type_script_lang_ts_metadata("design:type",String)],Pa.prototype,"placeholder",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDatepickervue_type_script_lang_ts_metadata("design:type",Date)],Pa.prototype,"minDate",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDatepickervue_type_script_lang_ts_metadata("design:type",Date)],Pa.prototype,"maxDate",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!0}),cardDatepickervue_type_script_lang_ts_metadata("design:type",Boolean)],Pa.prototype,"canClear",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!0}),cardDatepickervue_type_script_lang_ts_metadata("design:type",Boolean)],Pa.prototype,"dateonly",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDatepickervue_type_script_lang_ts_metadata("design:type",Function)],Pa.prototype,"allowedDates",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Inject)({from:"form",default:null}),cardDatepickervue_type_script_lang_ts_metadata("design:type",Object)],Pa.prototype,"form",void 0),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Watch)("value",{immediate:!0}),cardDatepickervue_type_script_lang_ts_metadata("design:type",Function),cardDatepickervue_type_script_lang_ts_metadata("design:paramtypes",[Object,Object]),cardDatepickervue_type_script_lang_ts_metadata("design:returntype",void 0)],Pa.prototype,"onValueChanged",null),cardDatepickervue_type_script_lang_ts_decorate([(0,rt.Watch)("dateonly"),cardDatepickervue_type_script_lang_ts_metadata("design:type",Function),cardDatepickervue_type_script_lang_ts_metadata("design:paramtypes",[]),cardDatepickervue_type_script_lang_ts_metadata("design:returntype",void 0)],Pa.prototype,"onDateonlyChanged",null),Pa=cardDatepickervue_type_script_lang_ts_decorate([gt.default],Pa);const Oa=Pa,ka=Oa;var Fa=(0,Ct.Z)(ka,cardDatepickervue_type_template_id_47588cf6_scoped_true_render,Ia,!1,null,"47588cf6",null);const Aa=Fa.exports;_t()(Fa,{VBtn:g.Z,VCol:r.Z,VDatePicker:S.Z,VIcon:y.Z,VMenu:W.Z,VRow:a.Z,VSpacer:me.Z,VTextField:C.Z,VTooltip:_.Z});var cardDocitemsViewvue_type_template_id_482258ec_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[e._v("\n    "+e._s(e.label)+"\n  ")]),e._v(" "),n("v-col",{attrs:{cols:"12"}},[e.loading?n("div",{staticStyle:{height:"50px"}},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.loading}})],1):e._e(),e._v(" "),e._l(e.fullDocuments,(function(t,i){return n("v-col",{key:t.id+":"+e._uid,staticClass:"mb-2"},[n("v-row",{attrs:{"no-gutters":"",justify:"space-between",align:"center"}},[n("div",[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.viewingModel[i],expression:"!viewingModel[i]"}],staticClass:"item-collapse-button",attrs:{size:"18"},on:{click:function(t){return e.toggleItemViewing(i)}}},[e._v("\n            add\n          ")]),e._v(" "),n("v-icon",{directives:[{name:"show",rawName:"v-show",value:e.viewingModel[i],expression:"viewingModel[i]"}],staticClass:"item-collapse-button",attrs:{size:"18"},on:{click:function(t){return e.toggleItemViewing(i)}}},[e._v("\n            remove\n          ")]),e._v(" "),n("span",[e._v(e._s(t.attributes.Name))])],1),e._v(" "),n("v-row",{staticStyle:{"max-width":"fit-content"},attrs:{"no-gutters":"",align:"center"}},[e.isMobile?e._e():n("v-btn",{staticClass:"square-sm-button rounded-button grey lighten-3",attrs:{outlined:""},on:{click:function(n){return e.onOpenDocView(t)}}},[n("svg-icon",{staticClass:"svg-icon grey--text darken-3'",attrs:{icon:"chrome_reader_mode"}})],1)],1)],1),e._v(" "),n("div",{on:{dblclick:function(n){return e.onOpenDoc(t)}}},[n("document-list-item",{directives:[{name:"show",rawName:"v-show",value:e.viewingModel[i],expression:"viewingModel[i]"}],attrs:{document:t,selected:!1,"action-context":e.context,"entity-view-mode":e.context.entityViewMode,"content-type":e.context.contentType}})],1)],1)}))],2)],1)},$a=[],ja=n(70294),cardDocitemsViewvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardDocitemsViewvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardDocitemsViewvue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Ea=class CardDocitemViewComponent extends(o()){constructor(){super(...arguments),this.fullDocuments=[],this.viewingModel=[],this.loading=!1}onDocumentsChange(){this.documents&&(this.fullDocuments=Array.isArray(this.documents)?this.documents:[this.documents])}onDocIdsChange(e,t){return cardDocitemsViewvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.docIds&&!(0,ba.Z)(e,t)&&(yield this.fetchDocuments())}))}created(){this.createDocItemsVieweingModel()}toggleItemViewing(e){this.viewingModel[e]=!this.viewingModel[e],this.$forceUpdate()}onOpenDocView(e){this.$app.view(this.context,Ue.zc.Document,e)}onOpenDoc(e){this.$app.viewDoc(e.id,this.context)}createDocItemsVieweingModel(){const e=[];this.fullDocuments.forEach((()=>{e.push(!this.hideAl)})),this.viewingModel=o().observable(e)}fetchDocuments(){return cardDocitemsViewvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{if(Array.isArray(this.docIds))for(const e of this.docIds){const t=yield this.queryBus.exec(new He.U_(e,Ue.dS.View));this.fullDocuments.push(t)}else{const e=yield this.queryBus.exec(new He.U_(this.docIds,Ue.dS.View));this.fullDocuments.push(e)}}finally{this.loading=!1}}))}};cardDocitemsViewvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDocitemsViewvue_type_script_lang_ts_metadata("design:type",Object)],Ea.prototype,"documents",void 0),cardDocitemsViewvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDocitemsViewvue_type_script_lang_ts_metadata("design:type",Object)],Ea.prototype,"docIds",void 0),cardDocitemsViewvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardDocitemsViewvue_type_script_lang_ts_metadata("design:type",Boolean)],Ea.prototype,"hideAl",void 0),cardDocitemsViewvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDocitemsViewvue_type_script_lang_ts_metadata("design:type",Object)],Ea.prototype,"context",void 0),cardDocitemsViewvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardDocitemsViewvue_type_script_lang_ts_metadata("design:type",String)],Ea.prototype,"label",void 0),cardDocitemsViewvue_type_script_lang_ts_decorate([(0,ot.t)(Ae.M.IQueryBus),cardDocitemsViewvue_type_script_lang_ts_metadata("design:type",Object)],Ea.prototype,"queryBus",void 0),cardDocitemsViewvue_type_script_lang_ts_decorate([(0,rt.Watch)("documents",{immediate:!0}),cardDocitemsViewvue_type_script_lang_ts_metadata("design:type",Function),cardDocitemsViewvue_type_script_lang_ts_metadata("design:paramtypes",[]),cardDocitemsViewvue_type_script_lang_ts_metadata("design:returntype",void 0)],Ea.prototype,"onDocumentsChange",null),cardDocitemsViewvue_type_script_lang_ts_decorate([(0,rt.Watch)("docIds",{immediate:!0}),cardDocitemsViewvue_type_script_lang_ts_metadata("design:type",Function),cardDocitemsViewvue_type_script_lang_ts_metadata("design:paramtypes",[Object,Object]),cardDocitemsViewvue_type_script_lang_ts_metadata("design:returntype",Promise)],Ea.prototype,"onDocIdsChange",null),Ea=cardDocitemsViewvue_type_script_lang_ts_decorate([(0,gt.default)({components:{"document-list-item":ja.Z}})],Ea);const Ma=Ea,Na=Ma;var Va=(0,Ct.Z)(Na,cardDocitemsViewvue_type_template_id_482258ec_scoped_true_render,$a,!1,null,"482258ec",null);const Ba=Va.exports;_t()(Va,{VBtn:g.Z,VCol:r.Z,VIcon:y.Z,VRow:a.Z});var cardEditTextvue_type_template_id_7418af20_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"edit-text-wrapper"},[n("v-row",{class:{column:e.mobile||e.labelOnTop},attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label",class:{help:e.labelHint},style:e.labelStyle},i),[e._v("\n                "+e._s(e.label)+"\n                "),e.required?n("span",{staticClass:"require"}):e._e()])]}}],null,!1,430857962)},[e._v(" "),n("span",[e._v(e._s(e.labelHint))])]):[n("span",{staticClass:"label",style:e.labelStyle},[e._v("\n              "+e._s(e.label)+"\n              "),e.required?n("span",{staticClass:"require"}):e._e()])]],2)],1)],1):e._e(),e._v(" "),n("v-col",{staticClass:"d-flex",class:e.inputSizeClasses},[n("v-text-field",{staticClass:"small-input text-body-1 font-weight-light my-0",class:{disabled:e.disabled},attrs:{value:e.text,type:e.type,flat:"",solo:e.solo,"single-line":"",outlined:"","persistent-hint":e.persistentHint,rules:e.validRules,"validate-on-blur":e.validateOnBlur,placeholder:e.placeholder,disabled:e.disabled,readonly:e.readonly,hint:e.inputHint,mask:e.mask,tabindex:e.tabIndex,maxlength:e.maxlength,"hide-details":e.hideDetails},on:{change:function(t){return e.$emit("change",t)},input:function(t){return e.$emit("input",t)},blur:function(t){return e.$emit("blur",t)},click:function(t){return e.$emit("click",t)}},scopedSlots:e._u([{key:"append",fn:function(){return[e.clearIcon&&e.text?n("v-icon",{attrs:{color:"red"},on:{click:function(t){return e.$emit("input","")}}},[e._v(" close ")]):e._e()]},proxy:!0}])})],1)],1)],1)},La=[],cardEditTextvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardEditTextvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ua=class CardEditTextComponent extends((0,gt.mixins)(va.Z,ya,la)){get appendIcon(){return this.clearIcon&&this.text?"close":""}get labelStyle(){return{"text-align":this.alignLabelToRight?"end":"start"}}};cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Model)("input"),cardEditTextvue_type_script_lang_ts_metadata("design:type",Object)],Ua.prototype,"text",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardEditTextvue_type_script_lang_ts_metadata("design:type",Boolean)],Ua.prototype,"mobile",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:"text"}),cardEditTextvue_type_script_lang_ts_metadata("design:type",String)],Ua.prototype,"type",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1,type:Boolean}),cardEditTextvue_type_script_lang_ts_metadata("design:type",Boolean)],Ua.prototype,"clearIcon",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardEditTextvue_type_script_lang_ts_metadata("design:type",Boolean)],Ua.prototype,"persistentHint",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardEditTextvue_type_script_lang_ts_metadata("design:type",String)],Ua.prototype,"inputHint",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardEditTextvue_type_script_lang_ts_metadata("design:type",String)],Ua.prototype,"mask",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardEditTextvue_type_script_lang_ts_metadata("design:type",Object)],Ua.prototype,"maxlength",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:""}),cardEditTextvue_type_script_lang_ts_metadata("design:type",String)],Ua.prototype,"placeholder",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardEditTextvue_type_script_lang_ts_metadata("design:type",Boolean)],Ua.prototype,"hideDetails",void 0),cardEditTextvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!0}),cardEditTextvue_type_script_lang_ts_metadata("design:type",Boolean)],Ua.prototype,"solo",void 0),Ua=cardEditTextvue_type_script_lang_ts_decorate([gt.default],Ua);const Ha=Ua,Qa=Ha;var za=(0,Ct.Z)(Qa,cardEditTextvue_type_template_id_7418af20_scoped_true_render,La,!1,null,"7418af20",null);const Za=za.exports;_t()(za,{VCol:r.Z,VIcon:y.Z,VRow:a.Z,VTextField:C.Z,VTooltip:_.Z});var Wa,cardFolderStructurevue_type_template_id_52da8d15_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{"no-gutters":""}},[e.customHeader.length?n("v-col",{attrs:{cols:"12"}},e._l(e.customHeader,(function(t,i){return n("v-row",{key:i,attrs:{"no-gutters":""}},[n("v-btn",{staticClass:"small-button sm-text mr-2",attrs:{outlined:"",color:e.stateBtnColor(t)},on:{click:function(e){return t.action()}}},[e._v("\n        "+e._s(t.title)+"\n      ")])],1)})),1):e._e(),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("span",{staticClass:"tree-control sm-text black--text lighten-1 mx-2",on:{click:e.onCloseAll}},[e._v("Свернуть всё")]),e._v(" "),n("span",{staticClass:"tree-control sm-text black--text lighten-1 mx-2",on:{click:e.onOpenAll}},[e._v("Развернуть всё")])]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{size:18,color:"primary",indeterminate:""}}),e._v(" "),n("v-row",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"mt-2",attrs:{"no-gutters":""}},[n("v-col",[n("v-treeview",{attrs:{items:e.structureItems,"item-key":"id","item-text":"name","item-children":"items","open-on-click":"","return-object":"",open:e.opened,"expand-icon":e.expandIcon},on:{"update:open":function(t){e.opened=t}},scopedSlots:e._u([{key:"prepend",fn:function(t){var i=t.item,o=t.open;return[i.selectable?n("v-checkbox",{attrs:{label:i.name,ripple:!1,"hide-details":""},on:{change:i.selectable.action},model:{value:i.selectable.value,callback:function(t){e.$set(i.selectable,"value",t)},expression:"item.selectable.value"}}):[n("svg-icon",{staticClass:"svg-icon",class:[{"not-file":!i.fileInfo},e.setIconColor(i,o)],attrs:{icon:e.setNodeIcon(i,o)}})]]}},{key:"label",fn:function(t){var i=t.item,o=t.open;return[i.selectable?e._e():n("span",{staticClass:"node-title",class:{"font-weight-bold":o&&i.root&&i.items.length,"root-font":i.root},on:{click:function(e){i.mainAction&&i.mainAction()}}},[e._v("\n            "+e._s(i.name)+"\n          ")])]}},{key:"append",fn:function(t){var i=t.item;return[n("v-row",{attrs:{"no-gutters":""}},e._l(i.actions,(function(t,i){return n("v-col",{key:i,staticClass:"action-icon mx-0"},[t.tooltip?n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("span",e._g({},o),[t.icon?n("v-icon",{staticClass:"medium-icon mx-0 grey--text darken-3 ml-2",on:{click:t.action}},[e._v("\n                      "+e._s(t.icon)+"\n                    ")]):e._e(),e._v(" "),t.svgIcon?n("svg-icon",{staticClass:"svg-icon",attrs:{icon:t.svgIcon}}):e._e()],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.tooltip))])]):[t.icon?n("v-icon",{staticClass:"medium-icon mx-0 grey--text darken-3 ml-2",on:{click:t.action}},[e._v("\n                  "+e._s(t.icon)+"\n                ")]):e._e(),e._v(" "),t.svgIcon?n("svg-icon",{staticClass:"svg-icon",attrs:{icon:t.svgIcon}}):e._e()]],2)})),1)]}}]),model:{value:e.selection,callback:function(t){e.selection=t},expression:"selection"}})],1)],1)],1)},qa=[],Ga=n(74769);(function(e){e[e["Folder"]=0]="Folder",e[e["File"]=1]="File",e[e["Document"]=2]="Document"})(Wa||(Wa={}));var cardFolderStructurevue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardFolderStructurevue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ka=class CardFolderStructuteComponent extends(o()){constructor(){super(...arguments),this.selection=[],this.opened=[],this.loading=!1}onOpenAll(){this.opened=this.openAllNodes(this.structureItems)}onCloseAll(){this.opened=[]}openAllNodes(e){return e.forEach((e=>{this.opened.push(e),Array.isArray(e.items)&&e.items.length&&this.openAllNodes(e.items)})),this.opened}stateBtnColor(e){return e.color?e.color:"primary"}setNodeIcon(e,t){var n,i;return(null===(n=e.nodeIcon)||void 0===n?void 0:n.iconName)?e.nodeIcon.iconColor:e.itemType===Wa.Document?"document":e.itemType===Wa.Folder?t&&(null===(i=e.items)||void 0===i?void 0:i.length)?"folder_opened":"folder_closed":e.itemType===Wa.File?Ot.C.extentionSvgIcon(e.fileInfo.fileExtension):void 0}setIconColor(e,t){var n,i;return(null===(n=e.nodeIcon)||void 0===n?void 0:n.iconColor)?e.nodeIcon.iconColor:e.itemType===Wa.Document?"primary--text":e.itemType===Wa.Folder?t&&(null===(i=e.items)||void 0===i?void 0:i.length)?"primary--text":"orange--text":e.itemType===Wa.File?Ot.C.extentionSvgIcon(e.fileInfo.fileExtension):void 0}customButton(e){return e.type===Ga.i.Button}customIcon(e){return e.type===Ga.i.Icon}get customHeader(){return Array.isArray(this.customActions)&&this.customActions.length?this.customActions:[]}get expandIcon(){return this.customExpandIcon?this.customExpandIcon:"keyboard_arrow_down"}};cardFolderStructurevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardFolderStructurevue_type_script_lang_ts_metadata("design:type",Array)],Ka.prototype,"structureItems",void 0),cardFolderStructurevue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!0}),cardFolderStructurevue_type_script_lang_ts_metadata("design:type",Boolean)],Ka.prototype,"multipleOpenedNodes",void 0),cardFolderStructurevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardFolderStructurevue_type_script_lang_ts_metadata("design:type",String)],Ka.prototype,"customExpandIcon",void 0),cardFolderStructurevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardFolderStructurevue_type_script_lang_ts_metadata("design:type",Array)],Ka.prototype,"customActions",void 0),Ka=cardFolderStructurevue_type_script_lang_ts_decorate([gt.default],Ka);const Ya=Ka,Ja=Ya;var Xa=(0,Ct.Z)(Ja,cardFolderStructurevue_type_template_id_52da8d15_scoped_true_render,qa,!1,null,"52da8d15",null);const el=Xa.exports;_t()(Xa,{VBtn:g.Z,VCheckbox:T.Z,VCol:r.Z,VIcon:y.Z,VProgressCircular:V.Z,VRow:a.Z,VTooltip:_.Z,VTreeview:ve.Z});var cardRadiobuttonvue_type_template_id_6dc5159d_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"radiobutton-wrapper",class:{column:e.mobile||e.labelOnTop,reverse:!e.labelToLeft}},[n("div",{on:{click:e.onLabelClick}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label",class:{help:e.labelHint}},i),[e._v(e._s(e.label))])]}}],null,!1,1033674075)},[e._v(" "),n("span",[e._v(e._s(e.labelHint))])]):n("span",{staticClass:"label"},[e._v(e._s(e.label))])],1),e._v(" "),n("div",{staticClass:"radiobutton-input mr-1"},[n("input",{ref:"radioInput",attrs:{type:"radio",disabled:e.disabled},domProps:{value:e.value,checked:e.isActive},on:{change:function(t){return e.$emit("change",t.target.value)},blur:function(t){return e.$emit("blur",t)}}})])])},tl=[],cardRadiobuttonvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardRadiobuttonvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let nl=class CardRadiobuttonComponent extends((0,gt.mixins)(la)){constructor(){super(...arguments),this.isActive=!1}mounted(){var e;null===(e=this.radio)||void 0===e||e.register(this)}beforeDestroy(){var e;null===(e=this.radio)||void 0===e||e.unregister(this)}onLabelClick(){this.$refs.radioInput.click()}};cardRadiobuttonvue_type_script_lang_ts_decorate([(0,rt.Model)("input"),cardRadiobuttonvue_type_script_lang_ts_metadata("design:type",Object)],nl.prototype,"value",void 0),cardRadiobuttonvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardRadiobuttonvue_type_script_lang_ts_metadata("design:type",String)],nl.prototype,"label",void 0),cardRadiobuttonvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardRadiobuttonvue_type_script_lang_ts_metadata("design:type",Boolean)],nl.prototype,"labelToLeft",void 0),cardRadiobuttonvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardRadiobuttonvue_type_script_lang_ts_metadata("design:type",Boolean)],nl.prototype,"mobile",void 0),cardRadiobuttonvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardRadiobuttonvue_type_script_lang_ts_metadata("design:type",Boolean)],nl.prototype,"labelOnTop",void 0),cardRadiobuttonvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardRadiobuttonvue_type_script_lang_ts_metadata("design:type",Boolean)],nl.prototype,"disabled",void 0),cardRadiobuttonvue_type_script_lang_ts_decorate([(0,rt.Inject)({from:"radio"}),cardRadiobuttonvue_type_script_lang_ts_metadata("design:type",Object)],nl.prototype,"radio",void 0),nl=cardRadiobuttonvue_type_script_lang_ts_decorate([gt.default],nl);const il=nl,ol=il;var sl=(0,Ct.Z)(ol,cardRadiobuttonvue_type_template_id_6dc5159d_scoped_true_render,tl,!1,null,"6dc5159d",null);const rl=sl.exports;_t()(sl,{VTooltip:_.Z});var cardRadiogroupvue_type_template_id_4b574261_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{staticClass:"pa-0"},[n("v-row",{class:{column:e.mobile||e.labelOnTop},attrs:{"no-gutters":""}},[e.label?n("v-col",{class:e.labelSizeClasses},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label",class:{help:e.labelHint}},i),[e._v("\n            "+e._s(e.label)+"\n          ")])]}}],null,!1,403553659)},[e._v(" "),n("span",[e._v(e._s(e.labelHint))])]):[n("div",{staticClass:"label"},[e._v("\n          "+e._s(e.label)+"\n          "),e.required?n("span",{staticClass:"require"}):e._e()]),e._v(" "),e.showHint?n("div",{staticClass:"text-caption font-weight-light",class:{"warning--text":e.validationMesssage,"grey--text lighten-1":!e.validationMesssage}},[e._v("\n          "+e._s(e.validationMesssage?e.validationMesssage:e.inputHint)+"\n        ")]):e._e()]],2):e._e(),e._v(" "),n("v-col",{class:[e.inputSizeClasses]},[e.column?[e._t("default")]:n("div",{staticClass:"d-flex flex-wrap"},[e._t("default")],2)],2)],1)],1)},al=[],ll=n(47767),cardRadiogroupvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardRadiogroupvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let cl=class CardRadioGroupComponent extends((0,gt.mixins)(la,ya,va.Z)){constructor(){super(...arguments),this.radio={register:this.register.bind(this),unregister:this.unregister.bind(this)},this.radios=[],this.internalValue=null,this.hasInput=!1,this.myRules=[],this.errorBucket=[],this.validationMesssage="",this.showInputHint=!1}onValueChange(){void 0!==this.value&&null!==this.value&&(this.internalValue=this.value,this.setActiveRadio())}onRadiosChange(){this.radios&&this.radios.length&&this.setActiveRadio()}created(){this.form&&this.form.register(this,null),this.fullErrorBucket()}destroyed(){this.form&&this.form.unregister(this,null)}onRadioChange(e){this.disabled||(this.hasInput=!0,this.internalValue=e,this.$emit("change",this.internalValue),this.setActiveRadio(),this.$nextTick((()=>this.validate())))}onRadioBlur(e){e.relatedTarget&&e.relatedTarget.classList.contains("card-radiobutton")||(this.hasInput=!0,this.$emit("blur",e))}register(e){e.$on("change",this.onRadioChange),e.$on("blur",this.onRadioBlur),this.radios.push(e)}unregister(e){e.$off("change",this.onRadioChange),e.$off("blur",this.onRadioBlur);const t=this.radios.findIndex((t=>t===e));t>-1&&this.radios.splice(t,1)}setActiveRadio(){for(let e=this.radios.length;--e>=0;e){const t=this.radios[e];if(!t)return;t.isActive=this.internalValue==t.value||(0,ba.Z)(this.internalValue,t.value)}}fullErrorBucket(){this.errorBucket=[];const e=(0,ll.n0)()(this.value);!0!==e&&this.errorBucket.push(e)}validate(){if(!String(this.value))return;this.errorBucket=[],this.validationMesssage="";const e=(0,ll.n0)()(String(this.value));return!0!==e&&(this.validationMesssage=e,this.errorBucket.push(e)),!this.validationMesssage}get showHint(){return Boolean(this.validationMesssage||this.inputHint&&this.showInputHint)}get hasError(){return Boolean(this.validationMesssage)||this.errorBucket.length>0}};cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Model)("change"),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Object)],cl.prototype,"value",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",String)],cl.prototype,"label",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Boolean)],cl.prototype,"row",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!0}),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Boolean)],cl.prototype,"column",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Boolean)],cl.prototype,"disabled",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Boolean)],cl.prototype,"required",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Boolean)],cl.prototype,"mobile",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",String)],cl.prototype,"inputHint",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Inject)({from:"form",default:null}),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Object)],cl.prototype,"form",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Provide)("radio"),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Object)],cl.prototype,"radio",void 0),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Watch)("value",{immediate:!0}),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Function),cardRadiogroupvue_type_script_lang_ts_metadata("design:paramtypes",[]),cardRadiogroupvue_type_script_lang_ts_metadata("design:returntype",void 0)],cl.prototype,"onValueChange",null),cardRadiogroupvue_type_script_lang_ts_decorate([(0,rt.Watch)("radios.length",{immediate:!0,deep:!0}),cardRadiogroupvue_type_script_lang_ts_metadata("design:type",Function),cardRadiogroupvue_type_script_lang_ts_metadata("design:paramtypes",[]),cardRadiogroupvue_type_script_lang_ts_metadata("design:returntype",void 0)],cl.prototype,"onRadiosChange",null),cl=cardRadiogroupvue_type_script_lang_ts_decorate([gt.default],cl);const dl=cl,ul=dl;var pl=(0,Ct.Z)(ul,cardRadiogroupvue_type_template_id_4b574261_scoped_true_render,al,!1,null,"4b574261",null);const hl=pl.exports;_t()(pl,{VCol:r.Z,VContainer:pe.Z,VRow:a.Z,VTooltip:_.Z});var cardRoutingvue_type_template_id_5e2d5f44_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",[n("h2",[e._v("Маршрут")]),e._v(" "),e.startedRoutes?n("v-row",[n("v-col",[n("display-running-route",{attrs:{document:e.document,"action-context":e.context}})],1)],1):n("v-row",[n("v-col",{staticClass:"mt-3"},[n("b",[e._v("Выберите шаблон маршрута из списка ")]),e._v("или\n      "),n("span",{staticClass:"underlineText primary--text",attrs:{disabled:e.hasRouteTemplateID},on:{click:e.createNewRoute}},[n("b",[e._v("создайте новый маршрут")])])]),e._v(" "),n("v-row",{staticClass:"section"},[n("v-col",{attrs:{cols:"8",sm:"8",md:"6",lg:"5",xl:"4"}},[n("card-select-list-textbox",{attrs:{mobile:e.isMobile,"vocabulary-name":"GRK_VOC_TypicalApprWFS",constrains:e.TYPYCALAPPR_MAIL_CONSTRAIN},model:{value:e.document.attr.RouteTemplateID,callback:function(t){e.$set(e.document.attr,"RouteTemplateID",t)},expression:"document.attr.RouteTemplateID"}})],1)],1),e._v(" "),n("v-row",[e.routeActivated?n("v-col",{attrs:{cols:"8",sm:"8",md:"6",lg:"5",xl:"4"}},[n("create-edit-route",{attrs:{"can-create-new-route":e.createRoute,document:e.document,"is-vocabulary":!1}})],1):e._e()],1)],1)],1)},ml=[],cardRoutingvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardRoutingvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let fl=class CardRoutingComponent extends(o()){constructor(){super(...arguments),this.createRoute=!1}createNewRoute(){this.document.attr.RouteTemplateID||(this.createRoute=!0)}get startedRoutes(){return!!this.document.listAttr.GRK_APPROVINGMAIl.length&&(this.document.listAttr.DOCTASKS.some((e=>"TSK_DELETED"!==e.TaskStateNameResName))||this.document.listAttr.GRK_APPROVINGMAIl.some((e=>e.MailID)))}get mailedRoutes(){return!!this.document.listAttr.GRK_APPROVINGMAIl.length&&this.document.listAttr.GRK_APPROVINGMAIl.some((e=>e.MailID))}get routeActivated(){return Boolean(this.document.attr.RouteTemplateID||this.document.listAttr.GRK_APPROVINGMAIl.length||this.createRoute)}get activeRuoteselector(){return Boolean(this.createRoute||this.document.listAttr.GRK_APPROVINGMAIl.length)}get hasRouteTemplateID(){return Boolean(!this.document.attr.RouteTemplateID&&!this.document.listAttr.GRK_APPROVINGMAIl.length)}get TYPYCALAPPR_MAIL_CONSTRAIN(){return[`Convert.ToInt32(Attributes["JournalID"]) == ${this.document.journalID}`]}};cardRoutingvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardRoutingvue_type_script_lang_ts_metadata("design:type",Object)],fl.prototype,"document",void 0),cardRoutingvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardRoutingvue_type_script_lang_ts_metadata("design:type",Object)],fl.prototype,"context",void 0),cardRoutingvue_type_script_lang_ts_decorate([(0,ot.t)(Ae.M.IQueryBus),cardRoutingvue_type_script_lang_ts_metadata("design:type",Object)],fl.prototype,"queryBus",void 0),fl=cardRoutingvue_type_script_lang_ts_decorate([(0,gt.default)({components:{}})],fl);const gl=fl,yl=gl;var vl=(0,Ct.Z)(yl,cardRoutingvue_type_template_id_5e2d5f44_scoped_true_render,ml,!1,null,"5e2d5f44",null);const bl=vl.exports;_t()(vl,{VCol:r.Z,VRow:a.Z});var cardSelectDocumentvue_type_template_id_981a9430_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"my-2"},[n("v-btn",{staticClass:"small-button rounded-button ml-0 my-0 px-2 elevation-0 font-weight-regular",attrs:{color:"primary"},on:{click:e.selectClick}},[e._v("\n      "+e._s(e.label)+"\n    ")])],1),e._v(" "),e._l(e.selectedDocuments,(function(t,i){return n("v-col",{key:t.documentId,staticClass:"mb-2"},[n("v-row",{attrs:{"no-gutters":"",justify:"space-between",align:"center"}},[n("div",[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.viewingModel[i],expression:"!viewingModel[i]"}],staticClass:"item-collapse-button",attrs:{size:"18"},on:{click:function(t){return e.toggleItemViewing(i)}}},[e._v("\n          add\n        ")]),e._v(" "),n("v-icon",{directives:[{name:"show",rawName:"v-show",value:e.viewingModel[i],expression:"viewingModel[i]"}],staticClass:"item-collapse-button",attrs:{size:"18"},on:{click:function(t){return e.toggleItemViewing(i)}}},[e._v("\n          remove\n        ")]),e._v(" "),n("span",[e._v(e._s(t.attributes.Name))])],1),e._v(" "),n("v-icon",{staticClass:"fit-content-width",on:{click:function(t){return e.deleteDoc(i)}}},[e._v(" delete ")])],1),e._v(" "),n("div",{on:{dblclick:function(n){return e.onOpenDoc(t)}}},[n("document-list-item",{directives:[{name:"show",rawName:"v-show",value:e.viewingModel[i],expression:"viewingModel[i]"}],attrs:{document:t,selected:!1,"action-context":e.context,"entity-view-mode":e.context.entityViewMode,"content-type":e.context.contentType}})],1)],1)}))],2)},Cl=[],wl=n(18361),cardSelectDocumentvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardSelectDocumentvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardSelectDocumentvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let _l=class CardSelectDocumentComponent extends(o()){constructor(){super(...arguments),this.docIds=[],this.selectedDocuments=[],this.viewingModel=[],this.loading=!1}onValueChange(){if(!this.value)return this.docIds=[],void(this.selectedDocuments=[]);Array.isArray(this.value)?this.docIds=this.value:this.docIds=[this.value],this.selectedDocuments&&this.selectedDocuments.length||(this.fetchDocuments(),this.createDocItemsVieweingModel())}onSelectedDocumentsChange(e,t){(e||t)&&(this.docIds=this.selectedDocuments.map((e=>e.id)),this.emitInput(this.docIds))}created(){this.label||(this.label=this.$gettext("Выбор документа"))}deleteDoc(e){const t=this.selectedDocuments[e];t&&(this.selectedDocuments.splice(e,1),this.docIds=this.selectedDocuments.map((e=>e.id)),this.emitInput(this.docIds),this.emitDeleteDoc(t.id))}toggleItemViewing(e){this.viewingModel[e]=!this.viewingModel[e],this.$forceUpdate()}selectClick(){return cardSelectDocumentvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=new wl.j(this.label,this.multiselect,this.selectedDocuments,!1,{allowedJournals:this.allowedJournals}),t=yield this.queryBus.exec(e);t&&(this.selectedDocuments=Array.isArray(t)?t:[t],this.emitDocAdd())}))}fetchDocuments(){return cardSelectDocumentvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{if(Array.isArray(this.docIds))for(const e of this.docIds){const t=yield this.queryBus.exec(new He.U_(e,Ue.dS.View));this.selectedDocuments.push(t)}else{const e=yield this.queryBus.exec(new He.U_(this.docIds,Ue.dS.View));this.selectedDocuments.push(e)}}finally{this.loading=!1}}))}createDocItemsVieweingModel(){const e=[];this.docIds.forEach((()=>{e.push(!this.hideAl)})),this.viewingModel=o().observable(e)}emitDeleteDoc(e){this.$emit("document-delete",e)}emitInput(e){e&&e[0]||(e=[]),this.multiselect?this.$emit("input",e):this.$emit("input",e[0])}emitDocAdd(){this.$emit("document-add",this.selectedDocuments)}};cardSelectDocumentvue_type_script_lang_js_decorate([(0,rt.Model)("input"),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",Object)],_l.prototype,"value",void 0),cardSelectDocumentvue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",Boolean)],_l.prototype,"multiselect",void 0),cardSelectDocumentvue_type_script_lang_js_decorate([(0,rt.Prop)({type:String}),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",String)],_l.prototype,"label",void 0),cardSelectDocumentvue_type_script_lang_js_decorate([(0,rt.Prop)(),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",Object)],_l.prototype,"context",void 0),cardSelectDocumentvue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",Boolean)],_l.prototype,"hideAl",void 0),cardSelectDocumentvue_type_script_lang_js_decorate([(0,rt.Prop)(),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",Array)],_l.prototype,"allowedJournals",void 0),cardSelectDocumentvue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",Object)],_l.prototype,"queryBus",void 0),cardSelectDocumentvue_type_script_lang_js_decorate([(0,rt.Watch)("value",{immediate:!0}),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",Function),cardSelectDocumentvue_type_script_lang_js_metadata("design:paramtypes",[]),cardSelectDocumentvue_type_script_lang_js_metadata("design:returntype",void 0)],_l.prototype,"onValueChange",null),cardSelectDocumentvue_type_script_lang_js_decorate([(0,rt.Watch)("selectedDocuments",{deep:!0}),cardSelectDocumentvue_type_script_lang_js_metadata("design:type",Function),cardSelectDocumentvue_type_script_lang_js_metadata("design:paramtypes",[Array,Array]),cardSelectDocumentvue_type_script_lang_js_metadata("design:returntype",void 0)],_l.prototype,"onSelectedDocumentsChange",null),_l=cardSelectDocumentvue_type_script_lang_js_decorate([(0,gt.default)({components:{"document-list-item":ja.Z}})],_l);const xl=_l,Sl=xl;var Il=(0,Ct.Z)(Sl,cardSelectDocumentvue_type_template_id_981a9430_scoped_true_render,Cl,!1,null,"981a9430",null);const Dl=Il.exports;_t()(Il,{VBtn:g.Z,VCol:r.Z,VIcon:y.Z,VRow:a.Z});var cardSelectListTextBoxvue_type_template_id_5a253ac4_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"card-select-list-textbox-wrapper",class:{column:e.mobile||e.labelOnTop},attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label font-weight-bold sm-text",class:{help:e.labelHint}},i),[e._v(e._s(e.label))])]}}],null,!1,495005635)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.labelHint))])]):n("span",{staticClass:"label font-weight-bold sm-text"},[e._v(e._s(e.label))]),e._v(" "),e.required?n("div",{staticClass:"pl-1",class:{require:e.required}}):e._e()],1)],1)],1):e._e(),e._v(" "),e.showInput?n("v-col",{class:e.inputSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"ld-selectbox",staticStyle:{position:"relative"}},[n("v-btn",{staticClass:"grey--border lighten-4 mx-0 my-0 square-sm-button rounded-button open-vocabulary-btn",attrs:{outlined:"",disabled:e.readonly||e.disabled},on:{click:e.onSelect}},[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"open-voc-icon",attrs:{color:e.validationMesssage?"warning":"primary"}},[e._v("\n            "+e._s(e.icon)+"\n          ")]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{size:18,color:"primary",indeterminate:""}})],1),e._v(" "),n("vue-multiselect",{ref:"multiselect",staticClass:"small-input text-body-1 font-weight-light multiselect",attrs:{"track-by":"id",label:e.selectionListLabel,"open-direction":"bottom",loading:e.loading,multiple:e.multiselect,placeholder:e.placeholder,"select-label":"",options:e.selectOptions,searchable:!0,"internal-search":!1,"clear-on-select":!e.multiselect,"close-on-select":!e.multiselect,"options-limit":300,"max-height":250,"show-no-results":!0,"show-no-options":!1,disabled:e.readonly,limit:e.selectionShowCount,"limit-text":e.limitText,tabindex:e.tabIndex},on:{close:e.dropdownClose,"search-change":e.getItems,select:e.emitUpdateItems,open:e.fetchData},scopedSlots:e._u([{key:"tag",fn:function(t){return[n("v-chip",{key:JSON.stringify(t.option),staticClass:"v-chip--select-multi white--text text-caption",attrs:{small:"",color:"primary_light",close:e.multiselect&&!e.readonly&&!e.disabled},on:{"click:close":function(n){return e.onRemoveItem(t.option)}}},[e._v("\n              "+e._s(e.getMultiselectTagValue(t))+"\n            ")])]}},{key:"option",fn:function(t){return[n("v-row",{attrs:{"no-gutters":"",align:"center"}},[e.multiselect?n("input",{attrs:{type:"checkbox"},domProps:{checked:e.optionSelected(t.option)}}):e._e(),e._v(" "),n("span",{staticClass:"ml-2"},[e._v(e._s(e.getSelectionOptionText(t.option)))])])]}}],null,!1,2164655455),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[e._v(" "),e._v(" "),n("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v(e._s(e.notFoundMessage))])])],1)],1),e._v(" "),n("div",{staticClass:"select-list-textbox-validate"},[n("transition",{attrs:{name:"squash"}},[e.showHint?n("span",{staticClass:"text-body-1 font-weight-light",class:{"error--text":e.warningHint,"grey--text lighten-1":!e.validationMesssage}},[e._v(e._s(e.displayingInputHint))]):e._e()])],1)],1):e._e(),e._v(" "),e.showInput?e._e():n("v-col",{class:e.inputSizeClasses},[n("v-chip",{key:JSON.stringify(e.selectedToArray[0]),staticClass:"v-chip--select-multi white--text text-caption",attrs:{small:"",close:!e.readonly&&!e.disabled,color:"primary_light"},on:{"click:close":function(t){return e.onRemoveItem(e.selectedToArray[0])}}},[e._v("\n      "+e._s(e.selectedToArray[0].attributes?e.selectedToArray[0].attributes[e.selectionListLabel]:e.selectedToArray[0].value)+"\n    ")])],1)],1)},Rl=[],Tl=n(26744),Pl=n(48711),Ol=n(47907),kl=n.n(Ol);class VocabularyValueCollection{constructor(e){this.vocabularyValues=e}get ids(){return this.vocabularyValues.map((e=>e.id))}removeBy(e){const t=this.vocabularyValues.findIndex((({id:t})=>t===e));return t<0?[...this.vocabularyValues]:[...this.vocabularyValues.slice(0,t),...this.vocabularyValues.slice(t+1)]}}var cardSelectListTextBoxvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardSelectListTextBoxvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardSelectListTextBoxvue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Fl=class CardSelectListTextBoxComponent extends((0,gt.mixins)(va.Z,ya,la)){constructor(){super(...arguments),this.selected=null,this.loading=!1,this.readedItems=[],this.showInputHint=null,this.myRules=[],this.notFoundMessage=this.$gettext("Идёт поиск..."),this.selectOptions=[],this.validationMesssage="",this.errorBucket=[],this.errorsHandler=[],this.getItems=null}onValueChanged(e,t){return cardSelectListTextBoxvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){try{const n=this.anyToArrayContainer(e);if(!n.length)return void(this.selected=[]);if(!this.isNullOrDefault(e)||!this.isNullOrDefault(t)){const e=this.valueToArray.filter((e=>!this.selectedToArray.find((t=>t.id===e))));if(e.length){let e;if(this.selectedItems&&!t){const[t]=this.valueToArray;e=Array.isArray(this.selectedItems)?this.selectedItems:[{id:t,value:this.selectedItems}]}this.selected=e||(yield this.fetchConcreteItems())}}}finally{this.isNullOrDefault(e)&&this.isNullOrDefault(t)||this.validate()}}))}onVocabularyNameChange(){return cardSelectListTextBoxvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){!this.selected&&this.value&&(this.selected=yield this.fetchConcreteItems()),this.readedItems=[]}))}created(){this.showInputHint=this.persistentHint,this.getItems=(0,Pl.Z)(this.goSearch.bind(this),!this.getFullVoc||this.multiselect||this.constrains?800:10),this.form&&this.form.register(this,null),this.fullErrorBucket()}destroyed(){this.form&&this.form.unregister(this,null)}goSearch(e){return cardSelectListTextBoxvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){!this.getFullVoc&&e?this.selectOptions=yield this.serverSearch(e):(this.readedItems&&this.readedItems.length||(yield this.fetchData()),this.selectOptions=this.filterSelectOptions(e)),this.selectOptions&&this.selectOptions.length?(this.selectOptions.sort(((e,t)=>e.value<t.value?-1:1)),this.errorsHandler.length&&(this.notFoundMessage=this.$gettext("Ошибка поиска"))):this.notFoundMessage=this.$gettext("Ничего не найдено")}))}limitText(e){return`(+${e} ${e<5?this.$gettext("элемента"):this.$gettext("элементов")})`}optionSelected(e){return this.selectedToArray.findIndex((t=>t.id===e.id))>-1}dropdownClose(){this.validate(),this.$emit("blur",this.selectedToArray),this.persistentHint||(this.showInputHint=!1),this.getFullVoc||(this.selectOptions=[])}onSelect(){return cardSelectListTextBoxvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){try{if(this.$emit("click"),this.readonly||this.disabled)return;const e=this.generateSelectQuery(this.valueToArray),t=yield this.queryBus.exec(e);t&&t.length&&(this.selected=t.map((({vocabularyValue:e})=>e)).filter((e=>Boolean(e))),this.emitUpdate())}finally{this.validate()}}))}onRemoveItem({id:e}){const t=this.selectedCollection.removeBy(e);t.length<this.selectedToArray.length&&(this.selected=t,this.emitUpdate())}validate(){this.errorBucket=[];let e=null;return this.validationMesssage="",this.validRules.forEach((t=>{e=t(this.selectedToArray),!0!==e&&(this.validationMesssage=e,this.errorBucket.push(e))})),!this.validationMesssage}fullErrorBucket(){this.errorBucket=[];let e=null;this.validRules.forEach((t=>{e=t(this.selectedToArray),!0!==e&&this.errorBucket.push(e)}))}emitUpdateItems(){this.$nextTick((()=>{this.$emit("update-items",this.selectedToArray),this.emitInput(this.selectedCollection.ids)}))}getMultiselectTagValue(e){if(!(null===e||void 0===e?void 0:e.option))return"";const t=Object.assign({},e.option);return Object.keys(t).forEach((e=>{t[e.toLowerCase()]=t[e]})),t.attributes?t.attributes.value:t.name?t.name:t.value?t.value:void 0}getSelectionOptionText({columns:e,value:t}){return e?Object.keys(e).reduce(((t,n)=>`${t} ${e[n]},`),"").slice(0,-1):t}emitUpdate(){this.$nextTick((()=>{this.$emit("update-items",this.selectedToArray);const e=this.selectedCollection.ids;this.multiselect?(0,ba.Z)(e,this.value)||this.$emit("input",e):e.length?this.value!==e[0]&&this.$emit("input",e[0]):this.$emit("input",0)}))}generateSelectQuery(e){return new ze.F({title:this.label,componentName:"wrapper-catalogue",componentProps:{searchV2:this.searchV2,constrains:this.constrains,gridColumns:this.gridColumns,name:this.vocabularyNameToArray,selected:e,disabledItems:[],selectedItems:e,multiselect:this.multiselect,fullInfo:this.fullInfo,sortByDefault:this.sortByDefault},width:this.multiselect?"80%":"50%",fullHeight:!0})}fetchData(e=!1){return cardSelectListTextBoxvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.notFoundMessage=this.$gettext("Идёт поиск..."),this.showInputHint=!0;try{if(this.getFullVoc&&(!this.readedItems||!this.readedItems.length)){this.loading=!0;const t=yield this.fetchVocabulary(new Pt.Yi(this.vocabularyNameToArray[0],!1,null,null,e));this.readedItems=t.values,this.loading=!1,this.$refs.multiselect.$el.focus()}}catch(e){this.errorsHandler.push(`${this.$gettext("Ошибка получения значений словаря")}`),this.notFoundMessage=this.$gettext("Ошибка поиска"),this.$log.debug(e)}finally{this.loading=!1}}))}serverSearch(e){var t;return cardSelectListTextBoxvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.cancellationService.cancel(),this.loading=!0;let n=null;try{n=null===this.searchV2?yield this.queryBus.exec(this.getVocabularySearchQuery(e)):yield this.queryBus.exec(this.getVocabularySearchV2Query(e))}catch(e){if(e instanceof Fn.Mk)return[];this.errorsHandler.push(`${this.$gettext("Ошибка поиска в словаре")}`),this.$log.debug(e)}return this.loading=!1,n?(null===(t=this.gridColumns)||void 0===t?void 0:t.length)?n.items.map((({attributes:e,vocabularyValue:t})=>Object.assign(Object.assign({},t),{columns:this.gridColumns.reduce(((t,n)=>e[n]?Object.assign(Object.assign({},t),{[n]:e[n]}):t),{})}))):n.items.map((e=>e.vocabularyValue)):[]}))}getVocabularySearchQuery(e){const t=this.constrains instanceof Array?this.constrains:[];return new Pt.j_(this.vocabularyNameToArray[0],[],this.isReturnActual,[e],{skip:0,take:30,where:t},!0,!0)}getVocabularySearchV2Query(e){return new Pt.Ox(this.vocabularyNameToArray[0],this.searchV2,e,[],this.isReturnActual,{skip:0,take:30},!0,!0)}filterSelectOptions(e){var t,n;return null!==(n=null===(t=this.readedItems)||void 0===t?void 0:t.filter((t=>t.value.toLowerCase().includes(e.toLowerCase()))))&&void 0!==n?n:[]}fetchConcreteItems(){return cardSelectListTextBoxvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){let e=[];if(!this.valueToArray.length||!this.vocabularyNameToArray.length)return this.$log.debug("CardSelectListTextBoxComponent.fetchConcreteItems - не хватает каких-то данных для работы, возвращает пустой массив"),e;try{if(this.loading=!0,this.vocabularyNameToArray.length&&this.valueToArray.length){const t=yield this.fetchVocabularyByIds(new Pt.hu(this.vocabularyNameToArray[0],this.valueToArray));if(t)return e=t[0].items.map((e=>e.vocabularyValue||e)),e}}catch(e){this.errorsHandler.push(`${this.$gettext("Ошибка получения значений из словаря")}`),this.$log.debug(e)}finally{this.loading=!1}}))}emitInput(e){this.multiselect?(0,ba.Z)(e,this.value)||this.$emit("input",e):this.value!==e[0]&&this.$emit("input",e[0])}anyToArrayContainer(e){return Array.isArray(e)?[...e]:e?[e]:[]}isNullOrDefault(e){return null===e||void 0===e}get showHint(){return this.validRules.length?Boolean(this.validationMesssage):Boolean(this.inputHint&&this.showInputHint)}get showInput(){return this.multiselect||!this.selectedToArray.length}get warningHint(){return Boolean(this.validationMesssage)||this.errorsHandler.length>0}get displayingInputHint(){return this.errorsHandler.length?this.errorsHandler[this.errorsHandler.length-1]:this.validationMesssage?this.validationMesssage:this.inputHint}get hasError(){return Boolean(this.validationMesssage)||this.errorBucket.length>0}get valueToArray(){let e=null;return e=Array.isArray(this.value)?[...this.value]:this.value?[this.value]:[],this.multiselect?e:e.slice(0,1)}get vocabularyNameToArray(){return this.anyToArrayContainer(this.vocabularyName)}get selectedToArray(){return this.anyToArrayContainer(this.selected)}get selectedCollection(){return new VocabularyValueCollection(this.selectedToArray)}};cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Object)],Fl.prototype,"value",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:""}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Object)],Fl.prototype,"vocabularyName",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Fl.prototype,"fullInfo",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Object)],Fl.prototype,"selectedItems",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:""}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",String)],Fl.prototype,"placeholder",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Fl.prototype,"multiselect",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",String)],Fl.prototype,"labelWidth",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Array)],Fl.prototype,"gridColumns",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Array)],Fl.prototype,"constrains",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:"more_horiz"}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",String)],Fl.prototype,"icon",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",String)],Fl.prototype,"inputHint",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Fl.prototype,"persistentHint",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Fl.prototype,"mobile",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:"Name"}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",String)],Fl.prototype,"selectionListLabel",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Fl.prototype,"getFullVoc",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Number)],Fl.prototype,"selectionShowCount",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!0}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Fl.prototype,"isReturnActual",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Array}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Array)],Fl.prototype,"sortByDefault",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!0}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Fl.prototype,"isCollapsed",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Boolean)],Fl.prototype,"showPreview",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Object,default:null}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Object)],Fl.prototype,"searchV2",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,ot.t)(Ae.M.IQueryBus),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Object)],Fl.prototype,"queryBus",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,ot.t)(Tl.h),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Tl.h)],Fl.prototype,"cancellationService",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,fa.eI)("fetchVocabulary"),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Object)],Fl.prototype,"fetchVocabulary",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,fa.eI)("fetchVocabularyByIds"),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Object)],Fl.prototype,"fetchVocabularyByIds",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Inject)({from:"form",default:null}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Object)],Fl.prototype,"form",void 0),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Watch)("value",{immediate:!0}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Function),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:paramtypes",[Object,Object]),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:returntype",Promise)],Fl.prototype,"onValueChanged",null),cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,rt.Watch)("vocabularyName",{immediate:!0}),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:type",Function),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:paramtypes",[]),cardSelectListTextBoxvue_type_script_lang_ts_metadata("design:returntype",Promise)],Fl.prototype,"onVocabularyNameChange",null),Fl=cardSelectListTextBoxvue_type_script_lang_ts_decorate([(0,gt.default)({components:{"vue-multiselect":kl()}})],Fl);const Al=Fl,$l=Al;var jl=(0,Ct.Z)($l,cardSelectListTextBoxvue_type_template_id_5a253ac4_scoped_true_render,Rl,!1,null,"5a253ac4",null);const El=jl.exports;_t()(jl,{VBtn:g.Z,VChip:P.Z,VCol:r.Z,VIcon:y.Z,VProgressCircular:V.Z,VRow:a.Z,VTooltip:_.Z});var cardSelectUsersvue_type_template_id_6d89a015_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"card-select-users-wrapper",class:{column:e.mobile||e.labelOnTop},attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2 pt-1",class:e.labelSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label font-weight-bold sm-text",class:{help:e.labelHint}},i),[e._v(e._s(e.label))])]}}],null,!1,495005635)},[e._v(" "),n("span",[e._v(e._s(e.labelHint))])]):n("span",{staticClass:"label font-weight-bold sm-text"},[e._v(e._s(e.label))])],1),e._v(" "),e.required?n("div",{class:{require:e.required}}):e._e()],1)],1):e._e(),e._v(" "),e.showInput?n("v-col",{class:e.inputSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"ld-selectbox",staticStyle:{position:"relative"}},[e.isMobile?e._e():n("v-btn",{staticClass:"grey--border lighten-4 mx-0 my-0 square-sm-button rounded-button col-lg-2 open-vocabulary-btn",attrs:{id:"addReceiver",outlined:"",disabled:e.readonly},on:{click:e.onAddReceiver}},[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"open-voc-icon",attrs:{color:"primary"}},[e._v(" account_circle ")]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{value:20,color:"primary",indeterminate:""}})],1),e._v(" "),n("vue-multiselect",{ref:"multiselect",staticClass:"small-input text-body-1 font-weight-light multiselect",attrs:{"track-by":"id",label:"name","open-direction":"bottom",loading:e.loading,multiple:e.multiselect,placeholder:e.placeholder,options:e.receivers,searchable:!0,"internal-search":!1,"clear-on-select":!e.multiselect,"close-on-select":!e.multiselect,"options-limit":300,"max-height":250,"show-no-results":!0,"show-no-options":!1,disabled:e.readonly,limit:e.selectionShowCount,"limit-text":e.limitText,tabindex:e.tabIndex},on:{close:e.closeClick,"search-change":e.getUsers,select:e.receiverSelected,remove:e.emitUpdateReceivers,click:function(t){return e.$emit("click",t)},open:function(t){e.showInputHint=!0}},scopedSlots:e._u([{key:"tag",fn:function(t){return[e.tooltipFields?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-chip",e._g({key:t.option.id,staticClass:"v-chip--select-multi white--text text-caption",attrs:{small:"",close:!e.readonly&&!e.disabled,color:"primary_light"},on:{"click:close":function(n){return e.receiverRemoved(t.option)}}},o),[n("v-icon",{staticClass:"mr-1"},[e._v("\n                      "+e._s(e.tagIcon(t.option))+"\n                    ")]),e._v(" "),n("div",{staticClass:"selected-user-name"},[e._v(e._s(t.option.name||t.option.departmentName))])],1)]}}],null,!0)},[e._v(" "),e._l(e.tooltipFields,(function(i,o){return n("v-row",{key:o+":"+e._uid,attrs:{"no-gutters":""}},[n("span",{staticClass:"font-weight-bold mr-2 sm-text"},[e._v(e._s(i.label))]),e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(t.option[i.fieldName]))])])}))],2):n("div",[n("v-chip",{key:t.option.id,staticClass:"v-chip--select-multi white--text text-caption",attrs:{small:"",color:"primary_light",close:e.multiselect&&!e.readonly&&!e.disabled},on:{"click:close":function(n){return e.receiverRemoved(t.option)}}},[n("v-icon",{staticClass:"mr-1"},[e._v("\n                    "+e._s(e.tagIcon(t.option))+"\n                  ")]),e._v(" "),n("div",{staticClass:"selected-user-name"},[e._v("\n                    "+e._s(t.option.displayName||t.option.name||t.option.departmentName)+"\n                  ")])],1)],1)]}},{key:"option",fn:function(t){return[n("v-row",{attrs:{"no-gutters":"",align:"center"}},[e.multiselect?n("input",{attrs:{type:"checkbox"},domProps:{checked:e.optionSelected(t.option)}}):e._e(),e._v(" "),e.multiselect?n("v-icon",{class:{"primary--text":e.optionSelected(t.option)}},[e._v("\n                  "+e._s(e.tagIcon(t.option))+"\n                ")]):e._e(),e._v(" "),n("span",[e._v(e._s(e.getAutocompleteName(t.option)))])],1)]}}],null,!1,2667179050),model:{value:e.selectedUsers,callback:function(t){e.selectedUsers=t},expression:"selectedUsers"}},[e._v(" "),e._v(" "),n("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v(e._s(e.notFoundMessage))])])],1)],1)],1),e._v(" "),n("div",{staticClass:"select-users-validate"},[n("transition",{attrs:{name:"squash"}},[e.showHint?n("span",{staticClass:"text-body-1 font-weight-light",class:{"error--text":e.validationMesssage,"grey--text lighten-1":!e.validationMesssage}},[e._v(e._s(e.validationMesssage?e.validationMesssage:e.inputHint))]):e._e()])],1)],1):e._e(),e._v(" "),e.showInput?e._e():n("v-col",[e.tooltipFields?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-chip",e._g({key:JSON.stringify(e.selectedUsers[0]),staticClass:"v-chip--select-multi white--text text-caption",attrs:{small:"",close:!e.readonly&&!e.disabled,color:"primary_light"},on:{"click:close":function(t){return e.receiverRemoved(e.selectedUsers[0])}}},i),[n("v-icon",{staticClass:"mr-1"},[e._v("\n            "+e._s(e.tagIcon(e.selectedUsers[0]))+"\n          ")]),e._v(" "),n("div",{staticClass:"selected-user-name"},[e._v(e._s(e.selectedUsers[0].name))])],1)]}}],null,!1,2689930309)},[e._v(" "),e._l(e.tooltipFields,(function(t,i){return n("v-row",{key:i+":"+e._uid,staticClass:"no-gutters"},[n("span",{staticClass:"font-weight-bold mr-2 sm-text"},[e._v(e._s(t.label))]),e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.selectedUsers[0][t.fieldName]))])])}))],2):n("v-chip",{key:JSON.stringify(e.selectedUsers[0]),staticClass:"v-chip--select-multi white--text text-caption",attrs:{small:"",close:!e.readonly&&!e.disabled,color:"primary_light"},on:{"click:close":function(t){return e.receiverRemoved(e.selectedUsers[0])}}},[n("v-icon",{staticClass:"mr-1"},[e._v("\n        "+e._s(e.tagIcon(e.selectedUsers[0]))+"\n      ")]),e._v(" "),n("div",{staticClass:"selected-user-name"},[e._v(e._s(e.selectedUsers[0].name))])],1)],1)],1)},Ml=[],Nl=n(91908),cardSelectUsersvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardSelectUsersvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardSelectUsersvue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Vl=class CardSelectUsersComponent extends((0,gt.mixins)(va.Z,la,ya)){constructor(){super(...arguments),this.receivers=[],this.selectedUsers=[],this.notFoundMessage=this.$gettext("Идёт поиск..."),this.defaultTitle=this.$gettext("Выбор сотрудника"),this.loading=!1,this.getUsers=(0,Pl.Z)(this.fetchData.bind(this),800),this.receiverTypes=[],this.validationMesssage="",this.showInputHint=!1,this.myRules=[],this.vocReceiverTypes={USER:Nn.OP.User,DEPARTMENT:Nn.OP.Department,ROLE:Nn.OP.Role,GROUPUSER:Nn.OP.GroupUser},this.errorBucket=[],this.removedReceiver=!1}onRulesChanged(e){Array.isArray(e)&&e.length?this.myRules=[...e]:this.myRules=[]}onValueChanged(e,t){return cardSelectUsersvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){if(!(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e=>t.includes(e))))){if((!this.value||Array.isArray(this.value)&&!this.value.length)&&(this.selectedUsers=null),this.selectedUsers&&this.selectedUsers.length&&!Array.isArray(this.value)&&this.selectedUsers[0].id!==this.value&&(this.selectedUsers=yield this.fetchConcreteReceivers([this.value])),e&&!t&&this.selectedItems&&!this.removedReceiver){const e=Array.isArray(this.selectedItems)?this.selectedItems:[this.selectedItems],t=e.map(((e,t)=>{if("string"===typeof e){const n=Array.isArray(this.value)&&this.value.length>=t?this.value[t]:0;return{name:e,id:n,presentation:e,type:0,value:e}}return e}));this.selectedUsers=t}if(this.value){let e=Array.isArray(this.value)?this.value:[this.value];!this.multiselect&&e.length&&(e=[e[0]]);const t=Array.isArray(this.selectedUsers)?this.selectedUsers:[],n=e.filter((e=>!t.find((t=>t.id===e))));this.selectedUsers&&e.length===t.length||!n.length||(this.selectedUsers=yield this.fetchConcreteReceivers(e))}}}))}onVocNamesChange(){this.vocNames&&this.vocNames.length?Array.isArray(this.vocNames)?this.receiverTypes=this.vocNames.map((e=>this.vocReceiverTypes[e])):this.receiverTypes=[this.vocReceiverTypes[this.vocNames]]:this.receiverTypes=[]}onSelectedUsersChanged(){this.selectedUsers&&(Array.isArray(this.selectedUsers)||(this.selectedUsers=[this.selectedUsers]))}created(){this.showInputHint=this.persistentHint,this.form&&this.form.register(this,null),this.fullErrorBucket()}destroyed(){this.form&&this.form.unregister(this,null)}receiverSelected(e){this.emitUpdateReceivers()}receiverRemoved(e){if(this.removedReceiver=!0,!Array.isArray(this.selectedUsers))return void(this.selectedUsers=null);const t=this.selectedUsers.findIndex((t=>t.id===e.id));if(t>=0&&(this.selectedUsers.splice(t,1),this.tooltipFields&&this.tooltipFields.length)){const e=this.selectedUsers;return this.selectedUsers=[],void setTimeout((()=>{this.selectedUsers=e,this.validate(),this.emitUpdateReceivers(),this.$refs.multiselect&&this.$refs.multiselect.$emit("close")}),10)}this.validate(),this.emitUpdateReceivers(),this.$refs.multiselect&&this.$refs.multiselect.$emit("close")}clearAll(){this.selectedUsers.length=0,this.emitUpdateReceivers()}tagIcon(e){if(e)switch(e.type){case Nn.OP.GroupUser:return"group";case Nn.OP.User:return"person";case Nn.OP.Department:return"group";case Nn.OP.Role:return"group"}}getAutocompleteName(e){if(this.tooltipFields){const t=this.tooltipFields.map((t=>e[t.fieldName])).join(", ");return`${e.name} (${t})`}return e.name}selectedUserObject(e){return this.selectedUsers.filter((t=>t.id===e))}limitText(e){return`(+${e} ${e<5?this.$gettext("элемента"):this.$gettext("элементов")})`}optionSelected(e){return!(!this.selectedUsers||!this.selectedUsers.length)&&Boolean(this.selectedUsers.filter((t=>t.id===e.id)).length)}closeClick(){this.validate(),this.$emit("blur",this.selectedUsers),this.receivers=[],this.persistentHint||(this.showInputHint=!1)}validate(){this.errorBucket=[];let e=null;return this.validationMesssage="",this.validRules.forEach((t=>{e=t(this.selectedUsers),!0!==e&&(this.validationMesssage=e,this.errorBucket.push(e))})),!this.validationMesssage}fullErrorBucket(){this.errorBucket=[];let e=null;this.validRules.forEach((t=>{e=t(this.selectedUsers),!0!==e&&this.errorBucket.push(e)}))}onAddReceiver(){return cardSelectUsersvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.selectedUsers||(this.selectedUsers=[]);const e=new Nl.B(this.modalTitle,this.multiselect,this.receiverTypes,[...this.selectedUsers],null,!0,!1,this.states),t=yield this.queryBus.exec(e);t&&t.length&&(this.selectedUsers=t,this.emitUpdateReceivers(),this.$refs.multiselect.$emit("close"))}))}emitUpdateReceivers(){this.$nextTick((()=>{let e=[];this.selectedUsers&&!Array.isArray(this.selectedUsers)&&(this.selectedUsers=[this.selectedUsers]),this.$emit("update-receivers",this.selectedUsers),this.selectedUsers&&this.selectedUsers.length&&(e=this.selectedUsers.map((e=>e.id))),this.emitInput(e)}))}emitInput(e){this.multiselect?(0,ba.Z)(e,this.value)||this.$emit("input",e):this.value!==e[0]&&this.$emit("input",e[0])}fetchConcreteReceivers(e){return cardSelectUsersvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){let t=[];if(!e)return t;try{return this.loading=!0,t=yield this.fetchSearchReceiversById(new vr.uR(e,!0)),t.forEach((e=>{Object.assign(e,e.value),delete e.value})),t}catch(e){this.$log.debug(e)}finally{this.loading=!1}}))}fetchData(e=""){e&&this.$nextTick((()=>cardSelectUsersvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.notFoundMessage=this.$gettext("Идёт поиск...");try{this.loading=!0;const t=new vr.NF(Array.isArray(this.vocNames)?this.vocNames:[this.vocNames],e,300,!0,this.states),n=yield this.fetchSearchReceiversByTypes(t);this.receivers=n.map((e=>Object.assign(Object.assign({},e),e.value))),this.receivers&&this.receivers.length?this.notFoundMessage=this.$gettext("Идёт поиск...!"):this.notFoundMessage=this.$gettext("Поиск не дал результатов.")}catch(e){this.notFoundMessage=this.$gettext("Поиск не дал результатов (-:"),this.$log.debug(e)}finally{this.loading=!1}}))))}get showInput(){return this.multiselect||!(this.selectedUsers&&this.selectedUsers.length)}get showHint(){return this.validRules.length?Boolean(this.validationMesssage):Boolean(this.inputHint&&this.showInputHint)}get hasError(){return Boolean(this.validationMesssage)||this.errorBucket.length>0}get modalTitle(){return this.title?this.title:this.defaultTitle}};cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Model)("input"),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Object)],Vl.prototype,"value",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Array)],Vl.prototype,"selectedItems",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:""}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",String)],Vl.prototype,"placeholder",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1,type:Boolean}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Boolean)],Vl.prototype,"multiselect",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",String)],Vl.prototype,"label",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({required:!0}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Object)],Vl.prototype,"vocNames",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Boolean)],Vl.prototype,"mobile",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",String)],Vl.prototype,"inputHint",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Boolean)],Vl.prototype,"persistentHint",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Number)],Vl.prototype,"selectionShowCount",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Boolean)],Vl.prototype,"required",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:()=>[]}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Array)],Vl.prototype,"rules",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:()=>[]}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Array)],Vl.prototype,"customRules",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Boolean)],Vl.prototype,"validateOnBlur",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Array)],Vl.prototype,"tooltipFields",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",String)],Vl.prototype,"title",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Boolean)],Vl.prototype,"readonly",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Array,default:null}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Array)],Vl.prototype,"states",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,fa.Vw)("fetchSearchReceiversByTypes"),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Object)],Vl.prototype,"fetchSearchReceiversByTypes",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,fa.Vw)("fetchSearchReceiversById"),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Object)],Vl.prototype,"fetchSearchReceiversById",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,ot.t)(Ae.M.IQueryBus),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Object)],Vl.prototype,"queryBus",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,ot.t)(Ve.O.ICommandBus),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Object)],Vl.prototype,"commandBus",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Inject)({from:"form",default:null}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Object)],Vl.prototype,"form",void 0),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Watch)("rules",{immediate:!0}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Function),cardSelectUsersvue_type_script_lang_ts_metadata("design:paramtypes",[Array]),cardSelectUsersvue_type_script_lang_ts_metadata("design:returntype",void 0)],Vl.prototype,"onRulesChanged",null),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Watch)("value",{immediate:!0}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Function),cardSelectUsersvue_type_script_lang_ts_metadata("design:paramtypes",[Object,Object]),cardSelectUsersvue_type_script_lang_ts_metadata("design:returntype",Promise)],Vl.prototype,"onValueChanged",null),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Watch)("vocNames",{immediate:!0}),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Function),cardSelectUsersvue_type_script_lang_ts_metadata("design:paramtypes",[]),cardSelectUsersvue_type_script_lang_ts_metadata("design:returntype",void 0)],Vl.prototype,"onVocNamesChange",null),cardSelectUsersvue_type_script_lang_ts_decorate([(0,rt.Watch)("selectedUsers"),cardSelectUsersvue_type_script_lang_ts_metadata("design:type",Function),cardSelectUsersvue_type_script_lang_ts_metadata("design:paramtypes",[]),cardSelectUsersvue_type_script_lang_ts_metadata("design:returntype",void 0)],Vl.prototype,"onSelectedUsersChanged",null),Vl=cardSelectUsersvue_type_script_lang_ts_decorate([(0,gt.default)({components:{"vue-multiselect":kl()}})],Vl);const Bl=Vl,Ll=Bl;var Ul=(0,Ct.Z)(Ll,cardSelectUsersvue_type_template_id_6d89a015_scoped_true_render,Ml,!1,null,"6d89a015",null);const Hl=Ul.exports;_t()(Ul,{VBtn:g.Z,VChip:P.Z,VCol:r.Z,VIcon:y.Z,VProgressCircular:V.Z,VRow:a.Z,VTooltip:_.Z});var cardTablevue_type_template_id_55814078_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-table",style:e.computedHeight},[n("v-row",{staticClass:"mb-2",attrs:{"no-gutters":""}},[e.searchable?n("v-text-field",{staticClass:"pl-0 small-input sm-text",attrs:{flat:"","hide-details":"","single-line":"",outlined:"","prepend-inner-icon":"search",label:e.$gettext("Поиск в таблице")},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}):e._e()],1),e._v(" "),n("div",[n("table",{staticClass:"table grey--border lighten-3"},[n("thead",[n("tr",[e._l(e.fields,(function(t){return n("th",{key:t.key,staticClass:"column grey lighten-4",on:{click:function(n){return e.fieldClick(t)}}},[n("v-row",{attrs:{"no-gutters":""}},[n("span",[e._v(e._s(t.label||t.key))]),e._v(" "),e.fieldHasSort(t)?n("v-icon",{staticClass:"ml-1",class:{"asc-sorting-icon":e.isSortingAsc(t)},attrs:{small:""}},[e._v("\n                filter_list\n              ")]):e._e()],1)],1)})),e._v(" "),e.editable?n("th",{staticClass:"column control grey lighten-4"},[n("translate",[e._v("Изменить")])],1):e._e(),e._v(" "),e.deletable?n("th",{staticClass:"column control grey lighten-4"},[n("translate",[e._v("Удалить")])],1):e._e()],2)]),e._v(" "),n("tbody",[e._l(e.displayedData,(function(t,i){return n("tr",{key:"table-row"+i,staticClass:"lighten-4",class:{primary_light:e.isRowSelected(t.id)},on:{click:function(n){return e.rowClicked(t)}}},[e._l(e.fields,(function(i,o){return n("td",{key:"field"+o,staticClass:"table-row",style:i.style},[e._v("\n            "+e._s(t[i.key])+"\n          ")])})),e._v(" "),e.editable?n("td",{staticClass:"table-row control"},[n("v-icon",{on:{click:function(t){return t.stopPropagation(),e.editRow(i)}}},[e._v("edit")])],1):e._e(),e._v(" "),e.deletable?n("td",{staticClass:"table-row control"},[n("v-icon",{attrs:{color:"warning"},on:{click:function(t){return t.stopPropagation(),e.deleteRow(i)}}},[e._v("delete")])],1):e._e()],2)})),e._v(" "),e.noData?n("tr",[n("td",{staticClass:"table-row message",attrs:{colspan:e.fields.length}},[n("span",{staticClass:"mt-2 ml-1"},[e._v("В таблице отсутствуют данные")])])]):e._e()],2)])])],1)},Ql=[],zl=n(11583),cardTablevue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardTablevue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardTablevue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Zl=class CardTable extends(o()){constructor(){super(...arguments),this.selected=[],this.selectedRows=[],this.searchTerm="",this.sortFields=[],this.innerData=[]}onDataChanged(){if(!this.data||!this.data.length)return;let e=0;this.data[0].id||0===this.data[0].id||this.data.forEach((t=>t.id=e++)),this.innerData=[...this.data]}onCancelledSelection(){this.selected.length=0}onCancelledPrevSelection(){this.selected=[]}editRow(e){return cardTablevue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){if(!this.vocabulary)return;const t=yield this.editVocElem(this.innerData[e].id);t&&(this.innerData[e]=t)}))}deleteRow(e){return cardTablevue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){const t=this.innerData.splice(e,1);if(this.selected.includes(t[0].id)){const e=this.selected.indexOf(t[0].id);this.selected.splice(e,1),this.selectedRows.splice(e,1)}if(this.vocabulary){const e=new ir.Gv(this.vocabulary,t[0].id);try{const t=yield this.commandBus.exec(e);t.error?(this.$toasted.error(this.$gettext("При удалении элемента списка произошла ошибка")),this.$log.error(t.error)):this.$toasted.success(this.$gettext("Значение удалено"))}catch(e){this.$log.error(this.$gettextInterpolate(this.$gettext("Ошибка: %{e} \nпри удалении значения %{value} словаря %{vocabulary}"),{e,value:t[0].id,vocabulary:this.vocabulary}))}}this.$emit("delete",t[0]),this.emitSelected(),this.emitInput()}))}rowClicked(e){if(!this.noneSelect&&e){if(this.singleSelect)if(this.selected.includes(e.id))this.selected=[],this.selectedRows=[];else{const t=this.data.indexOf(this.data.filter((t=>t.id===e.id))[0]);this.selected[0]=e.id,this.selectedRows[0]=this.data[t]}else if(this.multiselect)if(this.selected.includes(e.id)){const t=this.selected.indexOf(e.id);this.selected.splice(t,1),this.selectedRows.splice(t,1)}else this.selected.push(e.id),this.selectedRows.push(e);this.emitSelected(),this.$forceUpdate()}}isRowSelected(e){return this.selected.includes(e)}fieldClick(e){let t=this.sortFields.filter((t=>t.key===e.key))[0];if(!t)return t={key:e.key,direction:"asc"},void this.$set(this.sortFields,0,t);const n=this.sortFields.indexOf(t);"asc"===t.direction?(t.direction="desc",this.$set(this.sortFields,n,t)):this.sortFields.splice(n,1)}fieldHasSort(e){return this.sortFields.filter((t=>t.key===e.key)).length>0}isSortingAsc(e){const t=this.sortFields.filter((t=>t.key===e.key))[0];return!!t&&"asc"===t.direction}editVocElem(e,t,n=this.$gettext("Редактирование")){return cardTablevue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){if(this.context&&(e||t)){let i=t;return t||(i=yield this.fetchVocabularyItem(new Pt.AG(this.vocabulary,e))),this.$app.editCatalogueItem({item:i,title:n,name:this.vocabulary,context:this.context})}}))}emitInput(){if(this.selectedRows&&this.selectedRows.length||this.$emit("input",[]),this.selectedRows&&this.selectedRows.length&&!this.selectedRows[0].id)return;const e=this.selectedRows.map((e=>e.id));this.$emit("input",e)}emitSelected(){const e={ids:this.selected,rows:this.selectedRows};this.$emit("select",e)}sortingData(){if(this.data)return this.sortFields&&this.sortFields.length?"asc"===this.sortFields[0].direction?this.innerData.sort(((e,t)=>{const n=e[this.sortFields[0].key],i=t[this.sortFields[0].key];return n<i?-1:n>i?1:0})):this.innerData.sort(((e,t)=>{const n=e[this.sortFields[0].key],i=t[this.sortFields[0].key];return n>i?-1:n<i?1:0})):(this.innerData=[...this.data],this.innerData)}filterData(e){const t=this.fields.map((e=>({prop:e.key})));return(0,zl.O)(e,t,this.searchTerm)}get displayedData(){let e=this.innerData;return e=this.sortingData(),this.searchTerm&&(e=this.filterData(e)),e}get noneSelect(){return"none"===this.selectMode}get singleSelect(){return"single"===this.selectMode}get multiselect(){return"multi"===this.selectMode}get computedHeight(){return this.maxHeight?`max-height: ${this.maxHeight}px`:""}get noData(){return!this.displayedData||!this.displayedData.length}};cardTablevue_type_script_lang_ts_decorate([(0,rt.Model)("input"),cardTablevue_type_script_lang_ts_metadata("design:type",Array)],Zl.prototype,"value",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTablevue_type_script_lang_ts_metadata("design:type",Boolean)],Zl.prototype,"cancelledSelection",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1}),cardTablevue_type_script_lang_ts_metadata("design:type",Boolean)],Zl.prototype,"multipleTables",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)({default:0}),cardTablevue_type_script_lang_ts_metadata("design:type",Number)],Zl.prototype,"currentTableId",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTablevue_type_script_lang_ts_metadata("design:type",Object)],Zl.prototype,"context",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTablevue_type_script_lang_ts_metadata("design:type",Array)],Zl.prototype,"fields",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTablevue_type_script_lang_ts_metadata("design:type",Array)],Zl.prototype,"data",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTablevue_type_script_lang_ts_metadata("design:type",Boolean)],Zl.prototype,"editable",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTablevue_type_script_lang_ts_metadata("design:type",Boolean)],Zl.prototype,"deletable",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)({default:"none"}),cardTablevue_type_script_lang_ts_metadata("design:type",String)],Zl.prototype,"selectMode",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTablevue_type_script_lang_ts_metadata("design:type",String)],Zl.prototype,"vocabulary",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTablevue_type_script_lang_ts_metadata("design:type",String)],Zl.prototype,"editComponent",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTablevue_type_script_lang_ts_metadata("design:type",Boolean)],Zl.prototype,"searchable",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTablevue_type_script_lang_ts_metadata("design:type",Number)],Zl.prototype,"maxHeight",void 0),cardTablevue_type_script_lang_ts_decorate([(0,Ee.f3)(Ve.O.ICommandBus),cardTablevue_type_script_lang_ts_metadata("design:type",Object)],Zl.prototype,"commandBus",void 0),cardTablevue_type_script_lang_ts_decorate([(0,fa.eI)("fetchVocabularyItem"),cardTablevue_type_script_lang_ts_metadata("design:type",Object)],Zl.prototype,"fetchVocabularyItem",void 0),cardTablevue_type_script_lang_ts_decorate([(0,rt.Watch)("data",{immediate:!0,deep:!0}),cardTablevue_type_script_lang_ts_metadata("design:type",Function),cardTablevue_type_script_lang_ts_metadata("design:paramtypes",[]),cardTablevue_type_script_lang_ts_metadata("design:returntype",void 0)],Zl.prototype,"onDataChanged",null),cardTablevue_type_script_lang_ts_decorate([(0,rt.Watch)("cancelledSelection"),cardTablevue_type_script_lang_ts_metadata("design:type",Function),cardTablevue_type_script_lang_ts_metadata("design:paramtypes",[]),cardTablevue_type_script_lang_ts_metadata("design:returntype",void 0)],Zl.prototype,"onCancelledSelection",null),cardTablevue_type_script_lang_ts_decorate([(0,rt.Watch)("currentTableId"),cardTablevue_type_script_lang_ts_metadata("design:type",Function),cardTablevue_type_script_lang_ts_metadata("design:paramtypes",[]),cardTablevue_type_script_lang_ts_metadata("design:returntype",void 0)],Zl.prototype,"onCancelledPrevSelection",null),Zl=cardTablevue_type_script_lang_ts_decorate([gt.default],Zl);const Wl=Zl,ql=Wl;var Gl=(0,Ct.Z)(ql,cardTablevue_type_template_id_55814078_scoped_true_render,Ql,!1,null,"55814078",null);const Kl=Gl.exports;_t()(Gl,{VIcon:y.Z,VRow:a.Z,VTextField:C.Z});var cardTextareavue_type_template_id_3010e0da_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-textfield-wrapper"},[n("v-row",{class:{"flex-column":e.mobile||e.labelOnTop},attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("div",e._g({staticClass:"label font-weight-bold sm-text help"},i),[e._v("\n                "+e._s(e.label)+"\n                "),e.required?n("span",{staticClass:"require"}):e._e()])]}}],null,!1,1701805709)},[e._v(" "),n("span",[e._v(e._s(e.labelHint))])]):n("div",{staticClass:"label font-weight-bold sm-text"},[e._v("\n            "+e._s(e.label)+"\n            "),e.required?n("span",{staticClass:"require"}):e._e()])],1)],1)],1):e._e(),e._v(" "),n("v-col",{staticClass:"d-flex",class:e.inputSizeClasses},[n("v-textarea",{staticClass:"small-input text-body-1 font-weight-light my-0",class:{disabled:e.disabled,"none-resizable":!e.resizable},attrs:{value:e.text,type:e.type,flat:"",solo:"","single-line":"",outlined:"","persistent-hint":e.persistentHint,rules:e.validRules,"validate-on-blur":e.validateOnBlur,placeholder:e.placeholder,disabled:e.disabled,readonly:e.readonly,hint:e.inputHint,tabindex:e.tabIndex,maxlength:e.maxlength,rows:e.rows},on:{input:function(t){return e.$emit("input",t)},blur:function(t){return e.$emit("blur",t)}},scopedSlots:e._u([{key:"append",fn:function(){return[e.clearIcon&&e.text?n("v-icon",{attrs:{color:"red"},on:{click:function(t){return e.$emit("input","")}}},[e._v("close")]):e._e()]},proxy:!0}])})],1)],1)],1)},Yl=[],cardTextareavue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardTextareavue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Jl=class CardTextareaComponent extends((0,gt.mixins)(va.Z,ya,la)){get appendIcon(){return this.clearIcon&&this.text?"close":""}};cardTextareavue_type_script_lang_ts_decorate([(0,rt.Model)("input",{type:String}),cardTextareavue_type_script_lang_ts_metadata("design:type",String)],Jl.prototype,"text",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTextareavue_type_script_lang_ts_metadata("design:type",Boolean)],Jl.prototype,"mobile",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)({default:"text"}),cardTextareavue_type_script_lang_ts_metadata("design:type",String)],Jl.prototype,"type",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!1,type:Boolean}),cardTextareavue_type_script_lang_ts_metadata("design:type",Boolean)],Jl.prototype,"clearIcon",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTextareavue_type_script_lang_ts_metadata("design:type",Boolean)],Jl.prototype,"alignLabelToRight",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTextareavue_type_script_lang_ts_metadata("design:type",Boolean)],Jl.prototype,"persistentHint",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTextareavue_type_script_lang_ts_metadata("design:type",String)],Jl.prototype,"inputHint",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTextareavue_type_script_lang_ts_metadata("design:type",Object)],Jl.prototype,"maxlength",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTextareavue_type_script_lang_ts_metadata("design:type",Object)],Jl.prototype,"rows",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTextareavue_type_script_lang_ts_metadata("design:type",Boolean)],Jl.prototype,"resizable",void 0),cardTextareavue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:""}),cardTextareavue_type_script_lang_ts_metadata("design:type",String)],Jl.prototype,"placeholder",void 0),Jl=cardTextareavue_type_script_lang_ts_decorate([gt.default],Jl);const Xl=Jl,ec=Xl;var tc=(0,Ct.Z)(ec,cardTextareavue_type_template_id_3010e0da_scoped_true_render,Yl,!1,null,"3010e0da",null);const nc=tc.exports;_t()(tc,{VCol:r.Z,VIcon:y.Z,VRow:a.Z,VTextarea:s.Z,VTooltip:_.Z});var cardTextViewervue_type_template_id_d98969cc_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-viewer-wrapper"},[n("v-row",{class:{column:e.mobile||e.labelOnTop},attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label",class:{help:e.labelHint}},i),[e._v("\n                "+e._s(e.label)+"\n                "),e.required?n("span",{staticClass:"require"}):e._e()])]}}],null,!1,3368417499)},[e._v(" "),n("span",{staticClass:"text-body-1"},[e._v(e._s(e.labelHint))])]):[n("span",{staticClass:"label"},[e._v("\n              "+e._s(e.label)+"\n              "),e.required?n("span",{staticClass:"require"}):e._e()])]],2)],1)],1):e._e(),e._v(" "),n("v-col",{staticClass:"d-flex sm-text",class:e.inputSizeClasses},[e.activeLinks&&e.text?n("v-row",{attrs:{"no-gutters":"",align:"center"}},[n("span",{domProps:{innerHTML:e._s(e.textWithHyperlinks)}})]):n("v-row",{attrs:{"no-gutters":"",align:"center"}},[e._t("default")],2)],1)],1)],1)},ic=[];const oc=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\\[\]{};:'".,<>?«»“”‘’]))/i;var cardTextViewervue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardTextViewervue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let sc=class CardTextViewer extends((0,gt.mixins)(va.Z,ya,la)){get textWithHyperlinks(){if(!this.text)return;const e=new RegExp(oc,"ig");return this.text.replace(e,'<a href="$1" target="_blank">$1</a>')}};cardTextViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTextViewervue_type_script_lang_ts_metadata("design:type",Boolean)],sc.prototype,"mobile",void 0),cardTextViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTextViewervue_type_script_lang_ts_metadata("design:type",Boolean)],sc.prototype,"alignLabelToRight",void 0),cardTextViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTextViewervue_type_script_lang_ts_metadata("design:type",Boolean)],sc.prototype,"activeLinks",void 0),cardTextViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTextViewervue_type_script_lang_ts_metadata("design:type",String)],sc.prototype,"text",void 0),sc=cardTextViewervue_type_script_lang_ts_decorate([gt.default],sc);const rc=sc,ac=rc;var lc=(0,Ct.Z)(ac,cardTextViewervue_type_template_id_d98969cc_scoped_true_render,ic,!1,null,"d98969cc",null);const cc=lc.exports;_t()(lc,{VCol:r.Z,VRow:a.Z,VTooltip:_.Z});var cardTimelinevue_type_template_id_692cc029_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-timeline-wrapper",class:{column:e.mobile}},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.loading}}),e._v(" "),e.loading?e._e():n("v-timeline",{class:{"timeline--mobile":!e.isDesktop},attrs:{"align-top":"",dense:"",clipped:""}},e._l(e.docOperationsInfo,(function(t,i){return n("v-timeline-item",{key:i,attrs:{"fill-dot":"",color:e.timelineCircleColor(t.stateID),small:""},scopedSlots:e._u([{key:"icon",fn:function(){return[1===t.stateID?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"help"},i),[n("v-icon",{staticClass:"icon-font",attrs:{color:"white"}},[e._v("radio_button_unchecked")])],1)]}}],null,!0)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.$gettext("Выполняется")))])]):2===t.stateID?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"help"},i),[n("v-icon",{staticClass:"icon-font",attrs:{color:"white "}},[e._v("done")])],1)]}}],null,!0)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.$gettext("Завершено успешно")))])]):3===t.stateID?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"help"},i),[n("v-icon",{staticClass:"icon-font",attrs:{color:"white"}},[e._v("done")])],1)]}}],null,!0)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.$gettext("Завершено с отказом")))])]):4===t.stateID?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"help"},i),[n("v-icon",{staticClass:"icon-font",attrs:{color:"warning"}},[e._v("clear")])],1)]}}],null,!0)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.$gettext("Ошибка выполнения")))])]):5===t.stateID?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"help"},i),[n("v-icon",{staticClass:"icon-font",attrs:{color:"grey"}},[e._v("radio_button_unchecked")])],1)]}}],null,!0)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.$gettext("Отмена выполнения")))])]):e._e()]},proxy:!0}],null,!0)},[e._v(" "),n("v-card",{class:{"elevation-8":e.isItemSelected(i)},on:{click:function(n){return e.itemClicked(t,i)}}},[n("v-card-text",{staticClass:"pa-3"},[n("div",{staticClass:"timeline-item--top-row",class:{"timeline-item--top-row-tablet":e.isTablet,"timeline-item--top-row-mobile":e.isMobile}},[n("span",{staticClass:"text-body-1 font-weight-bold black--text lighten-1"},[e._v("\n              "+e._s(e.userNameShorting(t.executor))+"\n            ")]),e._v(" "),n("span",{staticClass:"text-body-1 grey--text darken-1"},[e._v("\n              "+e._s(e._f("date")(t.execDateTime,"DD.MM.YYYY hh:mm"))+"\n              "),n("v-icon",{staticClass:"ml-2",staticStyle:{transform:"translateY(-2px)"},attrs:{small:"",color:"primary"}},[e._v("date_range")])],1)]),e._v(" "),n("div",{staticClass:"text-body-1 mb-2 grey--text darken-1"},[e._v(e._s(t.name))]),e._v(" "),n("transition",{attrs:{name:"expand"}},[e.isItemSelected(i)?n("div",{staticClass:"text-body-1 black--text lighten-1"},[n("div",[n("span",{staticClass:"font-weight-bold mr-2"},[e._v("\n                  "+e._s(e.$gettext("Начало выполнения операции:"))+"\n                ")]),e._v(" "),n("span",[e._v(e._s(e._f("date")(t.startDateTime,"hh:mm DD.MM.YYYY")))])]),e._v(" "),n("div",[n("span",{staticClass:"font-weight-bold mr-2"},[e._v("\n                  "+e._s(e.$gettext("Завершение выполнения операции:"))+"\n                ")]),e._v(" "),n("span",[e._v(e._s(e._f("date")(t.execDateTime,"hh:mm DD.MM.YYYY")))])]),e._v(" "),n("div",[n("span",{staticClass:"font-weight-bold mr-2"},[e._v("\n                  "+e._s(e.$gettext("Исполнитель:"))+"\n                ")]),e._v(" "),n("span",[e._v(e._s(t.executor))])]),e._v(" "),n("div",{staticClass:"mb-2"},[n("span",{staticClass:"font-weight-bold mr-2"},[e._v("\n                  "+e._s(e.$gettext("Физический исполнитель:"))+"\n                ")]),e._v(" "),n("span",[e._v(e._s(t.physicalUser))])]),e._v(" "),n("div",[n("span",[e._v(e._s(t.text))])])]):e._e()])],1),e._v(" "),n("div",{staticClass:"arrow elevation-2"})],1)],1)})),1)],1)},dc=[],uc=n(97625),cardTimelinevue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardTimelinevue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardTimelinevue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let pc=class CardTimeline extends(o()){constructor(){super(...arguments),this.selected=null,this.selectedIdx=null,this.docOperationsInfo=[],this.loading=!0}onDocIdReceived(){return cardTimelinevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.id)try{this.docOperationsInfo=yield this.queryBus.exec(new He.k9(this.id,!1))}catch(e){this.$log.error(e)}finally{this.loading=!1}}))}userNameShorting(e){return uc.X.userNameShorting(e)}itemClicked(e,t){e===this.selected&&(this.selected=null,this.selectedIdx=null),this.selected=e,this.selectedIdx=t}isItemSelected(e){return e===this.selectedIdx}timelineCircleColor(e){switch(e){case 1:case 4:return"white";case 2:return"success";case 3:return"warning";case 5:return"grey"}}};cardTimelinevue_type_script_lang_js_decorate([(0,rt.Prop)(),cardTimelinevue_type_script_lang_js_metadata("design:type",Number)],pc.prototype,"id",void 0),cardTimelinevue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTimelinevue_type_script_lang_js_metadata("design:type",Boolean)],pc.prototype,"mobile",void 0),cardTimelinevue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),cardTimelinevue_type_script_lang_js_metadata("design:type",Object)],pc.prototype,"queryBus",void 0),cardTimelinevue_type_script_lang_js_decorate([(0,rt.Watch)("id",{immediate:!0}),cardTimelinevue_type_script_lang_js_metadata("design:type",Function),cardTimelinevue_type_script_lang_js_metadata("design:paramtypes",[]),cardTimelinevue_type_script_lang_js_metadata("design:returntype",Promise)],pc.prototype,"onDocIdReceived",null),pc=cardTimelinevue_type_script_lang_js_decorate([gt.default],pc);const hc=pc,mc=hc;var fc=(0,Ct.Z)(mc,cardTimelinevue_type_template_id_692cc029_scoped_true_render,dc,!1,null,"692cc029",null);const gc=fc.exports;_t()(fc,{VCard:D.Z,VCardText:R.ZB,VIcon:y.Z,VTimeline:se.Z,VTimelineItem:re.Z,VTooltip:_.Z});var cardTimepickervue_type_template_id_26e9d621_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-timepicker-wrapper",class:{column:e.mobile||e.labelOnTop}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label font-weight-bold sm-text",class:{help:e.labelHint}},i),[e._v(e._s(e.label))])]}}],null,!1,495005635)},[e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(e.labelHint))])]):n("span",{staticClass:"label font-weight-bold sm-text"},[e._v(e._s(e.label))])],1),e._v(" "),e.required?n("div",{class:{require:e.required}}):e._e()],1)],1):e._e(),e._v(" "),n("v-col",{staticClass:"d-flex",class:e.inputSizeClasses},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.timeString,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":[function(t){e.timeString=t},e.emitInput],"update:return-value":function(t){e.timeString=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-text-field",e._g({ref:"textfield",staticClass:"small-input text-body-1 font-weight-light my-0",class:{disabled:e.disabled},attrs:{flat:"",solo:"","single-line":"",outlined:"",readonly:e.disableKeyboardInput,mask:e.mask,"persistent-hint":e.persistentHint,rules:e.validRules,"validate-on-blur":e.validateOnBlur,placeholder:e.placeholder,disabled:e.disabled,hint:e.inputHint,"tab-index":e.tabIndex},on:{input:function(t){return e.$emit("input",e.timeString)},blur:function(t){return e.$emit("blur",t)},click:function(t){return e.$emit("click",t)},keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onTextFieldBlur(t)}},scopedSlots:e._u([{key:"append",fn:function(){return[e.disabled||e.readonly?e._e():n("v-icon",{attrs:{color:"grey"},on:{click:e.clear}},[e._v("close")]),e._v(" "),n("v-icon",e._g({staticClass:"mr-1",attrs:{color:"primary"},on:{click:e.onOpenClock}},i),[e._v("access_time")])]},proxy:!0}],null,!0),model:{value:e.timeString,callback:function(t){e.timeString=t},expression:"timeString"}},i))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),n("v-time-picker",{ref:"timepicker",attrs:{"no-title":"",scrollable:"",locale:"ru-ru",format:"24hr",disabled:e.disabled||e.readonly,color:"primary"},on:{change:e.save,input:e.emitInput},model:{value:e.timeString,callback:function(t){e.timeString=t},expression:"timeString"}},[n("v-spacer"),e._v(" "),n("v-btn",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v("Отмена")])],1)],1)],1)],1)},yc=[],cardTimepickervue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardTimepickervue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let vc=class CardTimepickerComponent extends((0,gt.mixins)(la,ya,va.Z)){constructor(){super(...arguments),this.timeString=null,this._timeString=null,this.menu=!1,this.mask="time"}onValueChange(){if(!this.value)return this.timeString="";this.timeString=this.value}onTimestringChange(){this.timeString&&(this.timeString.split("")[4]||this.validatekeyboardInput())}save(){!this.timeString&&this._timeString&&(this.timeString=this._timeString),this.$refs.menu.save(this.timeString),this._timeString=null,this.$refs.timepicker&&(this.$refs.timepicker.selecting=1)}onOpenClock(){this.menu?this.menu=!1:(this._timeString=this.timeString,this.timeString=null,this.menu=!0)}onTextFieldBlur(e){this.save(),this.$emit("blur",e)}clear(){this.timeString=null,this.$refs.timepicker&&(this.$refs.timepicker.selecting=1),this.emitInput()}emitInput(){this.$emit("input",this.timeString)}validatekeyboardInput(){this.timeString.length>1&&!/^\d{2}:/.test(this.timeString)&&(this.timeString=`${this.timeString.substr(0,2)}:${this.timeString.substr(2)}`,this.emitInput());const e=this.timeString.split("");return Number.parseInt(e[0],10)>2?(this.timeString="",this.$refs.textfield.lazyValue=this.timeString,void this.emitInput()):e[1]&&2===Number.parseInt(e[0],10)&&Number.parseInt(e[1],10)>3?(this.timeString=this.timeString.substr(0,1),this.$refs.textfield.lazyValue=this.timeString,void this.emitInput()):void(e[3]&&Number.parseInt(e[3],10)>5&&(this.timeString=this.timeString.substr(0,3),this.$refs.textfield.lazyValue=this.timeString,this.emitInput()))}get formattedTime(){return this.timeString?new Date(this.timeString).toLocaleDateString():""}};cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Model)("input"),cardTimepickervue_type_script_lang_ts_metadata("design:type",String)],vc.prototype,"value",void 0),cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTimepickervue_type_script_lang_ts_metadata("design:type",Boolean)],vc.prototype,"mobile",void 0),cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTimepickervue_type_script_lang_ts_metadata("design:type",Boolean)],vc.prototype,"alignLabelToRight",void 0),cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTimepickervue_type_script_lang_ts_metadata("design:type",Boolean)],vc.prototype,"persistentHint",void 0),cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardTimepickervue_type_script_lang_ts_metadata("design:type",String)],vc.prototype,"inputHint",void 0),cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:"00:00"}),cardTimepickervue_type_script_lang_ts_metadata("design:type",String)],vc.prototype,"placeholder",void 0),cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardTimepickervue_type_script_lang_ts_metadata("design:type",Boolean)],vc.prototype,"disableKeyboardInput",void 0),cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Watch)("value",{immediate:!0}),cardTimepickervue_type_script_lang_ts_metadata("design:type",Function),cardTimepickervue_type_script_lang_ts_metadata("design:paramtypes",[]),cardTimepickervue_type_script_lang_ts_metadata("design:returntype",void 0)],vc.prototype,"onValueChange",null),cardTimepickervue_type_script_lang_ts_decorate([(0,rt.Watch)("timeString"),cardTimepickervue_type_script_lang_ts_metadata("design:type",Function),cardTimepickervue_type_script_lang_ts_metadata("design:paramtypes",[]),cardTimepickervue_type_script_lang_ts_metadata("design:returntype",void 0)],vc.prototype,"onTimestringChange",null),vc=cardTimepickervue_type_script_lang_ts_decorate([gt.default],vc);const bc=vc,Cc=bc;var wc=(0,Ct.Z)(Cc,cardTimepickervue_type_template_id_26e9d621_scoped_true_render,yc,!1,null,"26e9d621",null);const _c=wc.exports;_t()(wc,{VBtn:g.Z,VCol:r.Z,VIcon:y.Z,VMenu:W.Z,VRow:a.Z,VSpacer:me.Z,VTextField:C.Z,VTimePicker:I.Z,VTooltip:_.Z});var cardUsersViewervue_type_template_id_5c5eebef_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"users-viewer-wrapper",style:{"max-height":e.maxHeight+"px"}},[n("v-row",{class:{column:e.mobile||e.labelOnTop},attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",{staticClass:"py-1",attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[n("span",{staticClass:"label"},[e._v(e._s(e.displayLabel))])])],1)],1):e._e(),e._v(" "),n("loader",{attrs:{options:{transparent:!1,global:!1},visible:e.loading}}),e._v(" "),e.loading?e._e():n("v-col",{class:Object.assign(e.inputSizeClasses,{"scrollable grey--border lighten-2 px-2 py-1":e.maxHeight})},[n("v-row",{staticClass:"user-column",attrs:{"no-gutters":""}},e._l(e.usersData,(function(t){return n("v-col",{key:t.id+":"+e._uid},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-row",e._g({staticClass:"user-data-wrapper sm-text",attrs:{"no-gutters":""}},o),[n("v-col",{staticClass:"d-flex align-center"},[n("v-icon",{staticClass:"mr-1",attrs:{color:"primary"}},[e._v("\n                    "+e._s(e.userIcon)+"\n                  ")]),e._v(" "),n("span",[e._v(e._s(e.userNameShorting(t)))])],1),e._v(" "),e.displayUserHint?n("v-col",{staticClass:"user-hint"},[n("span",{staticClass:"grey--text lighten-2 font-weight-light"},[e._v(e._s(e.getUserHint(t)))])]):e._e()],1)]}}],null,!0)},[e._v(" "),e._l(e.tooltipFields,(function(i,o){return n("v-row",{key:o+":"+e._uid,staticClass:"no-gutters"},[n("span",{staticClass:"font-weight-bold sm-text"},[e._v(e._s(i.label))]),e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(t[i.fieldName]))])])}))],2)],1)})),1)],1)],1)],1)},xc=[],cardUsersViewervue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardUsersViewervue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardUsersViewervue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Sc=class CardUsersViewerComponent extends((0,gt.mixins)(ya)){constructor(){super(...arguments),this.userIds=[],this.usersData=[],this.frameHeight=null,this.loading=!1}onUsersChange(){return cardUsersViewervue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){if(!this.users)return;const e=Array.isArray(this.users)?this.users:[this.users];if(this.userIds=[],this.usersData=[],e.forEach((e=>{if("number"===typeof e)this.userIds.push(e);else{const t=this.propsToCamelCase(e);this.usersData.push(t)}})),this.userIds.length)try{this.loading=!0;const e=yield this.queryBus.exec(new vr.zD(this.userIds,!1));Array.isArray(e)&&e.forEach((e=>this.usersData.push(e)))}catch(e){this.$log.error(e)}finally{this.loading=!1}}))}userNameShorting(e){return uc.X.userNameShorting(e.name)}getUserHint(e){return"string"===typeof this.displayUserHint?e[this.displayUserHint]:e.positionName}propsToCamelCase(e){const t={};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];"ID"===n?t["id"]=i:t[(0,it.eV)(n)]=i}return t}get displayLabel(){const e=this.userIds.length>1?`(${this.userIds.length})`:"";return`${this.label} ${e}`}};cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({required:!0}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Object)],Sc.prototype,"users",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Sc.prototype,"scrollable",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Number)],Sc.prototype,"maxHeight",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Sc.prototype,"mobile",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardUsersViewervue_type_script_lang_ts_metadata("design:type",String)],Sc.prototype,"label",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:"account_circle"}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",String)],Sc.prototype,"userIcon",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Sc.prototype,"alignLabelToRight",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Sc.prototype,"labelOnTop",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:[Boolean,String],default:!1}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Object)],Sc.prototype,"displayUserHint",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Array,default(){return[{label:"ФИО",fieldName:"name"},{label:"Должность",fieldName:"positionName"},{label:"Подразделение",fieldName:"departmentName"}]}}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Array)],Sc.prototype,"tooltipFields",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,ot.t)(Ae.M.IQueryBus),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Object)],Sc.prototype,"queryBus",void 0),cardUsersViewervue_type_script_lang_ts_decorate([(0,rt.Watch)("users",{deep:!0,immediate:!0}),cardUsersViewervue_type_script_lang_ts_metadata("design:type",Function),cardUsersViewervue_type_script_lang_ts_metadata("design:paramtypes",[]),cardUsersViewervue_type_script_lang_ts_metadata("design:returntype",Promise)],Sc.prototype,"onUsersChange",null),Sc=cardUsersViewervue_type_script_lang_ts_decorate([gt.default],Sc);const Ic=Sc,Dc=Ic;var Rc=(0,Ct.Z)(Dc,cardUsersViewervue_type_template_id_5c5eebef_scoped_true_render,xc,!1,null,"5c5eebef",null);const Tc=Rc.exports;_t()(Rc,{VCol:r.Z,VIcon:y.Z,VRow:a.Z,VTooltip:_.Z});var cardVocabularyViewervue_type_template_id_3721863b_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"vocabulary-viewer-wrapper",class:{column:e.mobile||e.labelOnTop},style:{"max-height":e.maxHeight+"px"},attrs:{"no-gutters":""}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",{attrs:{"no-gutters":""}},[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{"no-gutters":"",align:"center"}},[n("span",{staticClass:"label font-weight-bold sm-text"},[e._v(e._s(e.label))])])],1)],1):e._e(),e._v(" "),n("loader",{attrs:{options:{transparent:!1,global:!1},visible:e.loading}}),e._v(" "),!e.loading&&e.withTooltip?n("v-col",{class:Object.assign(e.inputSizeClasses,{"scrollable grey--border lighten-2 px-2 py-1":e.maxHeight})},[n("v-row",{attrs:{"no-gutters":""}},e._l(e.vocData,(function(t){return n("v-col",{key:e.getKey(t)+e._uid,attrs:{cols:"12"}},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-row",e._g({staticClass:"vocabulary-data-wrapper",attrs:{"no-gutters":""}},o),[n("v-col",{attrs:{cols:"12"}},[n("v-icon",{staticClass:"vocabulary-icon",attrs:{color:"primary"}},[e._v("\n                  "+e._s(e.icon)+"\n                ")]),e._v(" "),n("span",[e._v(e._s(t.attributes[e.displayField]))])],1),e._v(" "),t.attributes[e.hintField]?n("v-col",{staticClass:"vocabulary-hint"},[n("span",{staticClass:"grey--text lighten-2 font-weight-light"},[e._v(e._s(t.attributes[e.hintField]))])]):e._e()],1)]}}],null,!0)},[e._v(" "),n("v-row",{attrs:{"no-gutters":""}},e._l(e.tooltipFields,(function(i,o){return n("v-col",{key:"tooltip-field"+o+":"+e._uid},[n("span",{staticClass:"font-weight-bold sm-text"},[e._v(e._s(i.description))]),e._v(" "),n("span",{staticClass:"sm-text"},[e._v(e._s(t.attributes[i]))])])})),1)],1)],1)})),1)],1):e._e(),e._v(" "),e.loading||e.withTooltip?e._e():n("v-col",{class:Object.assign(e.inputSizeClasses,{"scrollable grey--border lighten-2 px-2 py-1":e.maxHeight})},[n("v-row",{attrs:{"no-gutters":""}},e._l(e.vocData,(function(t){return n("v-col",{key:e.getKey(t)+e._uid,attrs:{cols:"12"}},[n("v-row",{staticClass:"vocabulary-data-wrapper",attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[n("v-icon",{staticClass:"vocabulary-icon",attrs:{color:"primary"}},[e._v("\n              "+e._s(e.icon)+"\n            ")]),e._v(" "),n("span",[e._v(e._s(t.attributes[e.displayField]))])],1),e._v(" "),t.attributes[e.hintField]?n("v-col",{staticClass:"vocabulary-hint"},[n("span",{staticClass:"grey--text lighten-2 font-weight-light"},[e._v(e._s(t.attributes[e.hintField]))])]):e._e()],1)],1)})),1)],1)],1)},Pc=[],cardVocabularyViewervue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardVocabularyViewervue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardVocabularyViewervue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Oc=class CardVocabularyViewerComponent extends((0,gt.mixins)(ya)){constructor(){super(...arguments),this.vocIds=[],this.vocData=[],this.loading=!1}onElementsChange(e,t){e!==t&&this.elements&&(Array.isArray(this.elements)?this.elements.length&&(this.vocIds=this.elements):this.vocIds=[this.elements],!this.name||this.loading||this.offlineItems&&this.offlineItems.length||this.fetchVocData())}onOfflineItemsChange(){if(this.offlineItems){this.vocData=[];let e=0;this.offlineItems.forEach((t=>{const n={attributes:Object.assign({id:e++},t)};this.$set(this.vocData,e-1,n)}))}}onNameChange(){this.name&&(!this.vocIds||this.loading||this.offlineItems&&this.offlineItems.length||this.fetchVocData())}getKey(e){var t;if(!e)return"none";if(!e.attributes)return JSON.stringify(e);const n=null!==(t=e.attributes.id)&&void 0!==t?t:e.id;return n+":"}fetchVocData(){return cardVocabularyViewervue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{const e={where:[`new long[]{${this.vocIds.join(",")}}.Contains(Convert.ToInt64(Attributes["ID"]))`]},t=yield this.queryBus.exec(new Pt.j_(this.name,[],this.isReturnActual,null,e));this.vocData=t.items}catch(e){this.$toasted.error(this.$gettextInterpolate(this.$gettext("При запросе данных из словаря %{name} произошла ошибка"),{name:this.name}))}finally{this.loading=!1}}))}};cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",String)],Oc.prototype,"name",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({required:!0}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Object)],Oc.prototype,"elements",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:"data"}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",String)],Oc.prototype,"displayField",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:String,default:"hint"}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",String)],Oc.prototype,"hintField",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",String)],Oc.prototype,"icon",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Oc.prototype,"scrollable",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Number)],Oc.prototype,"maxHeight",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Oc.prototype,"mobile",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Oc.prototype,"withTooltip",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Array)],Oc.prototype,"tooltipFields",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!0}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Oc.prototype,"isReturnActual",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",String)],Oc.prototype,"label",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Oc.prototype,"alignLabelToRight",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Boolean)],Oc.prototype,"labelOnTop",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Array)],Oc.prototype,"offlineItems",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,ot.t)(Ae.M.IQueryBus),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Object)],Oc.prototype,"queryBus",void 0),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Watch)("elements",{immediate:!0,deep:!0}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Function),cardVocabularyViewervue_type_script_lang_ts_metadata("design:paramtypes",[Object,Object]),cardVocabularyViewervue_type_script_lang_ts_metadata("design:returntype",void 0)],Oc.prototype,"onElementsChange",null),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Watch)("offlineItems",{immediate:!0}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Function),cardVocabularyViewervue_type_script_lang_ts_metadata("design:paramtypes",[]),cardVocabularyViewervue_type_script_lang_ts_metadata("design:returntype",void 0)],Oc.prototype,"onOfflineItemsChange",null),cardVocabularyViewervue_type_script_lang_ts_decorate([(0,rt.Watch)("name",{immediate:!0}),cardVocabularyViewervue_type_script_lang_ts_metadata("design:type",Function),cardVocabularyViewervue_type_script_lang_ts_metadata("design:paramtypes",[]),cardVocabularyViewervue_type_script_lang_ts_metadata("design:returntype",void 0)],Oc.prototype,"onNameChange",null),Oc=cardVocabularyViewervue_type_script_lang_ts_decorate([gt.default],Oc);const kc=Oc,Fc=kc;var Ac=(0,Ct.Z)(Fc,cardVocabularyViewervue_type_template_id_3721863b_scoped_true_render,Pc,!1,null,"3721863b",null);const $c=Ac.exports;_t()(Ac,{VCol:r.Z,VIcon:y.Z,VRow:a.Z,VTooltip:_.Z});var cardWriteOffDocumentvue_type_template_id_53497402_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"writeOffDoc"},[n("v-row",{staticClass:"mt-2 mb-3",attrs:{"no-gutters":""}},[n("v-btn",{staticClass:"small-button rounded-button ml-0 my-0 px-2 mr-2 elevation-0 font-weight-regular mb-1",attrs:{outlined:"",color:"primary"},on:{click:e.createRecordWriteOff}},[e._v("\n      Списать в дело\n    ")]),e._v(" "),n("v-btn",{staticClass:"small-button rounded-button ml-0 my-0 px-2 mr-2 elevation-0 font-weight-regular mb-1",attrs:{outlined:"",color:"primary",disabled:!e.selectedRowID||e.disabledButtons},on:{click:e.changeRecord}},[n("v-icon",[e._v("create")]),e._v("\n      Изменить\n    ")],1),e._v(" "),n("v-btn",{staticClass:"small-button rounded-button ml-0 my-0 px-2 elevation-0 font-weight-regular",attrs:{outlined:"",color:"warning",disabled:!e.selectedRowID||e.disabledButtons},on:{click:e.deleteRecord}},[n("v-icon",[e._v("delete")]),e._v("\n      Удалить\n    ")],1)],1),e._v(" "),n("v-row",{staticStyle:{"overflow-x":"auto"},attrs:{"no-gutters":""}},[n("v-col",{staticStyle:{"min-width":"600px"}},[n("v-card",{staticClass:"elevation-0 bordered-card grey--border lighten-3 mb-3"},[n("v-card-title",{staticClass:"grey lighten-4 px-2 py-0"},[n("v-row",{attrs:{"no-gutters":""}},e._l(e.tableHeader,(function(t,i){return n("v-col",{key:i,staticClass:"word-wrap px-2",attrs:{cols:t.colSize||2}},[n("span",{staticClass:"text-body-1 font-weight-bold black--text lighten-1 header-text"},[e._v(e._s(t.name))])])})),1)],1),e._v(" "),n("v-card-text",{staticClass:"py-0 px-0",class:{"empty-text-container":e.emptyDocumentCopy}},[n("v-row",{staticClass:"justify-center text-body-1 black--text lighten-1",attrs:{"no-gutters":""}},[n("v-col",{class:{"empty-body":e.emptyDocumentCopy},attrs:{cols:"12"}},[e.emptyDocumentCopy?n("span",{staticClass:"text-body-1 black--text lighten-1"},[e._v("В таблице отсутствуют данные")]):e._l(e.documentCopy,(function(t,i){return n("v-row",{key:i,staticClass:"word-wrap px-2 py-2",class:{"selected-row":t.selected,"rows-divider":i!==e.documentCopy.lighten-1},attrs:{"no-gutters":""},on:{click:function(n){return e.setSelectedRow(t,i)}}},[n("v-col",{staticClass:"px-2",attrs:{cols:"2"}},[n("div",[e._v(e._s(t[e.tableHeader[0].field]))])]),e._v(" "),n("v-col",{staticClass:"px-2",attrs:{cols:"2"}},[n("div",[e._v(e._s(t[e.tableHeader[1].field]))])]),e._v(" "),n("v-col",{staticClass:"px-2",attrs:{cols:"3"}},[n("div",[e._v(e._s(t[e.tableHeader[2].field]))])]),e._v(" "),n("v-col",{staticClass:"px-2",attrs:{cols:"2"}},[n("div",[e._v(e._s(t[e.tableHeader[3].field]))])]),e._v(" "),n("v-col",{staticClass:"px-2",attrs:{cols:"3"}},[n("div",[e._v(e._s(t[e.tableHeader[4].field]))])])],1)}))],2)],1)],1)],1)],1)],1)],1)},jc=[],Ec=n(80790),Mc=n(45569),cardWriteOffDocumentvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardWriteOffDocumentvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardWriteOffDocumentvue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Nc=class CardWriteOffDocument extends(o()){constructor(){super(...arguments),this.documentCopy=[],this.selectedData=null,this.selectedRowID=null,this.tableHeader=[{name:this.$gettext("Индекс дела"),field:"FolderIndex"},{name:this.$gettext("Название дела"),field:"FolderName"},{name:this.$gettext("Подразделение"),field:"DepartmentName",colSize:3},{name:this.$gettext("Дата списания"),field:"FolderDateTime"},{name:this.$gettext("Комментарий"),field:"Comments",colSize:3}]}created(){this.documentCopyObject()}createRecordWriteOff(){return cardWriteOffDocumentvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{const e={model:this.id,data:null},t=new Mc.c({title:"Списать в дело",componentName:"write-off-document",componentProps:e,fullHeight:!1,width:"60%"});yield this.queryBus.exec(t)}catch(e){}finally{yield this.documentCopyObject(),this.loading=!1}}))}documentCopyObject(e){return cardWriteOffDocumentvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){try{const t=`<CONSTRAINTS><AND><EQUAL field="State" value="3" /><EQUAL field="DocumentID" value="${this.id}" /></AND></CONSTRAINTS>`,{DOCUMENTCOPY:n}=yield this.queryBus.exec(new He.Ip("DOCUMENTCOPY",Ec.b.ListItem,null,t));this.documentCopy=n.map((t=>({ObjID:t.ObjID,ID:t.ID,FolderIndex:t.FolderIndex,FolderName:t.FolderName,DepartmentName:t.DepartmentName,FolderDateTime:new Date(t.FolderDateTime).toLocaleDateString(),Comments:t.Comments,selected:e===t.ID})))}catch(e){this.$log.error(e)}}))}changeRecord(){return cardWriteOffDocumentvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.loading=!0;const e={model:this.id,data:this.selectedData.item},t=new Mc.c({title:"Списать в дело",componentName:"write-off-document",componentProps:e,fullHeight:!1,width:"60%"});yield this.queryBus.exec(t),yield this.documentCopyObject(this.selectedData.item.ID),this.loading=!1}))}deleteRecord(){return cardWriteOffDocumentvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){const e=this.documentCopy.indexOf(this.selectedData.item);e>=0&&(yield this.commandBus.exec(new Dt.wp("DOCUMENTCOPY",["ID"],[this.selectedRowID])),yield this.documentCopyObject(),this.$toasted.success("Запись успешно удалена"))}))}setSelectedRow(e,t){let n;const i=t;this.selectedData&&(n=this.selectedData.index,n>=0&&(this.documentCopy[n].selected=!1,this.selectedData=null,this.selectedRowID=null)),i!==n&&(e.selected=!e.selected,this.selectedData={item:e,index:t},this.selectedRowID=String(e.ID))}get disabledButtons(){return this.documentCopy.length<=0}get emptyDocumentCopy(){return!this.documentCopy||!this.documentCopy.length}};cardWriteOffDocumentvue_type_script_lang_ts_decorate([(0,rt.Prop)(),cardWriteOffDocumentvue_type_script_lang_ts_metadata("design:type",Number)],Nc.prototype,"id",void 0),cardWriteOffDocumentvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!1}),cardWriteOffDocumentvue_type_script_lang_ts_metadata("design:type",Boolean)],Nc.prototype,"mobile",void 0),cardWriteOffDocumentvue_type_script_lang_ts_decorate([(0,ot.t)(Ae.M.IQueryBus),cardWriteOffDocumentvue_type_script_lang_ts_metadata("design:type",Object)],Nc.prototype,"queryBus",void 0),cardWriteOffDocumentvue_type_script_lang_ts_decorate([(0,ot.t)(Ve.O.ICommandBus),cardWriteOffDocumentvue_type_script_lang_ts_metadata("design:type",Object)],Nc.prototype,"commandBus",void 0),Nc=cardWriteOffDocumentvue_type_script_lang_ts_decorate([(0,gt.default)({components:{"card-table":Kl}})],Nc);const Vc=Nc,Bc=Vc;var Lc=(0,Ct.Z)(Bc,cardWriteOffDocumentvue_type_template_id_53497402_scoped_true_render,jc,!1,null,"53497402",null);const Uc=Lc.exports;_t()(Lc,{VBtn:g.Z,VCard:D.Z,VCardText:R.ZB,VCardTitle:R.EB,VCol:r.Z,VIcon:y.Z,VRow:a.Z});var Hc=n(52479),chartViewervue_type_template_id_c8472328_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{"no-gutters":""}},[e.empty?e._e():n("div",{staticClass:"chart-container",class:"chart-container_"+e.chartId}),e._v(" "),e.empty?n("div",[e._v("Нет данных для отображения")]):e._e()])},Qc=[],zc=n(72181),chartViewervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},chartViewervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};zc.zX&&zc.kL.register(...zc.zX);let Zc=class ChartViewerComponent extends(o()){mounted(){this.renderChart()}handleClick(e){if(Array.isArray(e)&&e.length&&!this.isMobile){const t=e[0].index,n=this.chart.data.labels[t];this.$emit("click",n)}}renderChart(){const e=document.getElementsByClassName("chart-container_"+this.chartId)[0],t=document.createElement("canvas");e.appendChild(t);const n=t.getContext("2d");this.chart=new zc.kL(n,this.chartData),t.onclick=e=>{const t=this.chart.getElementsAtEventForMode(e,"index",{intersect:!0},!1);this.handleClick(t)}}};chartViewervue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),chartViewervue_type_script_lang_js_metadata("design:type",Object)],Zc.prototype,"queryBus",void 0),chartViewervue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),chartViewervue_type_script_lang_js_metadata("design:type",Object)],Zc.prototype,"commandBus",void 0),chartViewervue_type_script_lang_js_decorate([(0,rt.Prop)(),chartViewervue_type_script_lang_js_metadata("design:type",Object)],Zc.prototype,"chartData",void 0),chartViewervue_type_script_lang_js_decorate([(0,rt.Prop)(),chartViewervue_type_script_lang_js_metadata("design:type",Object)],Zc.prototype,"chartId",void 0),chartViewervue_type_script_lang_js_decorate([(0,rt.Prop)(),chartViewervue_type_script_lang_js_metadata("design:type",Boolean)],Zc.prototype,"empty",void 0),Zc=chartViewervue_type_script_lang_js_decorate([rt.Component],Zc);const Wc=Zc,qc=Wc;var Gc=(0,Ct.Z)(qc,chartViewervue_type_template_id_c8472328_render,Qc,!1,null,null,null);const Kc=Gc.exports;_t()(Gc,{VRow:a.Z});var documentTemplateRenderervue_type_template_id_04032222_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.myDocument?n("external-component-renderer",{key:"ecr",staticClass:"external-component-renderer",attrs:{role:"form",path:e.templatePath,context:e.actionContext,props:{document:e.myDocument,card:e.card,newDocDefaultData:e.newDocDefaultData,preview:e.preview,refresh:e.refreshCounter,validators:e.validators,isValid:e.isValid},mixin:e.mixin},on:{"external-component-created":e.onCardInstanceCreated,"set-result":e.onSetResult,"external-component-loading":function(t){return e.$emit("external-component-loading",t)},"external-component-emit":function(t){return e.onExternalComponentEmit(t)}}}):e._e()},Yc=[],Jc=n(60917),Xc=n(20785),documentTemplateRenderervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},documentTemplateRenderervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},documentTemplateRenderervue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const ed="external-component-emit",td="external-component-created",nd="external-component-loading",od="card-created",sd="card-updated",rd="card-mounted",ad="set-doc-active-tab",ld="set-result",cd="can-save-switch",dd="save-completed",ud="document-save-completed",pd="update-state";let hd=class DocumentTemplateRendererComponent extends kn.Z{constructor(){super(...arguments),this.myDocument=null,this.card=null,this.metadata=null,this.refreshCounter=0,this.suffix="_$IDS",this.validators=ll.z2,this.mobile=!0,this.templatePath="",this.oldTemplateType=-1,this.height=0,this.showSuccessMsg=!0,this.viewAfterCreate=!1,this.initFunc=null,this.isDestroyed=!1,this.selectedFileTemplates=[],this.mixin={created(){this.$templateRenderer||(this.$templateRenderer=this.$parent.$parent),this.$emit(td,this)},mounted(){this.$emit(ed,{name:rd})},updated(){this.$emit(ed,{name:sd})},beforeDestroy(){if(this.getViewState){const e=this.getViewState();this.$emit(ed,{name:"update-state",data:e})}},data(){return{}},methods:{getIds:Xc.s3,documentEdit(e,t){return this.command.exec(new Dt.Ae(e,t))},documentCreate(e,t){return this.command.exec(new Dt.p2(e,t))},view(e){if(!this.card.__savingInProcess)return e=e||this.card.id,this.$app.viewDoc(this.card.id,Object.assign(Object.assign({},this.context),{entityViewMode:Ue.dS.View}))},edit(e){if(!this.card.__savingInProcess)return e=e||this.card.id,this.$app.editDoc(e,Object.assign(Object.assign({},this.context),{entityViewMode:Ue.dS.Edit}),!0)},redirectInstruction(e,t){return this.$app.redirectInstruction(e,this.context,t)},create(e,t){const n=t&&t.context?t.context:this.context;return this.$app.createDocument({journalId:e?Number(e):this.card.journalID,context:Object.assign(Object.assign({},n),{entityViewMode:Ue.dS.Create}),params:t})},close({journalId:e}){if(e)return this.$app.goto(Pe.k.ToDocuments,this.context,{parentId:e.toString()});this.$app.goPrev(this.context)},createVocElem(e,t=this.$gettext("Создать"),n=null){return this.$app.createCatalogueItem({name:e,title:t,context:Object.assign(Object.assign({},this.context),{entityViewMode:Ue.dS.Create}),parent:n})},editVocElem(e,t,n,i=this.$gettext("Изменить"),o=null){return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let s=n;return n||(s=yield this.fetchVocabularyItem(new Pt.AG(e,t))),this.$app.editCatalogueItem({item:s,title:i,name:e,context:Object.assign(Object.assign({},this.context),{entityViewMode:Ue.dS.Edit}),parent:o})}))},$updateFiles(e){if(!e)return;const t=[];this.card.files=t,this.document.files=t,e.forEach((e=>{this.card.files.push(e)})),this.$emit(ed,{name:"card-files-updated",data:this.card.files})},addFileTemplate(e){this.$templateRenderer.selectedFileTemplates=e},sendReportTask(e,t,n=!0,i=!1,o){return this.$templateRenderer.sendReportTask(e,t,n,i,o)},saveDoc(){return this.$templateRenderer.saveCard()},saveCard(){return this.$templateRenderer.saveCard()},validate(){return this.$templateRenderer.validate()},validateSection(){return this.$templateRenderer.validateSection()},refreshDoc(){this.$templateRenderer.refreshDoc()},disableSaveButton(){this.$templateRenderer.canSaveSwitch(!1)},enableSaveButton(){this.$templateRenderer.canSaveSwitch(!0)},setLoadingStatus(e){this.$templateRenderer.setLoadingStatus(e)},disableSuccessMessage(){this.$templateRenderer.disableSuccessMessage()},enableSuccessMessage(){this.$templateRenderer.enableSuccessMessage()},viewAfterCreate(){this.$templateRenderer.setViewAfterCreate()},setListValues:Xc.SY,debounce:Pl.Z},computed:{isPreview(){return this.context.entityViewMode===Ue.dS.Preview}}},this.activeTab=-1}onForceIsMobileChanged(){this.templateType!==et.$.Item&&this.updateHeight()}onViewStateChanged(){var e;this.cardComponentInstance?this.cardComponentInstance.setViewState?(this.viewStateNotUpdated=!1,this.cardComponentInstance.setViewState(this.viewState)):(null===(e=this.viewState)||void 0===e?void 0:e.activeTab)&&localStorage.getItem("dss_signFiles")&&(this.viewStateNotUpdated=!1,setTimeout((()=>Je.X.$emit(ad,this,this.viewState.activeTab)))):this.viewStateNotUpdated=!0}onDocumentChanged(e,t){return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e)return;let n="";if((this.templateType!==this.oldTemplateType||e.cardId!==this.oldCardId)&&(n=yield this.getTemplatePath(e.cardId),!n))return;this.templateType===et.$.Create&&(this.card=null);let i=od;if(t&&e.id===t.id){if(i=sd,!e.__saved&&this.$app.state===Oe.Z.EditingDoc&&this.oldTemplateType===et.$.Edit){Object.keys(e.attributes).forEach((t=>{void 0===this.myDocument.attributes[t]&&e.attributes[t]&&(this.myDocument.attributes[t]=e.attributes[t]),void 0===this.card.attr[t]&&e.attributes[t]&&(this.card.attr[t]=e.attributes[t])}));const t=["id","type","attributes","files","data","mainFile","createDateTime","parentDocumentNode","oneToManyChildren","manyToManyRelations"];return Object.keys(e).filter((e=>!t.includes(e))).forEach((t=>{this.myDocument[t]=e[t],this.card[t]=e[t]})),void(this.myDocument.viewFlag||this.startReadedTimer())}e.__saved=!1}this.metadata=yield this.fetchDocumentMetadata(new He.XS(e.type)),this.oldTemplateType=this.templateType,this.redefineInitForChilds(),this.myDocument=(0,$n.Z)(e),(0,Xc.BK)(this.myDocument),this.card=this.createCard(this.myDocument),this.originalDocument=JSON.parse(JSON.stringify(this.documentDto(this.myDocument))),this.oldCardId=this.card.cardId,this.$emit(i,this.card),this.storeOriginalCard(this.card);const o=this.myDocument.viewFlag;o||this.templateType===et.$.Item||this.templateType===et.$.Create||this.startReadedTimer(),n&&(this.templatePath=n)}))}onLazyCardActionsCounterChanged(){var e;return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(null===(e=this.cardComponentInstance)||void 0===e?void 0:e.deferGetActions)try{yield this.cardComponentInstance.deferGetActions()}catch(e){this.$log.error(e)}}))}onSaveCounterChanged(){var e,t,n,i,o,s;return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let r=!0;try{const a=(null===(e=this.cardComponentInstance)||void 0===e?void 0:e.validate)?this.cardComponentInstance.validate.bind(this.cardComponentInstance):null,l=a?yield a():this.validate();if(!l)return;this.card.__savingInProcess=!0;const{isNew:c}=this.card,d=(null===(t=this.cardComponentInstance)||void 0===t?void 0:t.beforeSave)?this.cardComponentInstance.beforeSave.bind(this.cardComponentInstance):null,u=(null===(n=this.cardComponentInstance)||void 0===n?void 0:n.save)?this.cardComponentInstance.save.bind(this.cardComponentInstance):null,p=(null===(i=this.cardComponentInstance)||void 0===i?void 0:i.afterSave)?this.cardComponentInstance.afterSave.bind(this.cardComponentInstance):null;if(d){const e=yield d();if(!1===e)return void(r=!1)}if(u)return void(yield u());const h=yield this.saveCard();if(null!==h){if(this.selectedFileTemplates.length){const e=[];for(const t of this.selectedFileTemplates)e.push(this.attachFileTemplateToDoc(new Vi.O_(this.card.id,t.fullPath)));try{yield Promise.all(e)}catch(e){const t=this.$gettext("Не удалось прикрепить все выбранные файлы к документу");this.$toasted.error((null===(s=null===(o=e.response)||void 0===o?void 0:o.data)||void 0===s?void 0:s.message)||t)}}if(yield this.$nextTick(),this.card.__savingInProcess=!0,p)try{yield p()}catch(e){this.$log.error("document afterSave error:",e)}if(c)try{this.viewAfterCreate?this.$app.viewDoc(this.card.id,this.actionContext):this.$app.editDoc(this.card.id,this.actionContext,!0)}catch(e){this.$log.error(e)}r&&this.showSuccessMsg&&this.queryBus.exec(new gn.m("",this.$gettext("Документ успешно сохранён")))}}catch(e){this.$log.error("document save error:",e),r=!1}finally{delete this.card.__savingInProcess,this.$emit(dd,r),Je.X.$emit(ud,r)}}))}created(){Je.X.$on("doc:change-active-tab",this.onActiveTabChanged)}mounted(){this.updateHeight()}beforeUpdate(){this.updateHeight()}beforeDestroy(){Je.X.$off("doc:change-active-tab",this.onActiveTabChanged),this.isDestroyed=!0,this.initFunc&&(this.$log.debug("this.initFunc = null"),o().prototype._init=this.initFunc,this.initFunc=null),clearTimeout(this.setReadedTimer)}onActiveTabChanged(e,t){if(this===e){this.prevActiveTab=this.activeTab,this.activeTab=t;const e={activeTab:this.activeTab};this.$emit(pd,e)}}errorCaptured(e,t,n){this.$log.error("errorCaptured",e,t,n)}onCardInstanceCreated(e){var t,n,i;this.cardComponentInstance!==e&&((null===(n=null===(t=this.cardComponentInstance)||void 0===t?void 0:t.card)||void 0===n?void 0:n.id)===(null===(i=null===e||void 0===e?void 0:e.card)||void 0===i?void 0:i.id)&&setTimeout((()=>{var e;return Je.X.$emit(ad,this,null!==(e=this.prevActiveTab)&&void 0!==e?e:0)})),this.cardComponentInstance=e,this.updateHeight(),this.viewState&&this.viewStateNotUpdated&&this.onViewStateChanged(),this.$emit(td,e))}onSetResult(e){this.$emit(ld,e)}onExternalComponentEmit(e){e&&(e.name===sd||e.name&&this.$emit(e.name,e.data))}downloadReport(e,t){this.$toasted.success(this.$gettext("Началось скачивание отчёта"));const n=document.createElement("a");n.href=`${this.$config.apiPath()}fast-report/task/${e}/file`,n.download=t,document.body.appendChild(n),n.click(),setTimeout((()=>{document.body.removeChild(n),window.URL.revokeObjectURL(`${this.$config.apiPath()}fast-report/task/${e}/file`)}),0)}attachReportToDoc(e){return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=yield this.commandBus.exec(new Ao.w(e,this.card.id));t.error?this.$toasted.error(this.$gettext("Произошла ошибка при прикреплении результата отчёта в документу")):this.$toasted.success(this.$gettext("Результат отчёта прикреплён к документу как файл"))}))}disableSuccessMessage(){this.showSuccessMsg=!1}enableSuccessMessage(){this.showSuccessMsg=!0}setViewAfterCreate(){this.viewAfterCreate=!0}canSaveSwitch(e){this.$emit(cd,e)}setLoadingStatus(e){this.$emit(nd,e)}refreshDoc(){return this.fetchDocument(new He.U_(this.card.id||this.myDocument.id,this.context.entityViewMode,Number(this.actionContext.folderId),!0))}sendReportTask(e,t,n=!0,i=!1,o){return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const s=t||{},r=new Ao.c(e,s,i?this.card.id:null),a=yield this.commandBus.exec(r);if(!n&&!i)return Promise.resolve(!0);let l,c=new Promise((e=>l=e));if(a.error)this.$toasted.error(this.$gettext("При отправке задания на создание отчёта произошла ошибка")),o&&o(!1),c=Promise.reject(a.error);else{this.$toasted.success(this.$gettext("Задание на создание отчета успешно отправлено"));const onFileAttachedHandler=e=>{var t;this.pubSubService.off(a.value,onFileAttachedHandler),(null===e||void 0===e?void 0:e.error)?(this.$toasted.error(this.$gettext("При формировании отчёта произошла ошибка")),this.$log.error(`Ошибка при формировании отчета для документа ${e.documentId}: ${e.error}, status=${e.status}`)):n&&this.downloadReport(a.value,null!==(t=e.fileName)&&void 0!==t?t:"Отчёт"),o&&o(!(null===e||void 0===e?void 0:e.error)),l(!(null===e||void 0===e?void 0:e.error))};this.pubSubService.on(a.value,onFileAttachedHandler)}return c}))}saveCard(){return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const{card:e}=this;let{id:t}=e,n=e.attr;n=(0,Xc.xc)(n,this.originalCard.attr);const i=(0,Xc.QT)(e,this.suffix);let o;try{if(t){const s=(0,Xc.QT)(this.originalCard,this.suffix),{referencesToAdd:r,referencesToDelete:a}=(0,Xc.G4)(i,s),l=this.documentFromCard(e);o=yield this.documentSave(new Dt.Lt(n,r,a,t,e.journalID,Number(e.cardId),l))}else o=yield this.documentSave(new Dt.Lt(n,i,null,0,e.journalID,Number(e.cardId))),t=e.id=o.value.id,Array.isArray(e.files)&&e.files.length&&(yield this.saveFiles(t,e.files));return o.isFailure?null:o.value}catch(e){throw this.$log.error(e.message?e.message:e),this.$toasted.error(e.message?e.message:e),e}finally{this.$emit(dd)}}))}saveFiles(e,t){return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!Array.isArray(t))return;t=t.filter((e=>!e.id));const n=new FormData;if(t.forEach((e=>{n.append("file",e.file)})),t.length){const t=yield this.commandBus.exec(new un.eY(e,n));if(t.isFailure)throw t.error}}))}getTemplatePath(e){return documentTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let t,n,i=null;try{t=yield this.queryBus.exec(new tt.R0(e,"cards"))}catch(e){throw this.$log.error("Ошибка чтения манифеста",e),e}const o=et.$[this.templateType].toLowerCase();if(t&&(i=t[o]?t[o].toLowerCase():null),(!i||!t)&&(n=yield this.queryBus.exec(new tt.R0("default","cards")),n&&(i=n[o].toLowerCase(),e="default"),!n&&!t))throw new Error("Не загружен манифест!");return!i||i.includes("/")||i.includes("\\")||(i=`${e}/${i}`),(null===t||void 0===t?void 0:t.baseUrl)&&(i=t.baseUrl.endsWith("/")?`${t.baseUrl}${i}`:`${t.baseUrl}/${i}`),i}))}documentDto(e){const{attributes:t}=e;let n={};if(e.data){const t=(0,Xc.TT)(e.data,(t=>Array.isArray(e.data[t])&&e.data[t].length>0&&void 0!==e.data[t][0]));n=Object.keys(t).filter((e=>t[e])).map((e=>({key:e,ids:t[e].map((e=>e.id)).filter((e=>Boolean(e)))}))).reduce(((e,t)=>(e[t.key]=t.ids,e)),{})}return{attributes:t,referencesIds:n}}createCard(e){var t;if(!e)return null;this.setAttrTypes(e);const{attributes:n}=e,i=Object.keys(n),o={};e.manyToManyRelations&&e.data&&e.manyToManyRelations.forEach((t=>{const s=(0,Xc.e9)(e,t.name,this.suffix);t.attrName=s;const r=e.data[t.name];o[s]=[],o[t.name]=r,Array.isArray(r)&&(o[s]=r.map((e=>e.id||e.ID||e.Id||null)));const a=i.filter((e=>e.startsWith(t.name)));a.forEach((e=>{o[e]=n[e],delete n[e]}))})),e.oneToManyChildren&&e.data&&e.oneToManyChildren.forEach((t=>{const s=(0,Xc.e9)(e,t.name,this.suffix);t.attrName=s;const r=e.data[t.name];o[s]=[],o[t.name]=r,Array.isArray(r)&&(o[s]=r.map((e=>e.id||e.ID||e.Id||null)));const a=i.filter((e=>e.startsWith(t.name)));a.forEach((e=>{o[e]=n[e],delete n[e]}))}));const s={id:e.id,uid:e.uid,cardId:e.cardId,journalID:e.journalID,type:e.type,isVocabulary:!1,viewFlag:e.viewFlag,attr:n,files:null!==(t=e.files)&&void 0!==t?t:[],listAttr:o,title:null,readDateTime:e.readDateTime?e.readDateTime:new Date},r=this.$app.state===Oe.Z.CreatingDoc||this.$app.prevState===Oe.Z.CreatingDoc,a=this.card?this.card.isNew:!e.id;return Object.defineProperty(s,"isNew",{get:()=>a}),Object.defineProperty(s,"isCreate",{get:()=>r}),s}setAttrTypes(e){if(e){if(!this.metadata)throw new Error(`Отсутствуют метаданные для документа ${e.type}`);Object.keys(e.attributes).forEach((t=>{const n=this.metadata.attributes.find((e=>e.fieldName===t));if(n)switch(n.columnType){case Bn.cV.Date:case Bn.cV.DateTime:if(e.attributes[t]&&!(e.attributes[t]instanceof Date))try{e.attributes[t]=new Date(e.attributes[t])}catch(e){this.$log.error(e)}break;case Bn.cV.Number:e.attributes[t]&&"number"!==typeof e.attributes[t]&&(e.attributes[t]=Number(e.attributes[t]));break;default:break}}))}}documentFromCard(e){if(!e)return null;const t=e.attr;return{id:e.id,uid:e.uid,cardId:e.cardId,journalID:e.journalID,type:e.type,viewFlag:e.viewFlag,attributes:t,files:e.files,createDateTime:this.myDocument.createDateTime,data:this.myDocument.data,mainFile:this.myDocument.mainFile,manyToManyRelations:this.myDocument.manyToManyRelations,oneToManyChildren:this.myDocument.oneToManyChildren,parentDocumentNode:this.myDocument.parentDocumentNode}}storeOriginalCard(e){this.originalCard=JSON.parse(JSON.stringify(e))}setTimerReaded(e){this.setReadedTimer=setTimeout((()=>{this.setDocumentReadedCommand(new Dt.$6(this.myDocument.id,this.myDocument.journalID))}),1e3*e)}updateHeight(){}redefineInitForChilds(){if(this.templateType===et.$.Item)return;const e=o().prototype._init;this.initFunc||(this.initFunc=e);const t=this;o().prototype._init=function(n){if(this.$templateRenderer=t,e.call(this,n),t.checkParent(this,t)||(this.$templateRenderer=null),this._computedWatchers){const e=["__isMobileViewport","__isTabletViewport","isMobile","isTablet"];e.forEach((e=>{const t=this._computedWatchers[e];t&&(t.dirty=!0)}))}}}checkParent(e,t){if(!e||!e.$parent)return!1;let n=e.$parent;while(n){if(n===t||n.$externalComponentRenderer)return!0;n=n.$parent}return!1}startReadedTimer(){var e;const t=null===(e=this.userSettings)||void 0===e?void 0:e.markAsReadSecondsInterval;this.setTimerReaded(t||0)}get actionContext(){if(this.context)return Object.assign(Object.assign({},this.context),{document:[this.myDocument]})}get isTablet(){return!(this.isDestroyed||!this.forceIsTablet)||this.$root.isTablet}get isMobile(){return!(this.isDestroyed||!this.forceIsMobile)||this.$root.isMobile}};documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Boolean)],hd.prototype,"preview",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"document",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Number,default:et.$.Item}),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Number)],hd.prototype,"templateType",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Number)],hd.prototype,"saveCounter",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"context",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"newDocDefaultData",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Boolean)],hd.prototype,"forceIsMobile",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Boolean)],hd.prototype,"forceIsTablet",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"viewState",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Number)],hd.prototype,"lazyCardActionsCounter",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"queryBus",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"commandBus",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,ot.t)(Jc.h),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Jc.h)],hd.prototype,"pubSubService",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,fa.Hg)("fetchManifest"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"fetchManifest",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,fa.jI)("documentSave"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"documentSave",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,fa.jI)("fetchDocument"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"fetchDocument",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,fa.jI)("setDocumentReadedCommand"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"setDocumentReadedCommand",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,fa.jI)("fetchDocumentMetadata"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"fetchDocumentMetadata",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,fa.eI)("fetchVocabularyItem"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"fetchVocabularyItem",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,fa.p$)("attachFileTemplateToDoc"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"attachFileTemplateToDoc",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,at.aD)("userSettings",{namespace:"settings"}),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],hd.prototype,"userSettings",void 0),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Watch)("forceIsMobile",{immediate:!0}),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Function),documentTemplateRenderervue_type_script_lang_js_metadata("design:paramtypes",[]),documentTemplateRenderervue_type_script_lang_js_metadata("design:returntype",void 0)],hd.prototype,"onForceIsMobileChanged",null),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Watch)("viewState",{immediate:!0}),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Function),documentTemplateRenderervue_type_script_lang_js_metadata("design:paramtypes",[]),documentTemplateRenderervue_type_script_lang_js_metadata("design:returntype",void 0)],hd.prototype,"onViewStateChanged",null),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Watch)("document",{immediate:!0}),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Function),documentTemplateRenderervue_type_script_lang_js_metadata("design:paramtypes",[Object,Object]),documentTemplateRenderervue_type_script_lang_js_metadata("design:returntype",Promise)],hd.prototype,"onDocumentChanged",null),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Watch)("lazyCardActionsCounter"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Function),documentTemplateRenderervue_type_script_lang_js_metadata("design:paramtypes",[]),documentTemplateRenderervue_type_script_lang_js_metadata("design:returntype",Promise)],hd.prototype,"onLazyCardActionsCounterChanged",null),documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Watch)("saveCounter"),documentTemplateRenderervue_type_script_lang_js_metadata("design:type",Function),documentTemplateRenderervue_type_script_lang_js_metadata("design:paramtypes",[]),documentTemplateRenderervue_type_script_lang_js_metadata("design:returntype",Promise)],hd.prototype,"onSaveCounterChanged",null),hd=documentTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Component)({mixins:[kn.Z]})],hd);const md=hd,fd=md;var gd=(0,Ct.Z)(fd,documentTemplateRenderervue_type_template_id_04032222_render,Yc,!1,null,null,null);const yd=gd.exports;var messageTemplateRenderervue_type_template_id_44091854_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.myInstructionInfo||e.myMessage?n("external-component-renderer",{key:"ecr",staticClass:"external-component-renderer",attrs:{role:"form",path:e.templatePath,context:e.context,props:{message:e.myMessage,instructionInfo:e.myInstructionInfo,report:e.report,validators:e.validators,isValid:e.isValid},mixin:e.mixin},on:{"external-component-created":e.onCardInstanceCreated,"set-result":e.onSetResult,"external-component-loading":function(t){return e.$emit("external-component-loading",t)},"external-component-emit":function(t){return e.onExternalComponentEmit(t)}}}):e._e()},vd=[],messageTemplateRenderervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},messageTemplateRenderervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},messageTemplateRenderervue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let bd=class MessageTemplateRendererComponent extends kn.Z{constructor(){super(...arguments),this.myInstructionInfo=null,this.myMessage=null,this.myReport=null,this.oldTemplateType=-1,this.oldTemplatePath="",this.validators=ll.z2,this.templatePath=null,this.mixin={created(){this.$templateRenderer=this.$parent.$parent},updated(){this.$emit("external-component-emit",{name:"card-updated"})},data(){return{}},methods:{viewDoc(e){return e=e||this.card.id,this.$app.viewDoc(this.card.id,Object.assign(Object.assign({},this.context),{entityViewMode:Ue.dS.View}))},editDoc(e){return e=e||this.card.id,this.$app.editDoc(e,Object.assign(Object.assign({},this.context),{entityViewMode:Ue.dS.Edit}),!0)},redirectInstruction(e,t){return this.$app.redirectInstruction(e,this.context,t)},close(e){if(e)return this.$app.goto(Pe.k.ToMessages,this.context,{parentId:e.toString()});this.$app.goPrev(this.context)},createVocElem(e,t=this.$gettext("Создать")){return this.$app.createCatalogueItem({name:e,title:t,context:Object.assign(Object.assign({},this.context),{entityViewMode:Ue.dS.Create})})},editVocElem(e,t,n,i=this.$gettext("Изменить")){return messageTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let o=n;return n||(o=yield this.fetchVocabularyItem(new Pt.AG(e,t))),this.$app.editCatalogueItem({item:o,title:i,name:e,context:Object.assign(Object.assign({},this.context),{entityViewMode:Ue.dS.Edit})})}))},$updateFiles(e){if(!e)return;const t=[];this.card.files=t,this.document.files=t,e.forEach((e=>{this.card.files.push(e)})),this.$emit("external-component-emit",{name:"card-files-updated",data:this.card.files})},validate(){return this.$templateRenderer.validate()},validateSection(){return this.$templateRenderer.validateSection()},setLoadingStatus(e){this.$templateRenderer.setLoadingStatus(e)},debounce:Pl.Z},computed:{isPreview(){return this.context.entityViewMode===Ue.dS.Preview}}},this.queryIds=Ae.M,this.commandIds=Ve.O}onMessageChanged(e){var t,n;return messageTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e)return;const i=yield this.getTemplatePath(null===(n=null===(t=null===e||void 0===e?void 0:e.instructionTypeInfo)||void 0===t?void 0:t.instructionType)||void 0===n?void 0:n.id.toString());i&&(this.templatePath=i,this.myMessage=e)}))}onInstructionInfoChanged(e){return messageTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e)return;const t=this.report?132:null===e||void 0===e?void 0:e.instruction.instructionTypeID,n=yield this.getTemplatePath(t.toString());n&&(this.templatePath=n,this.myInstructionInfo=e)}))}getTemplatePath(e){return messageTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.templateType===this.oldTemplateType&&this.oldTemplatePath)return this.oldTemplatePath;const t=yield this.fetchTemplatePath(e);return this.oldTemplatePath=t,t?(this.oldTemplateType=this.templateType,t):null}))}fetchTemplatePath(e){var t,n;return messageTemplateRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let i,o=null;try{i=yield this.queryBus.exec(new tt.R0(String(e),"messages"))}catch(e){throw this.$log.error("Ошибка чтения манифеста",e),e}const s=(0,it.eV)(et.$[this.templateType]);return i&&(o=null===(t=i[s])||void 0===t?void 0:t.toLowerCase()),i&&o||(i=yield this.queryBus.exec(new tt.R0("default","messages")),i&&(o=null===(n=i[s])||void 0===n?void 0:n.toLowerCase(),e="default")),!o||o.includes("/")||o.includes("\\")||(o=`messages/${e}/${o}`),o}))}errorCaptured(e,t,n){this.$log.error("errorCaptured",e,t,n)}onCardInstanceCreated(e){this.componentInstance=e,this.$emit("external-component-created",e)}onSetResult(e){this.$emit("set-result",e)}onExternalComponentEmit(e){e&&("card-updated"===e.name||e.name&&this.$emit(e.name,e.data))}setLoadingStatus(e){this.$emit("external-component-loading",e)}};messageTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],bd.prototype,"instructionInfo",void 0),messageTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],bd.prototype,"message",void 0),messageTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],bd.prototype,"report",void 0),messageTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Number,default:et.$.Item}),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Number)],bd.prototype,"templateType",void 0),messageTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],bd.prototype,"context",void 0),messageTemplateRenderervue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],bd.prototype,"queryBus",void 0),messageTemplateRenderervue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],bd.prototype,"commandBus",void 0),messageTemplateRenderervue_type_script_lang_js_decorate([(0,at.aD)("userSettings",{namespace:"settings"}),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Object)],bd.prototype,"userSettings",void 0),messageTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Watch)("message",{immediate:!0}),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Function),messageTemplateRenderervue_type_script_lang_js_metadata("design:paramtypes",[Object]),messageTemplateRenderervue_type_script_lang_js_metadata("design:returntype",Promise)],bd.prototype,"onMessageChanged",null),messageTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Watch)("instructionInfo",{immediate:!0}),messageTemplateRenderervue_type_script_lang_js_metadata("design:type",Function),messageTemplateRenderervue_type_script_lang_js_metadata("design:paramtypes",[Object]),messageTemplateRenderervue_type_script_lang_js_metadata("design:returntype",Promise)],bd.prototype,"onInstructionInfoChanged",null),bd=messageTemplateRenderervue_type_script_lang_js_decorate([(0,rt.Component)({mixins:[kn.Z]})],bd);const Cd=bd,wd=Cd;var _d=(0,Ct.Z)(wd,messageTemplateRenderervue_type_template_id_44091854_render,vd,!1,null,null,null);const xd=_d.exports;var selectUservue_type_template_id_392acb06_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"select-user-wrapper",staticStyle:{width:"100%"}},[e.value[e.modelKey]&&e.value[e.modelKey].length?e._e():n("div",{staticClass:"d-flex align-center"},[n("vue-multiselect",e._b({staticStyle:{padding:"0"},attrs:{"show-no-options":!1,disabled:!e.messageTypeId},on:{"search-change":e.getUser},scopedSlots:e._u([{key:"tag",fn:function(t){return[n("v-chip",{staticClass:"chip--select-multi white--text caption",attrs:{color:"primary_light",close:"",small:""}},[n("v-icon",{staticClass:"mr-1 user-icon"},[e._v(e._s(e.tagIcon(t.option)))]),e._v(" "),n("span",[e._v(e._s(e.userNameShorting(t.option.name)))])],1)]}},{key:"option",fn:function(t){return[n("v-icon",[e._v(e._s(e.tagIcon(t.option)))]),e._v(" "+e._s(t.option.name)+"\n      ")]}}],null,!1,3552701299),model:{value:e.value[e.modelKey],callback:function(t){e.$set(e.value,e.modelKey,t)},expression:"value[modelKey]"}},"vue-multiselect",e.selectOptions,!1),[e._v(" "),e._v(" "),n("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v(e._s(e.notFoundMessage))])]),e._v(" "),n("v-btn",{staticClass:"square-sm-button rounded-button grey--border lighten-2 my-0 ml-2 elevation-0 bordered-button",attrs:{color:"white",disabled:!e.messageTypeId},on:{click:function(t){return e.onAddUser()}}},[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"primary--text open-voc-icon"},[e._v("account_circle")]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{size:20,color:"primary",indeterminate:""}})],1)],1),e._v(" "),e.value[e.modelKey]&&e.value[e.modelKey][0]?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-chip",e._g({staticClass:"chip--select-multi white--text caption",attrs:{color:"primary_light",close:"",small:""},on:{"click:close":function(t){return e.remove()}}},i),[n("v-icon",{staticClass:"mr-1 user-icon"},[e._v(e._s(e.tagIcon(e.value[e.modelKey][0])))]),e._v(e._s(e.userNameShorting(e.value[e.modelKey][0].name))+"\n      ")],1)]}}],null,!1,4164692906)},[e._v(" "),e._l(e.tooltipFields,(function(t,i){return n("div",{key:i+":"+e._uid,staticClass:"d-flex align-center"},[n("span",{staticClass:"font-weight-bold mr-2"},[e._v(e._s(t.label))]),e._v(" "),n("span",[e._v(e._s(e.value[e.modelKey][0][t.fieldName]))])])}))],2):e._e()],1)},Sd=[],Id=n(84337),selectUservue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectUservue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},selectUservue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Dd=class SelectUserComponent extends rt.Vue{constructor(){super(...arguments),this.loading=!1,this.users=[],this.notFoundMessage=this.searchingNowText,this.getUser=(0,Pl.Z)(this.fetchUser.bind(this),500),this.tooltipFields=[{fieldName:"departmentName",label:"Подразделение: "},{fieldName:"positionName",label:"Должность: "},{fieldName:"name",label:"ФИО: "}]}limitText(){return""}fetchUser(e=""){e&&(this.cancellationService.cancel(Ae.M.SearchUsersQuery),this.notFoundMessage=this.searchingNowText,this.$nextTick((()=>selectUservue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{this.loading=!0;const t=yield this.fetchSearchUsers(new vr.ty(e,!1,null,!0,this.currentEmployees));t&&t.length?this.notFoundMessage=this.searchingNowText:this.notFoundMessage=this.$gettext("Поиск не дал результатов."),this.users=t}catch(e){e instanceof Fn.Mk||(this.notFoundMessage=this.$gettext("Поиск не дал результатов (-:"))}finally{this.loading=!1}})))))}remove(){Array.isArray(this.value[this.modelKey])&&this.value[this.modelKey].splice(0,this.value[this.modelKey].length)}onAddUser(){return selectUservue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let e=null,t="";switch(this.modelKey){case"initiator":t=this.$gettext("Выберите инициатора сообщения");break;case"execAuditor":t=this.$gettext("Выберите контролёра сообщения");break;case"reportReceiver":t=this.$gettext("Выберите получателя отчёта")}e=new Nl.B(t,!1,[6],[],this.messageTypeId,!0,!1,this.currentEmployees);const n=yield this.queryBus.exec(e);n&&n.length&&(this.value[this.modelKey]=n,this.value[this.modelKey][0].name=this.userNameShorting(this.value[this.modelKey][0].name))}))}userNameShorting(e){return uc.X.userNameShorting(e)}tagIcon(e){switch(e.type){case Nn.OP.GroupUser:return"group";case Nn.OP.User:return"person";case Nn.OP.Department:return"group";case Nn.OP.Role:return"group";default:return"person"}}multiselectOptions(e){return{label:"name","track-by":"name",placeholder:e,"open-direction":"bottom","select-label":"",options:this.users,multiple:!0,limit:1,limitText:this.limitText.bind(this),searchable:!0,loading:this.loading,"internal-search":!1,"clear-on-select":!0,"close-on-select":!0,"options-limit":300,"max-height":600,"show-no-results":!0,"hide-selected":!1}}get searchingNowText(){return this.$gettext("Идёт поиск...")}get selectOptions(){switch(this.modelKey){case"initiator":return this.multiselectOptions(this.$gettext("Задание выдал..."));case"execAuditor":return this.multiselectOptions(this.$gettext("Контролёр..."));case"reportReceiver":return this.multiselectOptions(this.$gettext("Получатель отчета..."))}}get currentEmployees(){return[Id.H.Normal,Id.H.System,Id.H.Fixed,Id.H.ReadOnly]}};selectUservue_type_script_lang_js_decorate([(0,rt.Model)("input"),selectUservue_type_script_lang_js_metadata("design:type",Object)],Dd.prototype,"value",void 0),selectUservue_type_script_lang_js_decorate([(0,rt.Prop)({required:!0}),selectUservue_type_script_lang_js_metadata("design:type",Object)],Dd.prototype,"modelKey",void 0),selectUservue_type_script_lang_js_decorate([(0,rt.Prop)(),selectUservue_type_script_lang_js_metadata("design:type",Number)],Dd.prototype,"messageTypeId",void 0),selectUservue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),selectUservue_type_script_lang_js_metadata("design:type",Object)],Dd.prototype,"queryBus",void 0),selectUservue_type_script_lang_js_decorate([(0,ot.t)(Tl.h),selectUservue_type_script_lang_js_metadata("design:type",Tl.h)],Dd.prototype,"cancellationService",void 0),selectUservue_type_script_lang_js_decorate([(0,fa.Vw)("fetchSearchUsers"),selectUservue_type_script_lang_js_metadata("design:type",Object)],Dd.prototype,"fetchSearchUsers",void 0),Dd=selectUservue_type_script_lang_js_decorate([(0,rt.Component)({components:{"vue-multiselect":kl()}})],Dd);const Rd=Dd,Td=Rd;var Pd=(0,Ct.Z)(Td,selectUservue_type_template_id_392acb06_scoped_true_render,Sd,!1,null,"392acb06",null);const Od=Pd.exports;_t()(Pd,{VBtn:g.Z,VChip:P.Z,VIcon:y.Z,VProgressCircular:V.Z,VTooltip:_.Z});var kd=n(24377),Fd=n(38484),createEditRoutevue_type_template_id_16e11091_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"mt-2"},[e.loading?n("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center"}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{value:20,color:"primary",indeterminate:""}})],1):e._e(),e._v(" "),e.isVocabulary||e.loading?e._e():n("v-row",[n("v-col",[n("v-btn",{staticClass:"small-button rounded-button ml-0 my-0 elevation-0 font-weight-regular",attrs:{color:"primary",loading:e.stratingRoute},on:{click:e.startRoute}},[n("v-icon",{staticClass:"white--text"},[e._v(" play_arrow ")]),e._v(" "),n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"white--text"},[e._v("Отправить по маршруту")])],1),e._v(" "),n("span",{staticClass:"underlineText grey--text",on:{click:e.clearAllSettings}},[e._v("Сбросить настройки")])],1)],1),e._v(" "),e.loading?e._e():n("v-row",{staticClass:"mt-2"},[n("vue-draggable",{attrs:{"ghost-class":"ghost"},on:{change:e.onPositionChange},model:{value:e.approvingMailSteps,callback:function(t){e.approvingMailSteps=t},expression:"approvingMailSteps"}},e._l(e.groupedSteps,(function(t,i){return n("v-col",{key:i},[n("v-col",{staticClass:"routeBox"},[n("div",{class:{"elevation-0":e.isItemSelected(i)},on:{click:function(n){return e.itemClicked(t,i)}}},[n("v-row",{staticClass:"mx-3 mt-2 mb-2"},[t.step[0].StepCode?n("v-col",{attrs:{cols:"8"}},[n("span",{staticClass:"underlineText body-2 font-weight-bold"},[e._v(" "+e._s(e.setStepName(t))+" ")])]):n("v-col",{attrs:{cols:"8"}},[n("card-edit-text",{attrs:{placeholder:"Укажите название этапа"},model:{value:t.step[0].StepCode,callback:function(n){e.$set(t.step[0],"StepCode",n)},expression:"item.step[0].StepCode"}})],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[e.showSettings(t)?n("v-row",{attrs:{justify:"end"}},[n("v-tooltip",{attrs:{left:"",color:"black","max-width":"250px"},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("span",e._g({staticClass:"help"},o),[n("v-icon",{staticClass:"settingsIcon",on:{click:function(n){return e.openSettingsModal(t)}}},[e._v("settings")])],1)]}}],null,!0)},[e._v(" "),n("span",[e._v("Настройки этапа маршрута")])]),e._v(" "),n("v-tooltip",{attrs:{left:"",color:"black","max-width":"250px"},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("span",e._g({staticClass:"help"},o),[n("v-icon",{staticClass:"deleteIcon",on:{click:function(n){return e.deleteRoute(t.step[0])}}},[e._v("close")])],1)]}}],null,!0)},[e._v(" "),n("span",[e._v("Удалить этап маршрут")])])],1):e._e()],1)],1),e._v(" "),n("transition",{attrs:{name:"expand"}},[e.isItemSelected(i)?n("v-row",[n("v-row",{staticClass:"mx-3 mt-1",attrs:{justify:"space-between"}},[n("v-col",{attrs:{cols:"8",sm:"8",md:"8",xl:"8",lg:"8"}},[n("card-combobox",{attrs:{mobile:e.isMobile,items:e.instructionTypes},model:{value:t.mailTypeID,callback:function(n){e.$set(t,"mailTypeID",n)},expression:"item.mailTypeID"}})],1),e._v(" "),e.disabledFileds(t)?e._e():n("v-col",{staticClass:"pl-2",attrs:{cols:"4",md:"4",sm:"4",lg:"4",xl:"4"}},[n("card-datepicker",{attrs:{mobile:e.isMobile,"can-clear":!1},model:{value:t.step[0].ExecDateTime,callback:function(n){e.$set(t.step[0],"ExecDateTime",n)},expression:"item.step[0].ExecDateTime"}})],1)],1),e._v(" "),n("v-row",{staticClass:"mx-3 mt-2"},[n("card-select-users",{attrs:{placeholder:"Укажите получателей",multiselect:"","voc-names":["USER","GROUPUSER"],"input-size":12},on:{"update-receivers":e.updateReceivers},model:{value:t.receivers,callback:function(n){e.$set(t,"receivers",n)},expression:"item.receivers"}})],1)],1):e._e()],1)],1)]),e._v(" "),e.showVerticalLine(i)?n("v-row",{attrs:{justify:"center"}},[n("div",{staticClass:"separate-vertical-line"})]):e._e()],1)})),1)],1),e._v(" "),e.isVocabulary?e._e():n("v-row",{attrs:{justify:"center"}},[n("v-btn",{staticClass:"small-button rounded-button ml-0 my-0 elevation-0 font-weight-regular",attrs:{outline:"",color:"primary"},on:{click:e.createNewStep}},[n("v-icon",{staticClass:"primary--text"},[e._v(" add ")]),e._v(" "),n("span",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Добавить этап")])],1)],1)],1)},Ad=[],$d=n(9980),jd=n.n($d),createEditRoutevue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},createEditRoutevue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},createEditRoutevue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Ed="update-template";let Md=class CreateEditRouteComponent extends(o()){constructor(){super(...arguments),this.instructionTypes=[],this.approvingMailSteps=[],this.selectedIndex=null,this.selected=null,this.taskID=null,this.taskUID=null,this.loading=!1,this.stratingRoute=!1}createNewTemplateStep(){this.canCreateNewRoute?this.createNewStep():this.displaySelectedRouteTemplate()}onSelectedChanged(e,t){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){e!==t&&(this.loading=!0,yield this.changeRouteTemplate(e),this.loading=!1)}))}created(){this.fetchInstructionTypes()}createNewStep(){const e={StepCode:null,MailTypeID:null,ExecDateTime:null,ExecTerm:null,ReceiverID:null,Step:this.routeTemplateData.length?this.routeTemplateData[this.routeTemplateData.length-1].Step+1:1};this.document.listAttr.GRK_APPROVINGMAIl.push(e)}changeRouteTemplate(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=[],n={RouteTemplateID:0===e?null:e};this.saveDoc(n),this.approvingMailSteps.length&&(this.approvingMailSteps.forEach((e=>{t.push(this.deleteStep(this.document.id,e.step[0].Step,"DOCUMENT","GRK_SP_APPROVINGMAIL_DEL","pBaseERCID"))})),yield Promise.all(t)),0!==e&&(yield this.fetchApprovingMailTemplate()),yield this.refreshRouteTemplate()}))}displaySelectedRouteTemplate(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.routeTemplateData.length&&this.document.attr.RouteTemplateID){if(!this.document.attr.RouteTemplateID){const e={RouteTemplateID:this.document.attr.RouteTemplateID};this.saveDoc(e)}yield this.fetchApprovingMailTemplate()}}))}fetchInstructionTypes(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchTypes(new Fe.jl(!1));this.instructionTypes=e.map((e=>({id:e.id,value:e.name})))}))}fetchApprovingMailTemplate(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.document.attr.RouteTemplateID)try{yield this.commandBus.exec(new Ne.lF("Document","GRK_SP_APPROVING_FILL_TEMPLATE",[{type:"Long",name:"pBaseERCID",value:`${this.document.id}`},{type:"Long",name:"pTemplateID",value:`${this.document.attr.RouteTemplateID}`},{type:"Long",name:"pCurrentUserID",value:`${this.currentUser.id}`}]))}catch(e){this.$log.debug(e)}finally{yield this.refreshRouteTemplate()}}))}onPositionChange(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading=!0;const t=e.moved.newIndex,n=e.moved.oldIndex,i=e.moved.element.step[0].Step,o=t<n?"+":"-",s=this.isVocabulary?"VOCABULARY":"DOCUMENT",r=this.isVocabulary?"GRK_APPROVINGMAIL_TEMPLATE_CHANGEPOSITION":"GRK_SP_APPROVINGMAIL_CHANGEPOSITION";if(yield this.changePosition(s,r,i,o),!this.isVocabulary)return yield this.refreshRouteTemplate(),void(this.loading=!1);this.$emit(Ed),this.loading=!1}))}changePosition(e,t,n,i){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.commandBus.exec(new Ne.lF(e,t,[{type:"Long",name:this.isVocabulary?"pTypicalApprWFID":"pBaseERCID",value:this.isVocabulary?`${this.vocTemplateData[0].TypicalApprWFID}`:`${this.document.id}`},{type:"Long",name:"pStep",value:`${n}`},{type:"String",name:"pGoUp",value:`${i}`}]))}))}checkDocTasks(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const{TASK:e}=yield this.queryBus.exec(new He.Ip("TASK",Ec.b.ListItem,null,`<CONSTRAINTS><EQUAL field="ERCID" value="${this.document.id}" /></CONSTRAINTS>`));e.forEach((e=>this.document.listAttr.DOCTASKS.push(e)))}))}refreshRouteTemplate(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.document.listAttr.GRK_APPROVINGMAIl.length=0,this.approvingMailSteps.length=0;const{GRK_APPROVINGMAIL:e}=yield this.queryBus.exec(new He.Ip("GRK_APPROVINGMAIl",Ec.b.ListItem,null,`<CONSTRAINTS><EQUAL field="BaseERCID" value="${this.document.id}" /></CONSTRAINTS>`));if(!e.length){const e={RouteTemplateID:null};return yield this.saveDoc(e),this.routeTemplateData}return e.forEach((e=>this.document.listAttr.GRK_APPROVINGMAIl.push(e))),this.routeTemplateData}))}startRoute(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.confirmFunction("Запустить?");if(!e)return;this.stratingRoute=!0;const t=this.checkReceivers();if(t.length){if(t.length>1){const e=t.join(", ");return this.$toasted.error(`Для этапов ${e} не заданы получатели.`)}return this.$toasted.error(`Для этапа ${t[0]} не заданы получатели.`)}yield this.taskCreation(),yield this.runJob(),yield this.checkDocTasks(),this.stratingRoute=!1}))}sendMessages(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=this.approvingMailSteps[0],t=10===e.step[0].SendTypeID?ea.a.Fan:ea.a.Chain,n=e.receivers;for(const i of n)yield this.commandBus.exec(new un.ud({instructionTypeId:e.step[0].MailTypeID,documentId:this.document.id,control:!1,mainInstruction:{receiverID:i,text:e.step[0].Text,subject:e.step[0].Subject,comment:null,execAuditorID:e.step[0].AuditorID,initiatorID:null,reportReceiverID:null,startDate:new Date,execInterval:e.step[0].ExecTerm,execIntervalType:Nn.NH.Working,control:!1,instructionTypeInfo:null},reportToExecutive:!1,sendType:t,withExecutive:!1}));yield this.checkDocInstruction()}))}checkDocInstruction(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.queryBus.exec(new He.kb(`${this.document.id}`,!1)),t=this.approvingMailSteps[0].step[0],n=this.approvingMailSteps[0].receivers,i=[];for(const o of n)e.forEach((e=>{e.children[0].instruction.instructionTypeID===t.MailTypeID&&e.children[0].instruction.receiverID===o&&i.push(e)}));if(i.length){const e=[];i.forEach((t=>{const n=t.children[0].instruction.id;e.push(this.setMailsWF(n))})),yield Promise.all(e)}}))}setMailsWF(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_WF_SetMailID",[{type:"Long",name:"pDocID",value:`${this.document.id}`},{type:"Long",name:"pTaskID",value:`${this.taskID}`},{type:"Long",name:"pStageNum",value:"1"},{type:"String",name:"pMails",value:`${e}`},{type:"Long",name:"pRes",value:null}]))}))}checkReceivers(){const e=[];return this.approvingMailSteps.forEach((t=>{t.receivers.length||e.push(String(t.step[0].Step))})),e}taskCreation(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.commandBus.exec(new Dt.j2("TASK",["Name","TASKTYPE","TASKSTATE","ERCID"],["Маршрут","340254","2",`${this.document.id}`]));e&&(this.taskID=yield this.findTaskID(),yield this.setTaskToDocument())}))}findTaskID(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let{TASK:e}=yield this.queryBus.exec(new He.Ip("TASK",Ec.b.ListItem,null,`<CONSTRAINTS><EQUAL field="ERCID" value="${this.document.id}" /></CONSTRAINTS>`));e=e.filter((e=>"MS_ACTIVE"===e.TaskStateNameResName||"Активна"===e.TaskStateName));const t=e[0].ID;return this.taskUID=e[0].UID,t}))}setTaskToDocument(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.commandBus.exec(new Dt.WX(this.document.id,{TaskID:this.taskID},Ue.dS.View))}))}runJob(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.workflowCategoryObject();if(e){const t=yield this.findWorkflowCode(e),n=new RunJob(t,this.taskUID,this.taskID),i=yield this.commandBus.exec(n);i.value||this.$toasted.error("Ошибка запуска маршрута!"),this.$toasted.success("Маршрут успешно запущен.")}e||(yield this.sendMessages(),this.$toasted.success("Маршрут успешно запущен."))}))}workflowCategoryObject(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e="70500",t=yield this.queryBus.exec(new He.pV(e));if(t.ids)return t.ids[0]}))}findWorkflowCode(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const{WORKFLOW:t}=yield this.queryBus.exec(new He.Ip("Workflow",Ec.b.ListItem,null,`<CONSTRAINTS><EQUAL field="ID" value="${e}" /></CONSTRAINTS>`));return Array.isArray(t)&&t.length?t[0].GlobalID:0}))}clearAllSettings(){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_APPROVINGMAIL_CLEAR_HISTORY",[{type:"Long",name:"pBaseERCID",value:`${this.document.id}`}]))}catch(e){this.$log.debug(e),this.loading=!1}finally{yield this.refreshRouteTemplate(),this.loading=!1}}))}confirmFunction(e){return this.queryBus.exec(new Zt.l("",e))}openSettingsModal(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t="Редактирование параметров этапа",n={model:null,data:e.step[0],receivers:e.receivers,stepStarted:!1,isVocabulary:this.isVocabulary},i=new Mc.c({title:t,componentName:"routing-settings",componentProps:n,fullHeight:!1,width:"60%"}),o=yield this.queryBus.exec(i);if(o){if(this.loading=!0,!this.isVocabulary)return yield this.deleteStep(this.document.id,o.Step,"DOCUMENT","GRK_SP_APPROVINGMAIL_DEL","pBaseERCID"),yield this.editNewStep(o),yield this.refreshRouteTemplate(),void(this.loading=!1);yield this.deleteStep(o.TypicalApprWFID,o.Step,"VOCABULARY","GRK_APPROVINGMAIL_TEMPLATE_DEL","pTypicalApprWFID"),yield this.createEditTemplateStep(o),this.loading=!1}}))}createEditTemplateStep(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(e.SendTypeID=12===e.SendTypeID?1:0,e.ReceiverID&&Array.isArray(e.ReceiverID)){e.RespExists&&1===e.SendTypeID&&(e.RespReceiverID=e.ReceiverID[0]);for(const t of e.ReceiverID)yield this.saveNewTemplateStep(e,t)}else yield this.saveNewTemplateStep(e,null);this.$emit(Ed)}))}saveNewTemplateStep(e,t){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const n=12===e.SendTypeID?1:0;yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_APPROVINGMAIL_TEMPLATE_ADD",[{type:"Long",name:"pTypicalApprWFID",value:`${e.TypicalApprWFID}`},{type:"Long",name:"pStep",value:`${e.Step}`},{type:"String",name:"pStepCode",value:`${e.StepCode}`},{type:"String",name:"pIsCycledStep",value:"-"},{type:"String",name:"pIsNessesary",value:e.IsNessesary?`${e.IsNessesary}`:"-"},{type:"String",name:"pAutoApproving",value:e.IsAutoApproving?`${e.IsAutoApproving}`:"-"},{type:"Long",name:"pExecTerm",value:e.ExecTerm?`${e.ExecTerm}`:null},{type:"Long",name:"pMailTypeID",value:e.MailTypeID?`${e.MailTypeID}`:null},{type:"Long",name:"pSendType",value:e.SendTypeID?`${n}`:null},{type:"String",name:"pRespExists",value:e.RespExists?`${e.RespExists}`:"-"},{type:"Long",name:"pCreatorID",value:`${this.currentUser.effectiveId}`},{type:"Long",name:"pAuditorID",value:e.AuditorID?`${e.AuditorID}`:null},{type:"Long",name:"pInitiatorID",value:null},{type:"Long",name:"pExecAuditorID",value:null},{type:"String",name:"pSubject",value:e.Subject?`${e.Subject}`:null},{type:"String",name:"pText",value:e.Text?`${e.Text}`:null},{type:"Long",name:"pReceiverID",value:`${t}`},{type:"Long",name:"pSortOrder",value:"0"},{type:"Long",name:"pStateDocumentID",value:e.StepStateDocumentID?`${e.StepStateDocumentID}`:null},{type:"String",name:"pChangeVerFlag",value:e.IsChangeVer?`${e.IsChangeVer}`:"-"},{type:"String",name:"pFlgApprovingPositiveReport",value:e.IsApprovingPositiveReport?`${e.IsApprovingPositiveReport}`:"-"},{type:"String",name:"pFlgAutoRemove",value:e.IsAutoRemove?`${e.IsAutoRemove}`:"-"},{type:"Long",name:"pAutoRemoveJournalID",value:e.AutoRemoveJournalID?`${e.AutoRemoveJournalID}`:null},{type:"String",name:"pFlgContinuity",value:e.IsContinuity?`${e.IsContinuity}`:"-"},{type:"String",name:"pCheckCondition",value:e.IsCheckCondition?`${e.IsCheckCondition}`:"-"},{type:"Long",name:"CheckConditionTemplateID",value:e.CheckConditionTemplateID?`${e.CheckConditionTemplateID}`:null},{type:"Long",name:"pAutoRemoveTemplateID",value:e.AutoRemoveJournalID?`${e.AutoRemoveJournalID}`:null},{type:"String",name:"pFlgBarcode",value:"-"}]))}))}editNewStep(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(e.ReceiverID&&Array.isArray(e.ReceiverID))for(const t of e.ReceiverID)yield this.saveApprovingMailStep(e,t);else yield this.saveApprovingMailStep(e,null)}))}saveApprovingMailStep(e,t){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const n=12===e.SendTypeID?1:0;yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_APPROVINGMAIL_ADD",[{type:"Long",name:"pBaseERCID",value:`${this.document.id}`},{type:"Long",name:"pStep",value:`${e.Step}`},{type:"String",name:"pStepCode",value:e.StepCode?`${e.StepCode}`:null},{type:"Long",name:"pMailTypeID",value:e.MailTypeID?`${e.MailTypeID}`:null},{type:"String",name:"pSendType",value:`${n}`},{type:"String",name:"pRespExists",value:e.RespExists?`${e.RespExists}`:"-"},{type:"Long",name:"pCreatorID",value:`${this.currentUser.effectiveId}`},{type:"Long",name:"pAuditorID",value:e.AuditorID?`${e.AuditorID}`:null},{type:"String",name:"pCreateDateTime",value:`${(new Date).toLocaleDateString()}`},{type:"Long",name:"pExecTerm",value:e.ExecTerm?`${e.ExecTerm}`:null},{type:"String",name:"pSubject",value:e.Subject?`${e.Subject}`:null},{type:"String",name:"pText",value:e.Text?`${e.Text}`:null},{type:"Long",name:"pReceiverID",value:t?`${t}`:null},{type:"Long",name:"pCurrentUserID",value:`${this.currentUser.effectiveId}`},{type:"String",name:"pIsNessesary",value:e.IsNessesary?`${e.IsNessesary}`:"-"},{type:"String",name:"pAutoApproving",value:e.IsAutoApproving?`${e.IsAutoApproving}`:"-"},{type:"Long",name:"pSortOrder",value:"0"},{type:"Long",name:"pTemplateStepID",value:e.TemplateStepID?`${e.TemplateStepID}`:null},{type:"Long",name:"pStateDocumentID",value:e.StepStateDocumentID?`${e.StepStateDocumentID}`:null},{type:"String",name:"pChangeVerFlag",value:e.IsChangeVer?`${e.IsChangeVer}`:"-"},{type:"String",name:"pFlgApprovingPositiveReport",value:e.IsApprovingPositiveReport?`${e.IsApprovingPositiveReport}`:"-"},{type:"String",name:"pFlgAutoRemove",value:e.IsAutoRemove?`${e.IsAutoRemove}`:"-"},{type:"Long",name:"pAutoRemoveJournalID",value:e.AutoRemoveJournalID?`${e.AutoRemoveJournalID}`:null},{type:"String",name:"pFlgContinuity",value:e.IsContinuity?`${e.IsContinuity}`:"-"},{type:"String",name:"pCheckCondition",value:e.IsCheckCondition?`${e.IsCheckCondition}`:"-"},{type:"Long",name:"CheckConditionTemplateID",value:e.CheckConditionTemplateID?`${e.CheckConditionTemplateID}`:null},{type:"String",name:"pFlgBarcode",value:e.IsBarcode?`${e.IsBarcode}`:"-"},{type:"String",name:"pRequiredApprover",value:e.IsRequiredApprover?`${e.IsRequiredApprover}`:"-"}]))}))}deleteRoute(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=yield this.confirmFunction("Вы действительно хотите удалить выбранный этап маршрута?");if(t){if(this.loading=!0,!this.isVocabulary)return yield this.deleteStep(this.document.id,e.Step,"DOCUMENT","GRK_SP_APPROVINGMAIL_DEL","pBaseERCID"),this.refreshRouteTemplate(),void(this.loading=!1);yield this.deleteStep(e.TypicalApprWFID,e.Step,"VOCABULARY","GRK_APPROVINGMAIL_TEMPLATE_DEL","pTypicalApprWFID"),this.loading=!1,this.$emit(Ed)}}))}deleteStep(e,t,n,i,o){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.commandBus.exec(new Ne.lF(n,i,[{type:"Long",name:`${o}`,value:`${e}`},{type:"Long",name:"pStep",value:`${t}`},{type:"Long",name:"pReceiverID",value:null}]))}catch(e){this.$log.debug(e)}}))}saveDoc(e){return createEditRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.commandBus.exec(new Dt.WX(this.document.id,e,Ue.dS.View))}))}setStepName(e){return`Этап ${e.step[0].Step}: ${e.step[0].StepCode}`}updateReceivers(e){this.$emit("update-receivers",e)}isItemSelected(e){return!this.isVocabulary||(!(!this.isVocabulary||this.approvingMailSteps[e].mailTypeID)||e===this.selectedIndex)}itemClicked(e,t){if(e===this.selected)return this.selected=null,this.selectedIndex=null,!1;this.selected=e,this.selectedIndex=t}disabledFileds(e){return 340386===e.mailTypeID||340388===e.mailTypeID}showSettings(e){return!e.step[0].IsNessesary||"-"===e.step[0].IsNessesary}showVerticalLine(e){return!this.isVocabulary||e!==this.approvingMailSteps.length-1}get routeTemplateData(){return this.isVocabulary?this.vocTemplateData.length?this.vocTemplateData:[]:this.document.listAttr.GRK_APPROVINGMAIl.length?this.document.listAttr.GRK_APPROVINGMAIl:[]}get groupedSteps(){const e=this.stepGroupedTemplate;return this.approvingMailSteps=e.map((e=>({step:e,mailTypeID:e[0].MailTypeID,receivers:[]}))),this.approvingMailSteps.forEach((e=>{e.step.forEach((t=>{if(t.ReceiverID)return Array.isArray(t.ReceiverID)?e.receivers=t.ReceiverID:void e.receivers.push(t.ReceiverID)}))})),this.approvingMailSteps}get stepGroupedTemplate(){var e;const t={};let n=[];return(null===(e=this.routeTemplateData)||void 0===e?void 0:e.length)?(this.routeTemplateData.forEach((e=>{t[e.Step]||(t[e.Step]=[]),t[e.Step].push(e)})),n=Object.values(t).map((e=>Object.values(e))),n):n}};createEditRoutevue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),createEditRoutevue_type_script_lang_js_metadata("design:type",Boolean)],Md.prototype,"canCreateNewRoute",void 0),createEditRoutevue_type_script_lang_js_decorate([(0,rt.Prop)(),createEditRoutevue_type_script_lang_js_metadata("design:type",Object)],Md.prototype,"document",void 0),createEditRoutevue_type_script_lang_js_decorate([(0,rt.Prop)(),createEditRoutevue_type_script_lang_js_metadata("design:type",Array)],Md.prototype,"vocTemplateData",void 0),createEditRoutevue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),createEditRoutevue_type_script_lang_js_metadata("design:type",Boolean)],Md.prototype,"isVocabulary",void 0),createEditRoutevue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),createEditRoutevue_type_script_lang_js_metadata("design:type",Object)],Md.prototype,"commandBus",void 0),createEditRoutevue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),createEditRoutevue_type_script_lang_js_metadata("design:type",Object)],Md.prototype,"queryBus",void 0),createEditRoutevue_type_script_lang_js_decorate([(0,fa.Rm)("fetchTypes"),createEditRoutevue_type_script_lang_js_metadata("design:type",Object)],Md.prototype,"fetchTypes",void 0),createEditRoutevue_type_script_lang_js_decorate([(0,Ge.O)("currentUser"),createEditRoutevue_type_script_lang_js_metadata("design:type",Object)],Md.prototype,"currentUser",void 0),createEditRoutevue_type_script_lang_js_decorate([(0,rt.Watch)("canCreateNewRoute",{immediate:!0}),createEditRoutevue_type_script_lang_js_metadata("design:type",Function),createEditRoutevue_type_script_lang_js_metadata("design:paramtypes",[]),createEditRoutevue_type_script_lang_js_metadata("design:returntype",void 0)],Md.prototype,"createNewTemplateStep",null),createEditRoutevue_type_script_lang_js_decorate([(0,rt.Watch)("document.attr.RouteTemplateID"),createEditRoutevue_type_script_lang_js_metadata("design:type",Function),createEditRoutevue_type_script_lang_js_metadata("design:paramtypes",[Number,Number]),createEditRoutevue_type_script_lang_js_metadata("design:returntype",Promise)],Md.prototype,"onSelectedChanged",null),Md=createEditRoutevue_type_script_lang_js_decorate([(0,gt.default)({components:{"vue-draggable":jd()}})],Md);const Nd=Md,Vd=Nd;var Bd=(0,Ct.Z)(Vd,createEditRoutevue_type_template_id_16e11091_scoped_true_render,Ad,!1,null,"16e11091",null);const Ld=Bd.exports;_t()(Bd,{VBtn:g.Z,VCol:r.Z,VIcon:y.Z,VProgressCircular:V.Z,VRow:a.Z,VTooltip:_.Z});var displayRunningRoutevue_type_template_id_bad409c2_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"mt-2"},[e.loading?n("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center"}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{value:20,color:"primary",indeterminate:""}})],1):e._e(),e._v(" "),e.loading?e._e():n("v-row",{attrs:{justify:"start",align:"center"}},[n("v-btn",{staticClass:"rounded-button ml-0 my- elevation-0 font-weight-regular",attrs:{outline:"",color:"warning",loading:e.stopingRoute},on:{click:e.stopClearBtn}},[n("v-icon",{staticClass:"warning--text"},[e._v(" "+e._s(e.setBtnIcon)+" ")]),e._v(" "),n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"warning--text"},[e._v(e._s(e.btnText))])],1),e._v(" "),e.canDeleteDismissed&&e.isActiveJob?n("v-btn",{staticClass:"rounded-button ml-0 my- elevation-0 font-weight-regular",attrs:{outline:"",color:"primary"},on:{click:e.changeDismissedReceiver}},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"primary--text"},[e._v("Найти уволенных сотрудников")])]):e._e(),e._v(" "),n("v-icon",{staticClass:"primary--text",on:{click:e.refreshApprovingMail}},[e._v(" refresh ")]),e._v(" "),e.isActiveJob?n("v-col",{staticClass:"ml-2"},[n("v-row",[n("span",[e._v("Количество запусков: "+e._s(e.taskCount))]),e._v(" "),n("span",[e._v("Маршрут запущен: "+e._s(e.approvingMailCreator))])])],1):e._e()],1),e._v(" "),e.loading?e._e():n("v-row",[n("v-col",{attrs:{cols:"10",sm:"10",md:"7",lg:"6",xl:"6"}},[n("v-row",e._l(e.groupedApprovingMailSteps,(function(t,i){return n("v-col",{key:i},[n("v-col",{class:{routeBox:e.isActiveJob,canceledRouteBox:!e.isActiveJob}},[n("div",{class:{"elevation-0":e.isItemSelected(i)},on:{click:function(n){return e.itemClicked(t,i)}}},[n("v-row",{staticClass:"mx-3 mt-2"},[n("v-col",{attrs:{cols:"8"}},[n("v-row",{attrs:{align:"center"}},[n("v-icon",{staticClass:"mr-1",attrs:{color:e.messageStatus(t.mailInfo)}},[e._v(e._s(e.messageStateIcon(t.mailInfo)))]),e._v(" "),n("span",{staticClass:"underlineText body-2 font-weight-bold"},[e._v("\n                      "+e._s(e.setStepName(t))+"("+e._s(e.countReceivers(t.step))+")\n                    ")])],1)],1),e._v(" "),n("v-col",{attrs:{cols:"4"}},[n("v-row",{attrs:{justify:"end"}},[n("v-tooltip",{attrs:{left:"",color:"black","max-width":"250px"},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("span",e._g({staticClass:"help"},o),[n("v-icon",{staticClass:"icon",on:{click:function(n){return e.openSettingsModal(t)}}},[e._v("settings")])],1)]}}],null,!0)},[e._v(" "),n("span",[e._v("Настройки маршрута")])]),e._v(" "),e.isActiveJob&&e.isStepStarted(t.step)?n("v-menu",{staticClass:"menu-vert",attrs:{"open-on-click":"",buttom:"","offset-y":""}},[n("v-btn",{staticClass:"square-sm-button vert_button",attrs:{slot:"activator",small:"",icon:""},slot:"activator"},[n("v-icon",[e._v(" more_vert ")])],1),e._v(" "),n("v-list",[n("v-list-tile",{on:{click:function(n){return e.addReceiver(t)}}},[n("v-list-tile-title",[n("v-icon",[e._v("person_add")]),e._v("\n                            Добавить согласующего\n                          ")],1)],1),e._v(" "),e.negativeReport(t.mailInfo)?n("v-list-tile",{on:{click:function(n){return e.deleteReceiver(t)}}},[n("v-list-tile-title",[n("v-icon",[e._v("delete")]),e._v("\n                            Удалить согласующего\n                          ")],1)],1):e._e()],1)],1):e._e()],1)],1)],1),e._v(" "),n("v-row",{staticClass:"mx-3 mb-2"},[n("v-col",[n("v-row",{attrs:{align:"center"}},[n("span",{staticClass:"instructionType"},[e._v(e._s(t.step[0].Subject))]),e._v(" "),t.mailInfo.length?n("v-icon",{staticClass:"ml-2 mr-1",attrs:{color:"primary"}},[e._v("date_range")]):e._e(),e._v(" "),t.mailInfo.length?n("span",[e._v(e._s(e._f("date")(t.step[0].CreateDateTime,"DD.MM.YYYY")))]):e._e()],1)],1)],1),e._v(" "),e._l(t.mailInfo,(function(o,s){return t.mailInfo.length?n("div",{key:s},[n("transition",{attrs:{name:"expand"}},[e.isItemSelected(i)?n("v-row",{staticClass:"ml-3"},[e.showLine(t,s)?n("div",{staticClass:"tree-line"}):e._e(),e._v(" "),n("v-row",[n("v-col",[n("ul",[n("li",[n("v-tooltip",{attrs:{left:"",color:"white"}},[n("span",{attrs:{slot:"activator"},slot:"activator"},[n("v-avatar",{staticClass:"report-circle",attrs:{color:e.changeCircleColor(o),size:"15"}},[e.innerAvatarColor(o)?n("v-avatar",{attrs:{size:"13",color:"white"}}):e._e()],1)],1),n("span",{staticClass:"grey--text darken-4"},[e._v(e._s(o.stateName))])])],1),e._v(" "),n("v-row",{staticClass:"grey lighten-5 py-1 mb-2 mr-4",attrs:{align:"center"}},[n("v-row",{attrs:{align:"start"}},[n("v-icon",{staticClass:"pr-1 pl-2",class:{"primary--text":!e.isProjectMessage(o),"grey--text":e.isProjectMessage(o)},attrs:{size:"22"}},[e._v("\n                                email\n                              ")]),e._v(" "),n("v-row",[n("div",{staticClass:"flex",attrs:{row:""}},[n("span",{staticClass:"receiver",class:{"primary--text":!e.isProjectMessage(o),"grey--text":e.isProjectMessage(o)}},[e._v(e._s(o.receiverName))])]),e._v(" "),n("div",[n("span",[e._v(e._s(e._f("date")(o.sendDate,"DD.MM.YYYY")))])])])],1),e._v(" "),!e.isMobile&&o.mailID?n("v-row",{staticClass:"pr-2",attrs:{justify:"end"}},[n("v-btn",{staticClass:"square-sm-button elevation-0 rounded-button mx-0",attrs:{color:"grey lighten-3"},on:{click:function(t){return e.openMessage(o.mailID)}}},[n("v-icon",{staticStyle:{transform:"scaleX(0.78)"}},[e._v(" chrome_reader_mode ")])],1),e._v(" "),o.result?n("v-btn",{staticClass:"square-sm-button elevation-0 rounded-button mr-0 ml-2",attrs:{color:"grey lighten-3"},on:{click:function(t){return e.openReport(o.reportID,s)}}},[n("v-icon",[e._v("assignment")])],1):e._e()],1):e._e()],1)],1)])],1)],1):e._e()],1)],1):e._e()})),e._v(" "),e._l(t.step,(function(i,o){return t.mailInfo.length?e._e():n("div",{key:o},[n("v-col",{staticClass:"grey lighten-5 ml-3 mb-2",attrs:{cols:"11"}},[n("v-row",{staticClass:"py-1",attrs:{align:"center"}},[n("v-row",{attrs:{align:"start"}},[n("v-icon",{staticClass:"grey--text pr-1 pl-2",attrs:{size:"22"}},[e._v(" email ")]),e._v(" "),n("v-row",[n("div",{staticClass:"flex",attrs:{row:""}},[n("span",{staticClass:"grey--text receiver"},[e._v(e._s(e.receiverName(i.ReceiverID)))])]),e._v(" "),n("div",[n("span",[e._v("Еще не отправлено")])])])],1)],1)],1)],1)}))],2)]),e._v(" "),e.showVerticalLine(i)?n("v-row",{attrs:{justify:"center"}},[n("div",{staticClass:"seperate-vertical-line"})]):e._e()],1)})),1)],1)],1)],1)},Ud=[],displayRunningRoutevue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},displayRunningRoutevue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},displayRunningRoutevue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Hd=class DisplayRunningRouteComponent extends(o()){constructor(){super(...arguments),this.approvingMailSteps=[],this.mailedReceivers=[],this.notMailedReceivers=[],this.selectedIndex=null,this.selected=null,this.canDeleteDismissed=!0,this.loading=!1,this.stopingRoute=!1}created(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.canDeleteDismissed=yield this.checkUserRights(),yield this.fullRouteInfo()}))}checkUserRights(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchCurrentUserRights(),t=340616;return Object.keys(e).some((n=>e[Number(n)].includes(t)))}))}fullRouteInfo(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.mailedReceivers=yield this.fetchReceiversNames(this.mailedReceiverList),this.notMailedReceivers=yield this.fetchReceiversNames(this.notMailedReceiverList),this.stepMailInfo()}))}refreshApprovingMail(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading=!0,this.document.listAttr.GRK_APPROVINGMAIl.length=0;const{GRK_APPROVINGMAIL:e}=yield this.queryBus.exec(new He.Ip("GRK_APPROVINGMAIl",Ec.b.ListItem,null,`<CONSTRAINTS><EQUAL field="BaseERCID" value="${this.document.id}" /></CONSTRAINTS>`));e.length?(e.forEach((e=>this.document.listAttr.GRK_APPROVINGMAIl.push(e))),yield this.fullRouteInfo(),this.loading=!1):this.loading=!1}))}clear(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_APPROVINGMAIL_CLEAR_HISTORY",[{type:"Long",name:"pBaseERCID",value:`${this.document.id}`}]))}catch(e){this.$log.debug(e)}finally{yield this.checkDocTasks(),yield this.refreshApprovingMail()}}))}stop(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.confirmFunction("","Вы действительно хотите остановить маршрут?");if(e){this.stopingRoute=!0,this.mailedReceiverList.length&&(yield this.sendNotifications());try{yield this.refreshApprovingMail(),yield this.fullRouteInfo()}catch(e){this.$log.debug(e),this.stopingRoute=!1}finally{this.stopingRoute=!1}}}))}stopClearBtn(){this.isActiveJob?this.stop():this.clear()}sendNotifications(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=this.mailedReceiverList;for(const t of e)yield this.commandBus.exec(new un.ud({instructionTypeId:130,documentId:this.document.id,control:!1,mainInstruction:{receiverID:t,text:`Уважаемый пользователь! Маршрут согласования данного документа был остановлен сотрудником: ${this.currentUser.effectiveName}. Дата и время: ${(new Date).toLocaleDateString()}`,subject:"Отменено согласование по документу",comment:null,execAuditorID:null,initiatorID:null,reportReceiverID:null,startDate:null,execInterval:null,execIntervalType:null,control:!1,instructionTypeInfo:null},reportToExecutive:!1,sendType:null,withExecutive:!1}));this.$toasted.success("Уведомления об отмене согласования отправлены")}))}cancelJob(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=this.document.listAttr.DOCTASKS.filter((e=>"MS_ACTIVE"===e.TaskStateNameResName||"Активна"===e.TaskStateName)),t=e[0].WorkInstanceID;if(t){const e=yield this.commandBus.exec(new CancelJob(t,"Отменено инициатором"));if(!e.value)return this.$toasted.error("Произошла ошибка при отмене маршрута.")}this.$toasted.success("Маршрут успешно отменен"),this.mailedReceiverList.length?(yield this.cancelMail(),yield this.updateDocTasks(e[0].ID)):this.clear()}))}cancelMail(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_WF_CancelMail",[{type:"Long",name:"pDocID",value:`${this.document.id}`},{type:"Long",name:"pTaskID",value:`${this.document.attr.TaskID}`}]))}catch(e){this.$log.debug(e)}finally{yield this.checkDocTasks()}}))}updateDocTasks(e){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.commandBus.exec(new Dt.Ff(`${e}`,["ID","TASKSTATE"],[`${e}`,"5"]))}))}checkDocTasks(){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.document.listAttr.DOCTASKS.length&&(this.document.listAttr.DOCTASKS.length=0);const{TASK:e}=yield this.queryBus.exec(new He.Ip("TASK",Ec.b.ListItem,null,`<CONSTRAINTS><EQUAL field="ERCID" value="${this.document.id}" /></CONSTRAINTS>`));e.forEach((e=>this.document.listAttr.DOCTASKS.push(e)))}))}confirmFunction(e,t){return this.queryBus.exec(new Zt.l(e,t))}openSettingsModal(e){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t="Параметры этапа",n={model:null,data:e.step[0],receivers:e.receivers,stepStarted:!0},i=new Mc.c({title:t,componentName:"routing-settings",componentProps:n,fullHeight:!1,width:"60%"});yield this.queryBus.exec(i)}))}fetchReceiversNames(e){if(Array.isArray(this.approvingMailSteps))return this.queryBus.exec(new vr.zD(e,!1))}addReceiver(e){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t="Добавление согласующего в этап",n={model:null,data:e.step[0]},i=new Mc.c({title:t,componentName:"add-approving-receiver",componentProps:n,fullHeight:!1,width:"60%"}),o=yield this.queryBus.exec(i);if(!o)return;const s=e.receivers.filter((e=>e===o.receiverID));if(s.length)return this.queryBus.exec(new gn.m(this.$gettext("Ошибка"),this.$gettext("Согласующий уже есть в этапе!")));const r=yield this.addApproverMethod(e.step[0].ID,o);0!==Number(r.value)?(yield this.refreshApprovingMail(),this.$toasted.success("Согласующий успешно добавлен!")):this.$toasted.error("Согласующий не добавлен!")}))}addApproverMethod(e,t){return this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_APPROVINGMAIL_APPROVER_ADD",[{type:"Long",name:"pID",value:`${e}`},{type:"String",name:"pMailText",value:t.mailText?`${t.mailText}`:null},{type:"Long",name:"pMailTypeID",value:t.mailTypeID?`${t.mailTypeID}`:null},{type:"Long",name:"pReceiverID",value:`${t.receiverID}`},{type:"String",name:"pExecDT",value:t.execDateTime?`${new Date(t.execDateTime).toLocaleDateString()}`:null},{type:"Long",name:"pUserID",value:`${this.currentUser.effectiveId}`}]))}changeDismissedReceiver(){var e,t,n;return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const i=yield this.findDismissedReceiversStep(this.document.id);if(!(null===(n=null===(t=null===(e=i.value)||void 0===e?void 0:e.item)||void 0===t?void 0:t.records)||void 0===n?void 0:n.length))return this.queryBus.exec(new gn.m(this.$gettext("Информация"),this.$gettext("Уволенные сотрудники не найдены!")));const o={StepNumber:i.value.item.records[0].values[0].item,ReceiverIDs:i.value.item.records[0].values[1].item.split(",")},s=o.ReceiverIDs.map((e=>Number(e))),r=yield this.dismissedReceiverInfo(s),a="Замена уволенного",l={model:null,dismissedReceiverInfo:r,step:o.StepNumber},c=new Mc.c({title:a,componentName:"change-dismissed-receiver",componentProps:l,fullHeight:!1,width:"40%"}),d=yield this.queryBus.exec(c);d&&(yield this.changeReceiverMethod(d.newReceiverID,o.StepNumber,d.initialReceiverID),yield this.refreshApprovingMail(),yield this.fullRouteInfo())}))}dismissedReceiverInfo(e){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=[];for(const n of e){const{USER:e}=yield this.queryBus.exec(new He.Ip("USER",Ec.b.ListItem,null,`<CONSTRAINTS><EQUAL field="ID" value="${n}" /></CONSTRAINTS>`));5===e[0].State&&t.push(e[0])}if(t.length)return t.map((e=>({id:e.ID,value:e.FullName})))}))}changeReceiverMethod(e,t,n){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_CHANGE_DISMISSED",[{type:"Long",name:"pDocID",value:`${this.document.id}`},{type:"Long",name:"pStepID",value:`${t}`},{type:"Long",name:"pFromUserID",value:`${n}`},{type:"Long",name:"pToUserID",value:`${e}`}]))}catch(e){this.$log.debug(e)}finally{this.$toasted.success("Замена выполнена успешно")}}))}findDismissedReceiversStep(e){return this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_GET_DISMISSED_INFO",[{type:"Long",name:"pDocID",value:`${e}`}]))}deleteReceiver(e){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=yield this.confirmFunction("Внимание!","При выполнении действия отчет Согласующего будет удален и сообщение отозвано. Вы действительно хотите удалить согласующего из маршрута?");if(!t)return;const n=e.mailInfo.filter((e=>"MS_DONE_ERROR"===e.stateNameResName)),i=this.document.listAttr.GRK_APPROVINGMAIl.filter((e=>e.ReceiverID===n[0].receiverID&&"+"===e.IsStepStarted)),o=i[0].ID;yield this.deleteReceiverMethod(n[0],e.step[0].Step,o),yield this.refreshApprovingMail()}))}deleteReceiverMethod(e,t,n){return displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_APPROVINGMAIL_APPROVER_DEL",[{type:"Long",name:"pID",value:`${n}`}]))}catch(e){this.$log.debug(e)}finally{this.$toasted.success(`Удален согласующий ${e.receiverName} из этапа № ${t}`)}}))}openMessage(e){const t=Object.assign(Object.assign({},this.actionContext),{entityViewMode:Ue.dS.View});return this.$app.view(t,Ue.zc.Instruction,null,String(e))}openReport(e){this.$app.view(this.actionContext,Ue.zc.Instruction,null,String(e))}setStepName(e){return`Этап ${e.step[0].Step}: ${e.step[0].StepCode}`}countReceivers(e){const t=[],n=[];return e.forEach((e=>{t.push(e.ReceiverID),e.MailID&&e.MailStateID>1&&n.push(e.MailID)})),`${n.length}/${t.length}`}messageStateIcon(e){if(!e||!e.length)return;if(!this.isActiveJob)return"cancel";const t=e.every((e=>"MS_RESULT_PLUS"===e.stateNameResName));return t?"check_circle":e[0].mailID?"play_circle_filled":e[0].mailID?void 0:"help_outline"}messageStatus(e){if(!e||!e.length)return;const t=e.every((e=>"MS_RESULT_PLUS"===e.stateNameResName));return t?"green":void 0}isItemSelected(e){const t=this.approvingMailSteps[e].mailInfo.every((e=>!e.result));return!!t||e===this.selectedIndex}itemClicked(e,t){if(e===this.selected)return this.selected=null,this.selectedIndex=null,!1;this.selected=e,this.selectedIndex=t}receiverName(e){if(!this.notMailedReceivers.length)return;const t=this.notMailedReceivers.find((t=>t.id===e));return t&&t.name?t.name:void 0}stepMailInfo(){if(!this.groupedApprovingMailSteps&&!this.groupedApprovingMailSteps.length)return;let e;return this.approvingMailSteps.forEach((t=>{t.isStepStarted&&(t.mailInfo.length=0,t.step.forEach((n=>displayRunningRoutevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){e=yield this.fetchInstruction(new Fe.oE(n.MailID));const i={receiverName:e.instruction.receiverName,receiverID:e.instruction.receiverID,mailID:e.instruction.id,state:e.instruction.state,stateName:e.instruction.stateName,stateNameResName:e.instruction.stateNameResName,sendDate:e.instruction.createDateTime,result:e.instruction.result,reportID:e.instruction.reportID};t.mailInfo.push(i),t.mailInfo.sort(((e,t)=>Number(e.mailID)-Number(t.mailID)))})))))})),this.approvingMailSteps}showLine(e,t){return t!==e.mailInfo.length-1}showVerticalLine(e){return e!==this.approvingMailSteps.length-1}changeCircleColor(e){return e.result===this.$gettext("Завершено успешно")?"green":e.result===this.$gettext("Завершено с отказом")?"red":"CANCELED"===e.stateNameResName||"MS_READED"===e.stateNameResName||"MS_DELETED"===e.stateNameResName||"MS_ACTIVE"===e.stateNameResName||"MS_INWORK"===e.stateNameResName||"MS_NOTACTIVE"===e.stateNameResName||"MS_ACTIVE_REDIRECTED"===e.stateNameResName?"grey":""}isProjectMessage(e){return e.state===Mn.Wd.NotActive||e.state===Mn.Wd.CoExec}innerAvatarColor(e){return"MS_ACTIVE"===e.stateNameResName||"MS_INWORK"===e.stateNameResName||"MS_NOTACTIVE"===e.stateNameResName||"MS_ACTIVE_REDIRECTED"===e.stateNameResName}negativeReport(e){return e.some((e=>"MS_DONE_ERROR"===e.stateNameResName))}isStepStarted(e){return"+"===e[0].IsStepStarted}get isActiveJob(){var e;return null===(e=this.document.listAttr.DOCTASKS)||void 0===e?void 0:e.some((e=>"TSK_DELETED"!==e.TaskStateNameResName))}get setBtnIcon(){return this.isActiveJob?"stop":"delete"}get btnText(){return this.isActiveJob?"Остановить":"Очистить"}get taskCount(){return`${this.document.listAttr.DOCTASKS.length}`}get approvingMailCreator(){const e=this.document.listAttr.DOCTASKS.filter((e=>"TSK_DELETED"!==e.TaskStateNameResName));return`${e[0].CreatorName}, ${new Date(e[0].CreateTaskDateTime).toLocaleDateString()}`}get checkMails(){return this.approvingMailSteps.every((e=>e.mailInfo.length))}get notMailedReceiverList(){const e=[];return this.approvingMailSteps.forEach((t=>{t.step.forEach((t=>{t.MailID||e.push(t.ReceiverID)}))})),e}get mailedReceiverList(){const e=[];return this.approvingMailSteps.forEach((t=>{t.step.forEach((t=>{t.MailID&&e.push(t.ReceiverID)}))})),e}get groupedApprovingMailSteps(){if(!this.document.listAttr.GRK_APPROVINGMAIl&&!this.document.listAttr.GRK_APPROVINGMAI.length)return;const e={};this.document.listAttr.GRK_APPROVINGMAIl.forEach((t=>{e[t.Step]||(e[t.Step]=[]),e[t.Step].push(t)}));const t=Object.values(e).map((e=>Object.values(e)));return this.approvingMailSteps=t.map((e=>({step:e,mailInfo:[],isStepStarted:e.some((e=>e.MailID)),mailTypeID:e[0].MailTypeID,receivers:[]}))),this.approvingMailSteps.forEach((e=>{e.step.forEach((t=>{t.ReceiverID&&(Array.isArray(t.ReceiverID)||e.receivers.push(t.ReceiverID))}))})),this.approvingMailSteps}};displayRunningRoutevue_type_script_lang_js_decorate([(0,rt.Prop)(),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"document",void 0),displayRunningRoutevue_type_script_lang_js_decorate([(0,rt.Prop)(),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"actionContext",void 0),displayRunningRoutevue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"queryBus",void 0),displayRunningRoutevue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"commandBus",void 0),displayRunningRoutevue_type_script_lang_js_decorate([(0,fa.Rm)("fetchTypes"),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"fetchTypes",void 0),displayRunningRoutevue_type_script_lang_js_decorate([(0,fa.Rm)("fetchInstruction"),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"fetchInstruction",void 0),displayRunningRoutevue_type_script_lang_js_decorate([(0,fa.Hg)("fetchCurrentUserRights"),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"fetchCurrentUserRights",void 0),displayRunningRoutevue_type_script_lang_js_decorate([(0,Ke.Y)("getInstruction"),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"getInstruction",void 0),displayRunningRoutevue_type_script_lang_js_decorate([(0,Ge.O)("currentUser"),displayRunningRoutevue_type_script_lang_js_metadata("design:type",Object)],Hd.prototype,"currentUser",void 0),Hd=displayRunningRoutevue_type_script_lang_js_decorate([(0,gt.default)({components:{}})],Hd);const Qd=Hd,zd=Qd;var Zd=(0,Ct.Z)(zd,displayRunningRoutevue_type_template_id_bad409c2_scoped_true_render,Ud,!1,null,"bad409c2",null);const Wd=Zd.exports;_t()(Zd,{VAvatar:w.Z,VBtn:g.Z,VCol:r.Z,VIcon:y.Z,VList:m.Z,VMenu:W.Z,VProgressCircular:V.Z,VRow:a.Z,VTooltip:_.Z});var documentsNewsvue_type_template_id_271b6187_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{staticClass:"pt-0 pb-2 px-0"},[e.folderId||e.isEditWidgetSettings?e._e():n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"pl-4"},[n("span",{staticClass:"body-1"},[n("translate",[e._v("Укажите в настройках целевую папку документов")])],1)])],1),e._v(" "),e.isEditWidgetSettings?n("v-row",{staticClass:"pr-4",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"pa-0",attrs:{cols:"12"}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"col-xl-8 d-flex align-center px-0 pt-0 pb-3 body-1"},[n("translate",{staticClass:"black--text lighten-1"},[e._v("Высота виджета (в пикселях):")])],1),e._v(" "),n("v-col",{staticClass:"col-xl-4"},[n("card-edit-text",{staticClass:"body-1",attrs:{"persistent-hint":"","label-size":12,"input-size":12},model:{value:e.widgetHeight,callback:function(t){e.widgetHeight=t},expression:"widgetHeight"}})],1)],1)],1),e._v(" "),n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.isFetching}}),e._v(" "),!e.isFetching&&e.folders?[n("v-col",{staticClass:"widget_tree py-0 pl-0",attrs:{cols:"9"}},[n("tree-view",e._b({ref:"tree",attrs:{model:e.folders,selection:e.selection,onSelect:e.onSelect},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{key:t.item.id,staticClass:"tree-item py-1 my-1",class:{active:e.selectedFolder&&t.item.id===e.selectedFolder.id},attrs:{id:t.item.id,"data-test-id":"treeNode","data-test-uid":t.item.id}},[e._v("\n              "+e._s(t.item.name)+"\n            ")])]}}],null,!1,1755905237)},"tree-view",e.treeOptions,!1))],1),e._v(" "),n("v-col",{staticClass:"py-0",attrs:{cols:"3"}},[n("div",{staticClass:"body-1 mb-2"},[n("translate",[e._v("Выбрана папка")])],1),e._v(" "),e.selectedFolder?n("v-chip",{staticClass:"white--text",attrs:{color:"primary",small:"",close:!0},on:{"click:close":e.removeItem}},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({},i),[e._v(e._s(e.selectedFolder.name))])]}}],null,!1,2813280105)},[e._v(" "),n("span",[e._v(e._s(e.selectedFolder.name))])])],1):e._e()],1)]:e._e()],2):e.folderId&&e.actionContext&&e.fetchOptions?n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"py-0 pl-2",attrs:{cols:"12"}},[n("document-list",{attrs:{context:e.actionContext,"fetch-options":e.fetchOptions,"collection-view-mode":e.viewMode,"footer-is-hidden":!0},on:{"update-state":e.onListStateUpdate}})],1)],1):e._e()],1)},qd=[],Gd=n(53600),documentsNewsvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},documentsNewsvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},documentsNewsvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Kd=class DocumentsNewsComponent extends rt.Vue{constructor(){super(...arguments),this.selection=[],this.actionContext=null,this.fetchOptions=null,this.folderInfo=null,this.viewMode=Ue.Ml.List,this.selectedFolder=null,this.widgetHeight=365,this.isFetching=!0,this.treeOptions={category:"items",unique:e=>e.id,css:{TreeView:"tree-view"},strategies:{click:["select"],fold:["opener-control"]},openerOpts:{position:"left"}}}created(){return documentsNewsvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.height&&(this.widgetHeight=this.height),this.folderId?(yield this.getFolderInfo(),this.actionContext={section:Le.S.Documents,contentType:Ue.zc.Document,collectionViewMode:Ue.Ml.List,entityViewMode:Ue.dS.List,folderId:this.folderId,folderName:this.folderInfo?this.folderInfo.name:""},this.fetchOptions={section:Le.S.Documents,folderInfo:this.folderInfo,sortField:null,filter:null,refreshCounter:0,page:1,pageSize:0,unreadOnlyFilter:!1,searchTerm:""}):this.createFoldersTree()}))}onPropsChanged(){this.$emit("set-result",{data:this.settings})}onSelect(e,t){t.nodeType===Tt.J.Fake?t.__onExpandNode__&&t.__onExpandNode__(!0):this.selectedFolder=t}createFoldersTree(){return documentsNewsvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{const e=yield this.fetchDocsFolders(new He.u9(this.userSettings.useGroupJournalsByDepartments)),t=(0,kt.t)(e,Ue.zc.Document);this.folderId&&(this.selectedFolder=(0,kt.$)(t,this.folderId)),this.folders=t}catch(e){this.$log.error(e)}finally{this.isFetching=!1}}))}removeItem(){this.selectedFolder=null}onListStateUpdate(e){e.page&&this.fetchOptions.page!==e.page&&(this.fetchOptions.page=e.page),e.pageSize&&(this.fetchOptions.pageSize=e.pageSize)}get folderId(){var e;return this.selectedFolder?Number(this.selectedFolder.id):null===(e=this.widgetProps)||void 0===e?void 0:e.folderId}get height(){var e;return null===(e=this.widgetProps)||void 0===e?void 0:e.height}get settings(){return{folderId:this.folderId,height:this.widgetHeight}}get widgetProps(){var e;return(null===(e=this.widgetSavedProps)||void 0===e?void 0:e.widgetProps)||this.widgetProperties}getFolderInfo(){return documentsNewsvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.createFoldersTree(),this.folderInfo=this.getDocumentFolder(this.folderId)||null}))}};documentsNewsvue_type_script_lang_js_decorate([(0,rt.Prop)(),documentsNewsvue_type_script_lang_js_metadata("design:type",Object)],Kd.prototype,"widgetSavedProps",void 0),documentsNewsvue_type_script_lang_js_decorate([(0,rt.Prop)(),documentsNewsvue_type_script_lang_js_metadata("design:type",Object)],Kd.prototype,"widgetProperties",void 0),documentsNewsvue_type_script_lang_js_decorate([(0,rt.Prop)(),documentsNewsvue_type_script_lang_js_metadata("design:type",Number)],Kd.prototype,"widgetId",void 0),documentsNewsvue_type_script_lang_js_decorate([(0,rt.Prop)(),documentsNewsvue_type_script_lang_js_metadata("design:type",Boolean)],Kd.prototype,"isEditWidgetSettings",void 0),documentsNewsvue_type_script_lang_js_decorate([(0,fa.jI)("fetchFolders"),documentsNewsvue_type_script_lang_js_metadata("design:type",Object)],Kd.prototype,"fetchDocsFolders",void 0),documentsNewsvue_type_script_lang_js_decorate([(0,nt.x)("userSettings"),documentsNewsvue_type_script_lang_js_metadata("design:type",Object)],Kd.prototype,"userSettings",void 0),documentsNewsvue_type_script_lang_js_decorate([(0,We.k)("getDocumentFolder"),documentsNewsvue_type_script_lang_js_metadata("design:type",Object)],Kd.prototype,"getDocumentFolder",void 0),documentsNewsvue_type_script_lang_js_decorate([(0,rt.Watch)("settings",{deep:!0}),documentsNewsvue_type_script_lang_js_metadata("design:type",Function),documentsNewsvue_type_script_lang_js_metadata("design:paramtypes",[]),documentsNewsvue_type_script_lang_js_metadata("design:returntype",void 0)],Kd.prototype,"onPropsChanged",null),Kd=documentsNewsvue_type_script_lang_js_decorate([(0,rt.Component)({components:{"tree-view":Ft.L,"document-list":Gd.default}})],Kd);const Yd=Kd,Jd=Yd;var Xd=(0,Ct.Z)(Jd,documentsNewsvue_type_template_id_271b6187_scoped_true_render,qd,!1,null,"271b6187",null);const eu=Xd.exports;_t()(Xd,{VChip:P.Z,VCol:r.Z,VContainer:pe.Z,VRow:a.Z,VTooltip:_.Z});var tu=n(70832),favouriteDocsvue_type_template_id_7e3e15b5_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{staticClass:"pt-0 pb-2"},[e.hasDocs||e.isEditWidgetSettings?e.isEditWidgetSettings?n("v-row",{staticClass:"pr-4"},[n("v-col",{staticClass:"pa-0",attrs:{cols:"12"}},[n("v-row",{staticClass:"col-xl-12 pa-0",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"col-xl-8 d-flex align-center"},[n("v-col",{staticClass:"col-12 px-0 pt-0 pb-3 body-1"},[n("translate",{staticClass:"black--text lighten-1"},[e._v(" Количество документов в виджете: ")])],1)],1),e._v(" "),n("v-col",{staticClass:"col-xl-4"},[n("card-edit-text",{staticClass:"body-1",attrs:{"persistent-hint":"","label-size":12,"input-size":12},model:{value:e.count,callback:function(t){e.count=t},expression:"count"}})],1)],1),e._v(" "),n("v-row",{staticClass:"col-xl-12 pa-0",attrs:{"no-gutters":""}},[e.selectedDocs.length?n("v-col",{staticClass:"mb-1",attrs:{cols:"12"}},[e._l(e.selectedDocs,(function(t){return[n("div",{staticClass:"mb-1"},[n("v-chip",{staticClass:"white--text",attrs:{color:"primary",small:"",close:""},on:{"click:close":function(n){return e.removeItem(t.id)}}},[n("v-tooltip",{attrs:{bottom:"","open-delay":500},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("span",e._g({},o),[e._v(e._s(t.attributes.Name))])]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.attributes.Name))])])],1)],1)]}))],2):e._e(),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-btn",{staticClass:"small-button",attrs:{color:"primary",outlined:""},on:{click:e.selectDocument}},[n("v-icon",{attrs:{color:"primary",size:"18"}},[e._v("add")]),e._v(" "),n("translate",[e._v("Выбрать документ")])],1)],1)],1)],1)],1):n("v-row",[n("v-col",{staticClass:"py-0 pl-2",attrs:{cols:"12"}},[n("document-list",{attrs:{context:e.actionContext,"fetch-options":e.fetchOptions,"collection-view-mode":e.viewMode,"footer-is-hidden":!0},on:{"update-state":e.onListStateUpdate}})],1)],1):n("v-row",[n("v-col",[n("translate",[e._v("Выберите документы в настройках")])],1)],1)],1)},nu=[],favouriteDocsvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},favouriteDocsvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},favouriteDocsvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const iu=3;let ou=class FavouriteDocumentsComponent extends rt.Vue{constructor(){super(...arguments),this.selectedDocs=[],this.docsId=[],this.count=iu,this.actionContext=null,this.fetchOptions=null,this.viewMode=Ue.Ml.List}onPropsChanged(){this.$emit("set-result",{data:this.settings})}created(){var e,t;return favouriteDocsvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.count=(null===(e=this.widgetProps)||void 0===e?void 0:e.count)||iu,this.docsId=(null===(t=this.widgetProps)||void 0===t?void 0:t.docsId)||[],this.hasDocs)try{const e=[...this.docsId].splice(0,this.count),t=e.map((e=>this.fetchDocument(new He.U_(e,Ue.dS.View))));this.selectedDocs=yield Promise.all(t),this.actionContext={section:Le.S.Documents,contentType:Ue.zc.Document,collectionViewMode:Ue.Ml.List,entityViewMode:Ue.dS.List,folderId:"",folderName:""},this.fetchOptions={section:Le.S.Documents,folderInfo:null,sortField:null,filter:null,refreshCounter:0,page:1,pageSize:0,unreadOnlyFilter:!1,searchTerm:"",entities:this.selectedDocs}}catch(e){this.$log.error(e)}}))}selectDocument(){return favouriteDocsvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=new wl.j(this.$gettext("Поиск документа"),!1,[],!1),t=yield this.queryBus.exec(e);t&&this.selectedDocs.push(t)}))}removeItem(e){this.selectedDocs=this.selectedDocs.filter((t=>t.id!==e))}onListStateUpdate(e){e.page&&this.fetchOptions.page!==e.page&&(this.fetchOptions.page=e.page),e.pageSize&&(this.fetchOptions.pageSize=e.pageSize)}get hasDocs(){return this.docsId.length>0}get settings(){return{count:this.count,docsId:this.selectedDocs.map((e=>e.id))}}get widgetProps(){var e;return(null===(e=this.widgetSavedProps)||void 0===e?void 0:e.widgetProps)||this.widgetProperties}};favouriteDocsvue_type_script_lang_js_decorate([(0,rt.Prop)(),favouriteDocsvue_type_script_lang_js_metadata("design:type",Object)],ou.prototype,"widgetSavedProps",void 0),favouriteDocsvue_type_script_lang_js_decorate([(0,rt.Prop)(),favouriteDocsvue_type_script_lang_js_metadata("design:type",Object)],ou.prototype,"widgetProperties",void 0),favouriteDocsvue_type_script_lang_js_decorate([(0,rt.Prop)(),favouriteDocsvue_type_script_lang_js_metadata("design:type",Number)],ou.prototype,"widgetId",void 0),favouriteDocsvue_type_script_lang_js_decorate([(0,rt.Prop)(),favouriteDocsvue_type_script_lang_js_metadata("design:type",Boolean)],ou.prototype,"isEditWidgetSettings",void 0),favouriteDocsvue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),favouriteDocsvue_type_script_lang_js_metadata("design:type",Object)],ou.prototype,"queryBus",void 0),favouriteDocsvue_type_script_lang_js_decorate([(0,fa.jI)("fetchDocument"),favouriteDocsvue_type_script_lang_js_metadata("design:type",Object)],ou.prototype,"fetchDocument",void 0),favouriteDocsvue_type_script_lang_js_decorate([(0,rt.Watch)("settings",{deep:!0}),favouriteDocsvue_type_script_lang_js_metadata("design:type",Function),favouriteDocsvue_type_script_lang_js_metadata("design:paramtypes",[]),favouriteDocsvue_type_script_lang_js_metadata("design:returntype",void 0)],ou.prototype,"onPropsChanged",null),ou=favouriteDocsvue_type_script_lang_js_decorate([(0,rt.Component)({components:{"document-list":Gd.default}})],ou);const su=ou,ru=su;var au=(0,Ct.Z)(ru,favouriteDocsvue_type_template_id_7e3e15b5_scoped_true_render,nu,!1,null,"7e3e15b5",null);const lu=au.exports;_t()(au,{VBtn:g.Z,VChip:P.Z,VCol:r.Z,VContainer:pe.Z,VIcon:y.Z,VRow:a.Z,VTooltip:_.Z});var fileEditorvue_type_template_id_c793a478_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{staticClass:"px-0 py-0",attrs:{id:"file-editor-wrapper"}},[n("v-row",{staticClass:"pb-2",class:e.filesViewerActivatorClass,attrs:{align:"center","no-gutters":""},on:{click:e.filesViewClick}},[n("v-btn",{staticClass:"square-sm-button rounded-button mr-1 elevation-0",attrs:{outlined:!e.showFilesViewer,color:"primary"}},[n("v-icon",{attrs:{color:e.showFilesViewer?"white":"primary"}},[e._v(" assignment ")])],1),e._v(" "),n("span",{staticClass:"body-2 font-weight-bold"},[e._v("\n      "+e._s(e.$gettext("Файлы"))+" "+e._s(e.document&&e.documentFiles?"("+e.documentFiles.files.length+")":"")+"\n    ")])],1),e._v(" "),n("v-card",{staticClass:"elevation-0 bordered-card grey--border lighten-3 mb-3"},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.loading}}),e._v(" "),n("v-card-title",{staticClass:"grey lighten-4 px-1 pt-2 pb-1"},[n("v-row",{attrs:{align:"center","no-gutters":""}},[n("svg-icon",{staticClass:"svg-icon svg-doc mr-2",attrs:{icon:e.extentionFileIcon}}),e._v(" "),e.activeFile?n("v-col",[n("v-row",{attrs:{"no-gutters":""}},[n("span",{staticClass:"body-2 font-weight-bold primary--text mr-2"},[e._v(e._s(e.activeFile.fullFileName))]),e._v(" "),n("span",{staticClass:"caption font-weight-light error--text"},[e._v(e._s(e.numberVersionTitle))])]),e._v(" "),n("v-row",{attrs:{"no-gutters":""}},[n("span",{staticClass:"caption font-weight-light"},[e._v(e._s(e.activeFile.sizeKb))]),e._v(" "),n("span",{staticClass:"caption font-weight-light mx-3"},[e._v(e._s(e._f("date")(e.activeVersion.createDateTime,"DD.MM.YYYY hh:mm")))]),e._v(" "),n("span",{staticClass:"caption font-weight-light"},[e._v(e._s(e.activeFile.creator))])])],1):e._e(),e._v(" "),e.activeFile&&!e.activeFile.curEditorID&&e.canEdit(e.activeFile)?n("v-btn",{staticClass:"rounded-button ml-0 my-0 px-2 elevation-0 font-weight-regular",class:{"square-sm-button":e.isMobile,"small-button":!e.isMobile},attrs:{color:"primary"},on:{click:function(t){return e.onEdit(e.activeFile)}}},[n("v-row",{class:{"justify-center":e.isMobile},attrs:{align:"center","no-gutters":""}},[n("v-icon",{attrs:{color:"white"}},[e._v("lock")]),e._v(" "),e.isMobile?e._e():[n("translate",[e._v("Взять в работу")])]],2)],1):e._e(),e._v(" "),e.fileToEdit(e.activeFile)?n("v-btn",{staticClass:"rounded-button mr-2 my-0 px-2 elevation-0 font-weight-regular",class:{"square-sm-button":e.isMobile,"small-button":!e.isMobile},attrs:{color:"primary"},on:{click:function(t){return e.onUnlock(e.activeFile)}}},[n("v-row",{class:{"justify-center":e.isMobile},attrs:{align:"center","no-gutters":""}},[n("v-icon",{attrs:{color:"white"}},[e._v("lock_open")]),e._v(" "),e.isMobile?e._e():[n("translate",[e._v("Снять с редактирования")])]],2)],1):e._e(),e._v(" "),e.fileToEdit(e.activeFile)?n("v-btn",{staticClass:"rounded-button my-0 px-2 elevation-0 font-weight-regular",class:{"square-sm-button":e.isMobile,"small-button":!e.isMobile},attrs:{outlined:"",color:"primary"},on:{click:function(t){return e.onSave(e.activeFile)}}},[n("v-row",{class:{"justify-center":e.isMobile},attrs:{align:"center","no-gutters":""}},[n("v-icon",{attrs:{color:"primary"}},[e._v("publish")]),e._v(" "),e.isMobile?e._e():[n("translate",[e._v("Сохранить новую версию")])]],2)],1):e._e(),e._v(" "),e.canDelete(e.activeFile)?n("v-btn",{staticClass:"rounded-button my-0 ml-2 px-2 elevation-0 font-weight-regular",class:{"square-sm-button":e.isMobile,"small-button":!e.isMobile},attrs:{outlined:"",color:"warning"},on:{click:function(t){return e.onDelete(e.activeFile)}}},[n("v-row",{class:{"justify-center":e.isMobile},attrs:{align:"center","no-gutters":""}},[n("v-icon",{attrs:{color:"warning"}},[e._v("delete")]),e._v(" "),e.isMobile?e._e():[n("translate",[e._v("Удалить файл")])]],2)],1):e._e(),e._v(" "),n("v-icon",{staticClass:"ml-2 mr-3 mb-1",class:e.versionViewerActivatorClass,on:{click:e.viewVersions}},[e._v("history")])],1)],1),e._v(" "),n("v-card-text",{staticClass:"px-0 py-0",staticStyle:{position:"relative"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showFilesViewer||e.showVersions,expression:"showFilesViewer || showVersions"}],ref:"frameEditorCover",staticClass:"frame-editor-cover"}),e._v(" "),n("div",{attrs:{id:"placeholder"}})]),e._v(" "),n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showVersions,expression:"showVersions"}],staticClass:"px-2 py-2 elevation-5",attrs:{id:"file-version-wrapper"}},[e.activeVersion?n("file-version-viewer",{attrs:{file:e.activeFile,mobile:e.mobile||e.isMobile,activeVersionId:e.activeVersion.id,fileVersions:e.allVersions,deleteVersion:e.deleteVersion,viewerActivator:e.versionViewerActivatorClass},on:{"close-viewer":e.closeVersionViewer,"velsion-click":e.changeActiveVersion}}):e._e()],1)]),e._v(" "),n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showFilesViewer,expression:"showFilesViewer"}],staticClass:"px-2 py-1 elevation-5",attrs:{id:"files-viewer-wrapper"}},[e.activeFile?n("ld-files-viewer",{staticClass:"mt-2",attrs:{card:e.card,context:e.context,currFileId:e.activeFile.id,operationMode:e.operationMode,viewerActivator:e.filesViewerActivatorClass},on:{"close-viewer":e.closeFilesViewerHandler,"view-btn-clicked":e.changeActiveFile,"lock-file":e.onFileLock,"unlock-file":e.onFileUnlock,"new-file-version":e.onNewFileVersion,"update-editor-files":e.onUpdateEditorFiles,"delete-version":e.onDeleteVersion,"delete-file":e.onDeleteFile}}):e._e()],1)])],1)],1)},cu=[],du=n(98005),uu=n(21610),pu=n(39360),fileEditorvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},fileEditorvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},fileEditorvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let hu=class FileEditorComponent extends((0,gt.mixins)(pu.Z)){constructor(){super(...arguments),this.documentFiles=null,this.allVersions=null,this.prevFileId=null,this.activeVersion=null,this.showVersions=!1,this.showFilesViewer=!1,this.processedFile=!1,this.filesViewerActivatorClass="file-editor__title",this.versionViewerActivatorClass="file-editor__versions",this.iframe=null,this.processFile=(e,t)=>fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.processedFile){this.processedFile=!0;try{yield t()}finally{this.processedFile=!1}}}))}onFileChange(){this.activeFile=this.file,this.activeVersion=this.file}onOperationModeChange(){this.operationMode&&this.config&&this.reloadEditor()}onFilesChange(e,t){e&&t&&e.length<t.length&&this.findLockedFile()}onDocumentFilesChange(e,t){if(!this.documentFiles||!this.file)return;this.prevFileId=this.activeFile.id;const n=this.documentFiles.files.find((e=>e.versions.find((e=>e.id===this.prevFileId))));if(!n&&this.activeFile.versions.length){const n=t.files.findIndex((e=>e.id===this.prevFileId));if(-1===n)return;this.config=null,this.activeFile=e.files[n]}else this.activeFile=n}onActiveFileChange(){!this.config&&this.activeFile&&(this.allVersions=this.activeFile.versions,Array.isArray(this.allVersions)&&this.allVersions.length&&(this.activeVersion=this.allVersions[0]),this.operationMode=this.activeFile.curEditorID===this.currentUser.id?"edit":"view",this.reloadEditor())}created(){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.file&&(this.prevFileId=this.file.id,this.operationMode=this.activeFile.curEditorID===this.currentUser.id?"edit":"view",yield this.updateDocumentFiles())}))}focusEditorDocument(e){this.iframe&&e===this.$refs.frameEditorCover&&this.iframe.contentWindow.focus()}closeFilesViewerHandler(e){this.closeFilesViewer(),e&&this.focusEditorDocument(e)}closeFilesViewer(){this.showFilesViewer=!1}closeVersionViewer(){this.showVersions=!1}viewVersions(){this.calculateVersionsWidth(),this.showVersions=!this.showVersions}filesViewClick(){this.calculateFilesViewerWidth(),this.showFilesViewer=!this.showFilesViewer}changeActiveFile(e){this.config=null,this.activeFile=e,this.closeFilesViewer()}changeActiveVersion(e){e&&(this.closeVersionViewer(),this.loading=!0,this.config=null,this.activeVersion=e,this.reloadEditor(e.id),this.loading=!1)}canEdit(e){return!this.processedFile&&this.checkFileRight(e.id,du.K.EditFile)}canDelete(e){if(e)return!this.processedFile&&this.checkFileRight(e.id,du.K.DeleteFile)}onDownload(e){return`${this.$config.apiPath()}files/${e}`}onDelete(e){this.processFile(e.id,(()=>this.deleteFile(e)))}onEdit(e){this.processFile(e.id,(()=>this.editFile(e)))}onUnlock(e){this.unlockFileWithConfirmation(e)}onFileLock(e){var t;if(!e)return;const n=this.documentFiles.files.find((t=>t.id===e.id));n&&(n.curEditorID=this.currentUser.effectiveId,n.curEditorName=this.currentUser.effectiveName),e.uid===(null===(t=this.activeFile)||void 0===t?void 0:t.uid)&&(this.operationMode="edit",this.$forceUpdate())}onFileUnlock(e){var t;if(!e)return;const n=this.documentFiles.files.find((t=>t.id===e.id));n&&(n.curEditorID=null,n.curEditorName=null),e.uid===(null===(t=this.activeFile)||void 0===t?void 0:t.uid)&&(this.config=null,this.operationMode="view",this.updateDocumentFiles())}onNewFileVersion([e,t]){String(e)===this.activeFile.uid&&(this.file.versions=[t])}onUpdateEditorFiles(e){this.documentFiles=e}localDeleteFile(e){e&&(this.documentFiles.files=this.documentFiles.files.filter((t=>t.id!==e.id)))}onDeleteFile(e){var t;e&&(this.localDeleteFile(e),e.id===(null===(t=this.activeFile)||void 0===t?void 0:t.id)&&this.findLockedFile())}onDeleteVersion({file:e,fileVersion:t}){var n,i;if(!t||!e)return;const o=this.allVersions.find((e=>e.id===t.id));if(o){if(this.allVersions=this.allVersions.filter((e=>e.id!==t.id)),!this.allVersions.length)return void this.localDeleteFile(e);if((null===t||void 0===t?void 0:t.id)===(null===(n=this.activeFile)||void 0===n?void 0:n.id))return void this.updateDocumentFiles();(null===t||void 0===t?void 0:t.id)===(null===(i=this.activeVersion)||void 0===i?void 0:i.id)&&(this.activeVersion=this.allVersions[0],this.config=null,this.activeFile.versions=this.allVersions,this.reloadEditor(this.activeFile.id))}}findLockedFile(){this.config=null;const e=this.documentFiles.files.find((e=>(null===e||void 0===e?void 0:e.curEditorID)===this.currentUser.effectiveId));e?this.activeFile=e:this.$emit("close-editor")}onSave(e){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.isLastVersion&&!(yield this.queryBus.exec(new Zt.l(this.$gettext("Внимание!"),`${this.$gettext("Вы изменили не последнюю версию файла ")}${e.fullFileName}. Сохранить изменения как новую версию?`))))return;yield this.saveFileViaR7(),this.loading=!0;const t=new Promise(((e,t)=>{setTimeout((()=>e("готово!")),5e3)}));yield t,this.reloadFile(e)}))}deleteVersion(e,t){this.processFile(t.id,(()=>fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(yield this.queryBus.exec(new Zt.l(this.$gettext("Внимание!"),`${this.$gettext("Вы действительно хотите удалить файл")} <strong>${t.fileName}</strong>?`)))try{this.loading=!0,yield this.commandBus.exec(new Vi.gm(this.card.id,e.id,t.id)),e.versions=e.versions.filter((e=>t!==e)),e.versions.length||(this.documentFiles.files=this.documentFiles.files.filter((t=>t!==e)))}catch(e){this.$log.error(e),this.showError(e)}finally{this.loading=!1,this.processedFile=!1}}))))}fileToEdit(e){return(null===e||void 0===e?void 0:e.curEditorID)===this.currentUser.id}checkFileRight(e,t){return this.fileRights&&this.fileRights[e]&&this.fileRights[e].includes(t)}updateDocumentFiles(){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading=!0,this.documentFiles=yield this.queryBus.exec(new He.G4(this.card.id,this.cardId||this.card.cardId)),this.loading=!1}))}calculateVersionsWidth(){const e=document.getElementById("file-editor-wrapper").offsetWidth;document.getElementById("file-version-wrapper").style.width=e-108+"px"}calculateFilesViewerWidth(){const e=document.getElementById("file-editor-wrapper").offsetWidth;document.getElementById("files-viewer-wrapper").style.width=e-40+"px"}unlockFileWithConfirmation(e){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){(yield this.queryBus.exec(new Zt.l(this.$gettext("Внимание!"),this.$gettextInterpolate(this.$gettext("Снять файл %{file} с редактирования?"),{file:e.fullFileName}))))&&this.reloadFile(e)}))}editFile(e){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.commandBus.exec(new pn.n(e.id)),this.$set(e,"curEditorID",this.currentUser.effectiveId),this.$set(e,"curEditorName",this.currentUser.effectiveName),this.operationMode="edit",this.onDownload(e.id)}catch(e){this.$log.error(e),this.showError(e)}}))}deleteFile(e){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(e&&(yield this.queryBus.exec(new Zt.l(this.$gettext("Внимание!"),`${this.$gettext("Вы действительно хотите удалить файл ")}${e.fullFileName}?`))))try{this.loading=!0,yield this.commandBus.exec(new Vi.Hq(this.card.id,e.id)),this.localDeleteFile(e)}catch(e){this.showError(e)}finally{this.loading=!1,this.processedFile=!1}}))}unlockFile(e){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{this.processedFile=!0,yield this.commandBus.exec(new pn.rn(e.id)),e.curEditorName=null,e.curEditorID=null}catch(e){this.$log.error(e),this.showError(e)}finally{this.processedFile=!1}}))}getR7EditorFileConfig(e){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let t=null;const n=e||this.activeFile.id;if(this.loading=!0,n){t=yield this.queryBus.exec(new Bi.s(n));const e=t.document.fileType.toLowerCase();t.document.fileType=e,t.document.title=this.modifiedFileName,t.editorConfig.mode=this.operationMode,t.editorConfig.lang=this.$language.current,t.document=Object.assign(Object.assign({},t.document),{permissions:{download:!0,edit:!0}}),t.documentType=this.getCorrectEditorType(`.${e}`),t.events={onAppReady:this.onR7EditorReady.bind(this)}}return this.loading=!1,t}))}onR7EditorReady(){this.iframe=document.querySelector('iframe[name="frameEditor"]')}saveFileViaR7(){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.SaveFileViaR7Command(new Vi.GY(this.config.document.key));e&&!e.value.error?this.$toasted.success(`${this.$gettext("Файл успешно сохранен")}`):(this.$log.error(e),this.$toasted.error(`${this.$gettext("Произошла ошибка сохранения файла")}`))}))}showError(e){let t=this.$gettext("Не удалось выполнить операцию. Попробуйте позже."),n=!1;if(e&&(e instanceof Ne.$Q?(t=e.error?e.error.message:t,n=e.error.notDisplayError):t=e.message),this.$log.error(t),!n)return this.queryBus.exec(new gn.m(this.$gettext("Внимание!"),t))}reloadEditor(e){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.docEditor&&this.docEditor.destroyEditor(),this.config||(this.config=yield this.getR7EditorFileConfig(e)),this.correctingConfig(),this.docEditor=new window.DocsAPI.DocEditor("placeholder",this.config)}))}reloadFile(e){return fileEditorvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.config=null,this.operationMode="view",yield this.unlockFile(e),yield this.updateDocumentFiles()}))}correctingConfig(){"view"===this.operationMode&&"view"!==this.config.editorConfig.mode?this.config.editorConfig.mode="view":"edit"===this.operationMode&&this.config.document.permissions.edit&&(this.config.editorConfig.mode="edit")}get fileRights(){return this.documentFiles&&this.documentFiles.rights}get extentionFileIcon(){if(!this.activeFile)return"";const e=this.activeFile.fileExtension||(0,fs.mD)(this.activeFile.fullFileName);return Ot.C.extentionSvgIcon(e)}get isLastVersion(){var e,t;return(null===(e=this.activeVersion)||void 0===e?void 0:e.id)===(null===(t=this.activeFile)||void 0===t?void 0:t.id)}get numberVersionTitle(){var e;if("boolean"===typeof this.isLastVersion&&!this.isLastVersion)return`(версия ${null===(e=this.activeVersion)||void 0===e?void 0:e.majorVersion})`}};fileEditorvue_type_script_lang_js_decorate([(0,rt.Prop)(),fileEditorvue_type_script_lang_js_metadata("design:type",Object)],hu.prototype,"file",void 0),fileEditorvue_type_script_lang_js_decorate([(0,rt.Prop)(),fileEditorvue_type_script_lang_js_metadata("design:type",Object)],hu.prototype,"document",void 0),fileEditorvue_type_script_lang_js_decorate([(0,rt.Prop)(),fileEditorvue_type_script_lang_js_metadata("design:type",Object)],hu.prototype,"card",void 0),fileEditorvue_type_script_lang_js_decorate([(0,rt.Prop)(),fileEditorvue_type_script_lang_js_metadata("design:type",Object)],hu.prototype,"context",void 0),fileEditorvue_type_script_lang_js_decorate([(0,rt.Prop)(),fileEditorvue_type_script_lang_js_metadata("design:type",Boolean)],hu.prototype,"mobile",void 0),fileEditorvue_type_script_lang_js_decorate([(0,rt.Prop)(),fileEditorvue_type_script_lang_js_metadata("design:type",Object)],hu.prototype,"cardId",void 0),fileEditorvue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),fileEditorvue_type_script_lang_js_metadata("design:type",Object)],hu.prototype,"commandBus",void 0),fileEditorvue_type_script_lang_js_decorate([(0,fa.p$)("SaveFileViaR7Command"),fileEditorvue_type_script_lang_js_metadata("design:type",Object)],hu.prototype,"SaveFileViaR7Command",void 0),fileEditorvue_type_script_lang_js_decorate([(0,Ge.O)("currentUser"),fileEditorvue_type_script_lang_js_metadata("design:type",Object)],hu.prototype,"currentUser",void 0),fileEditorvue_type_script_lang_js_decorate([(0,rt.Watch)("file",{immediate:!0}),fileEditorvue_type_script_lang_js_metadata("design:type",Function),fileEditorvue_type_script_lang_js_metadata("design:paramtypes",[]),fileEditorvue_type_script_lang_js_metadata("design:returntype",void 0)],hu.prototype,"onFileChange",null),fileEditorvue_type_script_lang_js_decorate([(0,rt.Watch)("operationMode"),fileEditorvue_type_script_lang_js_metadata("design:type",Function),fileEditorvue_type_script_lang_js_metadata("design:paramtypes",[]),fileEditorvue_type_script_lang_js_metadata("design:returntype",void 0)],hu.prototype,"onOperationModeChange",null),fileEditorvue_type_script_lang_js_decorate([(0,rt.Watch)("documentFiles.files"),fileEditorvue_type_script_lang_js_metadata("design:type",Function),fileEditorvue_type_script_lang_js_metadata("design:paramtypes",[Array,Array]),fileEditorvue_type_script_lang_js_metadata("design:returntype",void 0)],hu.prototype,"onFilesChange",null),fileEditorvue_type_script_lang_js_decorate([(0,rt.Watch)("documentFiles"),fileEditorvue_type_script_lang_js_metadata("design:type",Function),fileEditorvue_type_script_lang_js_metadata("design:paramtypes",[Object,Object]),fileEditorvue_type_script_lang_js_metadata("design:returntype",void 0)],hu.prototype,"onDocumentFilesChange",null),fileEditorvue_type_script_lang_js_decorate([(0,rt.Watch)("activeFile"),fileEditorvue_type_script_lang_js_metadata("design:type",Function),fileEditorvue_type_script_lang_js_metadata("design:paramtypes",[]),fileEditorvue_type_script_lang_js_metadata("design:returntype",void 0)],hu.prototype,"onActiveFileChange",null),hu=fileEditorvue_type_script_lang_js_decorate([(0,gt.default)({components:{"file-version-viewer":uu.Z}})],hu);const mu=hu,fu=mu;var gu=(0,Ct.Z)(fu,fileEditorvue_type_template_id_c793a478_render,cu,!1,null,null,null);const yu=gu.exports;_t()(gu,{VBtn:g.Z,VCard:D.Z,VCardText:R.ZB,VCardTitle:R.EB,VCol:r.Z,VContainer:pe.Z,VIcon:y.Z,VRow:a.Z});var vu,bu=n(70178),Cu=n(80141),instructionTreevue_type_template_id_326b357a_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"no-gutters"},[n("loader",{attrs:{options:{transparent:!0,global:!1,size:e.circleSize},visible:Boolean(e.loading)}}),e._v(" "),e.loading?n("div",{staticClass:"emptybox"},[n("span",[e._v(e._s(e.$gettext("Идёт загрузка дерева сообщений...")))])]):e._e(),e._v(" "),e.hasTreeData||e.loading?e._e():n("div",{staticClass:"emptybox"},[n("span",{staticClass:"emptybox-text"},[e._v(e._s(e.$gettext("Дерево сообщений отсутствует")))])]),e._v(" "),e.hasTreeData?n("div",{staticClass:"item-tree__container"},[e.isRoot&&!e.wasSearched&&e.searchedMode?n("div",{staticClass:"no-gutters fold-unfold-block search",staticStyle:{position:"relative",left:"0",bottom:"0"}},[n("div",[n("v-text-field",{staticClass:"pl-0 small-input sm-text wshSearchField",attrs:{autocomplete:"off",name:"statsearch"+e.id,text:"","single-line":"",outlined:"",clearable:"","hide-details":"","prepend-inner-icon":"search",id:"statsearch"+e.id,autofocus:""},model:{value:e.searchingText,callback:function(t){e.searchingText=t},expression:"searchingText"}})],1)]):e._e(),e._v(" "),e.isRoot?n("div",{staticStyle:{height:"35px",display:"flex","align-items":"center"}},[n("span",{staticClass:"mx-2 fold-unfold-tree",on:{click:e.foldAll}},[e._v(e._s(e.$gettext("Свернуть все")))]),e._v(" "),n("span",{staticClass:"mx-2 fold-unfold-tree",on:{click:e.unfoldAll}},[e._v(e._s(e.$gettext("Развернуть все")))]),e._v(" "),n("span",{staticClass:"mx-2 fold-unfold-tree",class:{"font-weight-bold":e.rootSearchedMode},on:{click:e.showFilter}},[e._v(e._s(e.$gettext("Найти")))])]):e._e(),e._v(" "),e.hasActions&&e.hasDocument&&e.displayMainInstructionFeature?n("v-row",{staticClass:"mb-3",attrs:{"no-gutters":""}},[e.isMainMessage&&e.hasMainMessage?n("span",{staticClass:"mx-2 fold-unfold-tree",on:{click:e.goToMainMessage}},[e._v("\n        "+e._s(e.$gettext("Перейти к главному сообщению"))+"\n      ")]):e._e(),e._v(" "),e.isMainMessage&&e.hasMainMessage&&!e.isEditControlField?n("span",{staticClass:"mx-2 fold-unfold-tree",on:{click:e.changeResponsible}},[e._v("\n        "+e._s(e.$gettext("Изменить ответственного"))+"\n      ")]):e._e(),e._v(" "),e.isMainMessage&&e.hasMainMessage&&!e.isEditControlField?n("span",{staticClass:"fold-unfold-tree",on:{click:e.addCoExecutor}},[e._v("\n        "+e._s(e.$gettext("Добавить соисполнителя"))+"\n      ")]):e._e()]):e._e(),e._v(" "),e.hasActions&&e.hasMainMessage&&e.isMainMessage?n("div",{staticClass:"control mx-2"},[n("div",{staticClass:"control__item"},[n("card-combobox",{attrs:{mobile:e.isMobile,label:"Контроль","vocabulary-name":"GRK_CONTROLTYPEVOC","persistent-hint":"",disabled:e.isEditControlPage,multiselect:!1},model:{value:e.Control,callback:function(t){e.Control=t},expression:"Control"}})],1),e._v(" "),n("div",{staticClass:"control__item"},[n("card-datepicker",{attrs:{mobile:e.isMobile,"min-date":e.currentDate,"can-clear":!1,disabled:e.isEditControlPage,label:"Исполнить до"},on:{input:e.updateDate},model:{value:e.ErcExecDateTime,callback:function(t){e.ErcExecDateTime=t},expression:"ErcExecDateTime"}})],1),e._v(" "),n("div",{staticClass:"control__item"},[n("card-datepicker",{attrs:{mobile:e.isMobile,disabled:e.isEditControlPage,label:"Дата выполнения"},model:{value:e.ErcExecDateTimeComp,callback:function(t){e.ErcExecDateTimeComp=t},expression:"ErcExecDateTimeComp"}})],1)]):e._e(),e._v(" "),e._l(e.treeData,(function(t,i){return n("v-row",{key:"instruction-"+i,staticClass:"tree no-gutters mb-2",staticStyle:{position:"relative"}},[n("span",{attrs:{id:"searchpref"+t.id}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isFirstSearched&&e.rootSearchedMode,expression:"item.isFirstSearched && rootSearchedMode"}],staticClass:"no-gutters fold-unfold-block search"},[n("div",[n("v-text-field",{staticClass:"pl-0 small-input sm-text wshSearchField",attrs:{autocomplete:"off",id:"searchinput"+t.id,name:"searchinput"+t.id,placeholder:" ",text:"","hide-details":"","single-line":"",outlined:"",clearable:"","prepend-inner-icon":"search",autofocus:""},on:{"click:clear":e.clearInput,keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.moveArrowBottom(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.moveArrowTop(t)}]},model:{value:t.root.searchingText,callback:function(n){e.$set(t.root,"searchingText",n)},expression:"item.root.searchingText"}})],1),e._v(" "),n("ul",{staticClass:"arrows-block"},[n("li",{staticClass:"arrow",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.moveArrowBottom(t)},click:e.moveArrowBottom}},[n("v-icon",{staticClass:"material-icons mb-0 grey--text",staticStyle:{transform:"rotate(-90deg)"},attrs:{size:"20"}},[e._v("arrow_back")])],1),e._v(" "),n("li",{staticClass:"arrow",staticStyle:{"padding-left":"8px"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.moveArrowTop(t)},click:e.moveArrowTop}},[n("v-icon",{staticClass:"material-icons mb-0 grey--text",staticStyle:{transform:"rotate(-90deg)"},attrs:{size:"20"}},[e._v("arrow_forward")])],1)]),e._v(" "),n("span",{staticClass:"search-steps"},[e._v(e._s(e.searchSteps))]),e._v(" "),n("li",{staticClass:"arrow",staticStyle:{"padding-left":"10px","padding-right":"5px"},on:{click:e.showFilter}},[n("v-icon",{staticClass:"material-icons mb-0 grey--text",attrs:{size:"20"}},[e._v("clear")])],1)]),e._v(" "),t.items.length&&t.id<0?n("v-col",{staticClass:"root-info font-weight-regular",class:{"mt-2 mb-2":e.isRedirectedParent(t)},attrs:{cols:"12"}},[t.id<0&&t.parent?[n("span",[n("v-icon",{staticClass:"redirected"},[e._v("call_missed_outgoing")])],1)]:e._e(),e._v(" "),n("span",{domProps:{innerHTML:e._s(e.highlight(t.instruction.instructionTypeName,t.searchedText,t))}}),e._v(" "),t.instruction.creatorName?[n("span",[e._v("от")]),e._v(" "),n("span",{domProps:{innerHTML:e._s(e.highlight(t.instruction.creatorName,t.searchedText,t))}})]:e._e(),e._v(" "),n("br"),e._v(" "),n("span",{domProps:{innerHTML:e._s(e.highlight(e.printSendType(t.instruction.sendTypeIdx),t.searchedText,t))}})],2):e._e(),e._v(" "),n("v-col",{staticStyle:{position:"relative",width:"100%"},attrs:{cols:"12"}},[e.showLine(t,i)&&e.treeData.length>1?n("div",{staticClass:"tree-line"}):e._e(),e._v(" "),t.items.length?n("v-icon",{directives:[{name:"show",rawName:"v-show",value:t.id<0&&!e.treeNodeState[i],expression:"item.id < 0 && !treeNodeState[index]"}],staticClass:"tree-collapse-button",attrs:{size:"16"},on:{click:function(n){return e.toggleNodes(i,t)}}},[e._v("add\n        ")]):e._e(),e._v(" "),t.items.length?n("v-icon",{directives:[{name:"show",rawName:"v-show",value:t.id<0&&e.treeNodeState[i],expression:"item.id < 0 && treeNodeState[index]"}],staticClass:"tree-collapse-button",attrs:{size:"16"},on:{click:function(n){return e.toggleNodes(i,t)}}},[e._v("\n          remove\n        ")]):e._e(),e._v(" "),t.isReport?e._e():n("v-row",{class:{"mb-2 redirected-item":e.isRedirectedParent(t)},attrs:{"no-gutters":""}},[t.id>0&&!t.isReport?n("v-col",[n("div",{staticStyle:{"margin-top":"-8px"}},[n("div",{staticClass:"mb-2"},[n("v-tooltip",{attrs:{left:"","max-width":"250px"},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("span",e._g({},o),[n("v-avatar",{staticClass:"report-circle",attrs:{color:e.changeCircleColor(t),size:"12"}},[e.innerAvatarColor(t)?n("v-avatar",{attrs:{size:"10",color:"white"}}):e._e()],1)],1)]}}],null,!0)},[e._v(" "),n("span",{staticClass:"white--text"},[e._v(e._s(t.instruction.stateName))])])],1),e._v(" "),e.currentUser?n("v-row",{staticClass:"pl-2 pt-1 mt-3 ml-2 mb-1 no-gutters",class:e.stylesItemMessage(t),staticStyle:{"padding-right":"5px","padding-bottom":"5px"}},[n("v-col",{attrs:{cols:"10"}},[n("v-row",{staticClass:"ml-1 pt-1",attrs:{"no-gutters":""},on:{mouseenter:function(n){return e.onReceiverHover(t)}}},[n("div",{staticClass:"root-info__message-text"},[n("v-icon",{staticClass:"primary--text pr-1",class:{"primary--text":!e.isProjectMessage(t.instruction),"grey--text":e.isProjectMessage(t.instruction)},staticStyle:{"align-self":"start"},attrs:{size:"19"}},[e._v("\n                        email\n                      ")]),e._v(" "),n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.receiverInfoTooltip},expression:"{ content: receiverInfoTooltip }"}],staticClass:"receiver",class:{"primary--text":!e.isProjectMessage(t.instruction),"grey--text":e.isProjectMessage(t.instruction)},domProps:{innerHTML:e._s(e.highlight(t.instruction.receiverName,t.searchedText,t))}}),e._v(" "),e.respReceiverHintName(t)?n("span",{domProps:{innerHTML:e._s(e.highlight(e.respReceiverHintName(t),t.searchedText,t))}}):e._e(),e._v(" "),n("span",{staticClass:"px-2 grey--text"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text root-info__message-text"},[e._v("\n                        Создан: "+e._s(e.instructionCreateDateString(t))+"\n                      ")]),e._v(" "),null==t.instruction.executionEndDate||e.isTimeDisplayed(t.instruction)?e._e():n("span",{class:{"error--text":e.isOverdue,"grey--text lighten":!e.isOverdue}},[n("svg-icon",{staticClass:"svg-icon darken-3",class:{"error--text":e.isOverdue,"grey--text lighten":!e.isOverdue},staticStyle:{transform:"translate3d(0px, 5px, 0px)","margin-left":"8px"},attrs:{icon:"event"}}),e._v("\n                        "+e._s(e.instructionEndDateString)+"\n                      ")],1)],1)]),e._v(" "),n("v-row",{staticClass:"ml-1",attrs:{"no-gutters":""}},e._l(t.items,(function(t){return n("div",{key:t.id},[n("div",{staticClass:"font-italic pr-1"},[n("span",{attrs:{title:t.instruction.reportText}},[t.instruction.reportText&&t.instruction.reportText.trim()?n("i",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("\n                            Ответ:\n                          ")]):e._e(),e._v("\n                          "+e._s(e._f("truncate")(t.instruction.reportText))+"\n                        ")])]),e._v(" "),t.instruction.reportID&&t.instruction.reportERCName?n("div",{staticClass:"pr-1 font-italic"},[n("span",{attrs:{title:t.instruction.reportERCName}},[n("i",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v(" Ответный-документ: ")]),e._v("\n                          "+e._s(t.instruction.reportERCName)+"\n                        ")])]):e._e()])})),0)],1),e._v(" "),n("v-col",{staticClass:"ml-auto",staticStyle:{display:"flex","align-self":"flex-start !important"},attrs:{cols:"auto","align-self":"end"}},[e.shouldBeShownMainMessage(t)&&e.isMainMessage?n("v-btn",{staticClass:"elevation-0 rounded-button mx-1",attrs:{icon:"","x-small":"",color:"grey lighten-3"},on:{click:function(n){return e.onChangeMainMessage(t,i)}}},[n("v-icon",{staticStyle:{transform:"scaleX(0.63) scaleY(0.75)"},attrs:{color:e.stylesIconMainMessage(t)}},[e._v("\n                      star\n                    ")])],1):e._e(),e._v(" "),e.actionContext.isDialog?e._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(o){var s=o.on;return[e.isOpenReportIconVisible(t)?n("v-btn",e._g({staticClass:"elevation-0 mr-0 ml-2 square-sm-button",class:e.activeIcon===i+"open-report"?"grey--text darken-3":"transparent",attrs:{icon:""},on:{click:function(n){return e.onOpenReport(t,i)}}},s),[n("v-icon",{class:e.activeIcon===i+"open-report"?"primary--text":"grey--text darken-3",staticStyle:{height:"13px"},attrs:{small:""}},[e._v("assignment")])],1):e._e()]}}],null,!0)},[e._v(" "),n("translate",[e._v("Открыть отчет в доп. области")])],1),e._v(" "),e.actionContext.isDialog?e._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(o){var s=o.on;return[n("v-btn",e._g({staticClass:"elevation-0 mx-0 square-sm-button",class:e.activeIcon===i+"open-message"?"grey--text darken-3":"transparent",attrs:{icon:"",id:"itOpenMsg"},on:{click:function(n){return e.onOpenMessage(t,i)}}},s),[n("svg-icon",{staticClass:"svg-icon",class:e.activeIcon===i+"open-message"?"primary--text":"grey--text darken-3",attrs:{icon:"chrome_reader_mode"}})],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Открыть сообщение в доп. области")])],1)],1)],1):e._e()],1)]):e._e(),e._v(" "),t.items.length?n("v-col",{attrs:{cols:"12"}},[n("instruction-tree",{directives:[{name:"show",rawName:"v-show",value:e.treeNodeState[i],expression:"treeNodeState[index]"}],staticClass:"item-tree",class:{"report-message":e.checkForReport(t.items)},attrs:{id:t.instruction.id,"sub-tree":!0,root:t.root,"action-context":e.actionContext,instructionChild:t.items,"has-actions":!1,"instruction-list-visibility":e.instructionListVisibility}})],1):e._e()],1)],1)],1)}))],2):e._e()],1)},wu=[],instructionTreevue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},instructionTreevue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},instructionTreevue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const _u="update-counter",xu="searchinput";let Su=0,Iu=vu=class InstructionTreeComponent extends rt.Vue{constructor(){super(...arguments),this.Control=null,this.ErcExecDateTime=null,this.ErcExecDateTimeComp=null,this.foldedTree=!1,this.folderOpened=!1,this.treeData=[],this.searchedNodes=[],this.linearTree=[],this.withDeletedNodes=!1,this.needToLoad=!1,this.loading=0,this.searchingText="",this.selection=[],this.treeOptions={category:"items",unique:e=>e.id,css:{TreeView:"tree-view"},strategies:{click:["select","toggle-fold"],selection:["modifiers"],fold:["opener-control","no-child-selection"]},openerOpts:{position:"left"}},this.fetch=!1,this.executionEndDate=null,this.treeNodeState={},this.counter=0,this.activeIcon="",this.displayMainInstructionFeature=this.$config.mainInstructionFeature,this.listMainInstructionFeatureCards=this.$config.mainInstructionFeatureCards,this.currentDate=new Date,this.receiverInfo=null,this.searchedMode=!1,this.UID=++Su,this.searchDebounced=(0,Pl.Z)(this.searchMessages.bind(this),500)}clearAndReload(){this.instructionListVisibility&&this.needToLoad&&this.reload()}onUpdateTreeCounter(){this.reload()}onVisibleChange(){this.clearAndReload()}onIdChanged(){this.id&&(this.$emit(_u,0),this.needToLoad=!0,this.treeData=[],this.nodesState={},this.withDeletedNodes=this.withDeleted,this.clearAndReload())}onWithDeletedNodes(){this.reload()}onTreeDataChange(){var e;if(!this.treeData)return;this.updateFilter();let t=0;this.treeData.forEach((e=>{var n;let i=!!this.instructionChild||this.collapseAll;const o=null!==(n=this.nodesState)&&void 0!==n?n:this.rootOfTree.nodesState;o&&e.id in o&&(i=o[e.id]),this.$set(this.treeNodeState,t,i),t++}));const n=this.findNode(this.treeData,null===(e=this.instructionParent)||void 0===e?void 0:e.id);if(this.markMessage(n),this.isRoot){const e=this.linearTree.filter((e=>this.isDisplayed(e))).length;if(e<10)this.treeData.forEach(((e,t)=>this.toggleNodes(t,e)));else{const e=this.findMainMessageNode(n);if(e){const t=this.treeData.findIndex((t=>{if(t&&e)return t.id===e.id}));this.toggleNodes(t,e)}}}}onFolderOpenedChanged(){this.toggleTreeFolders()}onFolderTreeChanged(){this.toggleTreeFolders()}onContextChanged(){if(this.isRoot){if(!Array.isArray(this.actionContext.document)||!this.actionContext.document.length)return;this.ErcExecDateTime=this.actionContext.document[0].attributes.ErcExecDateTime,this.ErcExecDateTimeComp=this.actionContext.document[0].attributes.ErcExecDateTimeComp}}onControlChanged(e,t){e&&e!==t&&this.updateControl()}onSearch(e,t){this.searchDebounced(e)}created(){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.isRoot&&(this.nodesState={},yield this.checkEditControlRights(),Je.X.$on("app-entity-removed",this.onMessageNotFound))}))}beforeDestroy(){this.isRoot&&Je.X.$off("app-entity-removed",this.onMessageNotFound)}onMessageNotFound(e){const t=this.findNode(this.treeData,e);t&&this.removeNode(t)}removeNode(e){var t;if(!e)return;let n=e.parent;while(n){if(1!==(null===(t=n.items)||void 0===t?void 0:t.length))break;n=n.parent}if(n){const t=n.items.findIndex((t=>t===e));t>=0&&n.items.splice(t,1)}else{let t=-1;t=e.parent?this.treeData.findIndex((t=>t===e.parent)):this.treeData.findIndex((t=>t===e)),t>=0&&this.treeData.splice(t,1)}}updateDate(){if(!Array.isArray(this.actionContext.document)||!this.actionContext.document.length)return;const e=this.actionContext.document[0].attributes.ErcExecDateTime;e&&this.ErcExecDateTime.toDateString()===e.toDateString()||this.execDateUpdate(this.ErcExecDateTime,e)}execDateUpdate(e,t){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e)return;const n=yield this.queryBus.exec(new Zt.l("",this.$gettext('Вы действительно хотите изменить значение поля "Исполнить до"?')));if(!n)return this.ErcExecDateTime=t;yield this.changeEndDate(),yield this.updateControl(),this.reload()}))}changeEndDate(){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.hasDocument)return;this.loading++;const e=new Ne.O0("UpdateDocInstructionsScript",`{"DocumentId":${this.actionContext.document[0].id},\n      "JournalId":${this.actionContext.document[0].journalID},\n      "ExecutionEndDate":"${this.ErcExecDateTime.toISOString()}"}`);yield this.commandBus.exec(e),this.isEndDateChanged=!0,this.loading--}))}saveDocument(e){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{this.loading++;const[t]=this.actionContext.document;if(!t)return;yield this.commandBus.exec(new Dt.WX(t.id,e,Ue.dS.View))}finally{this.loading--}}))}updateControl(){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e={CONTROL:this.Control,ErcExecDateTime:this.ErcExecDateTime,ErcExecDateTimeComp:this.ErcExecDateTimeComp};yield this.saveDocument(e)}))}checkEditControlRights(){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.hasDocument){const e=yield this.queryBus.exec(new He.RF(this.actionContext.document[0].journalID));e.rights.includes(du.K.CanEditControlFields)?this.isEditControlField=!1:this.isEditControlField=!0,e.rights.includes(du.K.CanEditControlPage)?this.isEditControlPage=!1:this.isEditControlPage=!0}}))}reload(){var e;return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.treeData=[],this.loading++,this.$emit(_u,0),this.$emit("update-loading",!0);try{if(this.instructionChild)this.treeData=this.instructionChild;else{let t=null;this.isDocument?t=new He.kb(`${this.id}`,this.withDeletedNodes,!1,this.UID):this.isInstruction&&(t=new He.kb(String(null===(e=this.instructionParent)||void 0===e?void 0:e.baseDocumentID),this.withDeletedNodes,!1,this.UID)),this.cancellationService.cancel(Ae.M.DocumentInstructionsQuery,this.UID);const n=yield this.fetchDocInstructionsTree(t);this.treeData=this.dataToTree(n)}this.isEndDateChanged?this.countMessages():(this.countMessages(),this.setControl()),this.needToLoad=!1,this.$emit(_u,this.counter)}catch(e){this.$log.error(e)}finally{this.loading--,this.$emit("update-loading",!1)}}))}setControl(){if(this.hasDocument){const e=this.actionContext.document[0].attributes;this.Control=e.CONTROL}}onChangeMainMessage(e){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=this.isActiveMainMessage(e);if(t)return;const n=yield this.queryBus.exec(new Zt.l("",this.$gettext("Изменить главное сообщение?")));if(!n)return;const[i]=this.actionContext.document;if(!i)throw new Error("Нет документа-основания");i.attributes.ErcExecDateTime=e.instruction.executionEndDate?new Date(e.instruction.executionEndDate):null,i.attributes.MainMailID=e.instruction.id;const o={ErcExecDateTime:i.attributes.ErcExecDateTime,MainMailID:i.attributes.MainMailID};this.rootOfTree.ErcExecDateTime=i.attributes.ErcExecDateTime,this.saveDocument(o)}))}sendMessage(e,t){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{let n=0;this.hasDocument&&(n=this.actionContext.document[0].attributes.ID);const{instruction:{text:i,subject:o,comment:s,execAuditorID:r,initiatorID:a,reportReceiverID:l,startDate:c,instructionTypeID:d,execInterval:u,control:p}}=t,h=new un.ud({instructionTypeId:d,documentId:n,sendType:0,reportToExecutive:!1,withExecutive:!1,control:p,mainInstruction:{receiverID:e,text:i,subject:o,comment:s,execAuditorID:r,initiatorID:a,reportReceiverID:l,startDate:c,execInterval:u,execIntervalType:t.instruction.execIntervalType,control:p,instructionTypeInfo:null}});return yield this.commandBus.exec(h)}catch(e){this.$log.error(e)}}))}changeResponsible(){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.hasMainMessage)return void(yield this.queryBus.exec(new gn.m(this.$gettext("Ошибка"),this.dontHasMainMessageText)));const e=new Nl.B(this.$gettext("Выбрать ответственного"),!1,[Nn.OP.User],[],this.mainMailInstruction.instruction.instructionTypeID,!0),t=yield this.queryBus.exec(e);if(!t||!t.length)return;const n=yield this.commandBus.exec(new Ne.lF("DOCUMENT_101","GRK_CNGMAINRECEIVER",[{type:"String",name:"ParamString",value:`${this.id},${t[0].id}`}]));let i;if(n){if(n&&"1"===n.value.outputParameters[0].value){const e=[];if(this.treeData.forEach((t=>{t.data.children.forEach((n=>{n.instruction.id!==this.hasMainMessage||e.length||e.push(t.data.children)}))})),e.length){const n=e[0].find((e=>e.instruction.receiverID===t[0].id));i=n?n.instruction.id:this.hasMainMessage}this.$toasted.success("Ответственный исполнитель успешно изменен")}if(n&&"0"===n.value.outputParameters[0].value){const e=yield this.sendMessage(t[0].id,this.mainMailInstruction);if(!e||e.isFailure)return void(yield this.queryBus.exec(new gn.m("",this.$gettext("Ошибка отправки сообщений"))));i=e.value.success.instructionId;const n=yield this.commandBus.exec(new Ne.lF("DOCUMENT_101","GRK_ADDNEWRECEIVER_InDocument",[{type:"String",name:"newMailID",value:i},{type:"String",name:"oldMainMailID",value:this.hasMainMessage}]));if(!n)return void(yield this.queryBus.exec(new gn.m("",this.$gettext("Ошибка добавления ответственного исполнителя"))))}Array.isArray(this.actionContext.document)&&this.actionContext.document.length&&(this.actionContext.document[0].attributes.MainMailID=i),this.reload()}else yield this.queryBus.exec(new gn.m("",this.$gettext("Ошибка изменения ответственного исполнителя")))}))}addCoExecutor(){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.hasMainMessage)return void(yield this.queryBus.exec(new gn.m(this.$gettext("Ошибка"),this.dontHasMainMessageText)));const e=new Nl.B(this.$gettext("Выбрать сооисполнителя"),!1,[Nn.OP.User],[],this.mainMailInstruction.instruction.instructionTypeID,!0),t=yield this.queryBus.exec(e);if(!t||!t.length)return;const n=yield this.commandBus.exec(new Ne.lF("DOCUMENT","GRK_SP_ADD_CORECEIVERS",[{type:"String",name:"pDocID",value:`${this.id}`},{type:"String",name:"pCoReceiverIDs",value:`${t[0].id}`},{type:"String",name:"pMainMailID",value:`${this.hasMainMessage}`},{type:"String",name:"pUserID",value:`${this.currentUser.id}`},{type:"String",name:"pCodeEvent",value:"123"},{type:"String",name:"pCodeEventDel",value:"123"}]));!n||n.value&&"1"===n.value.outputParameters[0].value?yield this.queryBus.exec(new gn.m(this.$gettext("ОК"),this.$gettext("Ошибка добавления исполнителя"))):this.reload()}))}foldAll(){this.folderOpened=!this.folderOpened,this.foldedTree=!1}unfoldAll(){this.foldedTree=!0}goToMainMessage(){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=Object.assign(Object.assign({},this.actionContext),{entityViewMode:Ue.dS.View}),t=this.hasMainMessage;t?this.$app.view(e,Ue.zc.Instruction,null,String(t)):yield this.queryBus.exec(new gn.m(this.$gettext("Ошибка"),this.dontHasMainMessageText))}))}isActiveMainMessage(e){const t=this.hasMainMessage;if(t)return Number(t)===Number(e.instruction.id)}stylesIconMainMessage(e){return this.isActiveMainMessage(e)?"primary":"grey darken-2"}stylesItemMessage(e){const t=["lighten-5-2"];return e.isMarkedMessage?(t.push("markedMessage"),t):(this.isActiveMainMessage(e)&&this.displayMainInstructionFeature?t.push("blue"):t.push("grey"),t)}shouldBeShownMainMessage(e){return!(this.isInstruction||!this.displayMainInstructionFeature)&&(e.instruction.useControl&&"ResponsibleExecutor"===e.instruction.respReceiverResName)}toggleTreeFolders(){Object.keys(this.treeNodeState).forEach((e=>{this.treeNodeState[Number(e)]=this.foldedTree}))}countMessages(){this.counter=this.messageCount(this.treeData)}checkForReport(e){return e.some((e=>e.isReport))}changeReceiver(){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=Object.assign(Object.assign({},this.actionContext),{entityViewMode:Ue.dS.View}),t=this.hasMainMessage,n=this.currentUser.id;try{this.loading++;const i=yield this.commandBus.exec(new un.mH(t,n));this.$app.editInstruction(i.value.response.instructionId,e)}finally{this.loading--}}))}messageCount(e){if(!Array.isArray(e))return;let t=0;return e.forEach((e=>{e.id>0&&e.instructionTypeName!==this.$gettext("Отчет")&&t++,e.items.length>0&&(t+=this.messageCount(e.items))})),t}showName(e){return this.isMobile?uc.X.userNameShorting(e.instruction.receiverName):e.instruction.receiverName}onReceiverHover({instruction:{receiverID:e}}){return instructionTreevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.receiverInfo=yield this.fetchUserInfo(new Ze.O7(e))}))}toggleNodes(e,t){var n;this.treeNodeState[e]=!this.treeNodeState[e];const i=null!==(n=this.nodesState)&&void 0!==n?n:this.rootOfTree.nodesState;i[t.id]=this.treeNodeState[e]}toggleSubtreeWithSearched(){this.linearTree.forEach((e=>{const t=this.findMainMessageNode(e),n=this.treeData.findIndex((e=>{if(e&&t)return e.id===t.id}));!1===e.isMarkedMessage?this.treeNodeState[n]=!1:this.treeNodeState[n]=!0})),this.searchedNodes.forEach((e=>{const t=this.findMainMessageNode(e),n=this.treeData.findIndex((e=>{if(e&&t)return e.id===t.id}));this.treeNodeState[n]=!0}))}updateFilter(){this.linearTree=[],this.searchedNodes=[],this.searchingText="",this.treeToLine(this.treeData),this.searchedMode=!1}clearInput(e){e="",this.searchMessages(e)}highlight(e,t,n){if(t.length<1||""===n.searchedText)return e;if(this.rootSearchedMode){const i=new RegExp(t,"ig");return!0===n.isFirstSearched?e.replace(i,((e,t,n)=>'<mark style="background-color:orange;font-weight: bold;">'+e+"</mark>")):e.replace(i,((e,t,n)=>"<mark>"+e+"</mark>"))}return e}scrollToSearchSpanOf(e){if(e){const t=this.$el.querySelector(`#searchpref${String(e.id)}`);if(t)t.scrollIntoView({block:"center"});else{const t=this.rootOfTree.$el.querySelector(`#searchpref${String(e.id)}`);t&&t.scrollIntoView({block:"center"})}}}searchMessages(e){const t=this.rootOfTree;if(t.searchedNodes=[],(null===e||void 0===e?void 0:e.length)>0)t.lineSearch(e,t);else{t.linearTree.forEach((e=>{e.isFirstSearched=!1,e.isSearched=!1,e.searchedText=""}));const e=t.$el.querySelector(`#statsearch${String(t.id)}`);e&&e.scrollIntoView({block:"center"})}t.toggleSubtreeWithSearched(),t.searchingText=e;const n=t.searchedNodes.find((e=>e.isFirstSearched));if(n){const e=this.$el.querySelector(`#${xu+String(n.id)}`);this.focusOnElem(e),t.scrollToSearchSpanOf(n)}}treeToLine(e){for(let t=0;t<e.length;t++)e[t].isSearched=!0,this.linearTree.push(e[t]),Array.isArray(e[t].items)&&e[t].items.length>0&&this.treeToLine(e[t].items)}lineSearch(e,t){const n=t.linearTree.find((e=>e.isFirstSearched));t.linearTree.forEach((n=>{n.isFirstSearched=!1,this.isSearchedInNode(n,e)?(n.searchedText=e,n.isSearched=!0,t.searchedNodes.push(n)):(n.searchedText="",n.isSearched=!1)})),n&&n.searchedText.length>0&&((null===n||void 0===n?void 0:n.searchedText.includes(this.searchingText))||this.searchingText.includes(null===n||void 0===n?void 0:n.searchedText))?n.isFirstSearched=!0:t.searchedNodes.length&&(t.searchedNodes[0].isFirstSearched=!0)}isSearchedInNode(e,t){return!!this.isDisplayed(e)&&this.searchRuleResult(e,t)}searchRuleResult(e,t){return e.id<0?this.ruleCommander(e,t,this.notLeafRule.bind(this)):this.ruleCommander(e,t,this.leafRule.bind(this))}ruleCommander(e,t,n){const i=t.toLowerCase();return n(e,i)}leafRule(e,t){var n,i;return(null===(i=null===(n=null===e||void 0===e?void 0:e.instruction)||void 0===n?void 0:n.receiverName)||void 0===i?void 0:i.toLowerCase().lastIndexOf(t))>=0||this.respReceiverHintName(e.instructionInfo).toLowerCase().lastIndexOf(t)>=0}notLeafRule(e,t){var n,i,o,s;return(null===(i=null===(n=null===e||void 0===e?void 0:e.instruction)||void 0===n?void 0:n.instructionTypeName)||void 0===i?void 0:i.toLowerCase().lastIndexOf(t))>=0||(null===(s=null===(o=null===e||void 0===e?void 0:e.instruction)||void 0===o?void 0:o.creatorName)||void 0===s?void 0:s.toLowerCase().lastIndexOf(t))>=0||this.printSendType(e.instruction.sendTypeIdx).toLowerCase().lastIndexOf(t)>=0}isDisplayed(e){return(5!==e.instruction.state||0!==e.items.length)&&(!(e.id<0&&0===e.items.length)&&((0!==e.items.length||!e.isReport)&&(!(e.id>0&&e.isReport)&&!this.isSomeParentIsReport(e))))}isSomeParentIsReport(e){let t=null===e||void 0===e?void 0:e.parent;while(t){if(t.isReport)return!0;t=null===t||void 0===t?void 0:t.parent}return!1}moveArrowBottom(){const e=0===this.searchedNodes.length?this.rootOfTree.searchedNodes:this.searchedNodes;let t=e.findIndex((e=>e.isFirstSearched));if(t>=0){e[t].isFirstSearched=!1,t++,t>=e.length&&(t=0),e[t].isFirstSearched=!0,this.scrollToSearchSpanOf(e[t]);const n=this.$el.querySelector(`#${xu+String(e[t].id)}`);n&&(this.focusOnElem(n),n.setAttribute("autocomplete","off"))}}moveArrowTop(){const e=0===this.searchedNodes.length?this.rootOfTree.searchedNodes:this.searchedNodes;let t=e.findIndex((e=>e.isFirstSearched));if(t>=0){e[t].isFirstSearched=!1,t--,t<0&&(t=e.length-1),e[t].isFirstSearched=!0,this.scrollToSearchSpanOf(e[t]);const n=this.$el.querySelector(`#${xu+String(e[t].id)}`);n&&(this.focusOnElem(n),n.setAttribute("autocomplete","off"))}}focusOnElem(e){this.$nextTick((()=>{e&&e.focus()}))}showFilter(){this.rootOfTree.searchedMode=!this.rootOfTree.searchedMode}onOpenMessage(e,t){const n=Object.assign(Object.assign({},this.actionContext),{entityViewMode:Ue.dS.View});this.activeIcon=`${t}open-message`;const i=this.activeIcon,callbackOnPanelClose=()=>{i===this.activeIcon&&(this.activeIcon="")};this.$app.view(n,Ue.zc.Instruction,null,String(e.instruction.id),callbackOnPanelClose)}onOpenReport(e,t){this.activeIcon=`${t}open-report`;const n=this.activeIcon,callbackOnPanelClose=()=>{n===this.activeIcon&&(this.activeIcon="")};this.$app.view(this.actionContext,Ue.zc.Instruction,null,String(e.instruction.reportID),callbackOnPanelClose)}changeIconColor(e,t){return this.activeIcon===`${e}${t}`?"primary":"grey darken-3"}isTimeDisplayed(e){return e.createDateTime&&e.state!==Mn.Wd.NotActive&&e.state!==Mn.Wd.Active&&e.state!==Mn.Wd.InWork}isProjectMessage(e){return e.state===Mn.Wd.NotActive||e.state===Mn.Wd.CoExec}printSendType(e){return uc.X.getSentType(e)}respReceiverHintName(e){return"ResponsibleExecutor"===e.instruction.respReceiverResName?this.$gettext("ответственный"):""}instructionCreateDateString(e){var t;return(null===(t=null===e||void 0===e?void 0:e.items[0])||void 0===t?void 0:t.isReport)?Ln.C.shortDateFromISO(e.items[0].instruction.createDateTime):Ln.C.shortDateFromISO(e.instruction.createDateTime)}changeCircleColor(e){return e.instruction.result===this.$gettext("Завершено успешно")?"green":e.instruction.result===this.$gettext("Завершено с отказом")?"red":"CANCELED"===e.instruction.stateNameResName||"MS_READED"===e.instruction.stateNameResName||"MS_DELETED"===e.instruction.stateNameResName||"MS_ACTIVE"===e.instruction.stateNameResName||"MS_INWORK"===e.instruction.stateNameResName||"MS_NOTACTIVE"===e.instruction.stateNameResName||"MS_ACTIVE_REDIRECTED"===e.instruction.stateNameResName||"MS_INWORK_REDIRECTED"===e.instruction.stateNameResName?"grey":""}innerAvatarColor(e){return"MS_ACTIVE"===e.instruction.stateNameResName||"MS_INWORK"===e.instruction.stateNameResName||"MS_NOTACTIVE"===e.instruction.stateNameResName||"MS_ACTIVE_REDIRECTED"===e.instruction.stateNameResName}showLine(e,t){return e.id>0&&"MS_ACTIVE_REDIRECTED"!==e.stateNameResName&&!e.isReport&&t!==this.treeData.length-1}isRedirectedParent(e){var t;return"1"===(null===(t=null===e||void 0===e?void 0:e.parent)||void 0===t?void 0:t.instruction.redirectFlag)}isOpenReportIconVisible(e){var t;return!!(null===e||void 0===e?void 0:e.items)&&(null===(t=null===e||void 0===e?void 0:e.items[0])||void 0===t?void 0:t.isReport)}dataToTree(e){const t=[];for(const n of e)t.push(this.toViewModel(n,null));return t.sort(((e,t)=>this.compareRoots(e,t)))}findNode(e,t){let n=null;for(const i of e){if(i.itemId==t){n=i;break}if(n=this.findNode(i.items,t),n)break}return n}findMainMessageNode(e){return(null===e||void 0===e?void 0:e.parent)?this.findMainMessageNode(e.parent):e}markMessage(e){e&&(e.isReport?e.parent.isMarkedMessage=!0:e.isMarkedMessage=!0)}compareRoots(e,t){const n=e.instruction,i=t.instruction;return n.createDateTime<i.createDateTime?-1:1}toViewModel(e,t){const n=e.type===Mn.up.GroupNode;let i="",o="",s="",r=!1,a="",l=!1,c="";n?(i=e.instruction.instructionTypeName||"",o=(e.instruction.subject?`"${e.instruction.subject}"`:"")+(e.instruction.stateName?` [${e.instruction.stateName}]`:"")):e.instruction&&(i=e.instruction.receiverName||"",o=e.instruction.executionEndDate?this.$gettextInterpolate(this.$gettext("Исполнить до: %{date}"),{date:(0,Ws.v)(e.instruction.executionEndDate)}):"",s=(e.instruction.creatorName?this.$gettextInterpolate(this.$gettext("От: %{creator}"),{creator:e.instruction.creatorName}):"")+(e.instruction.createDateTime?this.$gettextInterpolate(this.$gettext("Дата отправки: %{sendDate}"),{sendDate:(0,Ws.v)(e.instruction.createDateTime)}):""),r=this.id===Number(e.instruction.id),a=e.instruction.instructionTypeName,l=instructionIsReport(e.instruction.instructionTypeID),c=e.instruction.id);const d=this.mappedIcon(e)||"",u={instruction:e.instruction,permissions:null,parentControlInstruction:null,instructionType:null},p=this.root||this,h={id:e.nodeId,itemId:n?0:c,data:e,parentFolderID:e.parentId,text1:i,text2:o,text3:s,isGroup:n,instructionTypeName:a,isReport:l,instruction:e.instruction,spriteCssClass:d,expanded:!1,selected:r,items:null,instructionInfo:u,root:p,parent:t,isMarkedMessage:!1,searchedText:"",isFirstSearched:!1,isSearched:!1};return h.items=e.children.map((e=>this.toViewModel(e,h))),h.selected&&this.selection.push(),h}mappedIcon(e){const t=e.type===Mn.up.GroupNode;return t?1===e.children.length?"k-sprite node":Ot.C.toSentTypeSprite(e.instruction.sendTypeIdx):Ot.C.toStateSprite(e.instruction.stateNameResName)||"fun"}get isRoot(){return!this.root}get rootSearchedMode(){return this.rootOfTree.searchedMode}get isOverdue(){if(this.treeData.length&&this.treeData[0].data.instruction.executionEndDate){const e=new Date;if(this.executionEndDate=new Date(this.treeData[0].data.instruction.executionEndDate),e>=this.executionEndDate)return!0}}get instructionEndDateString(){return Ln.C.shortDateFromISO(this.executionEndDate)}get isInstruction(){return this.actionContext.contentType===Ue.zc.Instruction}get searchSteps(){const e=0===this.searchedNodes.length?this.rootOfTree.searchedNodes:this.searchedNodes,t=e.findIndex((e=>e.isFirstSearched))+1;return String(t)+"/"+String(e.length)}get isDocument(){return this.actionContext.contentType===Ue.zc.Document}get hasTreeData(){return this.treeData.length>0}get hasMainMessage(){return this.hasDocument&&this.actionContext.document[0].attributes.MainMailID}get hasDocument(){return this.actionContext&&Boolean(this.actionContext.document)&&Boolean(this.actionContext.document[0])}get mainMailInstruction(){if(!this.hasMainMessage)return;const e=[];return this.treeData.forEach((({items:t})=>t.forEach((t=>e.push(t))))),e.find((({id:e})=>e===Number(this.hasMainMessage)))}get isMainMessage(){const e=this.hasDocument?this.actionContext.document[0].cardId:null;if(e)return this.displayMainInstructionFeature&&this.listMainInstructionFeatureCards.includes(Number(e))}get wasSearched(){return this.searchedNodes.length}get circleSize(){var e;return(null===(e=this.actionContext)||void 0===e?void 0:e.contentType)===Ue.zc.Document?"big":"small"}searching(){var e;return 0===(null===(e=this.searchingText)||void 0===e?void 0:e.length)?this.rootOfTree.searchingText:this.searchingText}get dontHasMainMessageText(){return this.$gettext("Отсутствует главное сообщение")}get receiverInfoTooltip(){var e,t;if(!this.receiverInfo)return;const n=null!==(e=this.receiverInfo.departmentName)&&void 0!==e?e:"",i=null!==(t=this.receiverInfo.positionName)&&void 0!==t?t:"";return`<span v-if="receiverInfo" class="white--text">${n}<br />\n    ${i}</span>`}get rootOfTree(){var e;return null!==(e=this.root)&&void 0!==e?e:this}};Iu.MAX_INSTRUCTION_LENGTH=256,instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),instructionTreevue_type_script_lang_js_metadata("design:type",Number)],Iu.prototype,"id",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),instructionTreevue_type_script_lang_js_metadata("design:type",Array)],Iu.prototype,"childData",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),instructionTreevue_type_script_lang_js_metadata("design:type",Boolean)],Iu.prototype,"withDeleted",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"actionContext",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),instructionTreevue_type_script_lang_js_metadata("design:type",Boolean)],Iu.prototype,"hasViewDeleted",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),instructionTreevue_type_script_lang_js_metadata("design:type",Boolean)],Iu.prototype,"instructionListVisibility",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),instructionTreevue_type_script_lang_js_metadata("design:type",Boolean)],Iu.prototype,"isActive",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)({default:null}),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"instructionParent",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)({default:null}),instructionTreevue_type_script_lang_js_metadata("design:type",Array)],Iu.prototype,"instructionChild",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),instructionTreevue_type_script_lang_js_metadata("design:type",Boolean)],Iu.prototype,"collapseAll",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)({default:!0}),instructionTreevue_type_script_lang_js_metadata("design:type",Boolean)],Iu.prototype,"hasActions",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),instructionTreevue_type_script_lang_js_metadata("design:type",Boolean)],Iu.prototype,"subTree",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)({default:null}),instructionTreevue_type_script_lang_js_metadata("design:type",rt.Vue)],Iu.prototype,"root",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Prop)(),instructionTreevue_type_script_lang_js_metadata("design:type",Number)],Iu.prototype,"updateTreeCounter",void 0),instructionTreevue_type_script_lang_js_decorate([(0,fa.jI)("fetchDocInstructionsTree"),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"fetchDocInstructionsTree",void 0),instructionTreevue_type_script_lang_js_decorate([(0,fa.Rm)("fetchSingleMessage"),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"fetchSingleMessage",void 0),instructionTreevue_type_script_lang_js_decorate([(0,fa.g4)("fetchCurrentuser"),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"fetchCurrentUser",void 0),instructionTreevue_type_script_lang_js_decorate([(0,fa.Vw)("fetchUserInfo"),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"fetchUserInfo",void 0),instructionTreevue_type_script_lang_js_decorate([(0,Ge.O)("currentUser"),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"currentUser",void 0),instructionTreevue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"queryBus",void 0),instructionTreevue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),instructionTreevue_type_script_lang_js_metadata("design:type",Object)],Iu.prototype,"commandBus",void 0),instructionTreevue_type_script_lang_js_decorate([(0,ot.t)(Tl.h),instructionTreevue_type_script_lang_js_metadata("design:type",Tl.h)],Iu.prototype,"cancellationService",void 0),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("updateTreeCounter"),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onUpdateTreeCounter",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("instructionListVisibility",{immediate:!1}),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onVisibleChange",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("id",{immediate:!0}),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onIdChanged",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("withDeletedNodes"),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onWithDeletedNodes",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("treeData",{immediate:!0}),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onTreeDataChange",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("folderOpened"),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onFolderOpenedChanged",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("foldedTree"),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onFolderTreeChanged",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("actionContext",{immediate:!0}),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onContextChanged",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("ErcExecDateTimeComp"),(0,rt.Watch)("Control"),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[Number,Number]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onControlChanged",null),instructionTreevue_type_script_lang_js_decorate([(0,rt.Watch)("searchingText"),instructionTreevue_type_script_lang_js_metadata("design:type",Function),instructionTreevue_type_script_lang_js_metadata("design:paramtypes",[String,String]),instructionTreevue_type_script_lang_js_metadata("design:returntype",void 0)],Iu.prototype,"onSearch",null),Iu=vu=instructionTreevue_type_script_lang_js_decorate([(0,rt.Component)({name:"instruction-tree",filters:{truncate(e,t=vu.MAX_INSTRUCTION_LENGTH){return(null===e||void 0===e?void 0:e.length)>t?`${e.substring(0,t-3)}...`:e}}})],Iu);const Du=Iu,Ru=Du;var Tu=(0,Ct.Z)(Ru,instructionTreevue_type_template_id_326b357a_scoped_true_render,wu,!1,null,"326b357a",null);const Pu=Tu.exports;_t()(Tu,{VAvatar:w.Z,VBtn:g.Z,VCol:r.Z,VIcon:y.Z,VRow:a.Z,VTextField:C.Z,VTooltip:_.Z});var ldAppTitlebarvue_type_template_id_6e4b099d_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"titlebar"}},[n("div",{staticClass:"app-menu"},[n("ul",e._l(e.menu,(function(t){return n("li",{on:{mouseover:function(n){e.currentMenuItem=t.id}}},[n("button",{on:{click:function(n){return e.onMenuBtnClick(t.id)}}},[n("span",[e._v(e._s(t.title))])]),e._v(" "),e.isSubmenuShow&&t.items&&e.currentMenuItem===t.id?n("ul",{staticClass:"app-submenu"},e._l(t.items,(function(t){return n("li",{class:{"app-menu-divider":"divider"===t.type}},["button"===t.type?n("button",[n("span",[e._v(e._s(t.title))])]):e._e()])})),0):e._e()])})),0)]),e._v(" "),n("div",{staticClass:"app-title"},[e._v(e._s(e.appTitle))]),e._v(" "),n("div",{staticClass:"app-controls"},[n("button",{attrs:{id:"minimize-button"},on:{click:function(t){return e.$electron.ipcRenderer.send("minimize")}}}),e._v(" "),n("button",{class:{"is-maximized":e.isAppMaximized},attrs:{id:"min-max-button"},on:{click:e.onMinMaxToggle}}),e._v(" "),n("button",{attrs:{id:"close-button"},on:{click:function(t){return e.$electron.ipcRenderer.send("hide")}}})])])},Ou=[],ku=n(76196),ldAppTitlebarvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let Fu=class LdAppTitlebarComponent extends rt.Vue{constructor(){super(...arguments),this.appTitle="",this.isAppMaximized=!1,this.isSubmenuShow=!1,this.currentMenuItem=null,this.menu=[{id:(0,ku.Z)(),title:this.$gettext("Файл"),type:"button",items:[{id:(0,ku.Z)(),title:this.$gettext("Настройки"),type:"button"},{id:(0,ku.Z)(),type:"divider"},{id:(0,ku.Z)(),title:this.$gettext("Выход"),type:"button"}]},{id:(0,ku.Z)(),title:this.$gettext("Справка"),type:"button",items:[{id:(0,ku.Z)(),title:this.$gettext("Обновления"),type:"button"},{id:(0,ku.Z)(),title:this.$gettext("О программе"),type:"button"}]}]}mounted(){document.body.classList.add("landocs-app"),this.appTitle=document.title,this.$electron.ipcRenderer.send("is-maximized-request"),this.$electron.ipcRenderer.on("is-maximized-response",((e,t)=>{this.isAppMaximized=t})),this.menuClickOutsideHandler=this.menuClickOutside.bind(this),document.addEventListener("click",this.menuClickOutsideHandler)}beforeDestroy(){document.removeEventListener("click",this.menuClickOutsideHandler)}onMinMaxToggle(){this.$electron.ipcRenderer.send("min-max"),this.isAppMaximized=!this.isAppMaximized}onMenuBtnClick(e){this.isSubmenuShow=!this.isSubmenuShow,this.currentMenuItem=e}menuClickOutside(e){const t=e.target;null===t.closest("#titlebar")&&(this.isSubmenuShow=!1,this.currentMenuItem=null)}};Fu=ldAppTitlebarvue_type_script_lang_ts_decorate([rt.Component],Fu);const Au=Fu,$u=Au;var ju=(0,Ct.Z)($u,ldAppTitlebarvue_type_template_id_6e4b099d_scoped_true_render,Ou,!1,null,"6e4b099d",null);const Eu=ju.exports;var ldAttachFilesvue_type_template_id_268434a7_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"ld-attach-files-wrapper",attrs:{"no-gutters":""}},[n("attach-doc",{attrs:{files:e.files,"files-to-copy":e.filesToCopy,"doc-changeable":!0,"content-type":e.contentType,"allowed-file-extensions":e.allowedFileExtensions},on:{"list-files-changed":e.onFilesChanged,"file-templates-changed":function(t){return e.$emit("file-templates-changed",t)}}})],1)},Mu=[],ldAttachFilesvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldAttachFilesvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ldAttachFilesvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Nu=class LdAttachFilesComponent extends(o()){constructor(){super(...arguments),this.contentType=Ue.zc.Document,this.allowedFileExtensions=[]}created(){return ldAttachFilesvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchFileTypes(new Bi.uL);this.allowedFileExtensions=e.filter((e=>e.Extension)).map((e=>e.Extension.toLowerCase()))}))}onFilesChanged(e){Array.isArray(e)||(e=[]),this.files.length=0,e.forEach((e=>{this.files.push(e)})),this.$emit("upload-files",e)}};ldAttachFilesvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldAttachFilesvue_type_script_lang_js_metadata("design:type",Array)],Nu.prototype,"files",void 0),ldAttachFilesvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldAttachFilesvue_type_script_lang_js_metadata("design:type",Array)],Nu.prototype,"filesToCopy",void 0),ldAttachFilesvue_type_script_lang_js_decorate([(0,fa.p$)("fetchFileTypes"),ldAttachFilesvue_type_script_lang_js_metadata("design:type",Object)],Nu.prototype,"fetchFileTypes",void 0),Nu=ldAttachFilesvue_type_script_lang_js_decorate([(0,st.Component)({components:{"attach-doc":Fd.Z}})],Nu);const Vu=Nu,Bu=Vu;var Lu=(0,Ct.Z)(Bu,ldAttachFilesvue_type_template_id_268434a7_render,Mu,!1,null,null,null);const Uu=Lu.exports;_t()(Lu,{VRow:a.Z});var ldAttachmentvue_type_template_id_8d2016b6_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.tipFile?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("div",e._g({staticClass:"ld-attachment-wrapper"},i),[n("v-row",{staticClass:"ld-attachment-inner",attrs:{"no-gutters":""},on:{click:function(t){return e.download(e.file)}}},[n("v-col",{staticClass:"icon-field pa-0"},[21===e.file.objectType?n("v-icon",{attrs:{color:"warning",size:"18"}},[e._v("warning")]):e.svgIcon?n("svg-icon",{staticClass:"icon",attrs:{icon:e.svgIcon}}):n("v-icon",{attrs:{color:"grey-lighten-6",size:"18"}},[e._v("\n            "+e._s(e.extIco)+"\n          ")])],1),e._v(" "),n("v-col",{staticClass:"content-field py-0 px-1"},[n("div",{staticClass:"content-filename"},[n("span",{staticClass:"filename primary--text text-body-1"},[e._v(e._s(e.fileName))])]),e._v(" "),n("div",[e.short?e._e():n("span",{staticClass:"grey--text"},[e._v(e._s(e.calcCreationDate))]),e._v(" "),e.short?e._e():n("span",{staticClass:"px-2 grey--text"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text"},[e._v(e._s(e._f("formatSize")(e.file.size)))]),e._v(" "),e.short?e._e():n("span",{staticClass:"px-2 grey--text"},[e._v("|")]),e._v(" "),e.short?e._e():n("span",{staticClass:"grey--text"},[e._v(e._s(e.file.creator))])])])],1)],1)]}}],null,!1,1061205175)},[e._v(" "),n("span",{domProps:{innerHTML:e._s(e.tipFile)}})]):e._e()},Hu=[],Qu=n(60601),ldAttachmentvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldAttachmentvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let zu=class LdAttachmentComponent extends rt.Vue{onFileChanged(){this.file&&(this.file.size||(this.file.size=(0,Qu.MK)(this.file.sizeKb)))}download(e){this.$emit("click",e)}get calcCreationDate(){return Ln.C.dateToString(this.creationDate,"date")}get extIco(){if(!this.svgIcon)return Ot.C.extentionIco(this.file.fileExtension)}get svgIcon(){return Ot.C.extentionSvgIcon(this.file.fileExtension)}get creationDate(){if(this.file)return new Date(this.file.createDateTime)}get version(){if(!this.file)return"";let e="";return this.file.majorVersion?e=this.file.majorVersion.toString():(this.file.verN||this.file.versionN)&&(e=Math.max(this.file.verN,this.file.versionN).toString()),e}get fileName(){var e,t,n,i,o,s,r,a;let l;try{l=decodeURI(null!==(t=null===(e=this.file)||void 0===e?void 0:e.fullFileName)&&void 0!==t?t:null===(n=this.file)||void 0===n?void 0:n.fileName)}catch(e){l=null}l||(l=null!==(o=null===(i=this.file)||void 0===i?void 0:i.fullFileName)&&void 0!==o?o:null===(s=this.file)||void 0===s?void 0:s.fileName);let c=(null===(r=this.file)||void 0===r?void 0:r.fileExtension)||(0,fs.mD)(null===(a=this.file)||void 0===a?void 0:a.fullFileName);return c=c.toLowerCase(),l.toLowerCase().endsWith(c)?l:c?`${l}.${c}`:l}get tipFile(){if(this.file){let e="";21===this.file.objectType&&(e=`<div class="d-flex"><span>${this.$gettext("Существуют более актуальные версии. Для просмотра актуальной версии перейдите к документу")}</span></div>`);let t="";this.version&&(t=`<div class="d-flex"><span>${this.$gettext("Версия:")}</span><span class="pl-3">${this.version}</span></div>`);let n="";this.file.creator&&(n=`<div class="d-flex"><span>${this.$gettext("Автор:")}</span><span class="pl-3">${this.file.creator}</span></div>`);const i=`${t}${e}${n}`;return`<div class="tooltip-file-inner" style="display:flex;flex-flow:column wrap;text-align:left;font-size:11px;">\n      ${i||this.file.fullFileName}\n      </div>`}}};ldAttachmentvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldAttachmentvue_type_script_lang_js_metadata("design:type",Object)],zu.prototype,"file",void 0),ldAttachmentvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldAttachmentvue_type_script_lang_js_metadata("design:type",Boolean)],zu.prototype,"short",void 0),ldAttachmentvue_type_script_lang_js_decorate([(0,rt.Watch)("file",{immediate:!0}),ldAttachmentvue_type_script_lang_js_metadata("design:type",Function),ldAttachmentvue_type_script_lang_js_metadata("design:paramtypes",[]),ldAttachmentvue_type_script_lang_js_metadata("design:returntype",void 0)],zu.prototype,"onFileChanged",null),zu=ldAttachmentvue_type_script_lang_js_decorate([rt.Component],zu);const Zu=zu,Wu=Zu;var qu=(0,Ct.Z)(Wu,ldAttachmentvue_type_template_id_8d2016b6_scoped_true_render,Hu,!1,null,"8d2016b6",null);const Gu=qu.exports;_t()(qu,{VCol:r.Z,VIcon:y.Z,VRow:a.Z,VTooltip:_.Z});var ldBadgevue_type_template_id_40f36c16_scoped_true_functional_true_render=function(e,t){var n=t._c;return t.props.value?n("div",[n("span",{staticClass:"badge",class:t.props.color,attrs:{title:t.props.caption?t.props.caption+": ":""+t.props.value}},[t._v(t._s(t.props.value))])]):t._e()},Ku=[];const Yu=o().extend({functional:!0,props:{caption:{type:String,default:""},value:{type:String,default:""},color:{type:String,default:""}}}),Ju=Yu;var Xu=(0,Ct.Z)(Ju,ldBadgevue_type_template_id_40f36c16_scoped_true_functional_true_render,Ku,!0,null,"40f36c16",null);const ep=Xu.exports;var ldChainsheavesvue_type_template_id_f0bd9e98_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",{staticClass:"chainsheaves-wrapper"},[n("v-col",{staticClass:"mb-2 pa-0",attrs:{cols:"12"}},[n("v-dialog",{attrs:{width:"70%",persistent:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.canCreateSheave&&e.hasCreateEditSheaveRight?n("v-btn",e._g({staticClass:"small-button rounded-button elevation-0",attrs:{color:"primary"}},i),[n("v-icon",{attrs:{small:""}},[e._v("link")]),e._v(" "),n("translate",[e._v("Создать связь")])],1):e._e()]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e._v(" "),n("v-card",[n("v-card-title",{staticClass:"pa-3 text-body-2 font-weight-bold"},[n("translate",[e._v("Создание связи")])],1),e._v(" "),n("v-card-text",{staticClass:"pa-0"},[n("v-container",{staticClass:"white"},[n("v-row",{staticClass:"mb-4"},[n("v-col",{staticClass:"d-flex py-0",attrs:{cols:"4"}},[n("span",{staticClass:"text-body-2 error--text"},[e._v("*")]),e._v(" "),n("v-select",{staticClass:"ml-1 small-input text-body-1 font-weight-light",attrs:{"return-object":"",text:"","single-line":"",outlined:"",label:e.$gettext("Выберите тип связи"),items:e.displayedSheaveTypes,"menu-props":"auto","item-text":e.multiselectSheaveName,"hide-details":""},model:{value:e.selectedSheaveType,callback:function(t){e.selectedSheaveType=t},expression:"selectedSheaveType"}})],1),e._v(" "),n("v-col",{staticClass:"py-0",attrs:{cols:"3"}},[n("v-switch",{staticClass:"mt-0 pt-0 ml-2 exec-checkbox text-body-1",attrs:{id:"revers-sheave-control",color:"primary",label:e.$gettext("Обратить связь"),"hide-details":""},model:{value:e.reverseSheave,callback:function(t){e.reverseSheave=t},expression:"reverseSheave"}})],1),e._v(" "),n("v-col",{staticClass:"py-0",attrs:{cols:"5"}},[n("v-textarea",{staticClass:"small-input text-body-1",attrs:{maxlength:"4000",name:"input-3-1",label:e.$gettext("Текст комментария"),rows:"1",text:"",flat:"","single-line":"",outlined:"","hide-details":""},model:{value:e.newSheaveComment,callback:function(t){e.newSheaveComment=t},expression:"newSheaveComment"}})],1)],1),e._v(" "),n("v-row",{staticClass:"mb-2 px-3",staticStyle:{"min-height":"350px"}},[n("v-col",{staticClass:"select-doc-wrapper",attrs:{cols:"12"}},[n("div",{staticClass:"select-doc-header"},[n("translate",[e._v("Выбор документа")])],1),e._v(" "),e.dialog?n("select-doc",{attrs:{"source-document-id":e.document.id,"allowed-journals":e.allowedJournals},on:{"set-result":e.onSelectDoc}}):e._e()],1)],1),e._v(" "),n("v-row",[n("v-col",{staticClass:"d-flex justify-center",attrs:{cols:"12"}},[n("v-btn",{staticClass:"small-button rounded-button mr-2 elevation-0",attrs:{color:"primary",disabled:!e.isSaveBtnEnabled},on:{click:e.save}},[n("translate",[e._v("Сохранить")])],1),e._v(" "),n("v-btn",{staticClass:"small-button rounded-button",attrs:{color:"primary",outlined:""},on:{click:e.cancel}},[n("translate",[e._v("Отменить")])],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.loading}}),e._v(" "),e.displayedChainSheaves.length>0?n("div",{staticClass:"datatable-inner"},[n("div",{staticClass:"datatable-toolbar pr-2 elevation-2"},[!e.isMobile&&e.selectedDoc?n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"square-sm-button rounded-button transparent",attrs:{icon:""},on:{click:function(t){return e.onOpenDocView(e.selectedDoc.document)}}},i),[n("svg-icon",{staticClass:"svg-icon grey--text darken-3",attrs:{icon:"chrome_reader_mode"}})],1)]}}],null,!1,3779289950)},[e._v(" "),n("translate",{staticClass:"nowrap-text"},[e._v("Открыть документ в доп. области")])],1):e._e(),e._v(" "),e.selectedDoc?n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.hasCreateEditSheaveRight?n("v-btn",e._g({staticClass:"mr-1 square-sm-button rounded-button transparent",attrs:{icon:""},on:{click:function(t){return e.deleteSheave(e.selectedDoc)}}},i),[n("svg-icon",{staticClass:"svg-icon grey--text darken-3",attrs:{icon:"delete"}})],1):e._e()]}}],null,!1,409642953)},[e._v(" "),n("translate",{staticClass:"nowrap-text"},[e._v("Удалить связь")])],1):e._e()],1),e._v(" "),n("datatable",{ref:"table",staticClass:"material ngx-flex nowrap-text elevation-0",attrs:{sortType:"multi",columnMode:"standard",rows:e.displayedChainSheaves,scrollbarH:!0,scrollbarV:!1,headerHeight:32,rowHeight:26,loadingIndicator:e.loading,selectionType:"singleClick"},on:{select:function(t){return e.onSelectRow(t)}}},e._l(e.columns,(function(t){return n("datatable-column",{key:t.prop,attrs:{name:t.name,prop:t.prop,resizeable:!0,visible:!0,sortable:!0,canAutoResize:!0},scopedSlots:e._u([{key:"default",fn:function(i){return i?[e.isDateColumn(t)?n("span",[e._v("\n              "+e._s(e._f("date")(i.value,"DD.MM.YYYY"))+"\n            ")]):t.component?n(t.component.name,e._b({tag:"component",attrs:{value:i.value,row:i.row}},"component",t.component.props,!1)):n("span",[e._v(e._s(i.value))])]:void 0}}],null,!0)})})),1)],1):e._e()],1)],1)},tp=[],np=n(73765),ip=n(53606),ldChainsheavesvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldChainsheavesvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ldChainsheavesvue_type_script_lang_ts_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let op=class LdChainsheavesComponent extends rt.Vue{constructor(){super(...arguments),this.chainsheaves=[],this.loading=!1,this.viewingModel=[],this.sheaveTypes=[],this.selectedSheaveType=null,this.allowedJournals=null,this.newSheaveDocument=null,this.reverseSheave=!1,this.newSheaveComment="",this.selectedDoc=null,this.dialog=!1,this.columns=[{name:this.$gettext("Роль текущего"),prop:"currentDocumentRoleName",columnType:Bn.cV.String},{name:this.$gettext("Роль связанного"),prop:"documentRoleName",columnType:Bn.cV.String},{name:this.$gettext("Наименование"),prop:"documentName",columnType:Bn.cV.String},{name:this.$gettext("Содержание"),prop:"document.attributes.Annotation",columnType:Bn.cV.String},{name:this.$gettext("Вид документа"),prop:"document.attributes.DocumentType",columnType:Bn.cV.String},{name:this.$gettext("Файлы"),prop:"document.attributes.HasFiles",columnType:Bn.cV.Number,component:{name:"IconColumn",props:[{icon:"attach_file"}]}},{name:this.$gettext("Комментарий"),prop:"comments",columnType:Bn.cV.String}]}onUpdateChainsheavesCounter(){this.updateChainsheaves()}onDocumentChanged(){return ldChainsheavesvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.document&&this.document.id&&(yield this.updateChainsheaves())}))}created(){return ldChainsheavesvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){this.sheaveTypes=yield this.queryBus.exec(new He.hj),this.allowedJournals=yield this.checkAllFoldersSheaveRight()}))}onSelectDoc(e){e&&(this.newSheaveDocument=e)}onSelectRow({selected:e}){this.selectedDoc=e[0]}isDateColumn(e){return[Bn.cV.Date,Bn.cV.DateTime].includes(e.columnType)}onOpenDocView(e){e&&this.$app.view(this.context,Ue.zc.Document,null,e.id)}onOpenDoc(e){this.$app.viewDoc(e.id,this.context)}cancel(){this.dialog=!1,this.clearSheave()}clearSheave(){this.newSheaveDocument=null,this.selectedSheaveType=null,this.newSheaveComment=""}updateChainsheaves(){return ldChainsheavesvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){try{this.chainsheaves=[],this.loading=!0;const e=new He.Hx(this.document.id,this.document.cardId,!1),t=yield this.queryBus.exec(e);let n=[];Array.isArray(t.parentDocuments)&&(n=[...t.parentDocuments]),Array.isArray(t.childDocuments)&&(n=[...n,...t.childDocuments]),this.chainsheaves=n}finally{this.loading=!1}}))}save(){var e,t,n;return ldChainsheavesvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){try{let e=null,t=null;this.reverseSheave?(e=this.newSheaveDocument.id,t=this.document.id):(e=this.document.id,t=this.newSheaveDocument.id),this.loading=!0,this.dialog=!1;const n=new Dt.OH(e,t,this.selectedSheaveType.id,this.newSheaveComment),i=yield this.commandBus.exec(n);this.loading=!1,i.error?this.$toasted.error(this.$gettextInterpolate(this.$gettext("При создании связи с документом %{err} произошла ошибка"),{err:this.newSheaveDocument.attributes.Name})):(yield this.updateChainsheaves(),this.$toasted.success(this.$gettextInterpolate(this.$gettext("Создана связь с документом %{sheave}"),{sheave:this.newSheaveDocument.attributes.Name})),this.clearSheave())}catch(i){const o=null===(t=null===(e=i.error)||void 0===e?void 0:e.exception)||void 0===t?void 0:t.response,s=null===(n=null===o||void 0===o?void 0:o.data)||void 0===n?void 0:n.message,r=s?`При создании связи произошла ошибка: ${s}`:"При создании связи произошла ошибка";this.$toasted.error(r)}finally{this.loading=!1}}))}deleteSheave(e){return ldChainsheavesvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){if(!e)return;const t=yield this.queryBus.exec(new Zt.l(this.$gettext("Внимание!"),this.$gettext("Вы действительно хотите удалить связь с выбранным документом?")));if(t)try{this.loading=!0;const t=new Dt.CS(e.id),n=yield this.commandBus.exec(t);n.error?(this.loading=!1,this.$toasted.error(this.$gettextInterpolate(this.$gettext("При удалении связи с документом %{err} произошла ошибка"),{err:e.document.attributes.Name}))):(this.loading=!1,this.chainsheaves.includes(e)&&(this.chainsheaves.splice(this.chainsheaves.indexOf(e),1),this.$toasted.success(this.$gettextInterpolate(this.$gettext("Связь с документом %{delete} удалена"),{delete:e.document.attributes.Name}))))}catch(e){this.$log.error(this.$gettextInterpolate(this.$gettext("Ошибка удаления связи с документом: %{responseErr} %{err}"),{responseErr:e.error.exception.response.status,err:e.message}))}finally{this.loading=!1,this.emitDelete(e.id)}}))}checkAllFoldersSheaveRight(){return ldChainsheavesvue_type_script_lang_ts_awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchJournalsList({journalType:"all"});let t=[];const n=1;return e.length&&(t=e.filter((e=>e.type===n||e.rights.includes(du.K.CreateEditSheave))).map((e=>e.id))),t}))}emitDelete(e){this.$emit("sheave-deleted",e)}get hasCreateEditSheaveRight(){var e,t;return null===(t=null===(e=this.context)||void 0===e?void 0:e.rights)||void 0===t?void 0:t.includes(du.K.CreateEditSheave)}get displayedSheaveTypes(){return this.sheaveTypes.filter((e=>5!==e.state))}get multiselectSheaveName(){return this.reverseSheave?"parentRoleName":"childRoleName"}get namesSheaf(){if(this.sheaveTypes.length)return this.idsSheaf&&this.idsSheaf.map((e=>{const{childRoleName:t,parentRoleName:n}=this.sheaveTypes.find((t=>t.id===e));return{childRoleName:t,parentRoleName:n}}))}get displayedChainSheaves(){var e;const t=null!==(e=this.chainsheaves)&&void 0!==e?e:[];return this.idsSheaf&&this.namesSheaf?t.filter((({documentRoleName:e})=>{var t;return null===(t=this.namesSheaf)||void 0===t?void 0:t.find((({childRoleName:t,parentRoleName:n})=>t===e||n===e))})):(t.forEach((e=>{e.parentRoleName=this.$gettext("Документ")})),t)}get isSaveBtnEnabled(){return Boolean(this.selectedSheaveType&&this.newSheaveDocument)}};ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Prop)(),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Object)],op.prototype,"document",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Prop)(),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Object)],op.prototype,"context",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!0}),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Boolean)],op.prototype,"hideAl",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Prop)(),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Array)],op.prototype,"idsSheaf",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Prop)({type:Boolean,default:!0}),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Boolean)],op.prototype,"canCreateSheave",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Prop)(),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Number)],op.prototype,"updateChainsheavesCounter",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,fa.Vw)("getUserInfo"),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Object)],op.prototype,"getUserInfo",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,fa.jI)("fetchJournalsList"),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Object)],op.prototype,"fetchJournalsList",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,ot.t)(Ae.M.IQueryBus),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Object)],op.prototype,"queryBus",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,ot.t)(Ve.O.ICommandBus),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Object)],op.prototype,"commandBus",void 0),ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Watch)("updateChainsheavesCounter"),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Function),ldChainsheavesvue_type_script_lang_ts_metadata("design:paramtypes",[]),ldChainsheavesvue_type_script_lang_ts_metadata("design:returntype",void 0)],op.prototype,"onUpdateChainsheavesCounter",null),ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Watch)("document",{immediate:!0}),ldChainsheavesvue_type_script_lang_ts_metadata("design:type",Function),ldChainsheavesvue_type_script_lang_ts_metadata("design:paramtypes",[]),ldChainsheavesvue_type_script_lang_ts_metadata("design:returntype",Promise)],op.prototype,"onDocumentChanged",null),op=ldChainsheavesvue_type_script_lang_ts_decorate([(0,rt.Component)({components:{"document-list-item":ja.Z,"select-doc":ip.default,IconColumn:np.Z}})],op);const sp=op,rp=sp;var ap=(0,Ct.Z)(rp,ldChainsheavesvue_type_template_id_f0bd9e98_scoped_true_render,tp,!1,null,"f0bd9e98",null);const lp=ap.exports;_t()(ap,{VBtn:g.Z,VCard:D.Z,VCardText:R.ZB,VCardTitle:R.EB,VCol:r.Z,VContainer:pe.Z,VDialog:x.Z,VIcon:y.Z,VRow:a.Z,VSelect:q.Z,VSwitch:F.Z,VTextarea:s.Z,VTooltip:_.Z});var ldCheckBoxvue_type_template_id_258f5a5e_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{class:{"column align-start":!e.label,"align-baseline":e.label}},[n("v-checkbox",{attrs:{rules:e.validRules,"validate-on-blur":e.validateOnBlur,disabled:e.disabled,readonly:e.readonly,label:e.label},model:{value:e.check,callback:function(t){e.check=t},expression:"check"}})],1)},cp=[],ldCheckBoxvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldCheckBoxvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let dp=class LdCheckboxComponent extends(o()){constructor(){super(...arguments),this.check=!1}onValueChanged(){this.check!==this.value&&(this.check=this.value)}onCheckChanged(){this.check!==this.value&&this.$emit("input",this.check)}};ldCheckBoxvue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean}),ldCheckBoxvue_type_script_lang_js_metadata("design:type",Boolean)],dp.prototype,"value",void 0),ldCheckBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldCheckBoxvue_type_script_lang_js_metadata("design:type",String)],dp.prototype,"label",void 0),ldCheckBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldCheckBoxvue_type_script_lang_js_metadata("design:type",Boolean)],dp.prototype,"disabled",void 0),ldCheckBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldCheckBoxvue_type_script_lang_js_metadata("design:type",Boolean)],dp.prototype,"required",void 0),ldCheckBoxvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldCheckBoxvue_type_script_lang_js_metadata("design:type",Boolean)],dp.prototype,"readonly",void 0),ldCheckBoxvue_type_script_lang_js_decorate([(0,rt.Watch)("value",{immediate:!0}),ldCheckBoxvue_type_script_lang_js_metadata("design:type",Function),ldCheckBoxvue_type_script_lang_js_metadata("design:paramtypes",[]),ldCheckBoxvue_type_script_lang_js_metadata("design:returntype",void 0)],dp.prototype,"onValueChanged",null),ldCheckBoxvue_type_script_lang_js_decorate([(0,rt.Watch)("check"),ldCheckBoxvue_type_script_lang_js_metadata("design:type",Function),ldCheckBoxvue_type_script_lang_js_metadata("design:paramtypes",[]),ldCheckBoxvue_type_script_lang_js_metadata("design:returntype",void 0)],dp.prototype,"onCheckChanged",null),dp=ldCheckBoxvue_type_script_lang_js_decorate([(0,gt.default)({mixins:[va.Z]})],dp);const up=dp,pp=up;var hp=(0,Ct.Z)(pp,ldCheckBoxvue_type_template_id_258f5a5e_scoped_true_render,cp,!1,null,"258f5a5e",null);const mp=hp.exports;_t()(hp,{VCheckbox:T.Z,VRow:a.Z});var ldComboBoxvue_type_template_id_25c018fc_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{align:"baseline"}},[e.label?n("v-col",{class:{xs4:!e.labelWidth},style:{"max-width":e.labelWidth,"min-width":e.labelWidth}},[n("span",{staticClass:"font-weight-bold sm-text",class:{label:e.labelWidth}},[e._v(e._s(e.label))]),e._v(" "),e.required?n("span",{class:{require:e.required}}):e._e()]):e._e(),e._v(" "),n("v-col",{staticClass:"ld-combobox d-flex"},[n("v-combobox",{staticClass:"small-input text-body-1 font-weight-light",attrs:{flat:"",solo:"","single-line":"",outline:"","item-value":"id","item-text":"value",items:e.myItems,loading:e.loading,rules:e.myValidRules,"validate-on-blur":e.validateOnBlur,"no-data-text":e.noDataText,readonly:e.readonly,multiple:e.multiselect,chips:e.multiselect,"deletable-chips":e.multiselect,disabled:e.disabled},on:{mouseup:e.onMouseUp},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1)},fp=[],ldComboBoxvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldComboBoxvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ldComboBoxvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let gp=class LdComboBoxComponent extends va.Z{constructor(){super(...arguments),this.selected=null,this.myItems=null,this.loading=!1,this.noDataText=this.$gettext("Нет данных")}onValueChanged(){let e;if(this.value&&this.myItems&&this.myItems.items.length){e=Array.isArray(this.value)?this.value:[this.value];for(let t=0;t<e.length;t++)e[t]=Number(e[t]);const t=this.myItems.items.filter((t=>e.includes(t.id)));t.length&&(this.selected=this.multiselect?t:t[0])}}onSelectedChanged(){let e=[];if(this.selected){const t=Array.isArray(this.selected)?this.selected:[this.selected];e=t.map((e=>e.id))}e.length||e.push(0),this.multiselect?(0,ba.Z)(e,this.value)||this.$emit("input",e):Number(this.value)!==e[0]&&this.$emit("input",e[0]),this.$emit("update-selected-items",this.selected),this.updateSelectedItems(this.selected)}created(){(!this.lazyLoad||this.multiselect&&Array.isArray(this.value)&&this.value.length||!this.multiselect&&this.value)&&this.fetchData()}onMouseUp(){this.myItems||this.fetchData()}get myValidRules(){return[].concat(this.validRules,this.inputValidate.bind(this))}inputValidate(e){if(!e)return!1;let t="";return t="string"===typeof e?e:e.value,!this.myItems.items.find((e=>e.value.toLowerCase()===t.toLowerCase()))&&this.$gettext("Выберите значение из списка")}updateSelectedItems(e){if(!e||!this.selectedItems)return;const t=Array.isArray(e)?e:[e];if(Array.isArray(this.selectedItems)){const e=t.filter((e=>!this.selectedItems.find((t=>t.id===e.id))));e.forEach((e=>{this.selectedItems.push(e)})),this.selectedItems.forEach(((e,n)=>{t.find((t=>t.id===e.id))||this.selectedItems.splice(n,1)}))}}fetchData(){return ldComboBoxvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading=!0,this.selectedItems?this.myItems.items=this.selectedItems:this.myItems=yield this.fetchVocabulary(new Pt.Yi(this.vocabularyName,!1)),this.onValueChanged(),this.loading=!1}))}};ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldComboBoxvue_type_script_lang_js_metadata("design:type",Object)],gp.prototype,"value",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)({type:String,default:""}),ldComboBoxvue_type_script_lang_js_metadata("design:type",String)],gp.prototype,"vocabularyName",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldComboBoxvue_type_script_lang_js_metadata("design:type",Array)],gp.prototype,"selectedItems",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldComboBoxvue_type_script_lang_js_metadata("design:type",Boolean)],gp.prototype,"lazyLoad",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldComboBoxvue_type_script_lang_js_metadata("design:type",String)],gp.prototype,"label",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldComboBoxvue_type_script_lang_js_metadata("design:type",String)],gp.prototype,"placeholder",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldComboBoxvue_type_script_lang_js_metadata("design:type",Boolean)],gp.prototype,"readonly",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldComboBoxvue_type_script_lang_js_metadata("design:type",Boolean)],gp.prototype,"disabled",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldComboBoxvue_type_script_lang_js_metadata("design:type",Boolean)],gp.prototype,"required",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldComboBoxvue_type_script_lang_js_metadata("design:type",Boolean)],gp.prototype,"multiselect",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldComboBoxvue_type_script_lang_js_metadata("design:type",String)],gp.prototype,"labelWidth",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,fa.eI)("fetchVocabulary"),ldComboBoxvue_type_script_lang_js_metadata("design:type",Object)],gp.prototype,"fetchVocabulary",void 0),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Watch)("value",{immediate:!0}),ldComboBoxvue_type_script_lang_js_metadata("design:type",Function),ldComboBoxvue_type_script_lang_js_metadata("design:paramtypes",[]),ldComboBoxvue_type_script_lang_js_metadata("design:returntype",void 0)],gp.prototype,"onValueChanged",null),ldComboBoxvue_type_script_lang_js_decorate([(0,rt.Watch)("selected"),ldComboBoxvue_type_script_lang_js_metadata("design:type",Function),ldComboBoxvue_type_script_lang_js_metadata("design:paramtypes",[]),ldComboBoxvue_type_script_lang_js_metadata("design:returntype",void 0)],gp.prototype,"onSelectedChanged",null),gp=ldComboBoxvue_type_script_lang_js_decorate([gt.default],gp);const yp=gp,vp=yp;var bp=(0,Ct.Z)(vp,ldComboBoxvue_type_template_id_25c018fc_scoped_true_render,fp,!1,null,"25c018fc",null);const Cp=bp.exports;_t()(bp,{VCol:r.Z,VCombobox:O.Z,VRow:a.Z});var ldContainervue_type_template_id_73e41844_scoped_true_functional_true_render=function(e,t){var n=t._c;return n("v-container",{staticClass:"px-0 py-0",attrs:{fluid:""}},[t._t("default")],2)},wp=[];const _p=o().extend({functional:!0}),xp=_p;var Sp=(0,Ct.Z)(xp,ldContainervue_type_template_id_73e41844_scoped_true_functional_true_render,wp,!0,null,"73e41844",null);const Ip=Sp.exports;_t()(Sp,{VContainer:pe.Z});var ldDatevue_type_template_id_f7010616_scoped_true_functional_true_render=function(e,t){var n=t._c;return n("v-col",[n("span",[n("b",{staticClass:"mr-1"},[t._v(" "+t._s(t.props.caption)+" ")]),t._v("\n    "+t._s(t._f("date")(t.props.value,t.props.template||"DD.MM.YYYY hh:mm"))+"\n  ")])])},Dp=[];const Rp=o().extend({functional:!0,props:{caption:{type:String,default:null},value:{default:null},template:{type:String,default:null}}}),Tp=Rp;var Pp=(0,Ct.Z)(Tp,ldDatevue_type_template_id_f7010616_scoped_true_functional_true_render,Dp,!0,null,"f7010616",null);const Op=Pp.exports;_t()(Pp,{VCol:r.Z});var ldEditTextvue_type_template_id_76d6b8e0_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ld-edit-text",class:{column:e.mobile||e.labelOnTop}},[e.label?n("v-col",{staticClass:"pr-2",class:e.labelSizeClasses},[n("v-row",[n("v-row",{staticClass:"label-wrapper",class:{"justify-end":e.alignLabelToRight},attrs:{align:"center"}},[e.labelHint?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"label font-weight-bold sm-text",class:{help:e.labelHint}},i),[e._v(e._s(e.label))])]}}],null,!1,495005635)},[e._v(" "),n("span",[e._v(e._s(e.labelHint))])]):n("span",{staticClass:"label font-weight-bold sm-text"},[e._v(e._s(e.label))])],1),e._v(" "),e.required?n("div",{class:{require:e.required}}):e._e()],1)],1):e._e(),e._v(" "),n("v-col",{staticClass:"d-flex",class:e.inputSizeClasses},[n("v-text-field",{staticClass:"small-input text-body-1 font-weight-light my-0",class:{disabled:e.disabled},attrs:{value:e.text,type:e.type,flat:"",solo:"","single-line":"",outline:"","persistent-hint":e.persistentHint,rules:e.validRules,"validate-on-blur":e.validateOnBlur,placeholder:e.placeholder,disabled:e.disabled,readonly:e.readonly,hint:e.inputHint,mask:e.mask,tabindex:e.tabindex},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"append",fn:function(){return[e.clearIcon&&e.text?n("v-icon",{attrs:{color:"red"},on:{click:function(t){e.text=""}}},[e._v("close")]):e._e()]},proxy:!0}])})],1)],1)},kp=[],ldEditTextvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldEditTextvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Fp=class CardEditTextComponent extends(o()){get appendIcon(){return this.clearIcon&&this.text?"close":""}};ldEditTextvue_type_script_lang_js_decorate([(0,rt.Model)("input"),ldEditTextvue_type_script_lang_js_metadata("design:type",Object)],Fp.prototype,"text",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextvue_type_script_lang_js_metadata("design:type",Boolean)],Fp.prototype,"mobile",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1,type:Boolean}),ldEditTextvue_type_script_lang_js_metadata("design:type",Boolean)],Fp.prototype,"disabled",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1,type:Boolean}),ldEditTextvue_type_script_lang_js_metadata("design:type",Boolean)],Fp.prototype,"required",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1,type:Boolean}),ldEditTextvue_type_script_lang_js_metadata("design:type",Boolean)],Fp.prototype,"readonly",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({default:"text"}),ldEditTextvue_type_script_lang_js_metadata("design:type",String)],Fp.prototype,"type",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1,type:Boolean}),ldEditTextvue_type_script_lang_js_metadata("design:type",Boolean)],Fp.prototype,"clearIcon",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1,type:Boolean}),ldEditTextvue_type_script_lang_js_metadata("design:type",Boolean)],Fp.prototype,"labelOnTop",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),ldEditTextvue_type_script_lang_js_metadata("design:type",Boolean)],Fp.prototype,"alignLabelToRight",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),ldEditTextvue_type_script_lang_js_metadata("design:type",Boolean)],Fp.prototype,"persistentHint",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({default:null}),ldEditTextvue_type_script_lang_js_metadata("design:type",Object)],Fp.prototype,"inputSize",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({default:3}),ldEditTextvue_type_script_lang_js_metadata("design:type",Object)],Fp.prototype,"labelSize",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextvue_type_script_lang_js_metadata("design:type",String)],Fp.prototype,"labelHint",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextvue_type_script_lang_js_metadata("design:type",String)],Fp.prototype,"inputHint",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextvue_type_script_lang_js_metadata("design:type",String)],Fp.prototype,"mask",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextvue_type_script_lang_js_metadata("design:type",Object)],Fp.prototype,"tabindex",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)({type:String,default:""}),ldEditTextvue_type_script_lang_js_metadata("design:type",String)],Fp.prototype,"placeholder",void 0),ldEditTextvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextvue_type_script_lang_js_metadata("design:type",String)],Fp.prototype,"label",void 0),Fp=ldEditTextvue_type_script_lang_js_decorate([(0,gt.default)({mixins:[va.Z,ya]})],Fp);const Ap=Fp,$p=Ap;var jp=(0,Ct.Z)($p,ldEditTextvue_type_template_id_76d6b8e0_scoped_true_render,kp,!1,null,"76d6b8e0",null);const Ep=jp.exports;_t()(jp,{VCol:r.Z,VIcon:y.Z,VRow:a.Z,VTextField:C.Z,VTooltip:_.Z});var ldEditTextAreavue_type_template_id_6870a54c_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{class:{"align-center":!e.labelWidth,"align-top":e.labelWidth}},[e.label?n("v-col",{staticClass:"mb-2 flex",class:{xs2:!e.labelWidth},style:{"min-width":e.labelWidth,"max-width":e.labelWidth}},[n("div",{staticClass:"font-weight-bold sm-text",class:{label:e.labelWidth}},[n("span",[e._v(e._s(e.label))])])]):e._e(),e._v(" "),n("v-col",{class:{xs12:!e.labelWidth}},[n("v-textarea",{attrs:{outline:"",rules:e.validRules,"validate-on-blur":e.validateOnBlur,placeholder:e.placeholder,value:e.text,readonly:e.readonly,height:"10"},on:{input:function(t){return e.$emit("input",t)}}})],1)],1)},Mp=[],ldEditTextAreavue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldEditTextAreavue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Np=class LdEditTextAreaComponent extends(o()){};ldEditTextAreavue_type_script_lang_js_decorate([(0,rt.Model)("input",{type:String}),ldEditTextAreavue_type_script_lang_js_metadata("design:type",String)],Np.prototype,"text",void 0),ldEditTextAreavue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextAreavue_type_script_lang_js_metadata("design:type",String)],Np.prototype,"label",void 0),ldEditTextAreavue_type_script_lang_js_decorate([(0,rt.Prop)({type:String,default:""}),ldEditTextAreavue_type_script_lang_js_metadata("design:type",String)],Np.prototype,"placeholder",void 0),ldEditTextAreavue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextAreavue_type_script_lang_js_metadata("design:type",Boolean)],Np.prototype,"disabled",void 0),ldEditTextAreavue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextAreavue_type_script_lang_js_metadata("design:type",Boolean)],Np.prototype,"required",void 0),ldEditTextAreavue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldEditTextAreavue_type_script_lang_js_metadata("design:type",Boolean)],Np.prototype,"readonly",void 0),ldEditTextAreavue_type_script_lang_js_decorate([(0,rt.Prop)(),ldEditTextAreavue_type_script_lang_js_metadata("design:type",String)],Np.prototype,"labelWidth",void 0),Np=ldEditTextAreavue_type_script_lang_js_decorate([(0,gt.default)({mixins:[va.Z]})],Np);const Vp=Np,Bp=Vp;var Lp=(0,Ct.Z)(Bp,ldEditTextAreavue_type_template_id_6870a54c_scoped_true_render,Mp,!1,null,"6870a54c",null);const Up=Lp.exports;_t()(Lp,{VCol:r.Z,VRow:a.Z,VTextarea:s.Z});var ldFileUploadervue_type_template_id_15e5b9cd_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("file-upload",{staticClass:"upload",attrs:{"post-action":e.saveUrl},on:{"file-loaded":e.onFileLoaded}})},Hp=[],Qp=n(21883),ldFileUploadervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldFileUploadervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let zp=class LdFileUploaderComponent extends(o()){constructor(){super(...arguments),this.saveUrl=""}created(){this.saveUrl=`${this.$config.apiPath()}instructions/document/${this.documentId}/files`}onFileLoaded(e){this.$emit("file-loaded",e)}};ldFileUploadervue_type_script_lang_js_decorate([(0,rt.Prop)(),ldFileUploadervue_type_script_lang_js_metadata("design:type",Number)],zp.prototype,"documentId",void 0),zp=ldFileUploadervue_type_script_lang_js_decorate([(0,gt.default)({components:{"file-upload":Qp.Z}})],zp);const Zp=zp,Wp=Zp;var qp=(0,Ct.Z)(Wp,ldFileUploadervue_type_template_id_15e5b9cd_scoped_true_render,Hp,!1,null,"15e5b9cd",null);const Gp=qp.exports;var ldHoveredItemvue_type_template_id_6f443fdc_scoped_true_functional_true_render=function(e,t){var n=t._c;return n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.props.caption},expression:"{ content: props.caption }"}],staticClass:"message-user-info",attrs:{title:t.props.caption}},[t._v(t._s(t.props.value))])},Kp=[];const Yp=o().extend({functional:!0,props:{caption:{type:String,default:null},value:{type:String,default:null}}}),Jp=Yp;var Xp=(0,Ct.Z)(Jp,ldHoveredItemvue_type_template_id_6f443fdc_scoped_true_functional_true_render,Kp,!0,null,"6f443fdc",null);const eh=Xp.exports;var ldIncludevue_type_template_id_ad30d22a_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-runtime-template",{attrs:{template:e.template,"parent-comp":e.parentComponent}})},th=[];const defineDescriptor=(e,t,n)=>{if(!t.hasOwnProperty(n)){const i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i)}},v_runtime_template_merge=e=>{const t={};return e.forEach((e=>{e&&Object.getOwnPropertyNames(e).forEach((n=>defineDescriptor(e,t,n)))})),t},buildFromProps=(e,t)=>{const n={};return t.forEach((t=>defineDescriptor(e,n,t))),n},nh={props:{template:String,parentComp:Object},render(e){if(this.template){if(this.dynamic&&this.$parent){const{$data:t,$props:n}=this.$parent;let i={$data:{},$props:{}};Object.keys(t||{}).forEach((e=>{void 0===this.$data[e]&&(i.$data[e]=t[e])})),Object.keys(n||{}).forEach((e=>i.$props[e]=n[e]));const o=v_runtime_template_merge([i.$data,i.$props,this.methodsFromProps]);return this.__renderFn__=e(this.dynamic,{props:o}),this.__renderFn__}const t=this.parentComp||this.$parent;this.$parent=t,this.$options.methods||(this.$options.methods={}),this.$options.computed||(this.$options.computed={}),this.$options.components||(this.$options.components={});const{$data:n,$props:i,$options:o}=t,{components:s,computed:r,methods:a}=o;let l={$data:{},$props:{},$options:{},components:{},computed:{},methods:{}};Object.keys(n||{}).forEach((e=>{void 0===this.$data[e]&&(l.$data[e]=n[e])})),Object.keys(i||{}).forEach((e=>{void 0===this.$props[e]&&(l.$props[e]=i[e])})),Object.keys(a||{}).forEach((e=>{void 0===this.$options.methods[e]&&(l.methods[e]=a[e])})),Object.keys(r||{}).forEach((e=>{void 0===this.$options.computed[e]&&(l.computed[e]=r[e])})),Object.keys(s||{}).forEach((e=>{void 0===this.$options.components[e]&&(l.components[e]=s[e])}));const c=Object.keys(l.methods||{}),d=Object.keys(l.$data||{}),u=Object.keys(l.$props||{}),p=d.concat(u).concat(c);this.methodsFromProps=buildFromProps(t,c);const h=v_runtime_template_merge([l.$data,l.$props,this.methodsFromProps]),m={},f={};let g=this.template||"<div></div>";d.forEach((e=>{const n=new RegExp(`[^"{\\s=]?${e}["}\\s]*?(?=["}\\s])`,"g"),i=n.exec(g);if(i===e){const i=`${e}_ld`;f[i]=l.$data[e],g=g.replace(n,i);const o=t._watchers.find((t=>t.expression===e));if(o){const e=o.cb;o.cb=function(n,o){const s=this.__renderFn__.componentInstance;s.$set(s,i,n),e.call(t,n,o)}.bind(this)}else{const n=function(e){const t=this.__renderFn__.componentInstance;t.$set(t,i,e)}.bind(this);t.$watch(e,n)}m[i]=function(n,i){t.$set(t,e,n)}}})),this.dynamic={template:g,props:p,data:()=>f,computed:l.computed,components:l.components,watch:m};const y=e(this.dynamic,{props:h});return this.__renderFn__=y,y}}};var ldIncludevue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldIncludevue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ldIncludevue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let ih=class LdIncludeComponent extends(o()){constructor(){super(...arguments),this.template="",this.parentComponent=null}onSrcChanged(){return ldIncludevue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.src)return;let e=this.baseUrl;e=e?e.endsWith("/")?`${e}${this.src}`:`${e}/${this.src}`:this.src,this.$emit("ld-include-loading",!0);try{const t=yield this.fetchTemplate(new tt.Gf(e,e.replace(/\/|\\/g,"-")));t&&(this.parentName&&(this.parentComponent=this.findParent(this.parentName)),this.template=t.template)}catch(e){this.$log.error(`ld-include onSrcChanged ${e}`)}finally{this.$emit("ld-include-loading",!1)}}))}findParent(e){let t=!1,n=this.$parent;while(!t&&n)t=n.$options.name===e,t||(n=n.$parent);return n}};ldIncludevue_type_script_lang_js_decorate([(0,rt.Prop)(),ldIncludevue_type_script_lang_js_metadata("design:type",String)],ih.prototype,"baseUrl",void 0),ldIncludevue_type_script_lang_js_decorate([(0,rt.Prop)(),ldIncludevue_type_script_lang_js_metadata("design:type",String)],ih.prototype,"src",void 0),ldIncludevue_type_script_lang_js_decorate([(0,rt.Prop)(),ldIncludevue_type_script_lang_js_metadata("design:type",String)],ih.prototype,"parentName",void 0),ldIncludevue_type_script_lang_js_decorate([(0,fa.Hg)("fetchExternalComponent"),ldIncludevue_type_script_lang_js_metadata("design:type",Object)],ih.prototype,"fetchTemplate",void 0),ldIncludevue_type_script_lang_js_decorate([(0,rt.Watch)("src",{immediate:!0}),ldIncludevue_type_script_lang_js_metadata("design:type",Function),ldIncludevue_type_script_lang_js_metadata("design:paramtypes",[]),ldIncludevue_type_script_lang_js_metadata("design:returntype",Promise)],ih.prototype,"onSrcChanged",null),ih=ldIncludevue_type_script_lang_js_decorate([(0,gt.default)({components:{"v-runtime-template":nh},$options:{props:{}}})],ih);const oh=ih,sh=oh;var rh=(0,Ct.Z)(sh,ldIncludevue_type_template_id_ad30d22a_scoped_true_render,th,!1,null,"ad30d22a",null);const ah=rh.exports;var ldNumbervue_type_template_id_774b766f_scoped_true_functional_true_render=function(e,t){var n=t._c;return n("div",[t._m(0),t._v(" "),t.props.caption?n("b",[t._v(" "+t._s(t.props.caption)+" ")]):t._e(),t._v(" "),n("span",[t._v(t._s(t.props.value||t.props.default||"-"))])])},lh=[function(e,t){var n=t._c;return n("span",[n("i",{staticClass:"fa fa-hashtag"})])}];const ch=o().extend({functional:!0,props:{caption:{type:String,default:null},value:{type:String,default:null},default:{type:String,default:null}}}),dh=ch;var uh=(0,Ct.Z)(dh,ldNumbervue_type_template_id_774b766f_scoped_true_functional_true_render,lh,!0,null,"774b766f",null);const ph=uh.exports;var ldPageTitlevue_type_template_id_7a0e3832_scoped_true_functional_true_render=function(e,t){var n=t._c;return n("div",{attrs:{title:t.props.caption}},[n("span",[t._v(" "+t._s(t.props.value)+" ")])])},hh=[];const mh=o().extend({functional:!0,props:{caption:{type:String,default:null},value:{type:String,default:null}}}),fh=mh;var gh=(0,Ct.Z)(fh,ldPageTitlevue_type_template_id_7a0e3832_scoped_true_functional_true_render,hh,!0,null,"7a0e3832",null);const yh=gh.exports;var ldRowvue_type_template_id_faa5c11a_scoped_true_functional_true_render=function(e,t){var n=t._c;return n("v-row",{attrs:{"no-gutters":""}},[t._t("default")],2)},vh=[];const bh=o().extend({functional:!0}),Ch=bh;var wh=(0,Ct.Z)(Ch,ldRowvue_type_template_id_faa5c11a_scoped_true_functional_true_render,vh,!0,null,"faa5c11a",null);const _h=wh.exports;_t()(wh,{VRow:a.Z});var ldSectionvue_type_template_id_498b8832_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._t("default")],2)},xh=[];function generateWarning(e,t){return()=>console.warn(`The ${e} component must be used inside a ${t}`)}function inject(e,t,n){const i=t&&n?{register:generateWarning(t,n),unregister:generateWarning(t,n)}:null;return o().extend({name:"RegistrableInject",inject:{[e]:{default:i}}})}function registerMixin(e){return o().extend({mixins:[inject(e)],created(){this[e]&&this[e].register(this)},beforeDestroy(){this[e]&&this[e].unregister(this)}})}var ldSectionvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldSectionvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Sh=class LdSection extends(o()){created(){const e=this;e.form&&e.form.register(this,Number(this.index))}destroyed(){const e=this;e.form&&e.form.unregister(this,Number(this.index))}};ldSectionvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldSectionvue_type_script_lang_js_metadata("design:type",String)],Sh.prototype,"index",void 0),Sh=ldSectionvue_type_script_lang_js_decorate([(0,gt.default)({mixins:[registerMixin("form")]})],Sh);const Ih=Sh,Dh=Ih;var Rh=(0,Ct.Z)(Dh,ldSectionvue_type_template_id_498b8832_scoped_true_render,xh,!1,null,"498b8832",null);const Th=Rh.exports;var ldSelectReceivervue_type_template_id_4597d32a_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ld-select-receivers-wrapper",class:{column:!e.labelInline}},[e.label?n("v-row",{attrs:{"no-gutters":""}},[n("span",{staticClass:"font-weight-bold"},[e._v(e._s(e.label)+":")])]):e._e(),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-row",{staticClass:"no-gutters"},[n("v-col",{class:{invalid:e.$v.selectedReceivers.$error}},[n("vue-multiselect",e._g({ref:"multiselect",class:{"multiselect--extended":!e.isRestrictedToIds,"multiselect--mobile-select":e.isMobile},staticStyle:{padding:"0"},attrs:{id:"multiselect-id",label:"name","track-by":"name",placeholder:e.myPlaceholder,"open-direction":"bottom","select-label":"",options:e.receivers,multiple:e.multiselect,loading:e.loading,searchable:!0,"internal-search":e.isRestrictedToIds,"clear-on-select":!0,"options-limit":300,"max-height":250,"show-no-results":!0,"hide-selected":!0,"show-no-options":!1,disabled:e.readonly},on:{select:e.receiverSelected,remove:e.receiverRemoved,input:e.receiverInputHandler},scopedSlots:e._u([{key:"clear",fn:function(t){return[e.selectedReceivers.length?n("div",{staticClass:"multiselect-clear",on:{mousedown:function(n){return n.preventDefault(),n.stopPropagation(),e.clearAll(t.search)}}}):e._e()]}},{key:"tag",fn:function(t){return[e.isGroupUsers(t)?[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-chip",e._g({staticClass:"v-chip--select-multi white--text",attrs:{small:"",close:!e.readonly,color:"primary_light"},on:{"click:close":function(n){return e.receiverRemoved(t.option)}}},o),[n("span",{class:{mobileChipContent:e.isMobile}},[e._v("\n                      "+e._s(t.option.displayName)+"\n                    ")])])]}}],null,!0)},[e._v(" "),n("div",[n("span",{domProps:{innerHTML:e._s(e.getNamesByGroupId(t.option.id))}})])])]:[e.tooltipFields.length?n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-chip",e._g({staticClass:"v-chip--select-multi white--text",attrs:{small:"",close:!e.readonly,color:"primary_light"},on:{"click:close":function(n){return e.receiverRemoved(t.option)}}},o),[n("v-icon",{staticClass:"mr-1 user-icon"},[e._v("\n                      "+e._s(e.tagIcon(t.option))+"\n                    ")]),e._v(" "),n("span",{class:{mobileChipContent:e.isMobile}},[e._v(e._s(t.option.displayName))])],1)]}}],null,!0)},[e._v(" "),e._l(e.tooltipFields,(function(i,o){return n("div",{key:o+":"+e._uid,staticClass:"d-flex align-center"},[n("span",{staticClass:"font-weight-bold mr-2"},[e._v(e._s(i.label))]),e._v(" "),n("span",[e._v(e._s(t.option[i.fieldName]))])])}))],2):n("div",[n("v-chip",{staticClass:"chip--select-multi white--text",attrs:{color:"primary_light",close:!e.readonly,small:""},on:{"click:close":function(n){return e.receiverRemoved(t.option)}}},[n("v-icon",{staticClass:"mr-1 user-icon"},[e._v("\n                    "+e._s(e.tagIcon(t.option))+"\n                  ")]),e._v(" "),n("span",{class:{mobileChipContent:e.isMobile}},[e._v(e._s(t.option.displayName))])],1)],1)]]}},{key:"option",fn:function(t){return[n("v-row",{staticClass:"py-2",attrs:{"no-gutters":""}},[n("v-icon",{staticClass:"align-self-start",attrs:{size:"18"}},[e._v("\n                "+e._s(e.tagIcon(t.option))+"\n              ")]),e._v(" "),n("div",[e._v("\n                "+e._s(t.option.name)+" ("+e._s(t.option.departmentName)+")\n                "),n("div",{staticClass:"position-name"},[n("span",[e._v(e._s(t.option.positionName))])])])],1)]}}]),model:{value:e.selectedReceivers,callback:function(t){e.selectedReceivers=t},expression:"selectedReceivers"}},e.bindOn),[e._v(" "),e._v(" "),e._v(" "),n("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v(e._s(e.notFoundMessage))])]),e._v(" "),n("label",{directives:[{name:"show",rawName:"v-show",value:e.isRequiredErrorShow,expression:"isRequiredErrorShow"},{name:"translate",rawName:"v-translate"}],staticClass:"pl-3 error--text"},[e._v("\n          Необходим хотя бы один получатель\n        ")])],1),e._v(" "),n("div",[e.isMobile||e.isRestrictedToIds?e._e():n("v-btn",{staticClass:"grey--border lighten-3 mx-0 my-0 square-sm-button rounded-button",attrs:{id:"addReceiver",outlined:"",disabled:e.readonly},on:{click:e.onAddReceiver}},[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"primary--text open-voc-icon"},[e._v("account_circle")]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{size:22,color:"primary",indeterminate:""}})],1)],1)],1),e._v(" "),e.withFavorite?n("v-row",{staticClass:"mt-2 no-gutters",staticStyle:{"min-height":"20px"},attrs:{id:"favoriteReceivers"}},[e.favoriteReceivers.length?[e.favoriteLabel&&e.favoriteReceivers.length?n("v-col",{staticClass:"col-12 mb-1"},[n("span",{staticClass:"text-body-1 black--text lighten-1 font-weight-bold"},[e._v(e._s(e.$gettext("Частые контакты:")))])]):e._e(),e._v(" "),n("v-col",[n("v-row",{class:{"position-start":e.favoriteLabel||e.favoriteReceivers.length<3},attrs:{align:"center","no-gutters":"",justify:"center"}},[e.tooltipFields.length?n("div",[n("v-sheet",{attrs:{"max-width":e.favoriteReceiversWidth}},[n("v-slide-group",{attrs:{multiple:""}},e._l(e.favoriteReceivers,(function(t,i){return n("v-slide-item",{key:t.id},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(o){var s=o.on;return[n("v-chip",e._g({key:"fav-rec:"+t.id,staticClass:"chip--select-multi white--text",class:{primary_light:t.isSelected,grey:!t.isSelected},attrs:{close:"",small:""},on:{"click:close":function(n){return e.deleteFavoriteReceiver(t,i)},click:function(n){return e.onFavoriteClick(t,i)}}},s),[n("v-icon",{staticClass:"mr-1 user-icon"},[e._v("\n                            "+e._s(e.tagIcon(t))+"\n                          ")]),e._v("\n                          "+e._s(t.displayName)+"\n                        ")],1)]}}],null,!0)},[e._v(" "),e._l(e.tooltipFields,(function(i,o){return n("div",{key:o+":"+e._uid,staticClass:"d-flex align-center"},[n("span",{staticClass:"font-weight-bold mr-2"},[e._v(e._s(i.label))]),e._v(" "),n("span",[e._v(e._s(t[i.fieldName]))])])}))],2)],1)})),1)],1)],1):n("div",[n("v-sheet",{attrs:{"max-width":e.favoriteReceiversWidth}},[n("v-slide-group",{attrs:{multiple:""}},e._l(e.favoriteReceivers,(function(t,i){return n("v-slide-item",{key:"fav-rec:"+t.id},[n("v-chip",{staticClass:"chip--select-multi white--text",class:{primary_light:t.isSelected,grey:!t.isSelected},attrs:{close:"",small:""},on:{input:function(n){return e.deleteFavoriteReceiver(t,i)},"click:close":function(n){return e.onFavoriteClick(t)}}},[n("v-icon",{staticClass:"mr-1 user-icon"},[e._v("\n                        "+e._s(e.tagIcon(t))+"\n                      ")]),e._v("\n                      "+e._s(t.displayName)+"\n                    ")],1)],1)})),1)],1)],1)])],1)]:e._e()],2):e._e()],1)],1)},Ph=[],Oh=n(28620),kh=n(40379),ldSelectReceivervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldSelectReceivervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ldSelectReceivervue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Fh=class LdSelectReceiverComponent extends(o()){constructor(){super(...arguments),this.receivers=[],this.selectedReceivers=[],this.favoriteReceivers=[],this.notFoundMessage=this.searchingNowText,this.loading=!1,this.getUsers=(0,Pl.Z)(this.fetchData.bind(this),500),this.multiselectUpdated=!1,this.userReceiversByGroups={}}onValueChanged(e,t){return ldSelectReceivervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(e&&!t&&this.selectedItems&&(this.selectedReceivers=this.selectedItems,this.receiverInputHandler()),this.value){let e=Array.isArray(this.value)?this.value:[this.value];if(!this.multiselect&&e.length&&(e=[e[0]]),e.length){const t=Array.isArray(this.selectedReceivers)?this.selectedReceivers:[],n=e.filter((e=>!t.find((t=>t.id===e))));n.length&&(this.selectedReceivers=yield this.fetchConcreteReceivers(e))}else this.selectedReceivers=[]}const n=[];this.selectedReceivers.forEach((e=>{(e.groupUsers||void 0!==e.groupType)&&(e.groupUsers=!0,n.push(e.id))})),n.length&&(yield this.getUsersByGroupId(n)),this.multiselectUpdated=!0,this.$nextTick((()=>{this.multiselectUpdated=!1}))}))}onValidateChanged(){this.$v.$touch()}onRestrictedIdsChanged(e){return ldSelectReceivervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){e.length>0&&(this.receivers=yield this.fetchConcreteReceivers(e))}))}created(){return ldSelectReceivervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=new Fe.AK(this.instructionTypeId);this.favoriteReceivers=yield this.fetchFavoriteReceivers(e),this.favoriteReceivers.forEach((e=>{let t=null;e.user?t=e.user:e.department?t=e.department:e.role&&(t=e.role),this.favoriteReceivers.length&&this.$emit("has-favorite",!0),this.createReceiverDisplayName(t),e.user?e.displayName=uc.X.userNameShorting(t.displayName):e.displayName=t.displayName,this.tooltipFields.forEach((n=>{n.fieldName in e&&(e[n.fieldName]=t[n.fieldName])}))}))}))}mounted(){this.$emit("mounted"),this.setFocus&&this.setFocusHandler()}receiverSelected(e){this.required&&this.$v.selectedReceivers.$touch(),this.emitUpdateReceivers();const t=this.selectedReceivers.length;this.checkLastAddedReceiver(e,t),this.isRestrictedToIds||(this.receivers=[]),this.receiverInputHandler(),this.setFocusHandler()}receiverRemoved(e){const t=this.selectedReceivers.indexOf(e);if(t>=0&&(this.selectedReceivers.splice(t,1),this.required&&this.$v.selectedReceivers.$touch()),null===e||void 0===e?void 0:e.isFav){const t=this.favoriteReceivers.findIndex((t=>t.id===e.id));this.favoriteReceivers[t].isSelected=!1}if(this.tooltipFields&&this.tooltipFields.length){const e=this.selectedReceivers;return this.selectedReceivers=[],void setTimeout((()=>{this.selectedReceivers=e,this.emitUpdateReceivers(),this.$refs.multiselect&&this.$refs.multiselect.$emit("close")}),10)}this.emitUpdateReceivers(),this.$refs.multiselect&&this.$refs.multiselect.$emit("close")}receiverInputHandler(){for(const e of this.selectedReceivers)this.createReceiverDisplayName(e)}clearAll(){this.selectedReceivers.length=0,this.required&&this.$v.selectedReceivers.$touch(),this.emitUpdateReceivers()}tagIcon(e){switch(e.type){case Nn.OP.GroupUser:return"group";case Nn.OP.User:return"person";case Nn.OP.Department:return"group";case Nn.OP.Role:return"group";default:return"person"}}onAddReceiver(){return ldSelectReceivervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.selectedReceivers||(this.selectedReceivers=[]);const e=new Nl.B(this.$gettext("Выберите получателей сообщения"),this.multiselect,this.receiverTypes,[...this.selectedReceivers],this.instructionTypeId,!0,!1,this.states,this.canReceiveInstruction),t=yield this.queryBus.exec(e);t&&t.length&&(this.selectedReceivers=t,this.required&&this.$v.selectedReceivers.$touch(),this.checkReceiversOnFavorite(),this.emitUpdateReceivers())}))}checkLastAddedReceiver(e,t){const n=this.favoriteReceivers.filter((t=>t.id===e.id))[0];n&&!n.isSelected&&(n.isSelected=!0,this.selectedReceivers[t].isFav=!0)}checkReceiversOnFavorite(){this.favoriteReceivers.forEach(((e,t)=>{const n=this.selectedReceivers.findIndex((t=>e.id===t.id)),i=e.isSelected;-1===n&&i?e.isSelected=!1:-1===n||i||(e.isSelected=!0,this.selectedReceivers[n].isFav=!0)}))}deleteFavoriteReceiver(e,t){return ldSelectReceivervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const n=new un.SI(this.instructionTypeId,String(e.id)),i=yield this.commandBus.exec(n);if(e.isSelected){const t=this.selectedReceivers.findIndex((t=>t.id===e.id));this.selectedReceivers.splice(t,1),this.emitUpdateReceivers()}this.favoriteReceivers.splice(t,1),i.error||this.$toasted.success(this.$gettextInterpolate(this.$gettext("Получатель %{receiver} удалён из списка частых контактов"),{receiver:e.displayName})),i.error&&this.$toasted.success(this.$gettextInterpolate(this.$gettext("При удалении пользователя %{receiver} из списка частых контактов произошла ошибка: %{err}"),{receiver:e.displayName,err:i.error}))}))}onFavoriteClick(e){e.isSelected?this.selectedReceivers=this.selectedReceivers.filter((t=>t.id!==e.id)):this.selectedReceivers.push(Object.assign(Object.assign({},e),{isFav:!0})),e.isSelected=!e.isSelected,this.emitUpdateReceivers()}setFocusHandler(){const e=this.$el.querySelector(".multiselect");e&&e.focus()}isGroupUsers(e){var t;return null===(t=e.option)||void 0===t?void 0:t.groupUsers}getNamesByGroupId(e){return this.userReceiversByGroups[e]&&Array.isArray(this.userReceiversByGroups[e])?this.userReceiversByGroups[e].join("<br>"):""}updateSelectedItems(){const e=this.selectedReceivers;Array.isArray(this.selectedItems)&&Array.isArray(e)&&(e.forEach((e=>{this.selectedItems.find((t=>t.id===e.id))||this.selectedItems.push(e)})),this.selectedItems.forEach(((t,n)=>{e.find((e=>e.id===t.id))||this.selectedItems.splice(n,1)})))}emitUpdateReceivers(){this.$nextTick((()=>{this.$emit("update-receivers",this.selectedReceivers),this.updateSelectedItems();let e=[];this.selectedReceivers&&(e=this.selectedReceivers.map((e=>e.id))),e.length||e.push(0),this.multiselect?(0,ba.Z)(e,this.value)||this.$emit("input",e):this.value!==e[0]&&this.$emit("input",e[0])}))}fetchConcreteReceivers(e){return ldSelectReceivervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let t=[];if(!e)return t;try{return this.loading=!0,t=yield this.fetchSearchReceiversById(new vr.uR(e,!0)),t&&t.forEach((e=>this.createReceiverDisplayName(e))),t.map((e=>Object.assign(Object.assign({},e),e.value)))}catch(e){this.$log.debug(e)}finally{this.loading=!1}}))}fetchData(e){0!==e.length&&(this.cancellationService.cancel(Ae.M.SearchReceiversByInstructionTypeQuery),this.notFoundMessage=this.searchingNowText,this.$nextTick((()=>ldSelectReceivervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{this.loading=!0;const t=yield this.fetchSearchReceiversByInstructionType(new vr.qv(this.instructionTypeId,e,!0,null,!1,this.states,this.canReceiveInstruction));this.receivers=t.map((e=>Object.assign(Object.assign({},e),e.value))),this.receivers&&this.receivers.length?this.notFoundMessage=this.searchingNowText:this.notFoundMessage=this.$gettext("Поиск не дал результатов.")}catch(e){e instanceof Fn.Mk||(this.notFoundMessage=this.$gettext("Поиск не дал результатов (-:")),this.$log.debug(e)}finally{this.loading=!1}})))))}createReceiverDisplayName(e){var t,n;let i="";"name"in e&&e.name?i=e.name:"fullName"in e&&e.fullName?i=e.fullName:"departmentName"in e&&e.departmentName?i=e.departmentName:(null===(t=e.user)||void 0===t?void 0:t.name)&&(i=null===(n=e.user)||void 0===n?void 0:n.name),e.displayName=i}getUsersByGroupId(e){return ldSelectReceivervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){for(const t of e)if(!this.userReceiversByGroups[t]){const e=yield this.fetchUserReceiversByGroups(new vr.c0([t]));if(Array.isArray(e)&&e.length){const n=e.map((({user:e})=>e.name));this.$set(this.userReceiversByGroups,t,n)}}}))}get myPlaceholder(){return this.selectedReceivers.length>0?"":this.placeholder}get isRequiredErrorShow(){return this.required&&this.$v.selectedReceivers.$error}get isRestrictedToIds(){return this.restrictedIds.length>0}get bindOn(){return this.isRestrictedToIds?null:{"search-change":this.getUsers}}get favoriteReceiversWidth(){return this.favoriteLabel?"660":"387"}get searchingNowText(){return this.$gettext("Идёт поиск...")}};ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:0}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Number)],Fh.prototype,"instructionTypeId",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)(),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Array)],Fh.prototype,"receiverTypes",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)(),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Object)],Fh.prototype,"value",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)(),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Array)],Fh.prototype,"selectedItems",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({type:String,default:""}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",String)],Fh.prototype,"placeholder",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Boolean)],Fh.prototype,"multiselect",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Boolean)],Fh.prototype,"readonly",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Boolean)],Fh.prototype,"required",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Boolean)],Fh.prototype,"withFavorite",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:!0}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Boolean)],Fh.prototype,"favoriteLabel",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)(),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Number)],Fh.prototype,"validate",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)(),ldSelectReceivervue_type_script_lang_js_metadata("design:type",String)],Fh.prototype,"label",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Boolean)],Fh.prototype,"labelInline",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:()=>[]}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Array)],Fh.prototype,"tooltipFields",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({default:()=>[]}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Array)],Fh.prototype,"restrictedIds",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Array,default:null}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Array)],Fh.prototype,"states",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Boolean)],Fh.prototype,"canReceiveInstruction",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Boolean)],Fh.prototype,"setFocus",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Object)],Fh.prototype,"queryBus",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Object)],Fh.prototype,"commandBus",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,ot.t)(Tl.h),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Tl.h)],Fh.prototype,"cancellationService",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,fa.Vw)("fetchSearchReceiversByInstructionType"),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Object)],Fh.prototype,"fetchSearchReceiversByInstructionType",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,fa.Vw)("fetchSearchReceiversById"),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Object)],Fh.prototype,"fetchSearchReceiversById",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,fa.Rm)("fetchFavoriteReceivers"),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Object)],Fh.prototype,"fetchFavoriteReceivers",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,fa.Vw)("fetchUserReceiversByGroups"),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Object)],Fh.prototype,"fetchUserReceiversByGroups",void 0),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Watch)("value",{immediate:!0}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Function),ldSelectReceivervue_type_script_lang_js_metadata("design:paramtypes",[Object,Object]),ldSelectReceivervue_type_script_lang_js_metadata("design:returntype",Promise)],Fh.prototype,"onValueChanged",null),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Watch)("validate"),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Function),ldSelectReceivervue_type_script_lang_js_metadata("design:paramtypes",[]),ldSelectReceivervue_type_script_lang_js_metadata("design:returntype",void 0)],Fh.prototype,"onValidateChanged",null),ldSelectReceivervue_type_script_lang_js_decorate([(0,rt.Watch)("restrictedIds",{immediate:!0}),ldSelectReceivervue_type_script_lang_js_metadata("design:type",Function),ldSelectReceivervue_type_script_lang_js_metadata("design:paramtypes",[Array]),ldSelectReceivervue_type_script_lang_js_metadata("design:returntype",Promise)],Fh.prototype,"onRestrictedIdsChanged",null),Fh=ldSelectReceivervue_type_script_lang_js_decorate([(0,gt.default)({mixins:[Oh.oE],components:{"vue-multiselect":kl()},validations:{selectedReceivers:{requiredValidator:kh.C1}}})],Fh);const Ah=Fh,$h=Ah;var jh=n(17449),Eh=(0,Ct.Z)($h,ldSelectReceivervue_type_template_id_4597d32a_scoped_true_render,Ph,!1,null,"4597d32a",null);const Mh=Eh.exports;_t()(Eh,{VBtn:g.Z,VChip:P.Z,VCol:r.Z,VIcon:y.Z,VProgressCircular:V.Z,VRow:a.Z,VSheet:jh.Z,VSlideGroup:G.Z,VSlideItem:K.Z,VTooltip:_.Z});const Nh=o().extend({functional:!0,props:{index:{type:String,default:null},heading:{type:String,default:null},disabled:{type:Boolean,default:!1},activeClass:{type:String,default:void 0},lazy:{type:Boolean,default:!1}},render(e,{props:t,slots:n}){return[e("v-tab",{props:t,key:t.index},[t.heading,n().icon]),e("v-tab-item",{props:t},[n().default])]}}),Vh=Nh;var Bh,Lh,Uh=(0,Ct.Z)(Vh,Bh,Lh,!1,null,"780caf94",null);const Hh=Uh.exports;var ldTabsvue_type_template_id_6c459793_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"ld-tabs no-gutters",class:{"ld-tabs-mobile":e.isMobile}},[e.vertical?n("div",{class:{"tabs-btn":!e.isMobile,"tab-mobile":e.isMobile}},[n("div",{staticClass:"d-flex justify-center"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"toggle-btn",attrs:{icon:""},on:{click:function(t){e.isTabsVisibled=!e.isTabsVisibled}}},i),[n("svg-icon",{staticClass:"svg-icon",class:{"primary--text":e.isTabsVisibled,"grey--text darken-3":!e.isTabsVisibled},attrs:{icon:"tab-menu"}})],1)]}}],null,!1,3498368250)},[e._v(" "),n("translate",[e._v(e._s(e.isTabsVisibled?"Скрыть вкладки":"Показать вкладки"))])],1)],1)]):e._e(),e._v(" "),n("div",{class:{"vertical-body":e.vertical,"horiz-body":!e.vertical},staticStyle:{overflow:"hidden"}},[n("v-tabs",{class:{"v-tabs-mobile":e.isMobile,vertical:e.vertical,horiz:!e.vertical,"hide-tabs":!e.isTabsVisibled,"hide-body":!e.isBodyVisibled,mobile:e.isMobile},attrs:{dark:e.dark,vertical:e.vertical},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[e._t("default")],2),e._v(" "),n("div",{staticClass:"footer"},[e._t("footer")],2)],1)])},Qh=[],ldTabsvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldTabsvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let zh=class LdTabsComponent extends(o()){constructor(){super(...arguments),this.active=-1,this.isTabsVisibled=!0,this.isBodyVisibled=!0,this.styleCleaned=!1}onValueChanged(e,t){e!==t&&(this.active=e)}onIsActiveChanged(){(this.isActive||0===this.isActive)&&(this.active=this.isActive)}onActiveChanged(){this.isMobile&&this.isTabsVisibled&&(this.isTabsVisibled=!1),this.$emit("change-step",this.active),this.$emit("input",this.active),Je.X.$emit("doc:change-active-tab",this.$templateRenderer,this.active)}onMobileChanged(){this.isMobile?(this.createClickHandlers(),this.isTabsVisibled=!1,this.isBodyVisibled=!0,this.isMobile&&this.isTabsVisibled&&(this.isTabsVisibled=!1)):(this.removeClickHandlers(),this.isBodyVisibled=!0)}onIsTabsVisibledChanged(){if(this.isMobile&&(this.isBodyVisibled=!this.isTabsVisibled,!this.styleCleaned&&this.$el)){const e=this.$el.getElementsByClassName("v-window__container");if(e&&e.length){const t=e[0],n=t.style.getPropertyValue("height");"0px"===n&&(t.style.removeProperty("height"),this.styleCleaned=!0)}}}created(){Je.X.$on("set-doc-active-tab",this.setActiveTab)}mounted(){this.isMobile&&this.createClickHandlers()}destroyed(){Je.X.$off("set-doc-active-tab",this.setActiveTab)}createClickHandlers(){if(!this.$el)return;const e=this.$el.getElementsByClassName("v-tab");if(e&&e.length)for(let t=0;t<e.length;t++){const n=e[t];n.onclick=this.onClick.bind(this)}}removeClickHandlers(){if(!this.$el)return;const e=this.$el.getElementsByClassName("v-tabs__div");if(e&&e.length)for(let t=0;t<e.length;t++){const n=e[t];n.onclick=null}}onClick(){this.onActiveChanged()}setActiveTab(e,t){this.$templateRenderer===e&&(this.active=t)}get isBtnVisibled(){return this.isMobile?!!this.vertical&&this.isBodyVisibled:this.vertical}};ldTabsvue_type_script_lang_ts_decorate([(0,rt.Prop)(),ldTabsvue_type_script_lang_ts_metadata("design:type",Number)],zh.prototype,"isActive",void 0),ldTabsvue_type_script_lang_ts_decorate([(0,rt.Prop)({default:!0}),ldTabsvue_type_script_lang_ts_metadata("design:type",Boolean)],zh.prototype,"vertical",void 0),ldTabsvue_type_script_lang_ts_decorate([(0,rt.Prop)(),ldTabsvue_type_script_lang_ts_metadata("design:type",Boolean)],zh.prototype,"dark",void 0),ldTabsvue_type_script_lang_ts_decorate([(0,rt.Prop)(),ldTabsvue_type_script_lang_ts_metadata("design:type",Number)],zh.prototype,"value",void 0),ldTabsvue_type_script_lang_ts_decorate([(0,rt.Watch)("value",{immediate:!0}),ldTabsvue_type_script_lang_ts_metadata("design:type",Function),ldTabsvue_type_script_lang_ts_metadata("design:paramtypes",[Number,Number]),ldTabsvue_type_script_lang_ts_metadata("design:returntype",void 0)],zh.prototype,"onValueChanged",null),ldTabsvue_type_script_lang_ts_decorate([(0,rt.Watch)("isActive",{immediate:!0}),ldTabsvue_type_script_lang_ts_metadata("design:type",Function),ldTabsvue_type_script_lang_ts_metadata("design:paramtypes",[]),ldTabsvue_type_script_lang_ts_metadata("design:returntype",void 0)],zh.prototype,"onIsActiveChanged",null),ldTabsvue_type_script_lang_ts_decorate([(0,rt.Watch)("active"),ldTabsvue_type_script_lang_ts_metadata("design:type",Function),ldTabsvue_type_script_lang_ts_metadata("design:paramtypes",[]),ldTabsvue_type_script_lang_ts_metadata("design:returntype",void 0)],zh.prototype,"onActiveChanged",null),ldTabsvue_type_script_lang_ts_decorate([(0,rt.Watch)("isMobile",{immediate:!0}),ldTabsvue_type_script_lang_ts_metadata("design:type",Function),ldTabsvue_type_script_lang_ts_metadata("design:paramtypes",[]),ldTabsvue_type_script_lang_ts_metadata("design:returntype",void 0)],zh.prototype,"onMobileChanged",null),ldTabsvue_type_script_lang_ts_decorate([(0,rt.Watch)("isTabsVisibled",{immediate:!0}),ldTabsvue_type_script_lang_ts_metadata("design:type",Function),ldTabsvue_type_script_lang_ts_metadata("design:paramtypes",[]),ldTabsvue_type_script_lang_ts_metadata("design:returntype",void 0)],zh.prototype,"onIsTabsVisibledChanged",null),zh=ldTabsvue_type_script_lang_ts_decorate([gt.default],zh);const Zh=zh,Wh=Zh;var qh=(0,Ct.Z)(Wh,ldTabsvue_type_template_id_6c459793_scoped_true_render,Qh,!1,null,"6c459793",null);const Gh=qh.exports;_t()(qh,{VBtn:g.Z,VRow:a.Z,VTabs:ee.Z,VTooltip:_.Z});var ldTextvue_type_template_id_787c23e4_scoped_true_functional_true_render=function(e,t){var n=t._c;return t.props.value?n("div",{staticClass:"sm-text"},[n("span",{staticClass:"grey--text darken-3 font-weight-bold"},[t._v(t._s(t.props.caption))]),t._v(" "),n("span",[t._v(" "+t._s(t.props.value))])]):t._e()},Kh=[];const Yh=o().extend({functional:!0,props:{caption:{type:String,default:null},value:{type:String,default:null}}}),Jh=Yh;var Xh=(0,Ct.Z)(Jh,ldTextvue_type_template_id_787c23e4_scoped_true_functional_true_render,Kh,!0,null,"787c23e4",null);const em=Xh.exports;var ldTitlevue_type_template_id_5f3213cc_scoped_true_functional_true_render=function(e,t){var n=t._c;return n("div",{attrs:{title:t.props.caption}},[n("span",[t._v(t._s(t.props.value))])])},tm=[];const nm=o().extend({functional:!0,props:{caption:{type:String,default:null},value:{type:String,default:null}}}),im=nm;var om=(0,Ct.Z)(im,ldTitlevue_type_template_id_5f3213cc_scoped_true_functional_true_render,tm,!0,null,"5f3213cc",null);const sm=om.exports;var ldTitledTextvue_type_template_id_1664e6f4_scoped_true_functional_true_render=function(e,t){var n=t._c;return n("div",[t.props.icon?n("span",[n("v-icon",[t._v(t._s(t.props.icon))])],1):t._e(),t._v(" "),n("strong",[t._v(" "+t._s(t.props.caption)+" ")]),t._v(" "),n("span",[t._v(t._s(t.props.value?t.props.value:"не задано"))])])},rm=[];const am=o().extend({functional:!0,props:{caption:{type:String,default:null},value:{type:String,default:null},icon:{type:String,default:null}}}),lm=am;var cm=(0,Ct.Z)(lm,ldTitledTextvue_type_template_id_1664e6f4_scoped_true_functional_true_render,rm,!0,null,"1664e6f4",null);const dm=cm.exports;_t()(cm,{VIcon:y.Z});var ldStepvue_type_template_id_327fcd12_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visibled,expression:"visibled"}]},[e._t("default")],2)},um=[],ldStepvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldStepvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let pm=class LdStepComponent extends(o()){constructor(){super(...arguments),this.visibled=!1,this.rendered=!1,this.loading=!1}created(){this.$emit("ld-step-created",this),this.setVisibled(this.outerVisible),this.$on("set-visibled",this.setVisibled.bind(this))}destroyed(){this.$emit("ld-step-destroyed",this),this.$off()}setVisibled(e){this.visibled=e}};ldStepvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldStepvue_type_script_lang_js_metadata("design:type",Number)],pm.prototype,"index",void 0),ldStepvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1,type:Boolean}),ldStepvue_type_script_lang_js_metadata("design:type",Boolean)],pm.prototype,"outerVisible",void 0),pm=ldStepvue_type_script_lang_js_decorate([gt.default],pm);const hm=pm,mm=hm;var fm=(0,Ct.Z)(mm,ldStepvue_type_template_id_327fcd12_scoped_true_render,um,!1,null,"327fcd12",null);const gm=fm.exports;var ldWizardvue_type_template_id_4e8452d8_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wizard"},[n("div",{staticClass:"content"},[e._t("default",null,{visible:e.show})],2),e._v(" "),n("div",{staticClass:"footer"},[n("v-btn",{staticClass:"white--text",attrs:{disabled:e.prevDisabled||0===e.stepIndex,color:"primary"},on:{click:e.onPrevClick}},[n("translate",[e._v("Назад")]),e._v(" "),n("v-icon",{attrs:{right:"",dark:""}},[e._v("arrow_back")])],1),e._v(" "),n("v-btn",{staticClass:"white--text",attrs:{disabled:e.nextDisabled||e.stepIndex===e.maxStepIndex,color:"primary"},on:{click:e.onNextClick}},[n("translate",[e._v("Вперед")]),e._v(" "),n("v-icon",{attrs:{right:"",dark:""}},[e._v("arrow_forward")])],1)],1)])},ym=[],ldWizardvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldWizardvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let vm=class LdWizardComponent extends(o()){constructor(){super(...arguments),this.step=null,this.stepIndex=0,this.steps=[],this.show=!0}onValueChanged(){this.value&&(this.stepIndex=this.value,this.setStepVisibled(this.stepIndex))}mounted(){const e=(this.$slots.default||[]).length;for(let t=0;t<e;t++){const e=this.$slots.default[t];e.componentOptions&&"ld-step"===e.componentOptions.tag&&this.steps.push(e.componentInstance)}this.setStepVisibled(this.stepIndex)}onPrevClick(){this.setStepIndex(this.stepIndex-1),this.setStepVisibled(this.stepIndex)}onNextClick(){this.setStepIndex(this.stepIndex+1),this.setStepVisibled(this.stepIndex)}get maxStepIndex(){return this.steps.length-1}setStepIndex(e){this.stepIndex=e,this.$emit("input",e)}setStepVisibled(e){this.step&&this.step.$emit("set-visibled",!1),this.step=this.steps.length?this.steps[e]:null,this.step&&this.step.$emit("set-visibled",!0)}};ldWizardvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldWizardvue_type_script_lang_js_metadata("design:type",Number)],vm.prototype,"value",void 0),ldWizardvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldWizardvue_type_script_lang_js_metadata("design:type",Boolean)],vm.prototype,"prevDisabled",void 0),ldWizardvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldWizardvue_type_script_lang_js_metadata("design:type",Boolean)],vm.prototype,"nextDisabled",void 0),ldWizardvue_type_script_lang_js_decorate([(0,rt.Watch)("value",{immediate:!0}),ldWizardvue_type_script_lang_js_metadata("design:type",Function),ldWizardvue_type_script_lang_js_metadata("design:paramtypes",[]),ldWizardvue_type_script_lang_js_metadata("design:returntype",void 0)],vm.prototype,"onValueChanged",null),vm=ldWizardvue_type_script_lang_js_decorate([gt.default],vm);const bm=vm,Cm=bm;var wm=(0,Ct.Z)(Cm,ldWizardvue_type_template_id_4e8452d8_scoped_true_render,ym,!1,null,"4e8452d8",null);const _m=wm.exports;_t()(wm,{VBtn:g.Z,VIcon:y.Z});var ldWizardTabsvue_type_template_id_1211b082_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wizard"},[n("div",{staticClass:"content"},[n("ld-tabs",{attrs:{"is-active":e.stepIndex,vertical:!0,mobile:e.mobile},on:{"change-step":e.setStepIndex},scopedSlots:e._u([{key:"footer",fn:function(){return[n("v-btn",{staticClass:"white--text wizard-btn",attrs:{disabled:e.isPrevDisabled,color:"primary",tile:""},on:{click:e.onPrevClick}},[n("v-icon",{attrs:{left:"",dark:""}},[e._v("arrow_back")]),e._v(" "),n("translate",[e._v("Назад")])],1),e._v(" "),e.stepIndex!==e.maxStepIndex?n("v-btn",{staticClass:"white--text wizard-btn",attrs:{disabled:e.isNextDisabled,color:"primary",tile:""},on:{click:e.onNextClick}},[n("translate",[e._v("Вперед")]),e._v(" "),n("v-icon",{attrs:{right:"",dark:""}},[e._v("arrow_forward")])],1):e._e(),e._v(" "),e.stepIndex===e.maxStepIndex?n("v-btn",{staticClass:"white--text wizard-btn",attrs:{disabled:e.finishDisabled,color:"primary",tile:"",loading:e.saving},on:{click:e.onSaveClick}},[e._v("\n          "+e._s(e.finishText)+"\n          "),n("v-icon",{attrs:{right:"",dark:""}},[e._v("save")])],1):e._e()]},proxy:!0}])},[e._t("default")],2)],1)])},xm=[],ldWizardTabsvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldWizardTabsvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Sm=class LdWizardTabsComponent extends(o()){constructor(){super(...arguments),this.step=null,this.stepIndex=0,this.steps=[],this.saving=!1}onValueChanged(){this.value!==this.stepIndex&&(this.stepIndex=this.value)}onStepIndexChange(e,t){this.stepIndex!==e&&this.$emit("input",e)}mounted(){Je.X.$on("document-save-completed",(()=>this.saving=!1));const e=(this.$slots.default||[]).length;for(let t=0;t<e;t++){const e=this.$slots.default[t];e.componentOptions&&"v-tab"===e.componentOptions.tag&&this.steps.push({instance:e.componentInstance,valid:!0})}}onPrevClick(){const e=this.steps[this.stepIndex];try{if(!this.disablePrevStepValidation&&this.changePageChecker){const t=this.changePageChecker(this.stepIndex,this.stepIndex-1);if(e.valid=t,!t)return}e.valid=!0,this.setStepIndex(this.stepIndex-1),this.$emit("prev-click",this.stepIndex,this.stepIndex+1)}finally{this.updateTabClass(e)}}onNextClick(){const e=this.steps[this.stepIndex];try{if(this.changePageChecker){const t=this.changePageChecker(this.stepIndex,this.stepIndex+1);if(e.valid=t,!t)return}e.valid=!0,this.$nextTick((()=>{this.steps[this.stepIndex+1].instance.disabled||(this.setStepIndex(this.stepIndex+1),this.$emit("next-click",this.stepIndex,this.stepIndex-1))}))}finally{this.updateTabClass(e)}}onSaveClick(){this.saving=!0,this.$emit("save-doc-click"),Je.X.$emit("save-document")}updateTabClass(e){e&&e.instance.$el.classList.toggle("valid-tab",e.valid)}get maxStepIndex(){return this.steps.length-1}get isNextDisabled(){const e=this.steps.length?this.steps[this.stepIndex+1]:null;return!e}get isPrevDisabled(){if(0===this.stepIndex)return!0;const e=this.steps.length?this.steps[this.stepIndex-1]:null;return!e}setStepIndex(e){this.stepIndex=e,this.$emit("input",e)}};ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Number)],Sm.prototype,"value",void 0),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Boolean)],Sm.prototype,"prevDisabled",void 0),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Boolean)],Sm.prototype,"nextDisabled",void 0),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!1}),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Boolean)],Sm.prototype,"finishDisabled",void 0),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Prop)({default:"Сохранить"}),ldWizardTabsvue_type_script_lang_js_metadata("design:type",String)],Sm.prototype,"finishText",void 0),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Function)],Sm.prototype,"changePageChecker",void 0),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Prop)(),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Boolean)],Sm.prototype,"mobile",void 0),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Prop)({default:!0}),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Boolean)],Sm.prototype,"disablePrevStepValidation",void 0),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Watch)("value",{immediate:!0}),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Function),ldWizardTabsvue_type_script_lang_js_metadata("design:paramtypes",[]),ldWizardTabsvue_type_script_lang_js_metadata("design:returntype",void 0)],Sm.prototype,"onValueChanged",null),ldWizardTabsvue_type_script_lang_js_decorate([(0,rt.Watch)("stepIndex",{immediate:!1}),ldWizardTabsvue_type_script_lang_js_metadata("design:type",Function),ldWizardTabsvue_type_script_lang_js_metadata("design:paramtypes",[Number,Number]),ldWizardTabsvue_type_script_lang_js_metadata("design:returntype",void 0)],Sm.prototype,"onStepIndexChange",null),Sm=ldWizardTabsvue_type_script_lang_js_decorate([gt.default],Sm);const Im=Sm,Dm=Im;var Rm=(0,Ct.Z)(Dm,ldWizardTabsvue_type_template_id_1211b082_scoped_true_render,xm,!1,null,"1211b082",null);const Tm=Rm.exports;_t()(Rm,{VBtn:g.Z,VIcon:y.Z});var Pm,lastActionsvue_type_template_id_627cc20f_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{staticClass:"pl-4 pr-0 py-0"},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"pr-2 pt-2",class:{"pb-2":!e.isMobile,"last-viewed":e.isMobile},attrs:{cols:"12"}},[n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.loadingHistory}}),e._v(" "),e.listItems?n("v-list",{staticClass:"py-0"},e._l(e.listItems,(function(t,i){return n("v-list-item",{key:i,on:{click:function(n){return e.onClick(t)}}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"12"}},[n("v-row",{staticClass:"list-item-row",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"list-item__icon"},[n("v-icon",{attrs:{color:"primary",size:"19"}},[e._v(" "+e._s(t.icon)+" ")])],1),e._v(" "),n("v-col",{staticClass:"list-item__title"},[t.isInstruction?[n("span",{staticClass:"list-item__title_text"},[e._v(" "+e._s(t.type)+" "+e._s(e.$gettext("от"))+" "+e._s(t.creator)+" ")])]:e._e(),e._v(" "),t.isDocument?[n("span",{staticClass:"list-item__title_text"},[e._v(" №"+e._s(t.regNumber)+" ")]),e._v(" "),n("span",{staticClass:"grey--text"},[e._v("  |  ")]),e._v(" "),n("span",{staticClass:"grey--text"},[e._v(e._s(t.regDate))])]:e._e()],2)],1),e._v(" "),t.isDocument||t.isInstruction&&t.isExecControl?n("v-row",{staticClass:"list-item-row",attrs:{"no-gutters":""}},[n("v-col",{staticStyle:{"margin-left":"27px"},attrs:{cols:"10"}},[t.isInstruction&&t.isExecControl?n("span",{staticClass:"body-1 text-overflow",class:{"error--text":t.isExecControlFailed,"grey--text":!t.isExecControlFailed}},[e._v("\n                    Срок: "+e._s(t.execDate)+"\n                  ")]):e._e(),e._v(" "),t.isDocument?n("span",{staticClass:"body-1 grey--text text-overflow"},[e._v(" "+e._s(t.journalName)+" ")]):e._e()])],1):e._e(),e._v(" "),n("v-row",{staticClass:"list-item-row",attrs:{"no-gutters":""}},[n("v-col",{staticStyle:{"margin-left":"27px"},attrs:{cols:"10"}},[n("span",{staticClass:"body-1 text-overflow"},[e._v(" "+e._s(t.annotation)+" ")])])],1)],1)],1)],1)})),1):n("div",{staticClass:"body-1"},[e.loadingHistory?n("span",[e._v(" Загрузка истории просмотров... ")]):n("span",{staticClass:"grey--text"},[e._v(" История просмотра отсутствует ")])])],1)],1)],1)},Om=[];(function(e){e["Document"]="description",e["Instruction"]="mail",e["Default"]=""})(Pm||(Pm={}));var lastActionsvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},lastActionsvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},lastActionsvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let km=class LastActionsComponent extends rt.Vue{constructor(){super(...arguments),this.historyList=null,this.listItems=null,this.loadingHistory=!1,this.viewMode=Ue.Ml.List,this.section=Le.S.Dashboard,this.fetchOptions={section:this.section,folderInfo:null,sortField:{cellName:"createDateTime",text:this.$gettext("Дата создания"),isAsc:null,isDate:!0},filter:null,refreshCounter:0,page:1,pageSize:10,unreadOnlyFilter:!1,searchTerm:""}}created(){this.readHistory();const e=this.$config.dashboardNewsFolderId||124394653;this.$nextTick((()=>this.fetchOptions.folderInfo={id:e,name:this.$gettext("Новости"),compositeId:String(e),topLevelFolderId:0,nodeType:Tt.J.DocumentFolder,contentType:Ue.zc.Document,kind:null,parentId:0}))}readHistory(){return lastActionsvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loadingHistory=!0;try{this.historyList=yield this.fetchHistory(new Ze.Zo),this.historyList&&this.historyList.length&&(this.listItems=this.historyList.map((e=>{let t={id:e.item.id,isDocument:!1,isInstruction:!1};switch(e.historyItemType){case Be.g.Document:t=Object.assign(Object.assign({},t),{isDocument:!0,icon:Pm.Document,regNumber:e.item.attributes.RegistrationNumber,regDate:Ln.C.dateToString(new Date(e.item.attributes.RegistrationDate),"date"),journalName:e.item.journalName,annotation:e.item.attributes.Annotation});break;case Be.g.Instruction:if(t=Object.assign(Object.assign({},t),{isInstruction:!0,icon:Pm.Instruction,type:e.item.instructionTypeName,creator:uc.X.userNameShorting(e.item.creatorName),annotation:e.item.mailText,isExecControl:Boolean(e.item.executionEndDate)}),t.isExecControl){const n=Ln.C.convert(e.item.executionEndDate),i=Ln.C.now();t.execDate=Ln.C.dateToString(n,"date time"),t.isExecControlFailed=Ln.C.compare(n,i)<0}break}return t})))}finally{this.historyList&&!this.historyList.length&&(this.historyList=null),this.loadingHistory=!1}}))}onClick(e){e.isInstruction&&this.$app.viewMessage(e.id,this.createContext(Ue.zc.Instruction)),e.isDocument&&this.$app.viewDoc(e.id,this.createContext(Ue.zc.Document))}createContext(e){return{section:this.section,collectionViewMode:Ue.Ml.None,contentType:e,entityViewMode:Ue.dS.View,folderId:0,folderName:"",breadcrumbs:new Ye.O}}};lastActionsvue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),lastActionsvue_type_script_lang_js_metadata("design:type",Object)],km.prototype,"queryBus",void 0),lastActionsvue_type_script_lang_js_decorate([(0,fa.Hg)("fetchHistory"),lastActionsvue_type_script_lang_js_metadata("design:type",Object)],km.prototype,"fetchHistory",void 0),km=lastActionsvue_type_script_lang_js_decorate([rt.Component],km);const Fm=km,Am=Fm;var $m=(0,Ct.Z)(Am,lastActionsvue_type_template_id_627cc20f_scoped_true_render,Om,!1,null,"627cc20f",null);const jm=$m.exports;_t()($m,{VCol:r.Z,VContainer:pe.Z,VIcon:y.Z,VList:m.Z,VListItem:ae.Z,VRow:a.Z});var Em=n(91739),Mm=n.n(Em);function defaultHelp(){return{app:{},msg:{},doc:{},rep:{},hst:{},fav:{},arc:{},opt:{},srch:{},voc:{}}}var startupFunctions_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Nm={install(e,t){e.prototype.$app=t}},Vm="application/json",Bm="max-age=0, no-cache, must-revalidate, proxy-revalidate",Lm={install(e,t){e.prototype.$help=t}};function fetchConfig(){var e;return startupFunctions_awaiter(this,void 0,void 0,(function*(){let t,n,i="config.json";const o={headers:{"Content-Type":Vm,"Cache-Control":Bm}};try{const{data:e}=yield xn().get(`config/${i}`,o);n=e}catch(e){n=null}try{const{data:e}=yield xn().get(i,o);t=e}catch(e){console.error(e),t=ln}n=Object.assign(t,n);{let e=n.apiPath;0,e.endsWith("/")||(e+="/"),n.apiPath=(t=1)=>t&&1!==t?e.replace("/v1/",`/v${t}/`):e}if(n.enableEsign){const e=["assets/lib/cadesplugin_api.js"];for(const t of e)downloadScript(t)}const s=yield fetchSearchConfig();return n.searchConfig=s,n.defLang=null!==(e=n.defLang)&&void 0!==e?e:"ru",n=Object.freeze(n),n}))}function fetchSearchConfig(){return startupFunctions_awaiter(this,void 0,void 0,(function*(){let e,t,n="searchConfig.json";const i={headers:{"Content-Type":Vm,"Cache-Control":Bm}};try{const{data:t}=yield xn().get(`config/${n}`,i);e=t}catch(t){e=null}try{const{data:e}=yield xn().get(n,i);t=e}catch(e){console.error(e),t=Br}return e=Object.assign(t,e),e}))}function configureStore(e,t){const n=createStore(e,t);return e.bind(je.t.Store).toConstantValue(n),n.commit(On.Jx,e),n}function registerHelp(e){return startupFunctions_awaiter(this,void 0,void 0,(function*(){let t=defaultHelp();e.enableHelp&&(t=yield n.e(291).then(n.t.bind(n,20291,19))),o().use(Lm,t)}))}function registerApp(e){o().use(Nm,e)}function registerLdComponents(){o().component("datatable",Mm()),o().component("document-template-renderer",yd),o().component("chart-viewer",Kc),o().component("last-actions",jm),o().component("documents-news",eu),o().component("favourite-docs",lu),o().component("catalogue-template-renderer",Hc.default),o().component("message-template-renderer",xd),o().component("action-panel",kd.default),o().component("attach-doc",Fd.Z),o().component("send-types",sa),o().component("select-user",Od),o().component("ld-container",Ip),o().component("ld-row",_h),o().component("ld-attachment",Gu),o().component("ld-page-title",yh),o().component("ld-hovered-item",eh),o().component("ld-titled-text",dm),o().component("ld-date",Op),o().component("ld-number",ph),o().component("ld-title",sm),o().component("ld-text",em),o().component("ld-badge",ep),o().component("uib-tabset",Gh),o().component("ld-tabs",Gh),o().component("uib-tab",Hh),o().component("ld-tab",Hh),o().component("ld-include",ah),o().component("ld-wizard",_m),o().component("ld-step",gm),o().component("ld-combobox",Cp),o().component("ld-file-uploader",Gp),o().component("ld-files-viewer",bu.Z),o().component("ld-select-receivers",Mh),o().component("lb-breadcrumbs",Zr),o().component("ld-attach-files",Uu),o().component("ld-edit-text",Ep),o().component("ld-edit-text-area",Up),o().component("ld-wizard-tabs",Tm),o().component("ld-sign-viewer",tu.Z),o().component("ld-agree-list",Cu.Z),o().component("ld-instruction-tree",Pu),o().component("ld-chainsheaves",lp),o().component("ld-checkbox",mp),o().component("ld-section",Th),o().component("ld-btn",Jr),o().component("ld-app-titlebar",Eu),o().component("card-routing",bl),o().component("card-writeoff-document",Uc),o().component("card-timeline",gc),o().component("card-combobox",Sa),o().component("card-edit-text",Za),o().component("card-checkbox",ha),o().component("file-editor",yu),o().component("card-select-users",Hl),o().component("card-textarea",nc),o().component("card-datepicker",Aa),o().component("card-users-viewer",Tc),o().component("card-table",Kl),o().component("card-text-viewer",cc),o().component("card-select-list-textbox",El),o().component("card-radiogroup",hl),o().component("card-radiobutton",rl),o().component("card-voc-viewer",$c),o().component("card-select-doc",Dl),o().component("card-doc-items",Ba),o().component("card-timepicker",_c),o().component("card-folder-structure",el),o().component("create-edit-route",Ld),o().component("display-running-route",Wd)}function fetchInitialState(e){return startupFunctions_awaiter(this,void 0,void 0,(function*(){let t;const n={headers:{"Content-Type":"application/json","Cache-Control":"max-age=0, no-cache, must-revalidate, proxy-revalidate"}};try{const{data:i}=yield xn().get(`${e.apiPath()}start`,n);t=i}catch(i){if(console.info(i),404===i.response.status)try{const i=[];i.push(xn().get(`${e.apiPath()}me`,n)),i.push(xn().get(`${e.apiPath()}me/settings`,n)),i.push(xn().get(`${e.apiPath()}me/lasturl`,n));const o=yield Promise.all(i);t={isFirstStart:!1,currentUser:o[0].data,userSettings:o[1].data,lastVisitedUrl:o[2].data,sendTimeout:"00:30:00",apiVersion:"?",inactiveTimeout:"00:10:00",wsVersion:"?"}}catch(e){t=null}else 401!==i.response.status&&403!==i.status||(t=null)}return t}))}function downloadScript(e){const t=document.createElement("script");t.type="text/javascript",t.charset="utf-8",t.src=e,document.body.appendChild(t)}var Um=n(83149);n(46118);const Hm=o().component("messages-container",{template:'<div style="height: 100%; width: 100%;">\n      <router-view v-bind="$attrs"></router-view>\n    </div>'}),dashboardComponent=()=>n.e(2677).then(n.bind(n,72677)).then((e=>e)),loginComponent=()=>n.e(7455).then(n.bind(n,97455)).then((e=>e)),wsComponent=()=>n.e(5935).then(n.bind(n,36184)).then((e=>e)),instructionComponent=()=>n.e(5764).then(n.bind(n,85764)).then((e=>e)),documentComponent=()=>n.e(5509).then(n.bind(n,95509)).then((e=>e)),fastReportComponent=()=>n.e(6026).then(n.bind(n,56026)).then((e=>e)),searchComponent=()=>n.e(7839).then(n.bind(n,57839)).then((e=>e)),monitorComponent=()=>n.e(3037).then(n.bind(n,53037)).then((e=>e)),systemSettingsComponent=()=>n.e(9553).then(n.bind(n,9553)).then((e=>e)),instructionDefaultSettingsComponent=()=>n.e(6944).then(n.bind(n,46944)).then((e=>e)),userInstructionFoldersComponent=()=>n.e(7548).then(n.bind(n,87548)).then((e=>e)),userDocumentsFoldersComponent=()=>n.e(7793).then(n.bind(n,47793)).then((e=>e)),userInstructionFolderRulesComponent=()=>n.e(1431).then(n.bind(n,21431)).then((e=>e)),userDeputiesComponent=()=>n.e(8181).then(n.bind(n,58181)).then((e=>e)),userResetSettingsComponent=()=>n.e(6071).then(n.bind(n,56071)).then((e=>e)),repoSettingsComponent=()=>n.e(1834).then(n.bind(n,1834)).then((e=>e)),cacheSettingsComponent=()=>n.e(7576).then(n.bind(n,97576)).then((e=>e)),vocabulariesCacheSettingsComponent=()=>n.e(1722).then(n.bind(n,1722)).then((e=>e)),sortingSettingsComponent=()=>n.e(7794).then(n.bind(n,67794)).then((e=>e)),displayingDefaultSettingsComponent=()=>n.e(2075).then(n.bind(n,22075)).then((e=>e)),brandingComponent=()=>n.e(6308).then(n.bind(n,36308)).then((e=>e)),cardDevelopmentComponent=()=>n.e(491).then(n.bind(n,50491)).then((e=>e)),componentDevelopmentComponent=()=>n.e(8885).then(n.bind(n,78885)).then((e=>e)),developmentCardVersionComponent=()=>Promise.all([n.e(4990),n.e(4620),n.e(6127)]).then(n.bind(n,48062)).then((e=>e)),developmentComponentVersion=()=>Promise.all([n.e(4990),n.e(4620),n.e(840)]).then(n.bind(n,78636)).then((e=>e)),notFoundComponent=()=>n.e(9539).then(n.bind(n,99539)).then((e=>e)),dssRedirectComponent=()=>n.e(2759).then(n.bind(n,52759)).then((e=>e));const getRoutes=(e,t=null)=>{let n=[];return t?n.push({path:"/",redirect:{name:t}}):n.push({path:"/",name:"default",component:dashboardComponent,meta:{transition:Pe.k.ToDashboard,state:Oe.Z.Dashboard}}),n=n.concat([{name:Le.S.Dashboard,path:"/dashboard",redirect:{path:"/"}},{name:"login",path:"/login",component:loginComponent,meta:{anonymous:!0,transition:Pe.k.Login,state:Oe.Z.Login}},{name:Le.S.Messages,path:"/messages",component:Hm,meta:{transition:Pe.k.None,state:Oe.Z.Messages},children:[{name:"viewMessage",path:"view/:id",props:e=>({id:String(e.params.id),actionType:Nn.xK.View,context:e.params.context}),component:instructionComponent,meta:{transition:Pe.k.ViewMessage,state:Oe.Z.ViewingMessage}},{name:`${Le.S.Messages}-folders`,path:":parentId?/:viewMode?",component:wsComponent,props:e=>({folderId:e.params.parentId?e.params.parentId.toString():null,section:Le.S.Messages,collectionViewMode:e.params.viewMode?"list"===e.params.viewMode?Ue.Ml.List:Ue.Ml.Grid:null,page:e.params.page?Number(e.params.page):e.query.page?Number(e.query.page):null,toFirstPage:e.params.toFirstPage?Number(e.params.toFirstPage):null}),meta:{transition:Pe.k.ToMessages,state:Oe.Z.Messages}}]},{name:Le.S.Documents,path:"/documents",component:Hm,meta:{transition:Pe.k.None,state:Oe.Z.Documents},children:[{name:"viewDocument",path:"view/:id",props:e=>({id:String(e.params.id),actionType:Um._.View,context:e.params.context}),component:documentComponent,meta:{transition:Pe.k.ViewDoc,state:Oe.Z.ViewingDoc}},{name:"createDocument",path:"create/:journalId",props:e=>({journalId:String(e.params.journalId),actionType:Um._.Create,context:e.params.context,newDocDefaultData:e.params.newDocDefaultData}),component:documentComponent,meta:{transition:Pe.k.CreateDoc,state:Oe.Z.CreatingDoc}},{name:"editDocument",path:"edit/:id",props:e=>({id:String(e.params.id),actionType:Um._.Edit,context:e.params.context}),component:documentComponent,meta:{transition:Pe.k.EditDoc,state:Oe.Z.EditingDoc}},{name:`${Le.S.Documents}-folders`,path:":parentId?/:viewMode?",component:wsComponent,props:e=>({folderId:e.params.parentId?e.params.parentId.toString():null,section:Le.S.Documents,collectionViewMode:e.params.viewMode?"list"===e.params.viewMode?Ue.Ml.List:Ue.Ml.Grid:null,nodeType:e.params.nodeType,page:e.params.page?Number(e.params.page):e.query.page?Number(e.query.page):null,toFirstPage:e.params.toFirstPage}),meta:{transition:Pe.k.ToDocuments,state:Oe.Z.Documents}}]},{name:Le.S.Reports,path:"/reports",component:Hm,meta:{transition:Pe.k.None,state:Oe.Z.Reports},children:[{name:"createFastReport",path:"create/:id",component:fastReportComponent,props:e=>({id:String(e.params.id),report:e.params.report,context:e.params.context}),meta:{transition:Pe.k.CreateFastReport,state:Oe.Z.CreatingFastReport}},{name:"repeatFastReport",path:"repeat/:id",component:fastReportComponent,props:e=>{var t,n,i,o;return{id:String(null===(t=null===e||void 0===e?void 0:e.params)||void 0===t?void 0:t.id),report:null===(n=null===e||void 0===e?void 0:e.params)||void 0===n?void 0:n.report,prevParams:null===(i=null===e||void 0===e?void 0:e.params)||void 0===i?void 0:i.prevParams,context:null===(o=null===e||void 0===e?void 0:e.params)||void 0===o?void 0:o.context}},meta:{transition:Pe.k.CreateFastReport,state:Oe.Z.CreatingFastReport}},{name:"viewFastReport",path:"view/:id",component:fastReportComponent,props:e=>{var t,n,i;return{id:String(null===(t=null===e||void 0===e?void 0:e.params)||void 0===t?void 0:t.id),report:null===(n=null===e||void 0===e?void 0:e.params)||void 0===n?void 0:n.report,context:null===(i=null===e||void 0===e?void 0:e.params)||void 0===i?void 0:i.context}},meta:{transition:Pe.k.ViewFastReport,state:Oe.Z.ViewingFastReport}},{name:`${Le.S.Reports}-folders`,path:":parentId?/:viewMode?",component:wsComponent,props:e=>({folderId:e.params.parentId?e.params.parentId.toString():"1",section:Le.S.Reports,collectionViewMode:Ue.Ml.List,nodeType:e.params.nodeType,cardId:e.params.cardId,page:e.params.page?Number(e.params.page):e.query.page?Number(e.query.page):1,toFirstPage:e.params.toFirstPage}),meta:{transition:Pe.k.ToReports,state:Oe.Z.Reports}}]},{name:"search",path:"/search",component:searchComponent,props:e=>{var t,n;return{searchTerm:null===(t=null===e||void 0===e?void 0:e.params)||void 0===t?void 0:t.searchTerm,context:null===(n=null===e||void 0===e?void 0:e.params)||void 0===n?void 0:n.context}},meta:{transition:Pe.k.ToSearch,state:Oe.Z.Search}},{name:Le.S.Kanban,path:"/kanban",component:Hm,meta:{transition:Pe.k.None,state:Oe.Z.Kanban},children:[{name:`${Le.S.Kanban}-boards`,path:":parentId?",component:wsComponent,props:e=>({folderId:e.params.parentId?e.params.parentId.toString():null,section:Le.S.Kanban,collectionViewMode:Ue.Ml.Kanban,nodeType:Tt.J.Kanban}),meta:{transition:Pe.k.ToKanban,state:Oe.Z.Kanban}}]},{name:Le.S.Vocabularies,path:"/vocabularies/:parentId?/:viewMode?",component:wsComponent,props:e=>{var t,n,i,o,s,r;return{folderId:(null===(t=null===e||void 0===e?void 0:e.params)||void 0===t?void 0:t.parentId)?null===(n=null===e||void 0===e?void 0:e.params)||void 0===n?void 0:n.parentId.toString():"",section:Le.S.Vocabularies,collectionViewMode:Ue.Ml.Grid,page:(null===(i=null===e||void 0===e?void 0:e.params)||void 0===i?void 0:i.page)?Number(null===(o=null===e||void 0===e?void 0:e.params)||void 0===o?void 0:o.page):e.query.page?Number(e.query.page):null,toFirstPage:(null===(s=null===e||void 0===e?void 0:e.params)||void 0===s?void 0:s.toFirstPage)?Number(null===(r=null===e||void 0===e?void 0:e.params)||void 0===r?void 0:r.toFirstPage):null}},meta:{transition:Pe.k.ToVocabularies,state:Oe.Z.Vocabularies}},{name:Le.S.Archive,path:"/archive/:parentId?/:viewMode?",component:wsComponent,props:e=>({folderId:e.params.parentId?e.params.parentId.toString():"",section:Le.S.Archive,collectionViewMode:e.params.viewMode?"list"===e.params.viewMode?Ue.Ml.List:Ue.Ml.Grid:null,page:e.params.page?Number(e.params.page):e.query.page?Number(e.query.page):null,toFirstPage:e.params.toFirstPage?Number(e.params.toFirstPage):null}),meta:{transition:Pe.k.ToArchive,state:Oe.Z.Archive}},{name:"settings",path:"/settings/:parentId?",component:systemSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings},children:[{path:"admin",meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"admin"}},{path:"monitor/:section?",component:monitorComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"monitor"},props:!0},{path:"user",component:instructionDefaultSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"user"}},{path:"user-instruction-folders",component:userInstructionFoldersComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"user-instruction-folders"}},{path:"user-documents-folders",component:userDocumentsFoldersComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"user-documents-folders"}},{path:"user-instruction-folder-rules",component:userInstructionFolderRulesComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"user-instruction-folder-rules"}},{path:"user-deputies",component:userDeputiesComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"user-deputies"}},{path:"user-reset-settings",component:userResetSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"user-reset-settings"}},{path:"instructions-sorting",component:sortingSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"instructions-sorting"}},{path:"documents-sorting",component:sortingSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"documents-sorting"}},{path:"instructions-folders-view",component:displayingDefaultSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"instructions-folders-view"}},{path:"documents-view",component:displayingDefaultSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"documents-view"}},{name:"card-development",path:"card-development",component:cardDevelopmentComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"development"}},{name:"component-development",path:"component-development",component:componentDevelopmentComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"development"}},{name:"card-new",path:"cards/:cardId/:type",component:developmentCardVersionComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"development"},props:!0},{name:"card-update",path:"cards/:cardId/:type/:id",component:developmentCardVersionComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"development"},props:!0},{name:"component-new",path:"components/:code",component:developmentComponentVersion,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"development"},props:!0},{name:"component-update",path:"components/:code/:id",component:developmentComponentVersion,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"development"},props:!0},{path:"cache",component:cacheSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"cache"}},{path:"vocabularies-cache",component:vocabulariesCacheSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"vocabularies-cache"}},{path:"default-message",component:instructionDefaultSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"default-message"}},{path:"repo",component:repoSettingsComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"repo"}},{path:"branding",component:brandingComponent,meta:{transition:Pe.k.ToSettings,state:Oe.Z.Settings,id:"branding"}}]},{name:"dss-redirect",path:"/dss",component:dssRedirectComponent,meta:{transition:Pe.k.ToDssRedirect,state:Oe.Z.DssRedirecting}},{name:"404",path:"/404",component:notFoundComponent,meta:{transition:Pe.k.ToNotFound,state:Oe.Z.NotFound}},{path:"*",redirect:"/404",meta:{transition:Pe.k.ToNotFound,state:Oe.Z.NotFound}}]),n};o().component("container",{template:'<div style="height: 100%; width: 100%;">\n      <router-view v-bind="$attrs"></router-view>\n    </div>'});var logger_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let Qm=class Logger{debug(...e){console.log(...e)}info(...e){const[t,...n]=e;console.info("%c "+t,...n,"background: #222; color: #bada55")}warn(...e){console.warn(...e)}error(...e){console.error(...e)}fatal(...e){console.error(...e)}};Qm=logger_decorate([(0,Ee.b2)()],Qm);const zm=new Ee.nZ(((e,t)=>{e(Ve.O.ICommandBus).to(wn),e(wn).toSelf()}));var Zm=n(36564),selectQuery_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectQuery_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Wm=class SelectQueryHandler extends Zm.W{ask(e){return selectQuery_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!!e.selectAsOk&&e.selectAsOk,width:e.width,fullHeight:e.fullHeight,height:e.height},n=yield this.openSelectDialog(t),i={model:e&&e.componentProps?e.componentProps.model:null,lists:e&&e.componentProps?e.componentProps.lists:null,disabledItems:e&&e.componentProps?e.componentProps.disabledItems:[],selectedItems:e&&e.componentProps?e.componentProps.selectedItems:[],component:e.componentName,multiselect:!(!e||!e.componentProps)&&e.componentProps.multiselect,props:this.restProps(e.componentProps)},o=yield this.waitForSelectDialog(n,i);return o.button===Wt.m.Ok?o.data:null}))}restProps(e){if(!e)return null;const t={};return Object.keys(e).forEach((n=>{"disabledItems"!==n&&"selectedItems"!==n&&"multiselect"!==n&&(t[n]=e[n])})),t}};Wm=selectQuery_handler_decorate([(0,Ee.b2)()],Wm);var qm=n(54626),infoWindowQuery_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},infoWindowQuery_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Gm=class InfoWindowQueryHandler extends Zm.W{ask(e){return infoWindowQuery_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!e.closeButton,hideFooter:!e.closeButton,width:e.width,fullHeight:e.fullHeight,height:e.height,content:e.text},n=yield this.openInfoDialog(t),i={disabledItems:null,selectedItems:null,props:e.componentProps,component:e.component},o=yield this.waitForInfoDialog(n,i);return o.data}))}};function createContainer(e){const t=new Ee.W2;return t.bind(je.t.Container).toConstantValue(t),t.bind(je.t.ILogger).to(Qm),t.bind(je.t.Config).toConstantValue(e),t.bind(Tl.h).toSelf().inSingletonScope(),t.bind(Ae.M.IQueryBus).to(Tn.b),t.bind(Tn.b).toSelf(),t.load(zm),t.bind(Ae.M.SelectQuery).to(Wm),t.bind(ze.F.name).to(Wm),t.bind(Ae.M.InfoWindowQuery).to(Gm),t.bind(qm._.name).to(Gm),t}Gm=infoWindowQuery_handler_decorate([(0,Ee.b2)()],Gm);var Km=n(67356),Ym=n(78345);o().use(Ym.Z),o().use(Km.Z);const createRouter=(e,t,n)=>{const i=new Ym.Z({routes:t(e,n),mode:"history",scrollBehavior(e,t,n){return n||{x:0,y:0}}});return i},configureRouter=(e,t)=>{e.beforeEach(((e,n,i)=>{const o=e.matched.some((e=>!e.meta.anonymous));if(!o)return i();t.getters["auth/isAuthenticated"]?i():i({name:"login",params:{retrieveRouteName:e.name,retrieveRoutePath:e.path}})})),e.afterEach(((e,n)=>{const i=["login","dss","mvp"];i.some((t=>e.path.includes(t)))?Je.X.$emit("dialog:close:all"):xn().put(`${t.state.config.apiPath()}me/lasturl`,{lastVisitedUrl:e.fullPath})}))};var Jm=n(12437),Xm=n.n(Jm);const ef=new(Xm())(window.navigator.userAgent),tf={install(e){e.mixin({computed:{__isMobileViewport(){return this.$templateRenderer?this.$templateRenderer.isMobile:this.$vuetify.breakpoint.xsOnly||Boolean(ef.mobile())||ef.isPhoneSized()},__isTabletViewport(){return this.$templateRenderer?this.$templateRenderer.isTablet:Boolean(ef.tablet())||this.$vuetify.breakpoint.smOnly||this.$vuetify.breakpoint.mdOnly},isMobile(){return this.__isMobileViewport},isTablet(){return this.__isTabletViewport},isDesktop(){return!this.isMobile&&!this.isTablet}}})},isIE:ef.match("IE")};var axios_interceptors_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let nf=0;const of=[];function createHttpInterceptors(e,t,n){nf=getIdleTimeout(t),n.debug("idleTimeout = ",nf),xn().interceptors.request.use((e=>axios_interceptors_awaiter(this,void 0,void 0,(function*(){if(e=e||{},e.withCredentials=!0,(e.cancelable||e.canceler||e.cancelToken&&"boolean"===typeof e.cancelToken)&&(e.cancelToken=new(xn().CancelToken)((function executor(n){var i;const o=null!==(i=e.canceler)&&void 0!==i?i:{};o.cancelFunc=n,o.url=e.url,t.state.cancelRegister.register(o),e.canceler=o}))),tf.isIE&&/\/api\//gi.test(e.url)){const t=e.params||{};t.ieTimestamp=Date.now(),e.params=t}else(e.url.includes("freshdoc")||e.url.includes(t.state.config.nativeAppAddress))&&(e.withCredentials=!1);if(e.chainedRead||e.chainedWrite){let t=null;const n=new Promise((e=>t=e));if(addToChain(Boolean(e.chainedWrite),n,t,e),of.length>1){const e=of[of.length-2];yield e.promise}}return e}))),(e=>(n.info("RequestError:",e.request),Promise.reject(e)))),xn().interceptors.response.use((e=>{var n;if(t.state.config.e2e&&["post","put","patch","delete"].includes(e.config.method.toLowerCase())){let t;try{t=JSON.parse(sessionStorage.lastResponses),t||(t=[])}catch(e){t=[]}t.push(e),t.length>10&&t.shift();try{sessionStorage.lastResponses=JSON.stringify(t,null,2)}catch(e){while(t.length>=5)t.shift();sessionStorage.lastResponses=JSON.stringify(t,null,2)}}return(null===(n=e.config)||void 0===n?void 0:n.canceler)&&t.state.cancelRegister.unregister(e.config.canceler),unchain(e),e}),(i=>{var o;if((null===(o=i.config)||void 0===o?void 0:o.canceler)&&t.state.cancelRegister.unregister(i.config.canceler),xn().isCancel(i))throw i;unchain(i);const s=i.response;if(n.info("ResponseError:",i.response),s){const n=s.data?s.data.message:s.data,i=403===s.status&&n&&"string"===typeof n&&n.includes("User is unauthorized");(401===s.status||402===s.status||i)&&(t.dispatch("forbidden"),e.push("/login"))}return Promise.reject(i)}))}function addToChain(e,t,n,i){let o=of.length-1;if(e){for(let e=of.length-1;e>=0;e--)if(of[e].isWrite){o=e;break}o=o+1===of.length?of.length-1:o+1}o===of.length-1?of.push({isWrite:e,promise:t,resolve:n,config:i}):of.splice(o,0,{isWrite:e,promise:t,resolve:n,config:i})}function unchain(e){if(of.length){const t=of[0];t&&t.config===e.config&&(of.shift(),t.resolve(e))}}function getIdleTimeout(e){let t=0;const n=e.getters["auth/getIdleTimeout"];if("string"===typeof n){const e=n.split(":");3===e.length&&(t=1e3*(60*Number(e[0])*60+60*Number(e[1])+Number(e[2])))}return t}const sf=o().mixin({beforeCreate(){const e=this.$options;e.config?this.$config=e.config:e.parent&&e.parent.$config&&(this.$config=e.parent.$config)}});var domainEvent_provider_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},domainEvent_provider_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let rf=class DomainEventProvider{constructor(){this._hub=new rt.Vue}on(e,t){return this._hub.$on(e,t),this}once(e,t){return this._hub.$once(e,t),this}off(e,t){return this._hub.$off(e,t),this}emit(e,...t){return this._hub.$emit(e,t),this}};rf=domainEvent_provider_decorate([(0,Ee.b2)(),domainEvent_provider_metadata("design:paramtypes",[])],rf);var af=n(27749),outerEvent_provider_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},outerEvent_provider_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},outerEvent_provider_param=function(e,t){return function(n,i){t(n,i,e)}};let lf=class OuterEventProvider{constructor(e,t){this._log=e,this._config=t;const n=this._config.apiPath().replace("/api/v1/","");this._connection=(new af.su).withUrl(`${n}/events`).withAutomaticReconnect().build(),this._connection.keepAliveIntervalInMilliseconds=6e4,this._connection.start().catch((e=>this._log.error(e)))}on(e,t){return this._connection.state===af.AC.Disconnected&&this._connection.start().catch((e=>this._log.error(e))),this._connection.on(e,t),this}off(e,t){this._connection.off(e,t);const n=this._connection.methods;return Object.keys(n).length||this._connection.state!==af.AC.Connected||this._connection.stop(),this}emit(e,...t){return this._connection.invoke(e,t),this}};lf=outerEvent_provider_decorate([(0,Ee.b2)(),outerEvent_provider_param(0,(0,Ee.f3)(je.t.ILogger)),outerEvent_provider_param(1,(0,Ee.f3)(je.t.Config)),outerEvent_provider_metadata("design:paramtypes",[Object,Object])],lf);class CanCloseReportQuery{constructor(e,t){this.instructionId=e,this.fromRemote=t}}class CustomActionsQuery{constructor(e,t,n,i,o){this.title=e,this.text=t,this.width=n,this.buttons=i,this.fromRemote=o}}var cf=n(3742),df=n(86006),uf=n(2385),pf=n(23800);class EditRoadmapStepQuery{constructor(e,t,n,i){this.title=e,this.roadmapStep=t,this.tableData=n,this.fromRemote=i}}var hf=n(99778),mf=n(8107);class PromptQuery{constructor(e,t,n,i){this.title=e,this.initValue=t,this.fromRemote=n,this.width=i}}var ff=n(1732),gf=n(33438);class SelectDocumentJournalsQuery{constructor(e,t){this.excludeJournalsId=e,this.fromRemote=t}}class SelectFoldersQuery{constructor(e,t,n,i){this.folders=e,this.disableFolders=t,this.contentType=n,this.fromRemote=i}}class SelectInstructionTypesQuery{constructor(e,t){this.excludeTypeId=e,this.fromRemote=t}}class SelectVocabularyQuery{constructor(e,t,n,i,o,s,r,a,l){this.title=e,this.vocabularyName=t,this.multiselect=n,this.selectedItems=i,this.disabledItems=o,this.columns=s,this.constrains=r,this.width=a,this.fromRemote=l}}var yf=n(70068);class FreshDocSurveyQuery{constructor(e,t,n,i){this.title=e,this.id=t,this.multiselect=n,this.fromRemote=i}}var alert_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let vf=class AlertQueryHandler extends Zm.W{ask(e){const t={title:e.title,content:e.text,selectAsOk:!1};return this.alertDialog(t)}};vf=alert_handler_decorate([(0,Ee.b2)()],vf);var bf=n(95478),confirm_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let Cf=class ConfirmQueryHandler extends Zm.W{ask(e){const t={title:e.title,content:e.text,selectAsOk:!1};return this.confirmDialog(t)}};Cf=confirm_handler_decorate([(0,Ee.b2)()],Cf);var createEdit_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},createEdit_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let wf=class CreateEditQueryHandler extends Zm.W{ask(e){return createEdit_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,description:e.description,hostObject:e.hostObject,selectAsOk:!0,width:e.width,height:e.height,fullHeight:e.fullHeight,hideFooter:"hideFooter"in e&&e.hideFooter,closable:e.closable,darkTitle:e.darkTitle,expandable:e.expandable,minimizable:e.minimizable,expandedSize:e.expandedSize,collapsedSize:e.collapsedSize,noModal:e.noModal,isChanged:()=>!!this._isChangedCallback&&this._isChangedCallback()},n=yield this.openCreateEditDialog(t),i={model:e&&e.componentProps?e.componentProps.model:null,lists:null,disabledItems:null,selectedItems:null,component:e.componentName,multiselect:!1,props:this.restProps(e.componentProps)},o=yield this.waitForCreateEditDialog(n,i);return o.button===Wt.m.Ok?o&&o.data?o.data:o:null}))}restProps(e){if(!e)return null;const t={setIsChangedCallback:this.setIsChangedCallback.bind(this)};return Object.keys(e).forEach((n=>{"disabledItems"!==n&&"selectedItems"!==n&&"multiselect"!==n&&(t[n]=e[n])})),t}setIsChangedCallback(e){this._isChangedCallback=e}};wf=createEdit_handler_decorate([(0,Ee.b2)()],wf);var customActionsQuery_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},customActionsQuery_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let _f=class CustomActionsQueryHandler extends Zm.W{ask(e){return customActionsQuery_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!0,hideFooter:!0,width:e.width},n=yield this.openInfoDialog(t),i={disabledItems:null,selectedItems:null,props:{text:e.text,buttons:e.buttons},component:"custom-actions",anyData:e},o=yield this.waitForSelectDialog(n,i);return o.data}))}};_f=customActionsQuery_handler_decorate([(0,Ee.b2)()],_f);var dashboardAddWidget_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},dashboardAddWidget_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let xf=class DashboardAddWidgetQueryHandler extends Zm.W{ask(e){return dashboardAddWidget_handler_awaiter(this,void 0,void 0,(function*(){const t={title:"Добавление виджета",selectAsOk:!0,hideFooter:!0,width:"50%",fullHeight:!1},n=yield this.openSelectDialog(t),i={multiselect:!1,disabledItems:[],selectedItems:[],component:"dashboard-widgets-list-viewer",props:{currentDashboard:e.currentDashboard,widgets:e.widgets}},o=yield this.waitForSelectDialog(n,i);return null===o||void 0===o?void 0:o.data}))}};xf=dashboardAddWidget_handler_decorate([(0,Ee.b2)()],xf);var dashboardSettings_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},dashboardSettings_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Sf=class DashboardSettingsQueryHandler extends Zm.W{ask(e){var t,n,i,o,s;return dashboardSettings_handler_awaiter(this,void 0,void 0,(function*(){const r={title:((null===(t=e.currentDashboard)||void 0===t?void 0:t.id)?"Настройки":"Создание")+" рабочего стола",selectAsOk:!0,hideFooter:!0,width:"50%",fullHeight:!1},a=yield this.openSelectDialog(r),l={multiselect:!1,disabledItems:[],selectedItems:[],component:"dashboard-settings-viewer",props:{dashboardID:null===(n=null===e||void 0===e?void 0:e.currentDashboard)||void 0===n?void 0:n.id,dashboardNameProp:null===(i=null===e||void 0===e?void 0:e.currentDashboard)||void 0===i?void 0:i.dashboardName,dashboardDefaultProp:null===(o=null===e||void 0===e?void 0:e.currentDashboard)||void 0===o?void 0:o.isDefault,dashboardCommonProp:null===(s=null===e||void 0===e?void 0:e.currentDashboard)||void 0===s?void 0:s.isCommon}},c=yield this.waitForSelectDialog(a,l);return c.data}))}};Sf=dashboardSettings_handler_decorate([(0,Ee.b2)()],Sf);var dashboardWidgetsSettings_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},dashboardWidgetsSettings_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let If=class DashboardWidgetsSettingsQueryHandler extends Zm.W{ask(e){return dashboardWidgetsSettings_handler_awaiter(this,void 0,void 0,(function*(){const t={title:"Настройки виджета",selectAsOk:!0,hideFooter:!1,width:"60%",fullHeight:!1},n=yield this.openCreateEditDialog(t),i={multiselect:!1,disabledItems:[],selectedItems:[],component:"dashboard-widgets-settings-viewer",props:{templatePath:e.templatePath,widgetName:e.widgetName,widgetID:e.widgetID,defaultRefreshTime:e.defaultRefreshTime,widgetSettings:e.widgetSettings,currentDashboard:e.currentDashboard}},o=yield this.waitForCreateEditDialog(n,i);return o.button===Wt.m.Ok&&(null===o||void 0===o?void 0:o.data)?o.data:null}))}};If=dashboardWidgetsSettings_handler_decorate([(0,Ee.b2)()],If);var docPreview_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},docPreview_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Df=class DocPreviewQueryHandler extends Zm.W{ask(e){return docPreview_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,hideFooter:!0,width:"90%",fullHeight:!0},n=yield this.openSelectDialog(t),i={multiselect:!1,disabledItems:[],selectedItems:[],component:"doc-viewer",props:{file:e.file}},o=yield this.waitForSelectDialog(n,i);return o.data}))}};Df=docPreview_handler_decorate([(0,Ee.b2)()],Df);var editedFiles_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},editedFiles_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Rf=class EditedFilesQueryHandler extends Zm.W{ask(e){return editedFiles_handler_awaiter(this,void 0,void 0,(function*(){const t={title:"Файлы заблокированные мной",selectAsOk:!1,hideFooter:!0,width:"90%",fullHeight:!0},n=yield this.openSelectDialog(t),i={multiselect:!1,disabledItems:[],selectedItems:[],component:"edited-files-viewer",anyData:e},o=yield this.waitForSelectDialog(n,i);return o.data}))}};Rf=editedFiles_handler_decorate([(0,Ee.b2)()],Rf);var editRoadmapStepQuery_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},editRoadmapStepQuery_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Tf=class EditRoadmapStepQueryHandler extends Zm.W{ask(e){return editRoadmapStepQuery_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,size:"lg"},n=yield this.openSelectDialog(t),i={lists:null,disabledItems:[],selectedItems:[e.roadmapStep],component:"edit-roadmap-step",anyData:e,multiselect:!1},o=yield this.waitForSelectDialog(n,i);return o.button===Wt.m.Ok?o.data:null}))}};Tf=editRoadmapStepQuery_handler_decorate([(0,Ee.b2)()],Tf);var esignDetails_hander_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},esignDetails_hander_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Pf=class EsignDetailsQueryHandler extends Zm.W{ask(e){return esignDetails_hander_awaiter(this,void 0,void 0,(function*(){const t={lists:null,disabledItems:null,selectedItems:null,component:"esign-detail",anyData:e},n={title:e.title,hideFooter:!1,selectAsOk:!1,width:"50%",fullHeight:!1,data:t},i=yield this.openInfoDialog(n),o=yield this.waitForInfoDialog(i,t);return o.data?o.data:null}))}};Pf=esignDetails_hander_decorate([(0,Ee.b2)()],Pf);var freshDocSurvey_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},freshDocSurvey_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Of=class FreshDocSurveyHandler extends Zm.W{ask(e){return freshDocSurvey_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,size:"lg"},n=yield this.openSelectDialog(t),i={lists:null,disabledItems:[],selectedItems:[],component:"freshdoc-survey",anyData:e,multiselect:e.multiselect},o=yield this.waitForSelectDialog(n,i);return o.button===Wt.m.Ok?o.data:null}))}};Of=freshDocSurvey_handler_decorate([(0,Ee.b2)()],Of);var pdfViewer_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},pdfViewer_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let kf=class PdfViewerQueryHandler extends Zm.W{ask(e){return pdfViewer_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,hideFooter:!0,width:"90%",fullHeight:!0},n=yield this.openSelectDialog(t),i={multiselect:!1,disabledItems:[],selectedItems:[],component:"pdf-viewer",anyData:e},o=yield this.waitForSelectDialog(n,i);return o.data}))}};kf=pdfViewer_handler_decorate([(0,Ee.b2)()],kf);var prompt_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let Ff=class PromptQueryHandler extends Zm.W{ask(e){const t={title:e.title,content:e.initValue,selectAsOk:!1,width:e.width||"60%"};return this.promptDialog(t)}};Ff=prompt_handler_decorate([(0,Ee.b2)()],Ff);var r7Viewer_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},r7Viewer_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Af=class R7ViewerQueryHandler extends Zm.W{ask(e){return r7Viewer_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,hideFooter:!0,width:"90%",fullHeight:!0},n=yield this.openSelectDialog(t),i={multiselect:!1,disabledItems:[],selectedItems:[],component:"r7-viewer",anyData:e},o=yield this.waitForSelectDialog(n,i);return o.data}))}};Af=r7Viewer_handler_decorate([(0,Ee.b2)()],Af);var selectCertificate_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectCertificate_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let $f=class SelectCertificateQueryHandler extends Zm.W{ask(e){return selectCertificate_handler_awaiter(this,void 0,void 0,(function*(){const t={title:"Выберите сертификат для подписи",selectAsOk:!0},n=yield this.openSelectDialog(t),i={isTree:!1,items:[]};let o=0;e.certificates.forEach((e=>{const t={id:++o,title:"Владелец:",name:e.SubjectName,subtitle:"Действителен до:",subname:(0,Ws.v)(e.ValidToDate),data:e};i.items.push(t)}));const s={lists:[i],disabledItems:[],selectedItems:[],component:"select-items"},r=yield this.waitForSelectDialog(n,s);if(r.button===Wt.m.Ok&&r.data&&Array.isArray(r.data)){const e=r.data.map((e=>e.data));return e[0]}return null}))}};$f=selectCertificate_handler_decorate([(0,Ee.b2)()],$f);var selectDocumentJornals_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectDocumentJornals_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let jf=class SelectDocumentJournalsQueryHandler extends Zm.W{ask(e){return selectDocumentJornals_handler_awaiter(this,void 0,void 0,(function*(){const e=yield this._queryBus.exec(new tt.Yf);if(!e||!e.documents||!Object.keys(e.documents).length)return yield this._queryBus.exec(new gn.m("Ошибка","Не настроен список журналов, в которых можно создавать документы.")),0;const t={title:"Выберите журнал",selectAsOk:!0},n=yield this.openSelectDialog(t),i=Object.keys(e.documents).map((t=>({id:t,name:e.documents[t]})));yield this._queryBus.exec(new He.PS("all")),yield this._queryBus.exec(new bn._Y(i.map((e=>Number(e.id)))));const o=[];for(const e of i){const t=yield this._queryBus.exec(new He.Ml(Number(e.id)));t.includes(du.K.RegisterDocument)||o.push(e)}const s=[];s.push({title:"",items:i,isTree:!1});const r={lists:s,disabledItems:o,selectedItems:[],component:"select-items"},a=yield this.waitForSelectDialog(n,r);if(a.button===Wt.m.Ok&&a.data&&Array.isArray(a.data)){const e=a.data;return e&&e.length?Number(e[0].id):0}return 0}))}};jf=selectDocumentJornals_handler_decorate([(0,Ee.b2)()],jf);var selectDocuments_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectDocuments_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Ef=class SelectDocumentsQueryHandler extends Zm.W{ask(e){return selectDocuments_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,width:"80%",fullHeight:!0},n=yield this.openSelectDialog(t),i={lists:null,disabledItems:[],selectedItems:e.selectedDocuments,component:"select-documents",anyData:e,multiselect:e.multiselect,props:this.restProps(e.componentProps)},o=yield this.waitForSelectDialog(n,i);return o.button===Wt.m.Ok?o.data:null}))}restProps(e){if(!e)return null;const t={};return Object.keys(e).forEach((n=>{"disabledItems"!==n&&"selectedItems"!==n&&"multiselect"!==n&&(t[n]=e[n])})),t}};Ef=selectDocuments_handler_decorate([(0,Ee.b2)()],Ef);var selectFolders_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectFolders_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Mf=class SelectFoldersQueryHandler extends Zm.W{ask(e){return selectFolders_handler_awaiter(this,void 0,void 0,(function*(){const t={title:"Выберите папку",selectAsOk:!1,width:"30%"},n=yield this.openSelectDialog(t);let i;try{const t=(0,kt.t)(e.folders,e.contentType),n=[];Array.isArray(e.disableFolders)&&e.disableFolders.forEach((e=>{const i=(0,kt.$)(t,e);n.push(i)})),i={lists:[{isTree:!0,items:t}],isTree:!0,disabledItems:n,selectedItems:[],component:"select-items"};for(const n of e.folders)if(987===n.id){const e=(0,kt.$)(t,n.id);i.disabledItems.push(e);break}}catch(e){this._log.error(e);const t={id:null,contentType:null,expanded:!1,items:null,name:e.message,nodeKind:null,nodeType:null};i={lists:[{isTree:!0,items:[t]}],isTree:!0,disabledItems:[t],selectedItems:[],component:"select-items"}}const o=yield this.waitForSelectDialog(n,i);return o.button===Wt.m.Ok&&o.data&&Array.isArray(o.data)?o.data.map((e=>e.nodeData)):null}))}};Mf=selectFolders_handler_decorate([(0,Ee.b2)()],Mf);var selectInstructionTypes_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectInstructionTypes_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Nf=class SelectInstructionTypesQueryHandler extends Zm.W{ask(e){return selectInstructionTypes_handler_awaiter(this,void 0,void 0,(function*(){const t={title:"Выберите тип сообщения",selectAsOk:!0},n=yield this.openSelectDialog(t);let i=yield this._queryBus.exec(new Fe.jl);if(e.excludeTypeId){const t=i.find((t=>t.id===e.excludeTypeId));t&&t.redirectAsControl&&(i=i.filter((e=>e.useControl)))}const o=[],s=[];i.forEach((e=>{const t={id:e.id,name:(0,it.kC)(e.name),data:e};e.useControl?o.push(t):s.push(t)}));const r=[];o.length&&(o.sort(((e,t)=>e.name>t.name?1:-1)),r.push({title:"С контролем",items:o,isTree:!1})),s.length&&(s.sort(((e,t)=>e.name>t.name?1:-1)),r.push({title:"Без контроля",items:s,isTree:!1}));const a={lists:r,disabledItems:[],selectedItems:[],component:"select-items"},l=yield this.waitForSelectDialog(n,a);return l.button===Wt.m.Ok&&l.data&&Array.isArray(l.data)?l.data.map((e=>e.data)):null}))}};Nf=selectInstructionTypes_handler_decorate([(0,Ee.b2)()],Nf);var selectReceivers_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectReceivers_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Vf=class SelectReceiversQueryHandler extends Zm.W{ask(e){return selectReceivers_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,width:"80%",fullHeight:!0},n=yield this.openSelectDialog(t),i={lists:null,disabledItems:[],selectedItems:e.selectedReceivers,component:"select-receivers",anyData:e,multiselect:e.multiselect},o=yield this.waitForSelectDialog(n,i);return o.button===Wt.m.Ok?o.data:null}))}};Vf=selectReceivers_handler_decorate([(0,Ee.b2)()],Vf);var selectVocabulary_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},selectVocabulary_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Bf=class SelectVocabularyQueryHandler extends Zm.W{ask(e){return selectVocabulary_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,width:e.width||"50%"},n=yield this.openSelectDialog(t),i={disabledItems:e.disabledItems,selectedItems:e.selectedItems,component:"wrapper-catalogue",multiselect:e.multiselect,props:{name:e.vocabularyName,gridColumns:e.columns,constrains:e.constrains,fullInfo:!0}},o=yield this.waitForSelectDialog(n,i);return o.data}))}};Bf=selectVocabulary_handler_decorate([(0,Ee.b2)()],Bf);var stampViewer_handler_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},stampViewer_handler_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Lf=class StampViewerQueryHandler extends Zm.W{ask(e){return stampViewer_handler_awaiter(this,void 0,void 0,(function*(){const t={title:e.title,selectAsOk:!1,hideFooter:!0,width:"90%",fullHeight:!0},n=yield this.openSelectDialog(t),i={multiselect:!1,disabledItems:[],selectedItems:[],component:"stamp-viewer",anyData:e},o=yield this.waitForSelectDialog(n,i);return o.data}))}};Lf=stampViewer_handler_decorate([(0,Ee.b2)()],Lf);const Uf=new Ee.nZ(((e,t)=>{e(Ae.M.SelectFoldersQuery).to(Mf),e(SelectFoldersQuery.name).to(Mf),e(Ae.M.SelectVocabularyQuery).to(Bf),e(SelectVocabularyQuery.name).to(Bf),e(Ae.M.EditedFilesQuery).to(Rf),e(Qe.b.name).to(Rf),e(Ae.M.DashboardSettingsQuery).to(Sf),e(df.j.name).to(Sf),e(Ae.M.DashboardAddWidgetQuery).to(xf),e(cf.M.name).to(xf),e(Ae.M.DashboardWidgetSettingsQuery).to(If),e(uf.R.name).to(If),e(Ae.M.CreateEditQuery).to(wf),e(Mc.c.name).to(wf),e(Ae.M.CustomActionsQuery).to(_f),e(CustomActionsQuery.name).to(_f),e(Ae.M.SelectReceiversQuery).to(Vf),e(Nl.B.name).to(Vf),e(Ae.M.FreshDocSurveyQuery).to(Of),e(FreshDocSurveyQuery.name).to(Of),e(Ae.M.SelectDocumentsQuery).to(Ef),e(wl.j.name).to(Ef),e(Ae.M.EditRoadmapStepQuery).to(Tf),e(EditRoadmapStepQuery.name).to(Tf),e(Ae.M.DocPreviewQuery).to(Df),e(pf.D.name).to(Df),e(Ae.M.PdfViewerQuery).to(kf),e(mf.a.name).to(kf),e(Ae.M.StampsFileQuery).to(Lf),e(yf.D.name).to(Lf),e(Ae.M.R7ViewerQuery).to(Af),e(ff.s.name).to(Af),e(Ae.M.SelectInstructionTypesQuery).to(Nf),e(SelectInstructionTypesQuery.name).to(Nf),e(Ae.M.SelectDocumentJournalsQuery).to(jf),e(SelectDocumentJournalsQuery.name).to(jf),e(Ae.M.SelectCertificateQuery).to($f),e(gf.z.name).to($f),e(Ae.M.ConfirmQuery).to(Cf),e(Zt.l.name).to(Cf),e(Ae.M.AlertQuery).to(vf),e(gn.m.name).to(vf),e(Ae.M.PromptQuery).to(Ff),e(PromptQuery.name).to(Ff),e(Ae.M.EsignDetailsQuery).to(Pf),e(hf.u.name).to(Pf),e(Ae.M.CanCloseReportQuery).to(bf.J),e(CanCloseReportQuery.name).to(bf.J)}));var Hf,docTemplate_service_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},docTemplate_service_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},docTemplate_service_param=function(e,t){return function(n,i){t(n,i,e)}};let Qf=Hf=class DocumentTemplateService{constructor(e,t){this.$config=e,this.$store=t,this.defaultTemplateUrl="assets/templates/"}getTemplateUrl(e,t){const n=this.getTemplateTypeAsString(t);let i=this.$config.templatesLocation||this.defaultTemplateUrl;i.endsWith("/")||(i+="/");let o=`${i}${e}/${n}.html`;return o}getDefaultTemplateUrl(e){const t=this.getTemplateTypeAsString(e);let n=this.$config.templatesLocation||this.defaultTemplateUrl;n.endsWith("/")||(n+="/");let i=`${n}${Hf.defaultDocumentType}/${t}.html`;return i}getTemplateTypeAsString(e){let t=e.toString();return"number"===typeof e&&(t=et.$[e]),t}};Qf.defaultDocumentType="default",Qf=Hf=docTemplate_service_decorate([(0,Ee.b2)(),docTemplate_service_param(0,(0,Ee.f3)(je.t.Config)),docTemplate_service_param(1,(0,Ee.f3)(je.t.Store)),docTemplate_service_metadata("design:paramtypes",[Object,cn.yh])],Qf);var action_base_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},action_base_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},action_base_param=function(e,t){return function(n,i){t(n,i,e)}},action_base_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let zf=class DocumentActionBase{constructor(e,t,n){this.$log=e,this.$queryBus=t,this.$commandBus=n}static commonRouteParams(e){return{context:e,folderId:String(e.folderId),folderName:e.folderName}}get id(){return""}caption(e){return""}execAsync(e){return action_base_awaiter(this,void 0,void 0,(function*(){if(!this.contextValidate(e))return Promise.resolve({type:Te.uE.None,status:Te.Ao.None});try{return yield this.execAction(e)}catch(e){return this.showError(e)}}))}getFinishState(e,t,n){return Oe.Z.None}contextValidate(e){return!!e&&(!!(e.contentType!==Ue.zc.Instruction||e.instructionInfo&&e.instructionInfo.length)&&(!!(e.contentType!==Ue.zc.Document||e.document&&e.document.length)&&!!(e.contentType!==Ue.zc.FastReport||e.fastReport&&e.fastReport.length)))}showError(e){return action_base_awaiter(this,void 0,void 0,(function*(){let t="Не удалось выполнить операцию. Попробуйте позже.",n=!1;throw e&&(e instanceof Ne.$Q?(t=e.error?e.error.message:t,e.error&&void 0!==e.error.notDisplayError&&(n=e.error.notDisplayError)):t=e.message),this.$log.error(t),n||(yield this.$queryBus.exec(new gn.m("Ошибка!",t))),e}))}};zf=action_base_decorate([(0,Ee.b2)(),action_base_param(0,(0,Ee.f3)(je.t.ILogger)),action_base_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),action_base_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),action_base_metadata("design:paramtypes",[Object,Object,Object])],zf);var addToFavourite_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let Zf=class AddToFavourite extends zf{get id(){return"add-to-favourite"}caption(){return"Добавить в избранное"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return new Promise((e=>"success"))}};Zf=addToFavourite_action_decorate([(0,Ee.b2)()],Zf);var Wf=n(86142),archiveDoc_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},archiveDoc_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let qf=class ArchiveDoc extends zf{get id(){return"archiveDoc"}caption(e){return e.section===Le.S.Documents?"Перенести в архив":"Восстановить"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return archiveDoc_action_awaiter(this,void 0,void 0,(function*(){let t=[];if(Array.isArray(e.entity)&&e.entity.length?t=e.entity:Array.isArray(e.instructionInfo)&&e.instructionInfo.length&&(t=e.document),!Array.isArray(t)||!t.length)return{type:Te.uE.None,status:Te.Ao.None};const n=[],i=[];for(const o of t)e.section===Le.S.Documents?n.push(o):e.section===Le.S.Archive&&i.push(o);const o=yield this.execCommand(n,!0),s=yield this.execCommand(i,!1);return o.type!==Te.uE.None?o:s}))}execCommand(e,t){var n;return archiveDoc_action_awaiter(this,void 0,void 0,(function*(){if(!e||!e.length)return{type:Te.uE.None,status:Te.Ao.None};let i="документ";e.length>1&&(i=`${(0,Wf.o)(e.length,"документ","документа","документов")}`);const o=t?`Вы действительно хотите перенести ${i} в архив?`:`Вы действительно хотите восстановить ${i}?`,s=yield this.$queryBus.exec(new Zt.l("Внимание!",o));if(s){let i,o=0;for(const n of e){const e=new Dt.eC(n.id,n.journalID,t);i=yield this.$commandBus.exec(e),i.isFailure||o++}if(!o){const e="Возникли ошибки при отправке в архив";return{type:Te.uE.Error,status:Te.Ao.None,message:null!==(n=i.message)&&void 0!==n?n:e}}let s=t?`${(0,Wf.o)(o,"документ","документа","документов")} перемещены в архив`:`${(0,Wf.o)(o,"документ","документа","документов")} восстановлено`;return 1===e.length&&(s=t?"Документ перенесен в архив":"Документ восстановлен"),{type:Te.uE.Completed,status:Te.Ao.RemoveFromFolder,message:s}}return{type:Te.uE.None,status:Te.Ao.None}}))}};qf=archiveDoc_action_decorate([(0,Ee.b2)()],qf);var createShortcut_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},createShortcut_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Gf=class CreateShortcut extends zf{get id(){return"createShortcut"}caption(){return"Создать ярлык"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return createShortcut_action_awaiter(this,void 0,void 0,(function*(){const t=yield this.$queryBus.exec(new He.Zc(!1));let n="";try{const i=t.find((e=>!e.parentId)),o=yield this.$queryBus.exec(new SelectFoldersQuery(t,i?[i.id]:[]));if(!o||!o.length)return Promise.resolve({type:Te.uE.None,status:Te.Ao.None});const s=yield this.$commandBus.exec(new Dt.ek(e.document[0].id,o[0].id));return s.value.isSuccessStatusCode?s.error?(n=`Ошибка создания ярлыка документа ${e.document[0].attributes.name} в журнале ${o[0].name}`,{type:Te.uE.Error,status:Te.Ao.None,message:n}):(n=`Ярлык документа создан в журнале ${o[0].name}`,{type:Te.uE.Completed,status:Te.Ao.None,message:n}):(n=`${s.value.reasonPhrase}`,{type:Te.uE.Error,status:Te.Ao.None,message:n})}catch(e){return Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}}))}};Gf=createShortcut_action_decorate([(0,Ee.b2)()],Gf);var customCard_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},customCard_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Kf=class CustomCardAction extends zf{get id(){return"card"}caption(){return""}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return customCard_action_awaiter(this,void 0,void 0,(function*(){const t=[];try{if(e.data&&"function"===typeof e.data){const n=yield e.data.call(null,e.document);t.push(n)}}catch(e){return this.$log.error(e),Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}return Promise.resolve({type:Te.uE.Completed,status:t.some((e=>(null===e||void 0===e?void 0:e.status)!==Te.Ao.None))?Te.Ao.NeedUpdateList:Te.Ao.None})}))}};Kf=customCard_action_decorate([(0,Ee.b2)()],Kf);var deleteDoc_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},deleteDoc_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Yf=class DeleteDoc extends zf{constructor(){super(...arguments),this.$gettext=e=>e}get id(){return"delete-doc"}caption(){return"Удалить документ"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){var t,n,i;return deleteDoc_action_awaiter(this,void 0,void 0,(function*(){try{const t=e.document[0],n=yield this.$queryBus.exec(new Zt.l("Внимание!","Вы действительно хотите удалить документ?"));if(n){const n=new Dt.Yb(t.id,t.journalID);yield this.$commandBus.exec(n),e.entityViewMode===Ue.dS.View&&(t.viewFlag=!1);const i=this.$gettext("Документ удален");return{type:Te.uE.Completed,status:Te.Ao.RemoveFromFolder,message:i}}return{type:Te.uE.Completed,status:Te.Ao.None}}catch(e){const o=null===(i=null===(n=null===(t=e.error.exception)||void 0===t?void 0:t.response)||void 0===n?void 0:n.data)||void 0===i?void 0:i.message,s=o?`Ошибка удаления документа: ${o}.`:"Произошла ошибка удаления документа.";return{type:Te.uE.Error,status:Te.Ao.None,message:s}}}))}};Yf=deleteDoc_action_decorate([(0,Ee.b2)()],Yf);var deleteShortcut_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},deleteShortcut_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Jf=class DeleteShortcut extends zf{get id(){return"delete-shortcut"}caption(){return"Удалить ярлык документа"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return deleteShortcut_action_awaiter(this,void 0,void 0,(function*(){try{const t=e.document[0],n=yield this.$queryBus.exec(new Zt.l("Внимание!","Вы действительно хотите удалить ярлык документа?"));if(n){const n=new Dt.Qy(t.id,Number(e.folderId));yield this.$commandBus.exec(n),e.entityViewMode===Ue.dS.View&&(t.viewFlag=!1);const i="Ярлык документа удален";return{type:Te.uE.Completed,status:Te.Ao.RemoveFromFolder,message:i}}return{type:Te.uE.Completed,status:Te.Ao.None}}catch(e){return{type:Te.uE.Error,status:Te.Ao.None,message:e.message}}}))}};Jf=deleteShortcut_action_decorate([(0,Ee.b2)()],Jf);var edit_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},edit_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Xf=class EditAction extends zf{get id(){return"edit"}caption(){return"Изменить"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return edit_action_awaiter(this,void 0,void 0,(function*(){const t=e.document[0],n=yield this.$queryBus.exec(new tt.R0(String(t.cardId),"cards")),i=yield this.$queryBus.exec(new tt.R0("default","cards")),o=(null===i||void 0===i?void 0:i.create)?null===i||void 0===i?void 0:i.create:null===n||void 0===n?void 0:n.create;return n&&o?Promise.resolve({type:Te.uE.Open,status:Te.Ao.None,data:{name:"editDocument",params:Object.assign({id:String(t.id),actionType:Um._.Edit},zf.commonRouteParams(Object.assign(Object.assign({},e),{entityViewMode:Ue.dS.Edit})))}}):(yield this.$queryBus.exec(new gn.m("Внимание!","Для этого журнала нет возможности редактировать документы")),Promise.resolve({type:Te.uE.Completed,status:Te.Ao.None}))}))}};Xf=edit_action_decorate([(0,Ee.b2)()],Xf);var sendMessage_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},sendMessage_action_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},sendMessage_action_param=function(e,t){return function(n,i){t(n,i,e)}},sendMessage_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let eg=class SendMessage extends zf{constructor(e,t,n,i){super(e,t,n),this.$log=e,this.$queryBus=t,this.$commandBus=n,this.$container=i}get id(){return"sendMessage"}caption(){return"Отправить сообщение"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return sendMessage_action_awaiter(this,void 0,void 0,(function*(){try{const t=this.$container.get(Pe.k.CreateMessage);return yield t.execAsync(e,{baseDocument:Array.isArray(e.document)&&e.document.length?e.document[0]:null})}catch(e){return Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}}))}};eg=sendMessage_action_decorate([(0,Ee.b2)(),sendMessage_action_param(0,(0,Ee.f3)(je.t.ILogger)),sendMessage_action_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),sendMessage_action_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),sendMessage_action_param(3,(0,Ee.f3)(je.t.Container)),sendMessage_action_metadata("design:paramtypes",[Object,Object,Object,Ee.W2])],eg);var setDocReaded_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},setDocReaded_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let tg=class SetDocReaded extends zf{get id(){return"set-doc-readed"}caption(){return"Пометить как прочитанный"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return setDocReaded_action_awaiter(this,void 0,void 0,(function*(){const t=e.document[0],n=new Dt.$6(t.id,t.journalID);return yield this.$commandBus.exec(n),e.entityViewMode===Ue.dS.View&&(t.viewFlag=!0),{type:Te.uE.Completed,status:Te.Ao.Updated}}))}};tg=setDocReaded_action_decorate([(0,Ee.b2)()],tg);var setDocUnreaded_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},setDocUnreaded_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let ng=class SetDocUnreaded extends zf{get id(){return"set-doc-unreaded"}caption(){return"Пометить как непрочитанный"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return setDocUnreaded_action_awaiter(this,void 0,void 0,(function*(){const t=e.document[0],n=new Dt.ng(t.id,t.journalID);return yield this.$commandBus.exec(n),e.entityViewMode===Ue.dS.View&&(t.viewFlag=!1),{type:Te.uE.Completed,status:Te.Ao.Updated}}))}};ng=setDocUnreaded_action_decorate([(0,Ee.b2)()],ng);var ViewDocumentData_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ViewDocumentData_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let ig=class ViewDocumentData extends zf{get id(){return"viewDocumentData"}caption(){return"Свойства"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return ViewDocumentData_action_awaiter(this,void 0,void 0,(function*(){const t={model:e,document:e.document[0]},n=new Mc.c({title:"Свойства документа",componentName:"document-data-modal",componentProps:t,fullHeight:!1,width:"80%"});return yield this.$queryBus.exec(n),{type:Te.uE.None,status:Te.Ao.None}}))}};ig=ViewDocumentData_action_decorate([(0,Ee.b2)()],ig);var fastReport_action_base_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},fastReport_action_base_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},fastReport_action_base_param=function(e,t){return function(n,i){t(n,i,e)}},fastReport_action_base_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const og=Fr;let sg=class FastReportActionBase{constructor(e,t,n){this.$log=e,this.$queryBus=t,this.$commandBus=n}static commonRouteparams(e){return{context:e}}get id(){return""}caption(e){return""}execAsync(e){return fastReport_action_base_awaiter(this,void 0,void 0,(function*(){if(!this.contextValidate(e))return Promise.resolve({type:Te.uE.None,status:Te.Ao.None});try{return yield this.execAction(e)}catch(e){return this.showError(e)}}))}getFinishState(e,t,n){return Oe.Z.None}contextValidate(e){return!!e&&(!!(e.contentType!==Ue.zc.Instruction||e.instructionInfo&&e.instructionInfo.length)&&(!!(e.contentType!==Ue.zc.Document||e.document&&e.document.length)&&!!(e.contentType!==Ue.zc.FastReport||e.fastReport&&e.fastReport.length)))}showError(e){return fastReport_action_base_awaiter(this,void 0,void 0,(function*(){let t="Не удалось выполнить операцию. Попробуйте позже.",n=!1;throw e&&(e instanceof Ne.$Q?(t=e.error?e.error.message:t,e.error&&void 0!==e.error.notDisplayError&&(n=e.error.notDisplayError)):t=e.message),this.$log.error(t),n||(yield this.$queryBus.exec(new gn.m("Ошибка!",t))),e}))}};sg=fastReport_action_base_decorate([(0,Ee.b2)(),fastReport_action_base_param(0,(0,Ee.f3)(je.t.ILogger)),fastReport_action_base_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),fastReport_action_base_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),fastReport_action_base_metadata("design:paramtypes",[Object,Object,Object])],sg);var downloadReportResult_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};let rg=class DownloadResult extends sg{get id(){return"download-report"}caption(){return"Скачать файл отчёта"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}downloadReport(e){if(!e.fastReport[0].fastReportTaskInfo)return"";const t=document.createElement("a");t.href=`${og.config.apiPath()}fast-report/task/${e.fastReport[0].fastReportTaskInfo.taskId}/file`,t.download=e.fastReport[0].fastReportTaskInfo.name,document.body.appendChild(t),t.click(),setTimeout((()=>{document.body.removeChild(t),window.URL.revokeObjectURL(`${og.config.apiPath()}fast-report/task/${e.fastReport[0].fastReportTaskInfo.taskId}/file`)}),0)}execAction(e){return this.downloadReport(e),Promise.resolve({type:Te.uE.None,status:Te.Ao.None})}};rg=downloadReportResult_action_decorate([(0,Ee.b2)()],rg);var repeatReport_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},repeatReport_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let ag=class RepeatReport extends sg{get id(){return"repeat-report"}caption(){return"Повторить отчёт"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return repeatReport_action_awaiter(this,void 0,void 0,(function*(){if(this.$log.info("Repeat report action click"),!e.fastReport||!e.fastReport.length||!e.fastReport[0].fastReportTaskInfo)return;let t="";const n=e.fastReport[0].fastReportTaskInfo,i=e.fastReport[0].fastReportInfo;if(i.editParametersTemplatePath)return Promise.resolve({type:Te.uE.Open,status:Te.Ao.None,data:{name:"repeatFastReport",params:Object.assign({id:String(n.reportId),report:{fastReportInfo:i,frTaskInfo:null},prevParams:n.userParams},sg.commonRouteparams(e))}});const o=new Ao.c(n.reportId,n.userParams),s=yield this.$commandBus.exec(o);return s.error?(t="Ошибка при создании задания на повторное формирование отчёта",{type:Te.uE.Error,status:Te.Ao.None,message:t}):(t="Создано задание на повторное формирование отчёта",{type:Te.uE.Completed,status:Te.Ao.NeedUpdateList,message:t})}))}};ag=repeatReport_action_decorate([(0,Ee.b2)()],ag);var instruction_action_base_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},instruction_action_base_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},instruction_action_base_param=function(e,t){return function(n,i){t(n,i,e)}},instruction_action_base_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let lg=class InstructionActionBase{constructor(e,t,n,i){this.$log=e,this.$queryBus=t,this.$commandBus=n,this.instructionService=i}static commonRouteparams(e){return{context:e,folderId:String(e.folderId),folderName:e.folderName}}static withCapitalizeFirstLetter(e){const t=e[0],n=e.substr(1);return`${t.toUpperCase()}${n}`}get id(){return""}caption(e){return""}getFinishState(e,t,n){return Oe.Z.None}execAsync(e,t){return instruction_action_base_awaiter(this,void 0,void 0,(function*(){if(!this.contextValidate(e))return this.$log.info("Невалидный контекст выполнения операции",e),Promise.resolve({type:Te.uE.None,status:Te.Ao.None});try{if(e.instructionInfo)for(const t of e.instructionInfo){const n=null===t||void 0===t?void 0:t.instruction;n&&!n.folder&&(n.folder={id:Number(e.folderId),name:e.folderName})}return yield this.execAction(e,t)}catch(e){return this.showError(e)}}))}getInstruction(e){return e.instructionInfo[0].instruction}contextValidate(e){return!!e&&(!!(e.contentType!==Ue.zc.Instruction||e.instructionInfo&&e.instructionInfo.length)&&(!!(e.contentType!==Ue.zc.Document||e.document&&e.document.length)&&!!(e.contentType!==Ue.zc.FastReport||e.fastReport&&e.fastReport.length)))}showError(e){return instruction_action_base_awaiter(this,void 0,void 0,(function*(){let t="Не удалось выполнить операцию. Попробуйте позже.",n=!1;throw e&&(e instanceof Ne.$Q?(t=e.error?e.error.message:t,e.error&&void 0!==e.error.notDisplayError&&(n=e.error.notDisplayError)):t=e.message),this.$log.error(t),n||(yield this.$queryBus.exec(new gn.m("Ошибка!",t))),e}))}instructionTitle(e){return uc.X.getInstructionTitle({createDateTime:e.createDateTime,creatorName:e.creatorName,documentRegistrationNumber:e.baseDocumentRegistrationNumber})}redirectReportAsReport(e,t){const n=this.getInstructionIdForReport(e),i=this.$container.get(Pe.k.CreateReport);return i.execAsync(e,{messageId:e.instructionInfo[0].instruction.id,actionType:Nn.xK.ForwardReport,reportId:t?String(t):null,targetInstructionId:String(n),isDialog:!0})}openReport(e,t){if(!e||!e.instructionInfo||!e.instructionInfo.length)return Promise.reject({type:Te.uE.None,data:"Для данного действия нет правильного контекста."});const n=this.getInstructionIdForReport(e),i=this.$container.get(Pe.k.CreateReport);return i.execAsync(e,{messageId:n,actionType:Nn.xK.CreateReport,isDialog:!0})}getInstructionIdForReport(e){const t=e.instructionInfo[0].instruction,n=e.instructionInfo[0].parentControlInstruction;return t.isReport?n?n.id:t.parentID:t.id}getDefaultReport(e,t,n=null){const i=e.reportReceiverID||e.creatorID,o=e.usersInfo?e.usersInfo[i]:{id:i,name:e.reportReceiverID?e.reportReceiverName:e.creatorName,departmentId:null},s={reportId:null,instructionId:e.id,creator:t,receiver:o,subject:"Отчет: "+e.subject,executionDate:new Date,operationMenuCaption:e.operationMenuCaption,operationDocumentId:e.baseDocumentID,operationTypeId:e.operationID,text:n,document:null,files:[],comment:null};return e.taskID&&(s.taskID=e.taskID),s}getCreator(){return instruction_action_base_awaiter(this,void 0,void 0,(function*(){const e=yield this.$queryBus.exec(new Ze.by);return{id:e.effectiveId,name:e.effectiveName,departmentId:e.departmentID}}))}getReportText(){return" "}sendReport(e,t,n,i){return instruction_action_base_awaiter(this,void 0,void 0,(function*(){const o=yield this.getCreator(),s=this.getDefaultReport(e,o,this.getReportText()),r=t.folderId?{id:Number(t.folderId),name:t.folderName}:e.folder,a=new un.Gm(e.id,s,r,n,i);yield this.$commandBus.exec(a);let l="";switch(n){case En.g.Success:l="подтверждением";break;case En.g.Reject:l="отказом";break;default:break}const c=this.instructionTitle(e);return`Отчет для ${c} с ${l} успешно отправлен`}))}};instruction_action_base_decorate([(0,Ee.f3)(je.t.Container),instruction_action_base_metadata("design:type",Ee.W2)],lg.prototype,"$container",void 0),lg=instruction_action_base_decorate([(0,Ee.b2)(),instruction_action_base_param(0,(0,Ee.f3)(je.t.ILogger)),instruction_action_base_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),instruction_action_base_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),instruction_action_base_param(3,(0,Ee.f3)(uc.X)),instruction_action_base_metadata("design:paramtypes",[Object,Object,Object,uc.X])],lg);var acceptReport_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},acceptReport_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let cg=class AcceptReport extends lg{get id(){return"acceptreport"}caption(){return"Принять отчет"}getFinishState(e,t,n){const i=t.instructionInfo[0].permissions;return i.canRedirectReportAsReport?n?n.type===Te.uE.Open?Oe.Z.CreatingReport:e:Oe.Z.LaterDefine:e}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return acceptReport_action_awaiter(this,void 0,void 0,(function*(){let t=[];Array.isArray(e.entity)&&e.entity.length?t=e.entity:Array.isArray(e.instructionInfo)&&e.instructionInfo.length&&(t=e.instructionInfo);let n,i=0;for(const o of t){const t=o.instruction,s=o.permissions;if(s.canRedirectReportAsReport){const o=yield this.acceptReport(t,e);if(n=o.message,!o.isFailure){i++;const n=yield this.$queryBus.exec(new Zt.l("Внимание!","Принятый отчет был отправлен по перенаправленному заданию. Хотите отчитаться по исходному заданию?"));if(n)return this.redirectReportAsReport(e,t.id)}}else{const o=yield this.acceptReport(t,e);n=o.message,o.isFailure||i++}}if(!i)return{type:Te.uE.Error,status:Te.Ao.None,message:n||"Возникли ошибки при принятии отчетов"};if(1===t.length){const e=this.instructionTitle(t[0].instruction);n=`Отчет ${e} успешно принят`}else n=`${(0,Wf.o)(i,"отчет","отчета","отчетов")} успешно ${(0,Wf.o)(i,"принят","принято","приняты",!1)}`;return{type:Te.uE.Completed,status:Te.Ao.RemoveFromFolder,message:n}}))}acceptReport(e,t){const n=new un.g$(e.id,t.folderId?{id:Number(t.folderId),name:t.folderName}:e.folder);return this.$commandBus.exec(n)}};cg=acceptReport_action_decorate([(0,Ee.b2)()],cg);var archive_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},archive_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let dg=class ArchiveAction extends lg{get id(){return"archive"}caption(e){return"Переместить в архив"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){var t;return archive_action_awaiter(this,void 0,void 0,(function*(){let n=[];Array.isArray(e.entity)&&e.entity.length?n=e.entity:Array.isArray(e.instructionInfo)&&e.instructionInfo.length&&(n=e.instructionInfo);const i=1===n.length?"сообщение":`${(0,Wf.o)(n.length,"сообщение","сообщения","сообщений")}`,o=yield this.$queryBus.exec(new Zt.l("Внимание!",`Вы действительно хотите отправить ${i} в архив?`));if(o){let i,o=0;for(const t of n)i=yield this.$commandBus.exec(new un.M3(t.instruction.id,Number(e.folderId))),i.isFailure||o++;if(!o){const e="Возникли ошибки при отправке в архив";return{type:Te.uE.Error,status:Te.Ao.None,message:null!==(t=i.message)&&void 0!==t?t:e}}let s=`${(0,Wf.o)(o,"сообщение","сообщения","сообщений")} перемещены в архив`;return 1===n.length&&(s=`Сообщение ${this.instructionTitle(n[0].instruction)} перемещено в архив`),{type:Te.uE.Completed,status:Te.Ao.RemoveFromFolder,message:s}}return{type:Te.uE.Completed,status:Te.Ao.None}}))}};dg=archive_action_decorate([(0,Ee.b2)()],dg);var createEdit_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},createEdit_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let ug=class CreateEditMessage extends lg{get id(){return"createMessage"}caption(){return"Создать сообщение"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}contextValidate(e){return!!e}execAction(e,t){var n,i,o;return createEdit_action_awaiter(this,void 0,void 0,(function*(){try{if(t||(t={}),!t.id&&!t.type){const e=yield this.$queryBus.exec(new SelectInstructionTypesQuery(null));if(!e||!e.length)return Promise.resolve({type:Te.uE.Cancel,status:Te.Ao.None});t.type=e[0]}e=Object.assign(Object.assign({},e),{entityViewMode:Ue.dS.Create});const s={model:null,context:e,id:String(t.id),reportId:t.reportId?t.reportId:null,type:(null===(n=t.type)||void 0===n?void 0:n.id)?String(null===(i=t.type)||void 0===i?void 0:i.id):null,actionType:t.actionType,modal:!0};let r,a=null;switch(null===t||void 0===t?void 0:t.actionType){case Nn.xK.ForwardMessage:r="Перенаправить сообщение";break;case Nn.xK.RepeatMessage:r="Повторить сообщение";break;case Nn.xK.RepeatChain:r="Повторить цепочку";break;case Nn.xK.Replace:r="Заменить сообщение";break;case Nn.xK.Edit:r="Изменить сообщение";break;default:r="Новое сообщение"}s.actionType=t.actionType?t.actionType:Nn.xK.Create,s.actionType!==Nn.xK.Create&&(a={id:t.id,contentType:Ue.zc.Instruction,kind:t.actionType}),s.defaultReceivers=t.defaultReceivers,s.baseDocument=t.baseDocument;const l=new Mc.c({title:r,componentName:"instruction-page",componentProps:s,fullHeight:!1,width:"80%",height:null,hideFooter:!0,darkTitle:!0,closable:!0,expandable:!0,minimizable:!0,collapsedSize:{height:"450px",width:"450px",noModal:!0},expandedSize:{height:"680px",width:"1088px",noModal:!1},description:null===(o=null===t||void 0===t?void 0:t.type)||void 0===o?void 0:o.name,hostObject:a});return this.$queryBus.exec(l),Promise.resolve({type:Te.uE.None,status:Te.Ao.None})}catch(e){return Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}}))}};ug=createEdit_action_decorate([(0,Ee.b2)()],ug);var createEditReport_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},createEditReport_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let pg=class CreateEditReport extends lg{get id(){return"createReport"}caption(){return"Создать отчёт"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}contextValidate(e){return!!e}execAction(e,t){return createEditReport_action_awaiter(this,void 0,void 0,(function*(){try{if(!Array.isArray(e.instructionInfo)||!e.instructionInfo.length)throw new Error("В контексте отсутствует объект сообщения");const n=e.instructionInfo[0].instruction;t||(t={messageId:n.id,actionType:Nn.xK.CreateReport}),t.messageId||(t.messageId=n.id),t.actionType||(t.actionType=Nn.xK.CreateReport);const i="Отчет по сообщению типа: "+n.instructionTypeName,o={model:null,context:e,id:String(t.messageId),actionType:t.actionType,reportId:t.reportId,targetInstructionId:t.targetInstructionId,modal:!0};let s=null;t.messageId&&(s={id:t.messageId,contentType:Ue.zc.Instruction,kind:t.actionType});const r=new Mc.c({title:i,componentName:"instruction-page",componentProps:o,fullHeight:!1,width:"80%",height:null,hideFooter:!0,darkTitle:!0,closable:!0,expandable:!0,minimizable:!0,collapsedSize:{height:"450px",width:"450px",noModal:!0},expandedSize:{height:"680px",width:"1088px",noModal:!1},description:`Отчет для ${n.instructionTypeName}`,hostObject:s});return this.$queryBus.exec(r),Promise.resolve({type:Te.uE.None,status:Te.Ao.None})}catch(e){return Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}}))}};pg=createEditReport_action_decorate([(0,Ee.b2)()],pg);var link_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},link_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let hg=class LinkAction extends lg{get id(){return"link"}caption(){return"Ссылка"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return link_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction,n=`landocs://${t.isReport?"report/":"instruction/"}${t.uid}`;return Promise.resolve({type:Te.uE.Link,status:Te.Ao.None,data:n})}))}};hg=link_action_decorate([(0,Ee.b2)()],hg);var move_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},move_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let mg=class MoveAction extends lg{*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}get id(){return"moveToFolder"}execAction(e){return move_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction;if(!t)return{type:Te.uE.None,status:Te.Ao.None};let n=e.folderId;if(n||(n=t.folder.id),!n)throw new Error("Папка-источник не установлена.");const i=yield this.$queryBus.exec(new Fe.c1(n)),o=yield this.$queryBus.exec(new SelectFoldersQuery(i,[e.folderId]));if(!o||!o.length)return Promise.resolve({type:Te.uE.None,status:Te.Ao.None});const s=yield this.$commandBus.exec(new un.Xw(t.id,Number(n),o[0].id));if(!s.value)return{type:Te.uE.Error,status:Te.Ao.None,message:s.message};const r=`Сообщение ${this.instructionTitle(t)} перемещено в папку "${o[0].name}"`;return{type:Te.uE.Completed,status:Te.Ao.RemoveFromFolder,message:r}}))}};mg=move_action_decorate([(0,Ee.b2)()],mg);var redirect_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},redirect_action_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},redirect_action_param=function(e,t){return function(n,i){t(n,i,e)}},redirect_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let fg=class RedirectInstructionAction extends lg{constructor(e,t,n,i){super(e,t,n,i),this.$log=e,this.$queryBus=t,this.$commandBus=n,this.instructionService=i}get id(){return"redirect"}caption(e){if(e&&Array.isArray(e.instructionInfo)){const t=e.instructionInfo[0].instruction;if(t.isReport)return"Перенаправить отчет"}return"Перенаправить сообщение"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return redirect_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction;let n=-1,i=null;if(e.data&&"number"===typeof e.data)n=e.data;else{const e=yield this.$queryBus.exec(new SelectInstructionTypesQuery(t.instructionTypeID));if(!e||!e.length)return Promise.resolve({type:Te.uE.Completed,status:Te.Ao.None});n=e[0].id,i=e[0]}try{const o=this.$container.get(Pe.k.CreateMessage);let s;return s=t.isReport?yield o.execAsync(e,{id:t.id?Number(t.id):null,reportId:t.id?String(t.id):null,type:null!==i&&void 0!==i?i:n,actionType:Nn.xK.ForwardMessage}):yield o.execAsync(e,{id:Number(t.id),type:null!==i&&void 0!==i?i:n,actionType:Nn.xK.ForwardMessage}),s}catch(e){return Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}}))}};fg=redirect_action_decorate([(0,Ee.b2)(),redirect_action_param(0,(0,Ee.f3)(je.t.ILogger)),redirect_action_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),redirect_action_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),redirect_action_param(3,(0,Ee.f3)(uc.X)),redirect_action_metadata("design:paramtypes",[Object,Object,Object,uc.X])],fg);var redirectReport_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},redirectReport_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let gg=class RedirectReportAction extends lg{get id(){return"redirectReport"}caption(e){return"Перенаправить отчет"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return redirectReport_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction,n=t.reportID||t.isReport&&t.id;return this.redirectReportAsReport(e,n)}))}};gg=redirectReport_action_decorate([(0,Ee.b2)()],gg);var remove_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},remove_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let yg=class RemoveAction extends lg{get id(){return"remove"}caption(e){return"Удалить"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){var t;return remove_action_awaiter(this,void 0,void 0,(function*(){const n=e.instructionInfo[0].instruction,i=yield this.$queryBus.exec(new Zt.l("Внимание!","Вы действительно хотите удалить сообщение?"));if(i){const i=yield this.$commandBus.exec(new un.cu(n.id,Number(e.folderId))),o=`Сообщение ${this.instructionTitle(n)} удалено`;return Object.assign(Object.assign({},null===i||void 0===i?void 0:i.value),{type:[Ue.dS.Edit,Ue.dS.View].includes(e.entityViewMode)?Te.uE.Close:null===(t=null===i||void 0===i?void 0:i.value)||void 0===t?void 0:t.type,message:o})}return{type:Te.uE.Cancel,status:Te.Ao.None}}))}};yg=remove_action_decorate([(0,Ee.b2)()],yg);var repeatChain_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},repeatChain_action_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},repeatChain_action_param=function(e,t){return function(n,i){t(n,i,e)}},repeatChain_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let vg=class RepeatChainAction extends lg{constructor(e,t,n,i){super(e,t,n,i),this.$log=e,this.$queryBus=t,this.$commandBus=n,this.instructionService=i}get id(){return"repeatChain"}caption(){return"Повторить цепочку сообщений"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return repeatChain_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction,n=e.instructionInfo[0].parentInstruction,i={id:Number(t.parentID),reportId:String(t.id),type:{id:n.instructionTypeID,name:n.instructionTypeName},actionType:Nn.xK.RepeatChain};try{const t=this.$container.get(Pe.k.CreateMessage);return yield t.execAsync(e,i)}catch(e){return Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}}))}};vg=repeatChain_action_decorate([(0,Ee.b2)(),repeatChain_action_param(0,(0,Ee.f3)(je.t.ILogger)),repeatChain_action_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),repeatChain_action_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),repeatChain_action_param(3,(0,Ee.f3)(uc.X)),repeatChain_action_metadata("design:paramtypes",[Object,Object,Object,uc.X])],vg);var repeatMessage_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},repeatMessage_action_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},repeatMessage_action_param=function(e,t){return function(n,i){t(n,i,e)}},repeatMessage_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let bg=class RepeatMessageAction extends lg{constructor(e,t,n,i){super(e,t,n,i),this.$log=e,this.$queryBus=t,this.$commandBus=n,this.instructionService=i}get id(){return"repeatMessage"}caption(){return"Повторить задание"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return repeatMessage_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction,n=e.instructionInfo[0].parentInstruction;try{const i=this.$container.get(Pe.k.CreateMessage);return yield i.execAsync(e,{id:Number(t.parentID),reportId:String(t.id),type:{id:n.instructionTypeID,name:n.instructionTypeName},actionType:Nn.xK.RepeatMessage})}catch(e){return Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}}))}};bg=repeatMessage_action_decorate([(0,Ee.b2)(),repeatMessage_action_param(0,(0,Ee.f3)(je.t.ILogger)),repeatMessage_action_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),repeatMessage_action_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),repeatMessage_action_param(3,(0,Ee.f3)(uc.X)),repeatMessage_action_metadata("design:paramtypes",[Object,Object,Object,uc.X])],bg);var replaceMessage_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},replaceMessage_action_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},replaceMessage_action_param=function(e,t){return function(n,i){t(n,i,e)}},replaceMessage_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Cg=class ReplaceMessageAction extends lg{constructor(e,t,n,i){super(e,t,n,i),this.$log=e,this.$queryBus=t,this.$commandBus=n,this.instructionService=i}get id(){return"replaceMessage"}caption(){return"Заменить"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return replaceMessage_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction;try{const n=this.$container.get(Pe.k.CreateMessage);return yield n.execAsync(e,{id:Number(t.id),type:{id:t.instructionTypeID,name:t.instructionTypeName},actionType:Nn.xK.Replace})}catch(e){return Promise.resolve({type:Te.uE.Error,status:Te.Ao.None,message:e.message})}}))}};Cg=replaceMessage_action_decorate([(0,Ee.b2)(),replaceMessage_action_param(0,(0,Ee.f3)(je.t.ILogger)),replaceMessage_action_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),replaceMessage_action_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),replaceMessage_action_param(3,(0,Ee.f3)(uc.X)),replaceMessage_action_metadata("design:paramtypes",[Object,Object,Object,uc.X])],Cg);var restore_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},restore_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let wg=class RestoreAction extends lg{get id(){return"restore"}caption(e){return"Восстановить из архива"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return restore_action_awaiter(this,void 0,void 0,(function*(){let t=[];Array.isArray(e.entity)&&e.entity.length?t=e.entity:Array.isArray(e.instructionInfo)&&e.instructionInfo.length&&(t=e.instructionInfo);const n=1===t.length?"сообщение":`${(0,Wf.o)(t.length,"сообщение","сообщения","сообщений")}`,i=yield this.$queryBus.exec(new Zt.l("Внимание!",`Вы действительно хотите восстановить ${n} из архива?`));if(i){let n=0;for(const i of t){const t=yield this.$commandBus.exec(new un.xS(i.instruction.id,Number(e.folderId)));t.isFailure||n++}if(!n)return{type:Te.uE.Error,status:Te.Ao.None,message:"Возникли ошибки при восстановлении из архива"};let i=`${(0,Wf.o)(n,"сообщение","сообщения","сообщений")} восстановлены из архива`;return 1===t.length&&(i=`Сообщение ${this.instructionTitle(t[0].instruction)} восстановлено из архива`),{type:Te.uE.Completed,status:Te.Ao.RemoveFromFolder,message:i}}return{type:Te.uE.Completed,status:Te.Ao.None}}))}};wg=restore_action_decorate([(0,Ee.b2)()],wg);var revoke_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},revoke_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let _g=class RevokeAction extends lg{get id(){return"revoke"}caption(e){return"Отозвать"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return revoke_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction,n=e.instructionInfo[0].permissions,i=yield this.$queryBus.exec(new Zt.l("Внимание!","Вы действительно хотите отозвать сообщение?"));if(i){const i=yield this.$commandBus.exec(new un.y0(t.id,n.canRevokeChain,Number(e.folderId))),o=`Сообщение ${this.instructionTitle(t)} отозвано`;return Object.assign(Object.assign({},null===i||void 0===i?void 0:i.value),{message:o})}return{type:Te.uE.Cancel,status:Te.Ao.None}}))}};_g=revoke_action_decorate([(0,Ee.b2)()],_g);var xg=n(73082),sendReport_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},sendReport_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Sg=class SendReport extends lg{get id(){return"sendreport"}caption(e){if(Array.isArray(e.instructionInfo)&&e.instructionInfo.length){const t=e.instructionInfo[0].instruction;if(t&&t.operationMenuCaption)return t.operationMenuCaption}return"Отчитаться"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return sendReport_action_awaiter(this,void 0,void 0,(function*(){let t="";const n=this.getInstruction(e),i=this.getReportId(e);if(i)return this.openReport(e,i);const o=this.$container.get(je.t.IOpenForm),s={id:n.id,contentType:Ue.zc.Instruction,kind:Nn.xK.CreateReport};if(!o.tryToOpen(s))return{type:Te.uE.None,status:Te.Ao.None};const r=yield this.getCreator(),{report:a,completionType:l}=this.tryCreateReport(e,r);if(!a)return this.openReport(e,i);let c="";c=l===En.g.Reject?"отправить отчет с отказом":this.caption(e).toLowerCase();let d,u=null;l===En.g.Success&&n.operationID&&(d=yield this.$queryBus.exec(new Fe.I1(n.id,!0)),u=this.instructionService.checkFilesVersions(d));const p=Array.isArray(u)&&u.length;let h=!1;if(p&&(h=yield this.instructionService.newFileVersionAlert(c)),p&&!h)return{type:Te.uE.Cancel,status:Te.Ao.None,message:t};d&&p&&(n.files=d);const m=yield this.$queryBus.exec(new Zt.l("Внимание!",`Вы действительно хотите ${c}?`));if(m){try{yield(0,xg.g)(3e3),t=yield this.sendReport(n,e,l,h)}catch(e){const i=e;if(i&&i.error){const e=this.instructionTitle(n);return t=`Ошибка отправки отчета ${e}: ${i.error.message}`,{type:Te.uE.Error,status:Te.Ao.None,message:t}}}return{type:Te.uE.Completed,status:Te.Ao.RemoveFromFolder,message:t}}return{type:Te.uE.Cancel,status:Te.Ao.None,message:t}}))}tryCreateReport(e,t){const n=this.getInstruction(e),i=e.data,o=e.instructionInfo[0],s=this.tryCreateDefaultReport(n,t,i===En.g.Success?o.instructionType.checkReportTypePositive:o.instructionType.checkReportTypeNegative);return{report:s,completionType:i}}getReportId(e){const t=e.instructionInfo[0].instruction;return t.reportID||t.isReport&&t.id}tryCreateDefaultReport(e,t,n){const i=this.getReportText(),o=this.getDefaultReport(e,t,i),s=uc.X.validateReportRequiredFields(o,n);return s?null:o}};Sg=sendReport_action_decorate([(0,Ee.b2)()],Sg);var setRead_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},setRead_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Ig=class SetReadAction extends lg{get id(){return"read"}caption(){return"Пометить как прочитанное"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return setRead_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction,n=new un.Ub(t.id,e.folderId?{id:Number(e.folderId),name:e.folderName}:t.folder);return yield this.$commandBus.exec(n),{type:Te.uE.Completed,status:Te.Ao.Updated}}))}};Ig=setRead_action_decorate([(0,Ee.b2)()],Ig);var setUnread_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},setUnread_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Dg=class SetUnreadAction extends lg{get id(){return"unread"}caption(){return"Пометить как непрочитанное"}*exec(){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return setUnread_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction,n=new un.xd(t.id,e.folderId?{id:Number(e.folderId),name:e.folderName}:t.folder);return yield this.$commandBus.exec(n),{type:Te.uE.Completed,status:Te.Ao.Updated}}))}};Dg=setUnread_action_decorate([(0,Ee.b2)()],Dg);var toWork_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},toWork_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Rg=class ToWorkAction extends lg{get id(){return"archive"}caption(e){return"Взять в работу"}*exec(e){yield{type:Te.uE.None,status:Te.Ao.None}}execAction(e){return toWork_action_awaiter(this,void 0,void 0,(function*(){const t=e.instructionInfo[0].instruction,n=yield this.$queryBus.exec(new Zt.l("Внимание!","Вы действительно хотите взять сообщение в работу?"));if(n){yield this.$commandBus.exec(new un.b9(t.id,Number(e.folderId)));const n=`Сообщение ${this.instructionTitle(t)} взято в работу`;return{type:Te.uE.Completed,status:Te.Ao.NeedUpdate,message:n}}return{type:Te.uE.Completed,status:Te.Ao.None}}))}};Rg=toWork_action_decorate([(0,Ee.b2)()],Rg);var back_action_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},back_action_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Tg=class BackAction extends lg{get id(){return"back"}caption(e){return"Назад"}*exec(e){yield{type:Te.uE.Open,status:Te.Ao.None}}execAction(e){return back_action_awaiter(this,void 0,void 0,(function*(){return Promise.resolve({type:Te.uE.Open,status:Te.Ao.NeedUpdateList})}))}};Tg=back_action_decorate([(0,Ee.b2)()],Tg);const Pg=new Ee.nZ(((e,t)=>{e(Pe.k.CreateMessage).to(ug),e(Pe.k.Edit).to(ug),e(Pe.k.CreateReport).to(pg),e(Pe.k.EditReport).to(pg),e(Pe.k.AcceptReport).to(cg),e(Pe.k.SendReport).to(Sg),e(Pe.k.SendRejectionReport).to(Sg),e(Pe.k.ToMessages).to(Tg),e(Pe.k.RemoveMessage).to(yg),e(Pe.k.RedirectInstruction).to(fg),e(Pe.k.RedirectReportAsInstruction).to(fg),e(Pe.k.RepeatChain).to(vg),e(Pe.k.RepeatInstruction).to(bg),e(Pe.k.Replace).to(Cg),e(Pe.k.RedirectReportAsReport).to(gg),e(Pe.k.Link).to(hg),e(Pe.k.SetMessageReaded).to(Ig),e(Pe.k.SetMessageUnreaded).to(Dg),e(Pe.k.Revoke).to(_g),e(Pe.k.Archive).to(dg),e(Pe.k.Restore).to(wg),e(Pe.k.ToWork).to(Rg),e(Pe.k.MoveToFolder).to(mg),e(Pe.k.AddToFavourite).to(Zf),e(Pe.k.CreateShortcut).to(Gf),e(Pe.k.RemoveShortcut).to(Jf),e(Pe.k.SendMessage).to(eg),e(Pe.k.SetDocReaded).to(tg),e(Pe.k.SetDocUnreaded).to(ng),e(Pe.k.DeleteDoc).to(Yf),e(Pe.k.EditDoc).to(Xf),e(Pe.k.CardCustomAction).to(Kf),e(Pe.k.ArchiveDoc).to(qf),e(Pe.k.ViewDocumentData).to(ig),e(Pe.k.DownloadResult).to(rg),e(Pe.k.RepeatReport).to(ag)}));var Og=n(40051),kg=n(73983),baseApp_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},baseApp_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},baseApp_param=function(e,t){return function(n,i){t(n,i,e)}},baseApp_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Fg=0;class HotReload{constructor(e,t,n){this._logger=e,this._queryBus=t,this._commandBus=n,this._extComp=new Map,this._card=new Map,this._recentPatches=[],this._timeoutId=null,this._socket=null;try{this._socket=new WebSocket("ws://localhost:8101"),this._socket.onmessage=e=>{const t=JSON.parse(e.data);this._logger.debug(new Date,t.name),this._patches[t.name]=t.file,this._recentPatches.push(t.name),this.reload()},this._socket.onerror=e=>{this._logger.debug(new Date,e)};const e=10;let t=0;const n=setInterval((()=>{t>e&&(clearInterval(n),this._logger.error("websocket connection failed")),t++,1===this._socket.readyState&&clearInterval(n)}),100)}catch(e){this._logger.error(e)}}set templates(e){this._templates=e}set mixins(e){this._mixins=e}set mixinDependencies(e){this._mixinDependencies=e}set patches(e){this._patches=e}add(e,t,n){const i={name:t,component:e,path:n};this._card.set(n,i),this._extComp.set(e,i)}remove(e){const t=this._extComp.get(e);t&&(this._extComp.delete(e),this._card.delete(t.path))}refreshComponent(e,t){return baseApp_awaiter(this,void 0,void 0,(function*(){try{const n=yield this._queryBus.exec(new tt.Gf(t,e));return this._commandBus.exec(new Ne.L$(e,n,this._manifest))}catch(e){this._logger.error(`Ошибка обновления компонента "${t}", ${e}`)}}))}refreshMixin(e){var t;return this._queryBus.exec(new tt.ac(e,null,null===(t=this._manifest)||void 0===t?void 0:t.mixinIsVueFile))}reload(){clearTimeout(this._timeoutId),this._timeoutId=setTimeout((()=>baseApp_awaiter(this,void 0,void 0,(function*(){try{let e;this._manifest||(this._manifest=yield this._queryBus.exec(new tt.Yf));const t=[],n=[...this._recentPatches];for(e of n){const n=this._mixins[e];if(!n)continue;t.push(n.name);const i=this._mixinDependencies[e];i&&i.forEach((e=>{let t=null;for(const n in this._templates)if(this._templates[n].name===e){t=n;break}t&&!this._recentPatches.includes(t)&&this._recentPatches.push(t)}))}t.length&&(yield this.refreshMixin(t));const i={};this._extComp.forEach((e=>{let t=i[e.name];t||(t=[],i[e.name]=t),t.push(e.component)}));const o=Object.keys(i);while(e=this._recentPatches.shift()){const t=this._templates[e];if((null===t||void 0===t?void 0:t.name)&&!o.includes(t.name))if(e.endsWith(".html"))t.template=null;else try{yield this.refreshComponent(t.name,e)}catch(e){this._logger.error(e)}}for(const e of o){const t=i[e];if(Array.isArray(t)&&t.length){const e=t.shift();yield e.loadComponent(!0)}for(const e of t)e.$forceUpdate()}}catch(e){this._logger.error(e)}}))),200)}}let Ag=class BaseApplication extends Og.M{constructor(e,t,n,i,s,r,a){super(e,t,i,r),this._container=e,this._queryBus=t,this._commandBus=n,this._logger=i,this._router=s,this.transitions=r,this._cancellationService=a,this._selfChangeUrl=!1,this._location=null,this._currentState={state:Oe.Z.None,from:Oe.Z.None},this._observableState=o().observable(this._currentState),this._config=this._container.get(je.t.Config),this.fsm.onLeaveState=this._onLeaveState.bind(this),this.fsm.onEnterState=this._onEnterState.bind(this),this.setup()}get hotReload(){return this._hotReload}get selfChangeUrl(){return this._selfChangeUrl}set vm(e){this._vm=e,this.config.hotCardReload&&(this._hotReload=new HotReload(this._logger,this._queryBus,this._commandBus),this._hotReload.templates=this.vm.$store.state.templates,this._hotReload.mixins=this.vm.$store.state.mixins,this._hotReload.mixinDependencies=this.vm.$store.state.mixinDependencies,this.vm.$store.state.extCompPatches||(this.vm.$store.state.extCompPatches={}),this._hotReload.patches=this.vm.$store.state.extCompPatches)}get vm(){return this._vm}get state(){return this._observableState.state}get fromState(){return this._observableState.from}get prevState(){return this._observableState.from}get config(){return this._config}get homeTransition(){var e,t,n;if(!(null===(e=this.config)||void 0===e?void 0:e.defaultSection))return Pe.k.ToDashboard;switch(null===(t=this.config)||void 0===t?void 0:t.defaultSection){case Le.S.Archive:return Pe.k.ToArchive;case Le.S.Dashboard:return Pe.k.ToDashboard;case Le.S.Documents:return Pe.k.ToDocuments;case Le.S.Messages:return Pe.k.ToMessages;case Le.S.Reports:return Pe.k.ToReports;case Le.S.Favorites:return Pe.k.ToFavorites;case Le.S.History:return Pe.k.ToHistory;case Le.S.Search:return Pe.k.ToSearch;case Le.S.Settings:return Pe.k.ToSettings;case Le.S.Vocabularies:return Pe.k.ToVocabularies;case Le.S.Kanban:return Pe.k.ToKanban;default:return(0,kg.y)(null===(n=this.config)||void 0===n?void 0:n.defaultSection)}}get homeState(){var e,t,n;if(!(null===(e=this.config)||void 0===e?void 0:e.defaultSection))return Oe.Z.Dashboard;switch(null===(t=this.config)||void 0===t?void 0:t.defaultSection){case Le.S.Archive:return Oe.Z.Archive;case Le.S.Dashboard:return Oe.Z.Dashboard;case Le.S.Documents:return Oe.Z.Documents;case Le.S.Messages:return Oe.Z.Messages;case Le.S.Reports:return Oe.Z.Reports;case Le.S.Favorites:return Oe.Z.Favorites;case Le.S.History:return Oe.Z.History;case Le.S.Search:return Oe.Z.Search;case Le.S.Settings:return Oe.Z.Settings;case Le.S.Vocabularies:return Oe.Z.Vocabularies;case Le.S.Kanban:return Oe.Z.Kanban;default:return(0,kg.y)(null===(n=this.config)||void 0===n?void 0:n.defaultSection)}}setup(){let e=0;this._router.beforeEach(((t,n,i)=>baseApp_awaiter(this,void 0,void 0,(function*(){try{if(!this.vm&&e<10)return e++,setTimeout((()=>{this._router.push(t)})),i(!1);if(this.state===Oe.Z.None)return yield this.setInitState(t),i();if(this._selfChangeUrl)return i(),void(this._selfChangeUrl=!1);if(this.vm.isMobile&&t.path.includes("settings"))return void i("/");const o=t.meta.transition;if(!o)return this._router.push("404");const s=this.destStateForTransition(o);this.state!==s&&(this.forcedTransiton(o),this._logger.debug(`BaseApplication: transition was cancelled from ${n.path} to ${t.path}`)),i()}catch(e){this._logger.error(e)}}))))}open(e,t,n){var i,o;return baseApp_awaiter(this,void 0,void 0,(function*(){if(!e)throw new Error("ActionContext is required");if(t.type===Te.uE.Link&&"string"===typeof t.data)return void(window.location.href=t.data);const n=null===t||void 0===t?void 0:t.data,s=null===t||void 0===t?void 0:t.data;(null===(o=null===(i=null===n||void 0===n?void 0:n.location)||void 0===i?void 0:i.params)||void 0===o?void 0:o.replace)?yield this.replace(n.location):(null===n||void 0===n?void 0:n.location)?yield this.push(n.location):(null===s||void 0===s?void 0:s.params.replace)?yield this.replace(t.data):yield this.push(t.data)}))}openHere(e,t,n){if(this.vm.isMobile)return this.open(e,t,n);if(!e)throw new Error("ActionContext is required");if(t.data&&"createReport"===t.data.name){const i=t.data.params,o={contentType:Ue.zc.Instruction,context:e,data:n,forEntityId:e.instructionInfo[0].instruction.id,instructionInfo:e.instructionInfo[0],reportData:{actionType:i?i.actionType:Nn.xK.CreateReport,quickReport:!0,reportId:i?i.reportId:0}};Je.X.$emit("app-view-open",o)}}checkAccess(e,t,n,i){return baseApp_awaiter(this,void 0,void 0,(function*(){return!e||Promise.resolve(!0)}))}setLastUrl(e){this._router.push(e)}findRoute(e,t){var n;if(!Array.isArray(e))return null;let i;for(const o of e){if((null===(n=o.meta)||void 0===n?void 0:n.transition)===t){i=o;break}if(i=this.findRoute(o.children,t),i)break}return i}goto(e,t,n={}){return baseApp_awaiter(this,void 0,void 0,(function*(){if(!t)throw new Error("context is required for action "+e.toString());e===Pe.k.ToHome&&(e=this.homeTransition);const i=this.findRoute(this._router.options.routes,e);if(!i)return this.do(e,t,n);n=n||{},n.context=t;const o={name:i.name,params:n};if(n.blank){let e;if(t.document&&(e=String(t.document[0].id)),t.instructionInfo&&(e=String(t.instructionInfo[0].instruction.id)),e){const t=this._router.resolve({name:o.name,params:{id:e}});return void window.open(t.href,"_blank")}}n.path&&(delete o.name,delete o.params,o.path=n.path);const s={type:Te.uE.Open,data:{location:o},status:Te.Ao.None},r=this.destStateForTransition(e);if(this.state===r)try{return yield this.open(t,s,null),Object.assign(Object.assign({},s),{type:Te.uE.Completed})}catch(e){throw{type:Te.uE.Cancel,status:Te.Ao.None,data:e}}const a=yield this.go(e,t,s,null);if((null===a||void 0===a?void 0:a.message)&&this.showMessage(a.message,null===a||void 0===a?void 0:a.type),(null===a||void 0===a?void 0:a.type)===Te.uE.Cancel||(null===a||void 0===a?void 0:a.type)===Te.uE.Error)throw a;return(null===a||void 0===a?void 0:a.status)===Te.Ao.RemoveFromFolder&&Je.X.$emit("remove-from-folder",t,a),a}))}do(e,t,n){return baseApp_awaiter(this,void 0,void 0,(function*(){const i=yield this.go(e,t,null,n);if((null===i||void 0===i?void 0:i.message)&&this.showMessage(null===i||void 0===i?void 0:i.message,null===i||void 0===i?void 0:i.type),(null===i||void 0===i?void 0:i.type)===Te.uE.Cancel||(null===i||void 0===i?void 0:i.type)===Te.uE.Error)throw i;return i.status&&i.status===Te.Ao.RemoveFromFolder&&Je.X.$emit("remove-from-folder",t,i),i}))}goHome(){return baseApp_awaiter(this,void 0,void 0,(function*(){if(this.state!==this.homeState)try{const e=this.homeTransition;return yield this.goto(e,{contentType:Ue.zc.Document,section:Le.S.Dashboard,collectionViewMode:Ue.Ml.None,entityViewMode:Ue.dS.None,folderId:0,folderName:"",breadcrumbs:new Ye.O},{toFirstPage:(++Fg).toString()})}catch(e){if(e instanceof Fn.Ol)throw e;if("boolean"===typeof e)throw new Fn.Ol("goHome - transition was cancelled");throw e}}))}goPrev(e,t){return baseApp_awaiter(this,void 0,void 0,(function*(){if(!e||!e.breadcrumbs)throw new Error("goPrev - context or breadcrumbs not found");const n=e.breadcrumbs.prev(t);if(!n)throw new Error("goPrev - route not found");{let t;n.params&&n.params.context&&(e=n.params.context),e.breadcrumbs&&(t=e.breadcrumbs,e.breadcrumbs=e.breadcrumbs.itemsBefore(n.path));try{if(n.meta&&n.meta.transition){const i=yield this.goto(n.meta.transition,e,n.params);if(!i||(null===i||void 0===i?void 0:i.type)===Te.uE.Cancel)throw e.breadcrumbs=t,new Fn.Ol("goPrev - transition was cancelled")}else yield this.push(n)}catch(n){if(n instanceof Fn.Ol)throw n;throw e.breadcrumbs=t,new Fn.Ol("goPrev - transition was cancelled",n)}}}))}goLastVisitedUrl(){return baseApp_awaiter(this,void 0,void 0,(function*(){const e=yield this._queryBus.exec(new $e.FD);if(e)return this._router.push(e);this.goHome()}))}cancelQueries(){this._cancellationService.cancel()}replaceURL(e){return this._selfChangeUrl=!0,this._location=e,this._router.replace(e)}setInitState(e){var t;const n=e.meta.transition;if(!n)return this._router.push("404");if(n===Pe.k.ToSettings)return this._router.push("/");const i=null===(t=this.config.sections)||void 0===t?void 0:t.includes("kanban");if(n===Pe.k.ToKanban&&(!i||this.vm.isMobile))return this._router.push("/");n!==Pe.k.Login&&setTimeout((()=>this.forcedTransiton(n)))}showMessage(e,t){Je.X.$emit("app-message",e,t)}_onLeaveState(){this.cancelQueries(),Je.X.$emit("dialog:close:all"),this.onLeaveState()}_onEnterState(e){this._currentState.state=Oe.Z[e.to],this._currentState.from=Oe.Z[e.from],this.onEnterState(e.to)}onAbort(e){if(this._logger.debug("onAbort",e),"boolean"!==typeof e&&"NavigationDuplicated"===(null===e||void 0===e?void 0:e.name))return Je.X.$emit("abort-transition",this._location);throw e}push(e){return baseApp_awaiter(this,void 0,void 0,(function*(){try{return this._selfChangeUrl=!0,this._location=e,yield this._router.push(e)}catch(e){this.onAbort(e)}}))}replace(e){return baseApp_awaiter(this,void 0,void 0,(function*(){try{return this._selfChangeUrl=!0,this._location=e,yield this._router.replace(e)}catch(e){this.onAbort(e)}}))}};Ag=baseApp_decorate([(0,Ee.b2)(),baseApp_param(0,(0,Ee.f3)(je.t.Container)),baseApp_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),baseApp_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),baseApp_param(3,(0,Ee.f3)(je.t.ILogger)),baseApp_param(4,(0,Ee.f3)(Ym.Z)),baseApp_param(5,(0,Ee.f3)(je.t.FsmTransitions)),baseApp_param(6,(0,Ee.f3)(Tl.h)),baseApp_metadata("design:paramtypes",[Ee.W2,Object,Object,Object,Ym.Z,Array,Tl.h])],Ag);var ldApp_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ldApp_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ldApp_param=function(e,t){return function(n,i){t(n,i,e)}},ldApp_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let $g=class LandocsApplication extends Ag{constructor(e,t,n,i,o,s,r,a,l){super(e,t,n,i,o,s,r),this._container=e,this._queryBus=t,this._commandBus=n,this._logger=i,this._router=o,this.transitions=s,this._noticeAndStatisticService=a,this._tourManager=l,this._fastReportPollers=[],this._introjs=null,this._sections=[Oe.Z.None,Oe.Z.Dashboard,Oe.Z.Login,Oe.Z.Messages,Oe.Z.Documents,Oe.Z.Reports,Oe.Z.History,Oe.Z.Favorites,Oe.Z.Archive,Oe.Z.Settings,Oe.Z.Search,Oe.Z.Kanban,Oe.Z.Vocabularies,Oe.Z.NotFound,Oe.Z.DssRedirecting],window.$ldGlobal={ActionResult:Te.uE,EntityStatus:Te.Ao,EntityViewMode:Ue.dS,CollectionViewMode:Ue.Ml,ContentType:Ue.zc}}set intro(e){this._introjs=e,this._tourManager.setHelpEngine(this.intro)}get intro(){return this._introjs}get tourManager(){return this._tourManager}get isAnyMessageState(){return this.fsm.state.toString().endsWith("Message")||this.state===Oe.Z.CreatingReport||this.state===Oe.Z.RepeatingChain||this.state===Oe.Z.RedirectingReportAsInstruction}get isAnyDocState(){return this.fsm.state.toString().endsWith("Doc")}get isAnySettingsState(){return this.state===Oe.Z.Settings}get isAnyFastReportState(){return this.fsm.state.toString().endsWith("FastReport")}get isSectionState(){return this._sections.includes(this.state)}startApp(){return ldApp_awaiter(this,void 0,void 0,(function*(){if(this._userSettings=yield this._queryBus.exec(new $e.n7),this._currentUser=yield this._queryBus.exec(new Ze.by),!this._userSettings||!this._currentUser)return this._logger.fatal("Cannot start application, userSettings or currentUser is undefined");this._logger.info("Application is started"),this.getPublicSettings(),this.startQueries()}))}stopApp(){this.stopQueries()}settingsUpdated(e){this._userSettings=e,this.stopQueries(),this.startQueries()}onLeaveState(){this.closeView()}onEnterState(e){}view(e,t,n,i,o){var s,r,a;if(!e)throw new Error("The $app.view method requires a valid context");let l,c,d=0,u=0;if(e.section===Le.S.Messages&&Array.isArray(e.instructionInfo)&&e.instructionInfo.length?u=null===(r=null===(s=e.instructionInfo[0])||void 0===s?void 0:s.instruction)||void 0===r?void 0:r.id:e.section===Le.S.Documents&&Array.isArray(e.document)&&e.document.length&&(u=null===(a=e.document[0])||void 0===a?void 0:a.id),t===Ue.zc.Instruction?(l=n,l&&(d=l.instruction.id)):t===Ue.zc.Document&&(c=n,c&&(d=c.id)),n||d||(d=i),!d)throw new Error("Не установлен ID для правой панели");const p=Object.assign(Object.assign({},e),{contentType:t,entityViewMode:Ue.dS.View,limitedMode:!0});t===Ue.zc.Instruction?(p.instructionInfo=null,p.document=null,l&&(p.instructionInfo=[l])):t===Ue.zc.Document&&(p.instructionInfo=null,p.document=null,c&&(p.document=[c]));const h={contentType:t,instructionInfo:l,document:c,context:p,forEntityId:u,id:d,callback:o};Je.X.$emit("app-view-open",h)}closeView(e,t){Je.X.$emit("app-view-close",e,t)}createMessage({context:e,type:t,defaultReceivers:n,baseDocument:i}){return e=Object.assign(Object.assign({},e),{entityViewMode:Ue.dS.Create}),this.goto(Pe.k.CreateMessage,e,{type:t,defaultReceivers:n,baseDocument:i,context:e})}createDocument({journalId:e,context:t,params:n}){var i;return ldApp_awaiter(this,void 0,void 0,(function*(){try{if(!e&&(e=yield this.DocumentJournalSelectModal(),!e))return null;const o=yield this._queryBus.exec(new He.u9),s=o.find((t=>t.id===e));if(!e)return yield this._queryBus.exec(new gn.m("Ошибка",this.vm.$gettext("Не найдены данные этого журнала"))),null;const r=yield this._queryBus.exec(new tt.R0(String(s.cardId),"cards")),a=yield this._queryBus.exec(new tt.R0("default","cards")),l=(null===a||void 0===a?void 0:a.create)?null===a||void 0===a?void 0:a.create:null===r||void 0===r?void 0:r.create;if(!r||!l)return yield this._queryBus.exec(new gn.m("Внимание!",this.vm.$gettext("Для этого журнала нет возможности создавать документы"))),null;const c=yield this._queryBus.exec(new He.Ml(Number(e)));if(Array.isArray(c)&&!c.includes(du.K.RegisterDocument))return yield this._queryBus.exec(new gn.m("Ошибка",this.vm.$gettext("Недостаточно прав для создания документа в этом журнале"))),null;t=Object.assign(Object.assign({},t),{entityViewMode:Ue.dS.Create,folderId:e,folderName:s.name});const d=t.breadcrumbs.last();return(null===(i=d.route)||void 0===i?void 0:i.path.includes(Le.S.Documents))||t.breadcrumbs.add({text:s.name,route:{path:`/${Le.S.Documents}/${e}`}}),this.goto(Pe.k.CreateDoc,t,{journalId:String(e),context:t,newDocDefaultData:n?n.newDocDefaultData:null})}catch(e){this._logger.error(e)}}))}createKanbanBoard({modalTitle:e}){return ldApp_awaiter(this,void 0,void 0,(function*(){const t=new Mc.c({title:e,componentName:"kanban-add-board",componentProps:{model:null,boardName:"",columns:null},fullHeight:!1,width:"40%"}),n=yield this._queryBus.exec(t);if(!n)return;const i=new wi.H(n);this._commandBus.exec(i)}))}viewMessage(e,t){return t=Object.assign(Object.assign({},t),{entityViewMode:Ue.dS.View}),this.goto(Pe.k.ViewMessage,t,{id:String(e),context:t})}replaceMessage(e,t){return t=Object.assign(Object.assign({},t),{entityViewMode:Ue.dS.Edit}),this.goto(Pe.k.Replace,t,{id:String(e),context:t})}viewDoc(e,t,n=!1){return t=Object.assign(Object.assign({},t),{entityViewMode:Ue.dS.View}),this.goto(Pe.k.ViewDoc,t,{id:String(e),context:t,blank:n})}editDoc(e,t,n=!1){return t=Object.assign(Object.assign({},t),{entityViewMode:Ue.dS.Edit}),this.goto(Pe.k.EditDoc,t,{id:String(e),context:t,replace:n})}editInstruction(e,t){return t=Object.assign(Object.assign({},t),{entityViewMode:Ue.dS.Edit}),this.goto(Pe.k.Edit,t,{id:String(e),context:t})}redirectInstruction(e,t,n){return t=Object.assign(Object.assign({},t),{entityViewMode:Ue.dS.Create}),t.data=n,this.goto(Pe.k.RedirectInstruction,t,{id:String(e),type:String(n),context:t})}createCatalogueItem({context:e,name:t,title:n,parent:i}){return this.openCreateEditDialog(null,t,n,et.$.Create,e,i)}editCatalogueItem({item:e,context:t,name:n,title:i,parent:o}){return this.openCreateEditDialog(e,n,i,et.$.Create,t,o)}addFastReportPoller(e){return this._fastReportPollers.push(e),this._fastReportPollers.length-1}removeFastReportPoller(e){if(this._fastReportPollers[e])return this._fastReportPollers.splice(e,1),!0;throw new Error("Не существует опросника с таки индексом")}runFastReportPoller(e){this._fastReportPollers[e]()}openCreateEditDialog(e,t,n,i,o,s){return ldApp_awaiter(this,void 0,void 0,(function*(){const r=yield this._queryBus.exec(new He.XS(t));if(r){const e=[];r.oneToManyChildren.forEach((t=>{e.push(this._queryBus.exec(new He.XS(t.className)))}));const t=yield Promise.all(e);r.metadatas={},r.oneToManyChildren.forEach(((e,n)=>{r.metadatas[e.className]=t[n]}))}const a={model:e,item:e,parent:s,context:o,vocabularyName:t,templateType:i,isModal:!0,metadata:r},l=new Mc.c({title:n,componentName:"catalogue-template-renderer",componentProps:a,fullHeight:!1,width:"80%",closable:!0}),c=yield this._queryBus.exec(l);return this._logger.debug(c),c}))}DocumentJournalSelectModal(){const e=new SelectDocumentJournalsQuery(null);return this._queryBus.exec(e)}getPublicSettings(){return ldApp_awaiter(this,void 0,void 0,(function*(){try{const e=new $e.u1(!0),t=yield this._queryBus.exec(e);this._logger.debug("fetch public settings",t)}catch(e){this._logger.error(e)}}))}startQueries(){var e;if(this._userSettings.checkSessionUserMode&&this._userSettings.timeoutCheckUserSession){const e=6e4*this._userSettings.timeoutCheckUserSession;this.pingInterval=window.setInterval((()=>this.ping()),e)}const t=(null===(e=this._userSettings)||void 0===e?void 0:e.folderStatisticUpdateSecondsInterval)?60*this._userSettings.folderStatisticUpdateSecondsInterval*1e3:0;this._noticeAndStatisticService.start(t)}stopQueries(){window.clearInterval(this._publicSetttingsId),window.clearInterval(this.pingInterval),this._noticeAndStatisticService.stop()}ping(){this._queryBus.exec(new zo.SE)}};$g=ldApp_decorate([(0,Ee.b2)(),ldApp_param(0,(0,Ee.f3)(je.t.Container)),ldApp_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),ldApp_param(2,(0,Ee.f3)(Ve.O.ICommandBus)),ldApp_param(3,(0,Ee.f3)(je.t.ILogger)),ldApp_param(4,(0,Ee.f3)(Ym.Z)),ldApp_param(5,(0,Ee.f3)(je.t.FsmTransitions)),ldApp_param(6,(0,Ee.f3)(Tl.h)),ldApp_param(7,(0,Ee.f3)(Me)),ldApp_param(8,(0,Ee.f3)(je.t.ITourManager)),ldApp_metadata("design:paramtypes",[Ee.W2,Object,Object,Object,Ym.Z,Array,Tl.h,Me,Object])],$g);(0,Og.o)(Pe.k.Login),(0,Og.o)(Oe.Z.Login),(0,Og.o)(Pe.k.ToHome),(0,Og.o)(Oe.Z.Vocabularies),(0,Og.o)(Pe.k.ToVocabularies),(0,Og.o)(Oe.Z.Vocabularies),(0,Og.o)(Pe.k.ToSettings),(0,Og.o)(Oe.Z.Settings),(0,Og.o)(Pe.k.ToNotFound),(0,Og.o)(Oe.Z.NotFound),(0,Og.o)(Pe.k.ViewVocabulary),(0,Og.o)(Oe.Z.ViewingVocabulary);var jg;(function(e){e[e["Manual"]=0]="Manual",e[e["Click"]=1]="Click",e[e["Value"]=2]="Value",e[e["Modal"]=3]="Modal"})(jg||(jg={}));const Eg={title:"Превью, поиск и папки",url:"messages/1999",allowPrevStep:!0,allowNextInAutoStep:!0,isReady(){return window.location.pathname.endsWith(this.url)},steps:[{title:"Это папки с соообщениями, они настроены под пользователя",nextStepAfter:jg.Manual,elementId:"appFolderTree",position:"right"},{title:"Это папка с входящими сообщениями. Она может иметь любое количество вложенных папок",nextStepAfter:jg.Manual,elementId:"[-1]",getElement(e,t,n){const i=document.querySelectorAll('[data-test-id="treeNode"]');if(!i||!i.length)return null;let o=null;for(let e=0;e<i.length;e++){const t=i[e];if("1999"===t.id){o=t;break}}return o}},{title:"Чтобы включить режим превью сообщения, нажмите на кнопку с глазом",nextStepAfter:jg.Click,elementId:"wshPreviewOn"},{title:"Содержимое сообщения - в этой панели",nextStepAfter:jg.Manual,elementId:"wsSidePanel"},{title:"Теперь выключите режим превью - нажмите на кнопку c зачеркнутым глазом",nextStepAfter:jg.Click,elementId:"wshPreviewOff"},{title:"Это строка поиска. Наберите поисковый запрос",nextStepAfter:jg.Value,elementId:"wshSearchField"},{title:'Это результаты поиска. Нажмите "Закончить", чтобы выйти из сценария',nextStepAfter:jg.Modal,elementId:"wsListPanel"}]};var tourManager_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},tourManager_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},tourManager_param=function(e,t){return function(n,i){t(n,i,e)}},tourManager_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const Mg="modal-cancel",Ng=500,Vg=10;let Bg=class TourManager{constructor(e,t,n){this._logger=e,this._queryBus=t,this._router=n,this._currentStepIndex=-1,this._intro=null,this._introInstance=null,this.$gettext=e=>e,this._canTourExit=!1,this._selfCloseHelp=!1,this.onClickHandler=this.onStepCompleted.bind(this),this.onValueChangedHandler=(0,Pl.Z)(this.onStepValueChanged.bind(this),1e3,{maxWait:2e3}),this.onModalCloseHandler=this.onModalClosed.bind(this)}setHelpEngine(e){this._intro=e}setTranslateFunc(e){this.$gettext=e}start(){return tourManager_awaiter(this,void 0,void 0,(function*(){const e=[Eg];if(this._currentScenario=yield this.selectScenarioModal(e),!this._currentScenario)return void this._logger.info("Не выбран сценарий");this._currentScenario.steps.forEach((e=>{e.element=null,e.subElementId&&(e.subElement=null)}));let t=null;const n=0;this._currentScenario.url?this._currentScenario.url.startsWith("/")||(this._currentScenario.url=`/${this._currentScenario.url}`):this._currentScenario.url="/",window.location.pathname.endsWith(this._currentScenario.url)||this._router.push(this._currentScenario.url);try{yield this.waitForUrl(this._currentScenario.url)}catch(e){throw this._logger.error("Сценарий не готов к запуску",e),yield this._queryBus.exec(new gn.m("Ошибка",`Сценарий "${this._currentScenario.title}" не готов к запуску`)),e}const i=this._currentScenario.steps[0];if(i.element=this.findElement(i),i.element&&(t=i),!t)return this._logger.error(`Для сценария "${this._currentScenario.title}" нет шагов на этой странице`),void(yield this._queryBus.exec(new gn.m("Ошибка",`Для сценария "${this._currentScenario.title}" нет шагов на этой странице`)));this._logger.info(`Сценарий "${this._currentScenario.title}" стартовал`),this._currentSteps=this._currentScenario.steps.slice(n,this._currentScenario.steps.length),this._currentStepIndex=-1,this._direction="forward",this.startIntro(this._currentSteps),this.toggleButtons({hideNext:!t.allowNextManual,hidePrev:!t.allowPrev})}))}getOptions(){return{nextLabel:this.$gettext("След.шаг"),prevLabel:this.$gettext("Назад"),skipLabel:this.$gettext("Закончить"),doneLabel:this.$gettext("Закончить"),hidePrev:!1,hideNext:!1,exitOnOverlayClick:!0,exitOnEsc:!0,disableInteraction:!1,showProgress:!1,showStepNumbers:!1,showBullets:!1,scrollToElement:!1,overlayOpacity:.3}}updateOptions(e){if(!this._introInstance)return;const t=Object.assign(Object.assign({},this.getOptions()),e);this._introInstance.setOptions(t)}startIntro(e,t){const n=this._intro();this._introInstance=n,this.updateOptions(),n.onnextbutton(this.manualGoNextStep.bind(this)),n.onprevbutton(this.manualGoPrevStep.bind(this)),n.onbeforechange(this.onBeforeStepChanged.bind(this)),n.onchange(this.onStepChanged.bind(this)),n.onbeforeexit(this.onBeforeIntroExit.bind(this)),n.onexit(this.onTourExit.bind(this)),n.removeHints(),n._currentStep=-1;for(const t of e){let e=t.title;"function"===typeof t.title&&(e=t.title.call(t,this._currentScenario)),n.addStep({element:t.element,intro:e,position:t.position})}n.start(),t&&n.goToStep(t+1)}onBeforeIntroExit(){return this._selfCloseHelp?(this._selfCloseHelp=!1,this._canTourExit=!1,!0):(this._canTourExit=this.checkBeforeIntroExit(),this._canTourExit)}checkBeforeIntroExit(){return confirm("Завершить сценарий?")}onTourExit(){this._canTourExit&&this.finishTour()}finishTour(){this.offEvents()}offEvents(){Je.X.$off("modal-ok",this.onModalCloseHandler),Je.X.$off(Mg,this.onModalCloseHandler),this._element&&(this._element.removeEventListener("click",this.onClickHandler),this._element.removeEventListener("input",this.onValueChangedHandler),this._element=null)}onBeforeStepChanged(e){if(!this._currentScenario)return;const t="backward"===this._direction?-1:1,n=this._currentSteps[this._currentStepIndex+t];return n?n.element||(n.element=this.findElement(n),n.element)?void this.updateStep(n):(this.closeHelp(),!1):void 0}onStepChanged(e){if(!this._currentScenario)return;clearInterval(this._intervalId),this.offEvents();const t="backward"===this._direction?-1:1;this._currentStepIndex=this._currentStepIndex+t;const n=this._currentSteps[this._currentStepIndex];if(!n)return;this.checkStep(n,e),n.canChanged&&(this._intervalId=setInterval((()=>{this.checkStep(n,e),this.updateStep(n,!0)}),100));const i=this.getAllowManualNextStep(n),o=this.getAllowManualPrevStep(n);setTimeout((()=>this.toggleButtons({hideNext:!i,hidePrev:!o})),100)}getAllowManualPrevStep(e){let t=!0;return"allowPrev"in e?t=e.allowPrev:this._currentScenario.allowPrevStep||(t=!1),t}getAllowManualNextStep(e){let t=!1;return"allowNextManual"in e?t=e.allowNextManual:(e.__nextStepAfter===jg.Manual||this._currentScenario.allowNextInAutoStep)&&(t=!0),t}checkStep(e,t){this.offEvents();let n=e.nextStepAfter;"function"===typeof e.nextStepAfter&&(n=e.nextStepAfter.call(e,this._currentScenario)),e.__nextStepAfter=n,n===jg.Click?(e.subElementId&&(e.subElement=document.getElementById(e.subElementId),e.subElement&&(t=e.subElement)),this._element=t,t.addEventListener("click",this.onClickHandler)):n===jg.Value?(this._element=t,t.addEventListener("input",this.onValueChangedHandler)):n===jg.Modal&&(this._element=t,t.addEventListener("click",this.onClickHandler),Je.X.$on("modal-ok",this.onModalCloseHandler),Je.X.$on(Mg,this.onModalCloseHandler))}onStepValueChanged(e){e.target===this._element&&(this._element.removeEventListener("input",this.onValueChangedHandler),this._element=null,this.autoGoNextStep())}onStepCompleted(){this._element.removeEventListener("click",this.onClickHandler),this._element=null;const e=this._currentSteps[this._currentStepIndex];if(e){const t=e.__nextStepAfter;t===jg.Click?this.autoGoNextStep():t===jg.Modal&&this.hideStep(!0)}}onModalClosed(){Je.X.$off("modal-ok",this.onModalCloseHandler),Je.X.$off(Mg,this.onModalCloseHandler),this.autoGoNextStep()}findSuitableStep(e=!0){const t="backward"===this._direction?-1:1;let n=this._currentSteps[this._currentStepIndex+t],i=!1;while(n){const o=!n.isEnable||n.isEnable(this._currentSteps,this._currentStepIndex+t),s=!e||this.findElement(n);if(o&&s)break;this._currentStepIndex=this._currentStepIndex+t,n=this._currentSteps[this._currentStepIndex+t],i=!0}return{step:n,isSkipped:i}}manualGoPrevStep(){if(!this._introInstance)return!1;const e=this._currentSteps[this._currentStepIndex];if(e&&!this.getAllowManualPrevStep(e))return!1;this._direction="backward";const{step:t,isSkipped:n}=this.findSuitableStep();return t?(n&&this._introInstance.goToStep(this._currentStepIndex),!n):(this._logger.info("Не нашлось подходящего шага для движения назад"),this.closeHelp())}manualGoNextStep(){if(!this._introInstance)return!1;const e=this._currentSteps[this._currentStepIndex],t=this.getAllowManualNextStep(e);if(e&&!t)return!1;this._direction="forward";const{step:n,isSkipped:i}=this.findSuitableStep();return n?(i&&this._introInstance.goToStep(this._currentStepIndex+2),this.showStep(),!i):(this._logger.info("Не нашлось подходящего шага для движения вперёд"),this.closeHelp())}autoGoNextStep(){return tourManager_awaiter(this,void 0,void 0,(function*(){if(!this._introInstance)return;this._direction="forward";let{step:e}=this.findSuitableStep(!1);if(!e)return this.closeHelp();this.hideStep(!1);try{yield this.waitForElementAppear(e)}catch(t){this._logger.error(t);const{step:n}=this.findSuitableStep();if(!n)return this.closeHelp();e=n}this.updateStep(e),this._introInstance.goToStep(this._currentStepIndex+2),this.showStep()}))}toggleButtons({hideNext:e,hidePrev:t}){let n=document.getElementsByClassName("introjs-prevbutton"),i="add";n.length&&(i=t?"add":"remove",n[0].classList[i]("hidden")),n=document.getElementsByClassName("introjs-nextbutton"),n.length&&(i=e?"add":"remove",n[0].classList[i]("hidden"))}updateStep(e,t=!1){const n="backward"===this._direction?-1:1,i=this._introInstance._introItems[this._currentStepIndex+n];if(i){if(i.position=e.position,i.element=e.element,"function"===typeof e.title&&(i.intro=e.title.call(e,this._currentScenario)),t){const e=document.querySelector(".introjs-tooltiptext");e&&(e.innerHTML=i.intro)}"floating"===i.position&&(i.position="")}}hideStep(e){let t=document.getElementsByClassName("introjs-tooltipReferenceLayer");t.length&&t[0].classList.add("hidden"),t=document.getElementsByClassName("introjs-helperLayer"),t.length&&t[0].classList.add("hidden"),t=document.getElementsByClassName("introjs-showElement"),t.length&&t[0].classList.remove("introjs-showElement"),e&&(t=document.getElementsByClassName("introjs-overlay"),t.length&&t[0].classList.add("hidden"))}showStep(){let e=document.getElementsByClassName("introjs-tooltipReferenceLayer");e.length&&e[0].classList.remove("hidden"),e=document.getElementsByClassName("introjs-helperLayer"),e.length&&e[0].classList.remove("hidden"),e=document.getElementsByClassName("introjs-overlay"),e.length&&e[0].classList.remove("hidden")}closeHelp(){this._selfCloseHelp=!0,this._introInstance?this._introInstance.exit():this._intro().exit()}findElement(e){const t=this._currentSteps?this._currentSteps.findIndex((t=>t===e)):-1,{parent:n,elementId:i}=this.getParentElement(e.elementId,t);if(e.getElement)return e.getElement.call(e,this._currentScenario,n,i);let o;return o=n?n.querySelector(`#${i}`):document.getElementById(i),o&&0===o.offsetWidth?null:o}getParentElement(e,t){if(!this._currentSteps)return{parent:null,elementId:e};const n=/\[-*\d+]/g,i=e.match(n),o={parent:null,elementId:e};if(i&&i.length){const s=parseInt(i[0].substr(1,i[0].length-2),10),r=this._currentSteps[t+s];r&&(o.parent=r.element),o.elementId=e.replace(n,"")}return o}waitForElementAppear(e){return tourManager_awaiter(this,void 0,void 0,(function*(){if(!e)return Promise.reject();if(e.element)return Promise.resolve();let t=null,n=null;const i=new Promise(((e,i)=>{t=e,n=i}));let o=0;const findElement=()=>{setTimeout((()=>{if(o++,o>Vg&&n(),e.element||(e.element=this.findElement(e)),e.element)return t();findElement()}),Ng)};return findElement(),i}))}selectScenarioModal(e){return tourManager_awaiter(this,void 0,void 0,(function*(){if(!e||!e.length)return null;const t={disabledItems:[],selectedItems:[],lists:[{isTree:!1,items:e}],multiselect:!1},n=new ze.F({title:"Выберите сценарий",componentName:"select-items",componentProps:t,selectAsOk:!0}),i=yield this._queryBus.exec(n);return i&&i.length?i[0]:null}))}waitForUrl(e){return tourManager_awaiter(this,void 0,void 0,(function*(){let t=null,n=null;const i=new Promise(((e,i)=>{t=e,n=i}));let o=0,s="";const checkUrl=()=>{setTimeout((()=>{if(o++,o>Vg&&n(s||`Превышен таймаут ожидания перехода на URL ${e}`),window.location.pathname.endsWith(e)){let n=!0;if(this._currentScenario.isReady&&(n=this._currentScenario.isReady()),n)return t("OK");s=`Для сценария нет данных на странице ${e}`}checkUrl()}),Ng)};return checkUrl(),i}))}};Bg=tourManager_decorate([(0,Ee.b2)(),tourManager_param(0,(0,Ee.f3)(je.t.ILogger)),tourManager_param(1,(0,Ee.f3)(Ae.M.IQueryBus)),tourManager_param(2,(0,Ee.f3)(Ym.Z)),tourManager_metadata("design:paramtypes",[Object,Object,Ym.Z])],Bg);const Lg=[{name:(0,Og.o)(Pe.k.ToNotFound),from:"*",to:(0,Og.o)(Oe.Z.NotFound)},{name:(0,Og.o)(Pe.k.Login),from:"*",to:(0,Og.o)(Oe.Z.Login)},{name:(0,Og.o)(Pe.k.ToDashboard),from:"*",to:(0,Og.o)(Oe.Z.Dashboard)},{name:(0,Og.o)(Pe.k.ToMessages),from:"*",to:(0,Og.o)(Oe.Z.Messages)},{name:(0,Og.o)(Pe.k.ToDocuments),from:"*",to:(0,Og.o)(Oe.Z.Documents)},{name:(0,Og.o)(Pe.k.ToReports),from:"*",to:(0,Og.o)(Oe.Z.Reports)},{name:(0,Og.o)(Pe.k.ToFavorites),from:"*",to:(0,Og.o)(Oe.Z.Favorites)},{name:(0,Og.o)(Pe.k.ToHistory),from:"*",to:(0,Og.o)(Oe.Z.History)},{name:(0,Og.o)(Pe.k.ToArchive),from:"*",to:(0,Og.o)(Oe.Z.Archive)},{name:(0,Og.o)(Pe.k.ToSettings),from:"*",to:(0,Og.o)(Oe.Z.Settings)},{name:(0,Og.o)(Pe.k.ToSearch),from:"*",to:(0,Og.o)(Oe.Z.Search)},{name:(0,Og.o)(Pe.k.ToKanban),from:"*",to:(0,Og.o)(Oe.Z.Kanban)},{name:(0,Og.o)(Pe.k.ToVocabularies),from:"*",to:(0,Og.o)(Oe.Z.Vocabularies)},{name:(0,Og.o)(Pe.k.ToDssRedirect),from:"*",to:(0,Og.o)(Oe.Z.DssRedirecting)},{name:(0,Og.o)(Pe.k.CreateMessage),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.RedirectInstruction),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.CreateReport),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.EditReport),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.ViewMessage),from:"*",to:(0,Og.o)(Oe.Z.ViewingMessage)},{name:(0,Og.o)(Pe.k.Edit),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.Replace),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.RepeatInstruction),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.RepeatChain),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.RedirectReportAsInstruction),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.RedirectReportAsReport),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.CreateFastReport),from:"*",to:(0,Og.o)(Oe.Z.CreatingFastReport)},{name:(0,Og.o)(Pe.k.ViewFastReport),from:"*",to:(0,Og.o)(Oe.Z.ViewingFastReport)},{name:(0,Og.o)(Pe.k.CreateDoc),from:"*",to:(0,Og.o)(Oe.Z.CreatingDoc)},{name:(0,Og.o)(Pe.k.ViewDoc),from:"*",to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.EditDoc),from:"*",to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.ToMvp),from:"*",to:(0,Og.o)(Oe.Z.Mvp)},{name:(0,Og.o)(Pe.k.SendReport),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.SendRejectionReport),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.AcceptReport),from:"*",to:(0,Og.o)(Oe.Z.LaterDefine)},{name:(0,Og.o)(Pe.k.RemoveMessage),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.MoveToFolder),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.ToWork),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.Revoke),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.Archive),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.Restore),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.SetMessageReaded),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.SetMessageUnreaded),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.Link),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.ToArchiveMessages),from:(0,Og.o)(Oe.Z.ViewingMessage),to:(0,Og.o)(Oe.Z.Archive)},{name:(0,Og.o)(Pe.k.AddToFavourite),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.CreateShortcut),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.RemoveShortcut),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.SetDocReaded),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.SetDocUnreaded),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.DeleteDoc),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.SendMessage),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.CardCustomAction),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.ArchiveDoc),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.ViewDocumentData),from:"*",to:"*"},{name:(0,Og.o)(Pe.k.AddToFavourite),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.CreateShortcut),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.RemoveShortcut),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.SetDocReaded),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.SetDocUnreaded),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.DeleteDoc),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.CardCustomAction),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.ArchiveDoc),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.ViewDocumentData),from:(0,Og.o)(Oe.Z.ViewingDoc),to:(0,Og.o)(Oe.Z.ViewingDoc)},{name:(0,Og.o)(Pe.k.AddToFavourite),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.CreateShortcut),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.RemoveShortcut),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.SetDocReaded),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.SetDocUnreaded),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.DeleteDoc),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.CardCustomAction),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.ArchiveDoc),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.ViewDocumentData),from:(0,Og.o)(Oe.Z.EditingDoc),to:(0,Og.o)(Oe.Z.EditingDoc)},{name:(0,Og.o)(Pe.k.DownloadResult),from:(0,Og.o)(Oe.Z.Reports),to:(0,Og.o)(Oe.Z.Reports)},{name:(0,Og.o)(Pe.k.RepeatReport),from:(0,Og.o)(Oe.Z.Reports),to:(0,Og.o)(Oe.Z.Reports)},{name:(0,Og.o)(Pe.k.RepeatReport),from:(0,Og.o)(Oe.Z.Reports),to:(0,Og.o)(Oe.Z.CreatingFastReport)},{name:(0,Og.o)(Pe.k.DownloadResult),from:(0,Og.o)(Oe.Z.ViewingFastReport),to:(0,Og.o)(Oe.Z.ViewingFastReport)},{name:(0,Og.o)(Pe.k.ArchiveDoc),from:(0,Og.o)(Oe.Z.Archive),to:(0,Og.o)(Oe.Z.Archive)}];function configureContainer(e,t){e.bind(Ym.Z).toConstantValue(t),e.load(Uf),e.load(Pg),e.bind(je.t.FsmTransitions).toConstantValue(Lg),e.bind(je.t.Application).to($g).inSingletonScope(),e.bind(Me).toSelf(),e.bind(je.t.AuthService).to(Xe.e),e.bind(Xe.e).toSelf(),e.bind(uc.X).toSelf().inSingletonScope(),e.bind(ke.Z).toSelf().inSingletonScope(),e.bind(Un.c).toSelf().inSingletonScope(),e.bind(Pn.b).toSelf().inSingletonScope(),e.bind(Qf).toSelf(),e.bind(je.t.ITourManager).to(Bg),e.bind(je.t.IDomainEventProvider).to(rf),e.bind(je.t.IOuterEventProvider).to(lf),e.bind(Jc.h).toSelf().inSingletonScope(),e.bind(je.t.IOpenForm).to(qt.r).inSingletonScope()}const Ug=JSON.parse('{"en":{"%{description}: кэш успешно сброшен":"%{description}: cache is successfully flushed","Cоздан:":"Created:","Cообщение заменено.":"Massage replaced","OK":"OK","Автор":"Author","Автор:":"Author:","Активно":"Active","Архив":"Archive","Безналичный;":"Cashless;","Будет сброшен весь кэш, включая кэш всех пользователей и кэш системных настроек. Продолжить?":"All cache will be flushed, including cahche of all users and system setting. Continue?","В выбранном подразделении отсутствуют сотрудники":"There are no employees in the selected department","В данной папке  %{condition}":" %{condition} on request in the folder","В очереди":"In the queue","В словаре нет данных":"No data is available in the dictionary","ВCЕ ПОДРАЗДЕЛЕНИЯ":"ALL DEPARTMENTS","версий":"versions","Версия":"Version","Версия файла":"File version","Версия:":"Version:","Взять в работу":"Start work on","Вид документа":"Document type","Внимание!":"Attention!","Внутренний документ ДСУД":"Internal document of the Document Management System Department (DSUD)","Войти в систему":"Log in","Войти с учётной записью Windows":"Log in with Windows account","Вперед":"Next","Время окончания:":"Closing time:","Все":"All","всего":"total","Всего":"Total","Вход":"Log on","Входящая":"Incoming","Вы действительно хотите сохранить проект отчета?":"Do you want to save report project?","Вы действительно хотите удалить файл":"Do you want to delete the file","Вы действительно хотите удалить файл ":"Do you want to delete the file ","Вы действительно хотите удалить файл %{file}?":"Do you want to delete the file %{file}?","Вы действительно хотите удалить элемент \\"%{name}\\"???":"Do you want to delete the element \\"%{name}\\"???","Вы действительно хотите удалить элемент \\"%{row}\\"???":"Do you want to delete the element \\"%{row}\\"???","Вы уверены, что хотите отправить сообщение без файлов?":"Do you want to send the message without files?","выберите":"select","Выберите %{s} для просмотра":"Select %{s} to view","Выберите значение из списка":"Select an item from the list","Выберите инициатора":"Select an initiator","Выберите инициатора сообщения":"Select an author of the message","Выберите контролёра":"Select controller","Выберите контролёра сообщения":"Select controller of the message","Выберите папку для просмотра %{content}":"Select folder to see %{content}","Выберите папку для просмотра %{contentName}":"Select folder to see %{contentName}","Выберите получателей":"Select receivers","Выберите получателей сообщения":"Select receivers of the message","Выберите получателя отчета":"Select receiver of the report","Выберите получателя отчёта":"Select receiver of the report","Выберите столбцы":"Select columns","Выбор документа":"Document type","Выбор из справочника «Сотрудники»":"\'Employees\' directory selection","Выборочный сброс кэшей":"Seleсеtive cache flushing","выбрано":"selected","Выбрано":"Selected","Выбрать":"Select","Выбрать инициатора":"Select initiator","Выбрать контролёра":"Select controller","Выбрать ответственного":"Select responsible person","Выбрать получателей":"Select receivers","Выбрать получателя отчёта":"Select receivers of the report","Выбрать фильтр":"Select filter","Выход":"Logout","Гарантия качества работ Подрядчика предусматривается в договоре:":"Quality assurance of the Contractor\'s work is provided in the contract:","Главная":"Home","Главная страница":"Home page","Групп.":"Groups.","Группы рассылки сотрудников":"Employees sending groups","Да":"Yes","Дальше":"Next","Данные об электронной подписи":"Data on digital signature","Данные по согласованию отсутствуют":"No data is available on agreement","Данные по ЭП отсутствуют":"No data is availiable on Digital Signature","Данные сообщения отсутствуют":"There is no message data","Данных нет":"No data","Дата выполнения":"Due date","Дата выполнения:":"Due date:","Дата загрузки":"Date of upload","Дата окончания:":"Closing date:","Дата отправки: %{sendDate}":"Send date: %{sendDate}","Дата подписания":"Date signed","Дата создания":"Creation date","Дата создания:":"Creation date:","ДД.ММ.ГГГГ":"DD.MM.YYYY","Дерево сообщений":"Message Tree","Дерево сообщений отсутствует":"There is no Message Tree","Длительность:":"Duration:","Для %{action} сообщения необходимо выбрать хотя бы одного получателя.":"For message %{action} you must select at least one recipient.","Для выполнения работ Заказчику необходимы разрешения (лицензии):":"Customer needs permissions (licenses) to perform the work:","Для выполнения работ Подрядчику необходимы разрешения (лицензии):":"Contractor needs permissions (licenses) to perform the work:","Для отправки сообщения необходимо выбрать  получателя.":"For sending message you must select recepient","Для отправки сообщения необходимо выбрать корректный срок исполнения.":"For sending message you must select correct term of perfomance.","Добавить в конец списка":"Add to the end of the list","Добавить в начало списка":"Add to the head of the list","Добавить соисполнителя":"Add co-executor","Добавлена версия файла %{fileName}":"Added %{fileName} file version","Добавляемая версия файла должна быть с раширением %{fileExtension}, файлы %{wrongExt}":"The added file version must have the %{file Extension} extension , files %{wrongExt}","Добавляемая версия файла должна быть с раширением %{last}, файлы %{wrongExt}":"The added file version must have the %{last} extension , files %{wrongExt}","Договор":"Contract","Договор заключен в связи с осуществлением предпринимательской деятельности:":"The contract is concluded in connection with the implementation of entrepreneurial activity:","документ":"document","Документ":"Document","Документ №":"Document N.","Документ успешно сохранён":"Document successfully saved","Документ-основание":"Main document","Документ-основание отсутствует":"There is no main document","документов":"documents","Документы":"Documents","Должность":"Position","Должность:":"Position","Домашняя страница":"Home page","Допускаются иные способы;":"Other ways are allowed;","Досрочное выполнение работ Подрядчиком:":"Early execution of works by the Contractor:","Журнал регистрации":"Registration book","Журнал регистрации:":"Registration book:","Журнал регистрации: ":"Registration book:","Заблокировано мной":"Blocked by me","Заблокировано:":"Blocked:","Завершено":"Completed","Завершено с отказом":"Completed with reject","Завершено с ошибкой":"Completed with error","Завершено успешно":"Succeeded","Загрузить новую версию":"Download new version","Загрузить файлы":"Upload files","Загрузка %{content}...":"Loading %{content}...","Загрузка %{contentName}...":"Loading %{contentName}...","Загрузка данных...":"Data loading...","Загрузка истории просмотров...":"Watch history loading...","Загрузка...":"Loading...","Задание выдал":"Task was issued by","Задание выдал:":"Task was issued by:","Задание выдал...":"Task was issued by...","Задание на создание отчета успешно отправлено":"Job for report creation successfully sent","Задание на создание отчёта успешно отправлено":"Job for report creation successfully sent","Закончить":"Finish","Закрыть":"Close","Заменить сообщение":"Replace message","Заменить сообщение:":"Replace message:","Заместитель":"Deputy","замещает":"deputes","Значение удалено":"Meanig removed","Идентификатор журнала регистрации в LanDocs:":"Identifier of the registration book in LanDocs","Идентификатор ключа":"Key identifier","Идентификатор типа документа по умолчанию в LanDocs:":"Default document type identifier in LanDocs:","Идёт поиск...":"Searching...","Идёт поиск...!":"Searching...","Идёт поиск....":"Searching...","из":"of","Избранное":"Favorite","Извините, произошла ошибка при чтении данных. Пожалуйста, обновите страницу.":"Sorry, an error occurred while reading the data. Please refresh the page.","ИЗВИНИТЕ, СТРАНИЦА НЕ НАЙДЕНА":"SORRY, PAGE NOT FOUND","Издатель сертификата":"Certificate Publisher","изменения":"changes","изменить":"change","Изменить":"Edit","Изменить главное сообщение?":"Edit main message?","Изменить ответственного":"Change responsible","или загрузите файлы":"or download files","Имеются задания, для которых срок выполнения меньше текущей даты, продолжить?":"There are tasks that have a due date less than the current date, continue?","Инструкция":"Instruction","Интервал обновления списка сообщений\\\\колокольчика (в секундах)":"Refresh interval of list of messages\\\\bell (in seconds)","Информационные документы департамента":"Information document of the department","Информация о сообщении":"Message infromation","Искать":"Search","Исполнитель":"Executor","Исполнить до: %{date}":"Execute to: %{date}","Использовать DSS":"Use DSS","Использовать функционал задач":"Use tasks functionality","Использовать функционал ЭП":"Use digital signature funtionality","Использовать ЭП, если это возможно":"Use Digital Signature if possible","История":"History","История изменений":"Reversion History","История просмотра отсутствует":"There is no watch history","Исходное сообщение":"Outcoming message","Как в исходном сообщении":"As in outcoming message","Календарных":"Calendar","карточки":"cards","Количество документов и сообщений в истории просмотра":"Number of documents and messages in watch history","Количество сообщений\\\\документов, выводимых на странице в форме списка":"Number of messages\\\\documents displayed on the page in the list-form","Количество сообщений\\\\документов, выводимых на странице в форме таблицы":"Number of messages\\\\documents displayed on the page in the table","Комментарии отсутствуют":"There is no comments","Комментарий":"Comments","Комментарий:":"Comment:","Контролёр:":"Controller:","Контролёр...":"Controller...","Контроллёр:":"Controller:","Контроль":"Control","Контроль:":"Control:","Концепция":"Conception","КП":"KP","Краткое содержание":"Abstract","Кэш системы успешно сброшен":"System cache is successfully flushed","Кэшировать белые списки":"Cache white lists","Лист согласования":"Approval page","Лицензионный ключ не найден или недействителен.":"The license key was not found or is invalid.","Логин":"Login","Максимальное количество сообщений\\\\документов на клиенте":"Maximum number of messages\\\\documents in the client","Место рассмотрения споров:":"Place of jurisdiction:","Метки:":"Marks:","Модули репозитория":"Repository modules","МОЁ ПОДРАЗДЕЛЕНИЕ":"MY DEPARTMENT","На главную":"Go to Home page","На странице:":"On page:","Назад":"Back","Название документа":"Document name","Название этапа":"Step name","Наименование":"Name","найден 1 документ":"found 1 document","Найдено":"Found","Найти":"Search","Наличие НДС по договору:":"availability of the VAT under the contract:","Наличными денежными средствами;":"By cash;","Направлять отчёты ответственному исполнителю":"Send reports to the responsible executor","Настроить столбцы":"Configure columns","Настройки":"Settings","Настройки администратора":"Administrator settings","Настройки администратора сохранены":"Administrator setting saved","Настройки отображения документов":"Document name","Настройки отображения папок сообщений":"Message folders display settings","Настройки пользователя":"User settings","Настройки пользователя сохранены":"User setting saved","Началось скачивание отчёта":"Report downloading has began","Не выбран элемент для редактирования!":"You have not selected an item to edit!","Не выбран элемент для удаления!":"You have not selected an item to remove!","Не задан":"Not defined","Не использовать функционал ЭП":"Don\'t use Digital Signature functionality","Не проверена":"Not verified","Не удалось авторизоваться.":"Failed to login","Не удалось авторизоваться. Время ожидания истекло. Попробуйте еще раз.":"Failed to login. Timeout. Try again.","Не удалось авторизоваться. Попробуйте еще раз!":"Failed to login. Try again!","Не удалось выполнить операцию. Попробуйте позже.":"Failed to perform operation. Try later","Не установлено имя шаблона для внешнего компонента %{folder}":"Template name is not set for external component %{folder}","Недопустимый тип файла":"Invalid file type","Необходим хотя бы один получатель":"At least one receiver is required","Нет":"No","нет ":"no ","нет %{content}":"There are no %{content}","Нет данных":"No data","Нет данных для отображения":"No data to display","Нет документов для отображения":"No documents to display","нет непрочитанных %{content}":"no unread %{content}","нет непрочитанных сообщений":"there are no unread messages","нет сообщений":"no messages","Нет файлов для отображения":"No files to display","Ничего не найдено":"No results found","Новое сообщение:":"New message:","Новости":"News","Новый документ":"New document","Номер версии":"Version number","обновить":"refresh","Обновить список":"Refresh the list","Обновлять настройки отображения":"Common display settings","Обновлять настройки полей сообщений по умолчанию:":"Refresh default message field settings:","Обновлять настройки сортировки сообщений и документов":"Refresh settings to sort messages and documents","Оборудование для выполнения работ предоставляется:":"The equipment for performance of works is provided:","Обработать":"Handle","Общая информация":"Common information","Объект":"Object","Ожидание":"Pending","Ок":"Ok","ОК":"OK","Окончание:":"Termination:","Операция":"Operation","Описание настроек системы":"System setting description","Оплата работ:":"Payment for work:","Определен в приложении к договору (календарном плане);":"Defined in the Annex to the contract (calendar plan);","Определен непосредственно в договоре;":"Defined directly in the contract;","Определяется в соответствии с законодательством;":"Defined in accordance with the law;","Организация":"Organization","Основания расторжения договора:":"Ground for termination of the contract","Основные настройки":"Common settings","от":"from","От: %{creator}":"From: %{creator}","Ответ:":"Response:","Ответный документ":"Response document","Ответственность сторон по договору:":"Contractual lewis","ответственный":"responsible","Ответственный исполнитель":"Responsible executor","Отказать":"Refuse","Отказы":"Refusals","Отключить режим замещения":"Disable substitution","Открыть в новом окне":"Open in new window","Открыть документ":"Open document","Отмена":"Cancel","Отменить":"Cancel","Отображать колокольчик (сообщения старше недели не отображаются)":"Display bell (messages older than a week are not displayed)","Отображение":"Display","Отображение количества непрочитанных сообщений":"Display number of unread meassages","Отправитель":"Sender","Отправитель:":"Sender:","Отправить":"Send","отправки":"sending","Отсутствует главное сообщение":"There is no main message","Отчет":"Report","Отчёт":"Report","Отчёт по сообщению":"Message report","Отчет содержит несохраненные данные. Сохранить проект отчета перед закрытием?":"Report contains unsaved data. Do you want to save the draft report before closing?","Отчет:":"Report:","отчетов":"reports","Отчеты":"Reports","Отчёты":"Reports","Отчеты отв. исполнителю":"Reports to responsible executor","Отчитаться":"Report","ошибка":"error","Ошибка":"Error","Ошибка fetchFolders: %{err}":"Error fetchFolders: %{err}","Ошибка запуска модального окна":"Error loading modal window","Ошибка изменения ответственного":"Change responsible error","Ошибка поиска":"Search error","Ошибка поиска в словаре":"Directory search failed","Ошибка поиска значения в словаре":"Error search for a value in the dictionary","Ошибка получения данных: %{err}":"Error reception data: %{err}","Ошибка получения значений из словаря":"Error reseption of value from the dictionary","Ошибка получения значений словаря":"Error reception of value of the dictionary","Ошибка получения метаданных документа":"Error getting document metadata","Ошибка получения списка фильтров":"Error receiving filter list","Ошибка получения элементов списка":"Error receiving list items","ошибка при добавлении версии файла":"error while adding file versions","ошибка при добавлении версии файла %{fileName}: %{err}":"error while adding file versions %{fileName}: %{err}","Ошибка при сбросе кэша системы: %{err}":"Error while flushing system cache: %{err}","Ошибка при сохранении настроек администратора: ":"Error while saving administrator settings: ","Ошибка при сохранении настроек пользователя: ":"Error while saving user settings: ","Ошибка удаления связи с документом: %{responseErr} %{err}":"Error removing document link: %{response Error} %{err}","Ошибка чтения данных":"Data read error","Ошибка чтения списка %{inst}":"List %{inst} read error","Ошибка: %{e} \\\\nпри удалении значения %{value} словаря %{vocabulary}":"Error: %{e} \\\\nremoving %{deleted[0].id} dictionary %{vocabulary}","Парал-я":"Par-l","Параллельная":"Parallel","Параметры":"Parameters","Пароль":"Password","Перейти к главному сообщению":"Go to main message","Перенаправить":"Redirect","Перенаправить отчет":"Redirect report","Перенаправить отчет как сообщение":"Redirect report as a message","Перенаправить сообщение":"Redirect message","Перенаправление сообщений":"Redirection of messages","перенаправления":"redirections","Перенаправлено":"Redirected","Перенаправлено:":"Redirected:","Перенос сроков выполнения работ, в случае несоблюдения Заказчиком встречных обязательств, производится:":"Transfer of terms of performance of works, in case of non-fulfilment by the Customer of mutual obligations, is made:","Перетащите файлы в это окно или":"Drop files into the window or ","Печать":"Print","Письмо":"Letter","ПМИ":"Test Pattern Method","По возрастанию":"In ascending order","по запросу":"on request","По запросу найдено":"Found ","По такому запросу нет результатов":"No results for the request","По убыванию":"In descending order","Повтор цепочки создан":"Chain repeat created","Повторить задание":"Repeat task","Повторить сообщение":"Repeat message","Повторить сообщение:":"Repeat message:","Повторить цепочку":"Repeat chain","Повторное сообщение отправлено.":"Repeated message sent","Подождите пожалуйста, сейчас вы будете перенаправлены на предыдущую страницу...":"Please wait, you will be reditected to the previous page...","Подождите, идёт загрузка.....":"Please wait while loading....","Подписант":"Signatory","Подписей нет":"No signatures","Подпись верна":"Signature is valid","Подпись не верна":"Signature is invalid","Подразделение:":"Departments","Подразделения":"Departments","Поиск":"Search","Поиск документа":"Search document","Поиск не дал результатов (-:":"Search produced no results (-:","Поиск не дал результатов.":"Search produced no results.","Поиск не дал результатов. Попробуйте изменить запрос.":"Search produced no results. Try to change the request.","Поиск по документам":"Search for documents","Поиск по названию роли":"Search by role name","Поиск по подразделениям":"Search by departments","Поиск по системе":"Search by system","Поиск по спискам рассылки":"Search the mailing list","Поиск по текущей папке":"Search in current folder","Поиск по ФИО или должности":"Search by full name or position","Поиск...":"Searching...","Показать все":"Show all","Показать предыдущие":"Show previous","Получатели":"Receivers","Получатели:":"Receivers:","Получатель":"Receiver","Получатель %{receiver} удалён из списка частых контактов":"Receiver %{receiver} was removed from the list of frequent contacts","Получатель отчета:":"Report receiver:","Получатель отчёта:":"Report receiver:","Получатель отчета...":"Report receiver...","Получатель:":"Receiver:","Поля":"Fields","Поля для сортировки документов":"Documents sorting fields","Поля для сортировки сообщений":"Messages sorting fields","Порядок разрешения споров:":"Dispute settlement procedure","Послед-я":"Con-ve","Последнее использованное значение":"Last used value","Последние":"Last","Последовательная":"Consecutive","Посмотреть ЭП":"See Digital Signature","Постановление":"Regulation","Предупреждение":"Warning","При загрузке файла %{name} произошла ошибка: %{err}":"An error occurred while loading file %{name}: %{err}","При загрузке файла %{name} произошла ошибка: Недопустимый тип файла %{extension}":"An error occurred while loading file %{name}: Invalid file type %{extension}","При запросе данных из словаря %{name} произошла ошибка":"An error occurred while requesting data from the %{name} directory","При отправке задания на создание отчёта произошла ошибка":"An error occured while sending job for report creation","При отправке задания на создание отчёта произошла ошибка %{err}":"An error occurred while sending job for report creation %{err}","При получении информации об ЭП произошла ошибка.":"An error occurred on receiving information of Digital Signature","При создании связи с документом %{err} произошла ошибка":"An error occurred while forming chain with the document %{err}","При удалении пользователя %{receiver} из списка частых контактов произошла ошибка: %{err}":"An error occurred while deleting user %{receiver} from the frequent contacts list: %{err}","При удалении связи с документом %{err} произошла ошибка":"An error occurred while deleting chain with the document %{err}","При удалении элемента списка произошла ошибка":"An error occurred while deleting chain with the document %{err}","При уклонении Заказчика от приемки работ Подрядчик имеет право продать результат работ третьему лицу:":"In case the Customer refuses to accept the work, the Contractor has the right to sell the result of the work to a third party:","При формировании отчёта произошла ошибка":"An error occurred while forming a report","Привлечение субподрядчика по договору осуществляется Подрядчиком:":"Subcontracting under the contract is carried out by the Contractor:","Приемка Заказчиком работ без проверки:":"Customer acceptance of the works without checking:","Приказ":"Order","Приложенные файлы":"Attached files","Применён фильтр:":"Applied filter:","Принять отчет":"Accept report","Проверить <span class=\\"text-lowercase\\">всё</span>":"Validate all","Проверить ЭП":"Validate Digital Signature","Проверка":"Validation","Проверка завершена":"Validation completed","Проверка ЭП":"Digital Signature validation","Произошла непредвиденная ошибка":"Unexpected error occurred","Пропустить":"Skip","Просмотр документа":"View document","Просмотр сообщения":"View message","Просмотр файла":"View file","Протокол":"Minutes","Пустое значение":"Empty","Работа выполняется из материалов:":"The work is performed from materials:","Рабочих":"Working","Развернуть все":"Expand all","Размер":"Size","Разрешать пользователям изменять количество сообщений/документов, выводимых на странице":"Allow users to change the number of messages/documents displayed on the page","Рег. Дата По":"Reg. Date To","Рег. Дата С":"Ger.Date From","рег.Дата":"reg. Date","Рег.Номер":"Reg. Number","Рег.Номер / рег.Дата":"Reg. Number / reg. Date","Регистрационный номер":"Registration number","Редактирование":"Editing","Редактирование этапа номер %{step}":"Editing stage number %{step}","Редактировать документ":"Edit document","Редактировать сообщение":"Edit message","Результат проверки":"Validation result","Результат проверки ЭП":"Digital Signature validation result","результатов":"results","Роли":"Roles","Руководство пользователя":"User\'s Guide","С ответственным":"With responsible","С ответственным исполнителем":"With responsible executive","Сброс всех кэшей, включая настройки пользователей и администратора":"Flush of all cache including user and administrator settings","Сбросить":"Reset","Сбросить всё":"Flush all","Свернуть все":"Collapse all","Связь с документом %{delete} удалена":"Link to the document %{delete} removed","секунд":"seconds","Серийный номер сертификата":"Certificate serial number","Скачать все файлы":"Download all files","Скачать последние версии файлов?":"Download last files versions?","Скрыть все":"Hide all","Скрыть предыдущие":"Hide previous","Снять с редактирования":"Remove from editing","Снять файл %{file} с редактирования?":"Do you want to remove %{file} from editing?","Создана связь с документом %{sheave}":"Link to the document %{sheave} created","Создание сообщений":"Create messages","Создание этапа номер %{step}":"Creating stage number %{step}","создания":"creation","Создатель":"Creator","создать":"create","Создать":"New","Создать документ":"Create a document","Создать отчёт":"Creator","Создать сообщение":"Create a message","сообщение":"message","Сообщение":"Message","Сообщение сохранено.":"Message saved","Сообщение\\\\документ считается прочтённым через":"The message\\\\document is read through","сообщений":"messages","сообщения":"message","Сообщения":"Messages","Сопроводительное письмо":"Transmittal","Сортировка":"Sorting","Состояние":"Status","Сотрудник":"Employee","Сотрудники":"Employees","Сохранить":"Save","Сохранить проект":"Save project","Спецификация":"Specification","Списки рассылки":"Mailout lists","список":"list","Способ выполнения работ:":"Way of performing works:","Способ расчетов по договору:":"Method of payment under the contract:","Способы направления претензионных писем:":"Methods of sending claim letters:","Справочники":"Directories","Среди приложенных файлов есть файлы с недопустимыми типами.":"There are files with invalid types among attached files.","Срок исполнения":"Date of perfomance","Срок исполнения:":"Date of perfomance:","Срок по умолчанию":"Default term","Сроки выполнения работ:":"Terms of work:","Статус ЭП":"Digital Signature status","Статус:":"Status:","Стоимость работ:":"Cost of works:","Существуют более актуальные версии файла. Скачать последнюю версию?":"There are more recent file versions. Download the last version?","Существуют более актуальные версии файлов:<br>":"There are more recent files versions: ","Существуют более актуальные версии. Для просмотра актуальной версии перейдите к документу":"There are more recent versions. To view the recent version, go to the document ","Сформировать отчёт":"Create report","таблица":"table","Таймаут проверки сессии пользователя (в минутах)":"User session check timeout (in minutes)","Текст сообщения":"Message text","Текст сообщения отсутствует":"There is no message text","Текст сообщения:":"Message text:","Текущая дата":"Current date","Текущий пользователь":"Current user","Тема":"Subject","Тема сообщения":"Subject","Тема сообщения:":"Subject:","Тема:":"Subject:","ТЗ":"TR","Тип документа:":"Document type:","Тип рассылки:":"Mailout type:","Тип сообщения":"Message type","Тип сообщения:":"Message type:","Тип файла":"File type","Только входящие":"Incoming only","Только для новых пользователей":"New users only","Только заказным почтовым отправлением;":"Only by registered mail;","Только непрочитанные":"Unread only","Только последнии версии":"Last versions only","Требовать ЭП":"Demand Digital Signature","Требуется настроить поля по умолчанию для создания документов.":"You must configure the default fields for creating documents.","удалить":"delete","Удалить":"Delete","Удалить файл":"Delete file","Указ":"Edict","Указано в договоре;":"Defined in the contract","Учётная запись Windows":"Windows account","Файл":"File","Файл %{name} добавлен к документу":"File %{name} added to the document","Файлы":"Files","Файлы документа отсутствуют":"There are no document files","Федеральный закон":"Federal Law","Фильтр":"Filter","Фильтр не выбран":"No filter selected","ФИО:":"Full name:","Функция onAddUser() в качестве параметра может принимать только значения: initiator / auditor / reportReceiver":"The on Add User() function can only take values as a parameter: initiator / auditor / reportReceiver","Частые контакты:":"Frequent contacts:","Чтобы проверить ЭП, кликните по строке таблицы":"Click on table row to verify Digital Signature","Чтобы сохранить приложенные файлы требуется настроить журнал и тип документа по умолчанию.":"To save the attached files, you must configure the default log and document type.","ЧЧ:ММ":"HH:MM","Элемент справочника успешно сохранён":"The element of the dictionary was saved successfully","элемента":"item","элементов":"items","элементов справочника":"items of the directories","Я ответственный исполнитель":"I am a responsible executor","Я соисполнитель":"I am a co-executor"}}'),Hg={ru:{}},Qg={en:Ug.en,ru:Hg.ru},zg=Qg,Zg={install(e){e.mixin({methods:{formatDateToString(e){return Ln.C.dateToString(e,"date")}}})}};var Wg=n(15137),qg=n(98492),Gg=n(22192),Kg=n.n(Gg),Yg=n(56760),Jg=n(9665),Xg=n.n(Jg),ey=n(10101),ty=n.n(ey);function registerPlugins(e){var t;o().use(qg.ZP),(null===(t=null===e||void 0===e?void 0:e.microsoftCloud)||void 0===t?void 0:t.enable)&&n.e(6957).then(n.t.bind(n,66957,23)).then((e=>(o().use(e,{auth:{clientId:"38549c4a-f06d-4fdb-ba60-76392611c240",redirectUri:"http://localhost:3000/"}}),e))).catch((e=>e)),o().use(Xg(),{position:"bottom-right",duration:5e3,action:{icon:"close",onClick:(e,t)=>{t.goAway(0)}}}),o().use(Yg.Z),o().use(tf);const i={name:"_blank",specs:["fullscreen=yes","titlebar=yes","scrollbars=yes"],styles:[]};o().use(Wg.Z,i),o().use(Zg);const s={isEnabled:!0,logLevel:"error",stringifyArguments:!1,showLogLevel:!0,showMethodName:!0,separator:"|",showConsoleColors:!0};o().use(ty(),s),o().use(Kg(),{availableLanguages:{en:"English",ru:"Русский"},autoAddKeyAttributes:!0,defaultLanguage:e&&e.defLang?e.defLang:"ru",translations:zg,silent:e&&"ru"===e.defLang,languageVmMixin:{computed:{currentKebabCase(){return this.current.toLowerCase().replace("_","-")}}}})}function fio(e){const t=e.split(" ");if(t.length>=3){const e=t[t.length-1],n=t[t.length-2];return t.length-=2,`${t.join(" ")} ${n[0]}.${e[0]}.`}return e}function pluralizeNounFilter(e,t,n,i){return(0,Wf.o)(e,t,n,i)}function cutTextLength(e,t=100){if(e){const n=[];return e.length>t?(e.split(" ").reduce(((e,i)=>(e+i.length<t&&n.push(i),e+i.length)),0),`${n.join(" ")}...`):e}return""}function registerFilters(){o().filter("date",Ws.v),o().filter("length",cutTextLength),o().filter("pluralizeNoun",pluralizeNounFilter),o().filter("formatSize",Qu.BU),o().filter("fio",fio)}const ny=rt.Vue.directive("hover",{bind(e,t,n){var i,o;const s=null===(o=null===(i=n.context)||void 0===i?void 0:i.$options)||void 0===o?void 0:o.name;if("object"!==typeof t.value){let e=`[v-hover]: provided expression '${t.expression}' is not an object, but it needs to be.`;s&&(e+=`\nFound in component '${s}'`),this.$log.warn(e)}if(!t.value.over&&!t.value.leave){let e="[v-hover]: object provided does not have 'over' or 'leave' properties. Needs at least one to be of use";s&&(e+=`\nFound in component '${s}'`),this.$log.warn(e)}e.__vHoverOver__=t.value.over||(()=>{}),e.__vHoverLeave__=t.value.leave||(()=>{}),e.addEventListener("mouseenter",e.__vHoverOver__),e.addEventListener("mouseleave",e.__vHoverLeave__)},unbind(e){e.removeEventListener("mouseenter",e.__vHoverOver__),e.removeEventListener("mouseleave",e.__vHoverLeave__),delete e.__vHoverOver__,delete e.__vHoverLeave__}}),iy={mobileParentId:null,tabletParentId:null,desktopParentId:null,el:null,component:null,moved:!1};let oy;function resizeThrottler(){oy||(oy=setTimeout((()=>{oy=null,moveComponent(iy)}),200))}function moveComponent(e){if(!e.component||!e.el)return;let t=null;if(e.component.isMobile&&e.mobileParentId?t=e.mobileParentId:e.component.isTablet&&e.tabletParentId?t=e.tabletParentId:e.component.isDesktop&&e.desktopParentId&&(t=e.desktopParentId),t){const n=document.getElementById(`${t}`);n&&n!==e.el.parentNode&&(e.el.parentNode.removeChild(e.el),n.appendChild(e.el),e.moved=!0)}}const sy=rt.Vue.directive("move",{bind(e,t,n){const i=t.value;void 0!==i.mobileParentId&&null!==i.mobileParentId&&(iy.mobileParentId=i.mobileParentId),void 0!==i.tabletParentId&&null!==i.tabletParentId&&(iy.tabletParentId=i.tabletParentId),void 0!==i.desktopParentId&&null!==i.desktopParentId&&(iy.desktopParentId=i.desktopParentId)},inserted(e,t,n){iy.el=e,iy.component=n.componentInstance,setTimeout((()=>moveComponent(iy)),0),window.addEventListener("resize",resizeThrottler,!1)},unbind(e){window.removeEventListener("resize",resizeThrottler),iy.moved&&e.parentNode.removeChild(e)}});function registerDirectives(){o().directive("move",sy),o().directive("hover",ny)}var collapseItemvue_type_template_id_58532c18_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"collapse"},[n("div",{staticClass:"header",on:{click:e.toggleActive}},[n("i",{staticClass:"arrow",class:e.modsArrow}),e._v(" "),n("span",{staticClass:"body-2 font-weight-bold black--text lighten-1 ml-3"},[e._v(" "+e._s(e.title)+" ")])]),e._v(" "),n("transition",{attrs:{name:"fade"}},[e.isActive?n("div",{staticClass:"content"},[e._t("default")],2):e._e()])],1)},ry=[],collapseItemvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},collapseItemvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let ay=class CollapseItem extends rt.Vue{constructor(){super(...arguments),this.isActive=!1}toggleActive(){this.isActive=!this.isActive}get modsArrow(){return this.isActive?"m-down":"m-right"}};collapseItemvue_type_script_lang_js_decorate([(0,rt.Prop)(),collapseItemvue_type_script_lang_js_metadata("design:type",String)],ay.prototype,"title",void 0),ay=collapseItemvue_type_script_lang_js_decorate([rt.Component],ay);const ly=ay,cy=ly;var dy=(0,Ct.Z)(cy,collapseItemvue_type_template_id_58532c18_scoped_true_render,ry,!1,null,"58532c18",null);const uy=dy.exports;var py,elementsGroupvue_type_template_id_f29add6c_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"elements-group",style:e.style},[e._t("default")],2)},hy=[],elementsGroupvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},elementsGroupvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};(function(e){e[e["one"]=1]="one",e[e["two"]=2]="two",e[e["three"]=3]="three",e[e["four"]=4]="four",e[e["five"]=5]="five",e[e["six"]=6]="six"})(py||(py={}));let my=class ElementsGroup extends(o()){get style(){return{"grid-template-columns":`repeat(${this.columns}, ${this.columnsSize})`}}};elementsGroupvue_type_script_lang_js_decorate([(0,rt.Prop)({default:py.one}),elementsGroupvue_type_script_lang_js_metadata("design:type",Number)],my.prototype,"columns",void 0),elementsGroupvue_type_script_lang_js_decorate([(0,rt.Prop)(),elementsGroupvue_type_script_lang_js_metadata("design:type",Boolean)],my.prototype,"mobile",void 0),elementsGroupvue_type_script_lang_js_decorate([(0,rt.Prop)({default:"1fr"}),elementsGroupvue_type_script_lang_js_metadata("design:type",String)],my.prototype,"columnsSize",void 0),my=elementsGroupvue_type_script_lang_js_decorate([rt.Component],my);const fy=my,gy=fy;var yy=(0,Ct.Z)(gy,elementsGroupvue_type_template_id_f29add6c_scoped_true_render,hy,!1,null,"f29add6c",null);const vy=yy.exports;var by,externalComponentRenderervue_type_template_id_8ddd39e0_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{dblclick:function(t){return e.$emit("dblclick")}}},[n(e.componentName,e._b({tag:"component",staticStyle:{height:"100%"},attrs:{context:e.actionContext,query:e.queryBus,"query-id":e.queryIds,"command-id":e.commandIds,"action-id":e.actionIds,"entity-mode":e.entityViewMode,command:e.commandBus,"templates-url":e.templatesUrl},on:{"external-component-loading":function(t){return e.$emit("external-component-loading",t)},"external-component-created":e.onInstanceCreated,"set-result":e.onSetResult,"external-component-emit":function(t){return e.$emit("external-component-emit",t)}}},"component",e.props,!1)),e._v(" "),e._t("default")],2)},Cy=[],wy=n(52774),_y=n.n(wy),externalComponentRenderervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},externalComponentRenderervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},externalComponentRenderervue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const xy={},Sy=new(_y());function getComponentName(e,t=Ue.dS[Ue.dS.None]){return e=Sy.transform(e,"_"),`ExtCmp-${t}-${e}`.replace(/[(),/\\]/g,"-").replace(".vue","")}const getCardType=e=>Ue.dS[e]===Ue.dS[Ue.dS.List]?Sn.e.Item:Ue.dS[e]===Ue.dS[Ue.dS.Preview]?Sn.e.View:Ue.dS[e];let Iy=by=class ExternalComponentRenderer extends rt.Vue{constructor(){super(...arguments),this.componentName="",this.templatesUrl="",this.myMixin={created(){this.$emit("external-component-created",this)},mounted(){if(this.$el instanceof HTMLElement){const e=this.$el.querySelector('input[tabindex="1"]');e instanceof HTMLElement&&this.$nextTick((()=>e.focus()))}},data(){return{}},methods:{alert:this.alert.bind(this),confirm:this.confirm.bind(this),execQuery:this.execQuery.bind(this),execCommand:this.execCommand.bind(this),objectDelete(e,t,n){return this.command.exec(new Dt.wp(e,t,n))},objectCreate(e,t,n){return this.command.exec(new Dt.j2(e,t,n))},objectUpdate(e,t,n){return this.command.exec(new Dt.Ff(e,t,n))}},computed:{}},this.loading=!1,this.queryIds=Ae.M,this.commandIds=Ve.O,this.actionIds=Pe.k,this.entityViewMode=Ue.dS}onTemplateTypeChanged(){this.loadComponent()}created(){this.$externalComponentRenderer=!0,this.loadComponent()}destroyed(){var e;null===(e=this.$app.hotReload)||void 0===e||e.remove(this)}onInstanceCreated(e){this.componentInstance=e,this.$emit("external-component-created",e)}onSetResult(e){this.$emit("set-result",e)}loadComponent(e=!1){var t,n,i;return externalComponentRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.path)try{this.patches&&this.patches[this.path]&&(e=!0),this.loading=!0;const o=getCardType(null===(t=this.context)||void 0===t?void 0:t.entityViewMode);this.$emit("external-component-loading",!0);const s=getComponentName(this.path,o),r=xy[s];if(!e&&r&&"boolean"===typeof r)this.componentName=s;else if(r instanceof Promise)yield r,this.componentName=s;else{let t,i;xy[s]=new Promise(((e,n)=>{t=e,i=n}));try{this.SFC={name:s,raw:"",url:"",template:"<h2>Ошибка при чтении шаблона внешнего компонента</h2>"};try{this.SFC=yield this.fetchExternalComponent(new tt.Gf(this.path,s))}catch(e){this.$log.error(`Ошибка чтения шаблона "${this.path}", ${e}`)}if(this.SFC){if(null===(n=this.SFC.script)||void 0===n?void 0:n.useConstructor){const{card:e,components:t}=yield this.cardsActual(new io.J2(this.props.card.cardId,o));yield this.registerBlocks(t||[]),this.SFC=by.createSFCFrom(e.data,this.SFC)}this.templatesUrl=this.SFC.url;const i=yield this.registerComponent(this.SFC,s);t(i),e&&this.$forceUpdate()}}catch(e){this.$log.error(`Ошибка регистрации компонента "${s}", ${e}`),this.componentName=null,i(e)}}null===(i=this.$app.hotReload)||void 0===i||i.add(this,s,this.path)}catch(e){throw this.$log.error(e),e}finally{this.$emit("external-component-loading",!1),this.loading=!1}}))}registerBlocks([e,...t]){return externalComponentRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(e){t.length&&(yield this.registerBlocks(t));try{const t=by.createSFCFrom(e.actualVersion.data);yield this.registerComponent(t,e.component.code)}catch(t){throw new Error(`Ошибка регистрации общего элемента "${e.component.name} (${e.component.code})", ${t}`)}}}))}registerComponent(e,t){var n,i;return externalComponentRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let o=[];if(null===(n=e.script)||void 0===n?void 0:n.mixins){const n=yield this.queryBus.exec(new tt.Yf);o=yield this.fetchMixins(new tt.ac(e.script.mixins,t,n.mixinIsVueFile))}if(!e.styleAppended&&e.style){const n=document.head||document.getElementsByTagName("head")[0];let i=n.querySelector(`#css-${t}`);i&&i.parentNode.removeChild(i),i=document.createElement("style"),i.id=`css-${t}`,i.appendChild(document.createTextNode(e.style)),n.appendChild(i),e.styleAppended=!0}let s=["query","actionId","queryId","commandId","entityMode","command","templatesUrl","context"];(null===(i=e.script)||void 0===i?void 0:i.props)&&(Array.isArray(e.script.props)?s=s.concat(e.script.props):"object"===typeof e.script.props&&(s=s.concat(Object.keys(e.script.props)))),this.props&&(s=s.concat(Object.keys(this.props))),s=Array.from(new Set(s));const r=rt.Vue.extend(Object.assign(Object.assign({name:t},e.script),{mixins:this.mixin?[this.myMixin,this.mixin,...o]:[this.myMixin,...o],props:s,template:e.template}));return rt.Vue.component(t,r),xy[t]=!0,this.componentName=t,e.raw=null,e.template=null,e.script=null,e.style=null,r}))}static createSFCFrom(e,t={}){const n=JSON.parse(e),i=new Function(`'use strict';${n.script}`)(),o=(new Template).from(n);return Object.assign(Object.assign({},t),{script:i,template:o})}get actionContext(){if(this.context)return Object.assign({},this.context)}alert(e){return this.queryBus.exec(new gn.m("",e))}confirm(e){return this.queryBus.exec(new Zt.l(this.$gettext("Предупреждение"),e))}execQuery(e,t){return externalComponentRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const n=yield this.queryBus.exec1(e,t);return n}))}execCommand(e,t){return externalComponentRenderervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const n=yield this.commandBus.exec1(e,t);if(n.isFailure)throw new Error(n.error.message);return n.value}))}};externalComponentRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),externalComponentRenderervue_type_script_lang_js_metadata("design:type",String)],Iy.prototype,"path",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"context",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"props",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,rt.Prop)(),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"mixin",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,fa.Hg)("fetchExternalComponent"),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"fetchExternalComponent",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,fa.Hg)("fetchMixins"),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"fetchMixins",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,fa.lY)("cardsActual",{namespace:"cards"}),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"cardsActual",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,ot.t)(Ae.M.IQueryBus),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"queryBus",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,ot.t)(Ve.O.ICommandBus),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"commandBus",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,at.ZM)("extCompPatches"),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Object)],Iy.prototype,"patches",void 0),externalComponentRenderervue_type_script_lang_js_decorate([(0,rt.Watch)("path"),externalComponentRenderervue_type_script_lang_js_metadata("design:type",Function),externalComponentRenderervue_type_script_lang_js_metadata("design:paramtypes",[]),externalComponentRenderervue_type_script_lang_js_metadata("design:returntype",void 0)],Iy.prototype,"onTemplateTypeChanged",null),Iy=by=externalComponentRenderervue_type_script_lang_js_decorate([rt.Component],Iy);const Dy=Iy,Ry=Dy;var Ty=(0,Ct.Z)(Ry,externalComponentRenderervue_type_template_id_8ddd39e0_scoped_true_render,Cy,!1,null,"8ddd39e0",null);const Py=Ty.exports;var Oy=n(35709),ky=n(80055),splittervue_type_template_id_63fe3486_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vue-splitter pt-0",style:{cursor:e.cursor,userSelect:e.userSelect,flexDirection:e.flexDirection},on:{mouseup:e.onUp,mousemove:e.onMouseMove,touchmove:e.onMove,touchend:e.onUp}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.leftVisibled,expression:"leftVisibled"}],staticClass:"left-pane splitter-pane pt-0",style:e.leftPaneStyle},[e._t("left-pane")],2),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.leftVisibled&&e.rightVisibled,expression:"leftVisibled && rightVisibled"}],staticClass:"splitter",class:{active:e.active},style:e.splitterStyle,on:{mousedown:e.onDown,click:e.onClick,touchstart:function(t){return t.preventDefault(),e.onDown(t)}}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.rightVisibled,expression:"rightVisibled"}],staticClass:"right-pane splitter-pane",style:e.rightPaneStyle},[e._t("right-pane")],2)])},Fy=[],splittervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},splittervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ay=class Splitter extends rt.Vue{constructor(){super(...arguments),this.active=!1,this.percent=50,this.hasMoved=!1,this.emitResize=null}leftSizePercentChanged(){this.percent=this.leftSizePercent}created(){this.emitResize=(0,Pl.Z)(this.emitResizeEvent.bind(this),200)}get flexDirection(){return this.horizontal?"column":"row"}get splitterStyle(){return this.horizontal?{height:"5px",cursor:"ns-resize"}:{width:"5px",cursor:"ew-resize"}}get leftPaneStyle(){const e=this.leftSizeMin.indexOf("px")>-1?"":"%";return this.horizontal?{height:this.percent+"%","min-height":`${this.leftSizeMin}${e}`}:{width:this.rightVisibled?this.percent+"%":"100%","min-width":`${this.leftSizeMin}${e}`}}get rightPaneStyle(){const e=this.rightSizeMin.indexOf("px")>-1?"":"%";return this.horizontal?{height:100-this.percent+"%","min-height":`${this.rightSizeMin}${e}`}:{width:this.leftVisibled?100-this.percent+"%":"100%","min-width":`${this.rightSizeMin}${e}`}}get userSelect(){return this.active?"none":""}get cursor(){return this.active?this.horizontal?"ns-resize":"ew-resize":""}onClick(){this.hasMoved||(this.percent=50,this.$emit("resize",this.percent))}onDown(){this.active=!0,this.hasMoved=!1}onUp(){this.active=!1}onMove(e){let t=0,n=e.currentTarget,i=0;if(this.active){if(this.horizontal){while(n)t+=n.offsetTop,n=n.offsetParent;i=Math.floor((e.pageY-t)/e.currentTarget.offsetHeight*1e4)/100}else{while(n)t+=n.offsetLeft,n=n.offsetParent;i=Math.floor((e.pageX-t)/e.currentTarget.offsetWidth*1e4)/100}i>this.margin&&i<100-this.margin&&(this.percent=i,this.emitResize()),this.hasMoved=!0}}onMouseMove(e){0!==e.buttons&&0!==e.which||(this.active=!1),this.onMove(e)}emitResizeEvent(){this.$emit("resize",this.percent)}};splittervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Number,default:10}),splittervue_type_script_lang_js_metadata("design:type",Number)],Ay.prototype,"margin",void 0),splittervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!1}),splittervue_type_script_lang_js_metadata("design:type",Boolean)],Ay.prototype,"horizontal",void 0),splittervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!0}),splittervue_type_script_lang_js_metadata("design:type",Boolean)],Ay.prototype,"leftVisibled",void 0),splittervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Boolean,default:!0}),splittervue_type_script_lang_js_metadata("design:type",Boolean)],Ay.prototype,"rightVisibled",void 0),splittervue_type_script_lang_js_decorate([(0,rt.Prop)({type:Number,default:50}),splittervue_type_script_lang_js_metadata("design:type",Number)],Ay.prototype,"leftSizePercent",void 0),splittervue_type_script_lang_js_decorate([(0,rt.Prop)({type:String,default:"25"}),splittervue_type_script_lang_js_metadata("design:type",String)],Ay.prototype,"leftSizeMin",void 0),splittervue_type_script_lang_js_decorate([(0,rt.Prop)({type:String,default:"0"}),splittervue_type_script_lang_js_metadata("design:type",String)],Ay.prototype,"rightSizeMin",void 0),splittervue_type_script_lang_js_decorate([(0,rt.Watch)("leftSizePercent",{immediate:!0}),splittervue_type_script_lang_js_metadata("design:type",Function),splittervue_type_script_lang_js_metadata("design:paramtypes",[]),splittervue_type_script_lang_js_metadata("design:returntype",void 0)],Ay.prototype,"leftSizePercentChanged",null),Ay=splittervue_type_script_lang_js_decorate([rt.Component],Ay);const $y=Ay,jy=$y;var Ey=(0,Ct.Z)(jy,splittervue_type_template_id_63fe3486_scoped_true_render,Fy,!1,null,"63fe3486",null);const My=Ey.exports;var svgIconvue_type_template_id_444a1980_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{staticStyle:{fill:"transparent",stroke:"transparent"}},[n("use",{attrs:{href:e.href}})])},Ny=[],svgIconvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},svgIconvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Vy=class SvgIconComponent extends rt.Vue{constructor(){super(...arguments),this.myPath="assets/img"}get href(){return`${this.path?this.path:this.myPath}/${this.icon}.svg#${this.icon}`}};svgIconvue_type_script_lang_js_decorate([(0,rt.Prop)(),svgIconvue_type_script_lang_js_metadata("design:type",String)],Vy.prototype,"icon",void 0),svgIconvue_type_script_lang_js_decorate([(0,rt.Prop)(),svgIconvue_type_script_lang_js_metadata("design:type",String)],Vy.prototype,"path",void 0),Vy=svgIconvue_type_script_lang_js_decorate([rt.Component],Vy);const By=Vy,Ly=By;var Uy=(0,Ct.Z)(Ly,svgIconvue_type_template_id_444a1980_scoped_true_render,Ny,!1,null,"444a1980",null);const Hy=Uy.exports;var Qy=n(40764),zy=n.n(Qy);function registerComponents(){o().component("loader",Oy.Z),o().component("vue-splitter",My),o().component("external-component-renderer",Py),o().component("pager",ky.Z),o().component("vdt-picker",Aa),o().component("collapse-item",uy),o().component("elements-group",vy),o().component("vue-draggable",jd()),o().component("svg-icon",Hy),o().component("vue-draggable-resizable",zy())}var Zy=n(87938),Wy=n(69633),qy=n(52484),Gy=n(56060),cardImportDiff_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardImportDiff_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cardImportDiff_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let Ky=class CardImportDiff extends rt.Vue{constructor(){super(...arguments),this.isActual=!0,this.selected=[]}onImport(){return cardImportDiff_awaiter(this,void 0,void 0,(function*(){const e=yield this.saveCardList(new no.xr(this.importSelected));if(e.isFailure)throw this.$toasted.error(e.message),e.error;this.$toasted.success(this.$gettext("Карточки успешно импортированы")),this.emitSetResult(e.value)}))}emitSetResult(e){return e}emitCancel(){}toggleAll(){this.selected=this.allSelected?[]:this.imported}get reducedCollection(){return this.collection.reduceBy(new Wy.a(this.importCollection))}get importCollection(){return Wy.y.createFrom(this.imported)}get selectedCollection(){return Wy.y.createFrom(this.selected)}get importSelected(){return this.isActual?this.selectedCollection.mapBy(new qy.Z):this.selected}get isDisabled(){return 0===this.selected.length}get allSelected(){return this.selected.length===this.imported.length}get allIndetermined(){return Boolean(this.selected.length&&!this.allSelected)}get hasOverrides(){const e=this.reducedCollection.items.reduce(((e,t)=>{const n=t.items.reduce(((e,{items:t})=>[...e,...t.map((({cardId:e,type:t,version:n})=>({cardId:e,type:t,version:n})))]),[]);return[...e,...n]}),[]);return this.selected.map((({cardId:e,type:t,version:n})=>({cardId:e,type:t,version:n}))).filter((t=>e.some((e=>t.cardId===e.cardId&&t.type===e.type&&t.version===e.version)))).length>0}get importHiddenCols(){return[Gy.q.ACTUAL,Gy.q.ACTIONS]}get sourceHiddenCols(){return[Gy.q.ACTIONS]}};cardImportDiff_decorate([(0,rt.Prop)({type:Object,required:!0}),cardImportDiff_metadata("design:type",Object)],Ky.prototype,"collection",void 0),cardImportDiff_decorate([(0,rt.Prop)({type:Array,required:!0}),cardImportDiff_metadata("design:type",Array)],Ky.prototype,"imported",void 0),cardImportDiff_decorate([(0,fa.lY)("importCards"),cardImportDiff_metadata("design:type",Object)],Ky.prototype,"saveCardList",void 0),cardImportDiff_decorate([(0,rt.Emit)("set-result"),cardImportDiff_metadata("design:type",Function),cardImportDiff_metadata("design:paramtypes",[Array]),cardImportDiff_metadata("design:returntype",Array)],Ky.prototype,"emitSetResult",null),cardImportDiff_decorate([(0,rt.Emit)("cancel"),cardImportDiff_metadata("design:type",Function),cardImportDiff_metadata("design:paramtypes",[]),cardImportDiff_metadata("design:returntype",void 0)],Ky.prototype,"emitCancel",null),Ky=cardImportDiff_decorate([(0,rt.Component)({components:{CardList:Zy.Z}})],Ky);const Yy=Ky;var Jy,Xy=n(87924),componentCreate_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},componentCreate_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},componentCreate_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let ev=Jy=class ComponentCreate extends rt.Vue{constructor(){super(...arguments),this.form={isValid:!0}}emitSetResult(e){return e}emitCancel(){}onCreateComponent(){return componentCreate_awaiter(this,void 0,void 0,(function*(){if(!this.$refs.componentForm.validate())return;const{code:e,name:t}=this.form;return this.handleCommandResult(yield this.createComponent(new yo.fG(e,t)))}))}handleCommandResult(e){if(e.isFailure)throw this.$toasted.error(e.error.message),e.error;this.emitSetResult(e.value),this.$toasted.success(Jy.CREATE_MESSAGE)}};ev.CREATE_MESSAGE="Общий элемент успешно добавлен",componentCreate_decorate([(0,fa.d9)("createComponent"),componentCreate_metadata("design:type",Object)],ev.prototype,"createComponent",void 0),componentCreate_decorate([(0,rt.Emit)("set-result"),componentCreate_metadata("design:type",Function),componentCreate_metadata("design:paramtypes",[Object]),componentCreate_metadata("design:returntype",Object)],ev.prototype,"emitSetResult",null),componentCreate_decorate([(0,rt.Emit)("cancel"),componentCreate_metadata("design:type",Function),componentCreate_metadata("design:paramtypes",[]),componentCreate_metadata("design:returntype",void 0)],ev.prototype,"emitCancel",null),ev=Jy=componentCreate_decorate([(0,rt.Component)({components:{ComponentForm:Xy.Z}})],ev);const tv=ev;var componentEdit_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},componentEdit_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},componentEdit_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let nv=class ComponentEdit extends rt.Vue{constructor(){super(...arguments),this.formModel={isValid:!0,disabledCode:!0}}emitSetResult(e){return e}emitCancel(){}onUpdateComponent(){return componentEdit_awaiter(this,void 0,void 0,(function*(){if(!this.$refs.componentForm.validate())return;const{code:e,name:t,actualId:n,lastVersion:i}=this.form;return this.handleCommandResult(yield this.updateComponent(new yo.MT({code:e,name:t,actualId:n,lastVersion:i})),this.$gettext("Общий элемент успешно сохранен"))}))}onDeleteComponent(){return componentEdit_awaiter(this,void 0,void 0,(function*(){if(!(yield this.queryBus.exec(new Zt.l(this.$gettext("Внимание!"),this.$gettext("Вы действительно хотите удалить общий элемент?")))))return;const e=yield this.deleteComponent(new yo.l1(this.form.code));if(e.isFailure)throw this.$toasted.error(e.error.message),e.error;this.emitSetResult(e.value),this.$toasted.success(this.$gettext("Общий элемент успешно удален"))}))}get form(){return Object.assign(Object.assign({},this.component),this.formModel)}set form(e){this.formModel=e}handleCommandResult(e,t){if(e.isFailure)throw this.$toasted.error(e.error.message),e.error;this.emitSetResult(e.value),this.$toasted.success(t)}};componentEdit_decorate([(0,rt.Prop)({type:Object,required:!0}),componentEdit_metadata("design:type",Object)],nv.prototype,"component",void 0),componentEdit_decorate([(0,fa.d9)("updateComponent"),componentEdit_metadata("design:type",Object)],nv.prototype,"updateComponent",void 0),componentEdit_decorate([(0,fa.d9)("deleteComponent"),componentEdit_metadata("design:type",Object)],nv.prototype,"deleteComponent",void 0),componentEdit_decorate([(0,ot.t)(Ae.M.IQueryBus),componentEdit_metadata("design:type",Object)],nv.prototype,"queryBus",void 0),componentEdit_decorate([(0,rt.Emit)("set-result"),componentEdit_metadata("design:type",Function),componentEdit_metadata("design:paramtypes",[Object]),componentEdit_metadata("design:returntype",Object)],nv.prototype,"emitSetResult",null),componentEdit_decorate([(0,rt.Emit)("cancel"),componentEdit_metadata("design:type",Function),componentEdit_metadata("design:paramtypes",[]),componentEdit_metadata("design:returntype",void 0)],nv.prototype,"emitCancel",null),nv=componentEdit_decorate([(0,rt.Component)({components:{ComponentForm:Xy.Z}})],nv);const iv=nv;var ov=n(23323),sv=n(57123),rv=n(83020),componentImportDiff_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},componentImportDiff_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},componentImportDiff_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let av=class ComponentImportDiff extends rt.Vue{constructor(){super(...arguments),this.isActual=!0,this.selected=[]}onImport(){return componentImportDiff_awaiter(this,void 0,void 0,(function*(){const e=yield this.saveComponentList(new yo.CF(this.importGroupMapper.mapGroup(new sv.zW)));if(e.isFailure)throw this.$toasted.error(e.message),e.error;this.$toasted.success(this.$gettext("Компоненты успешно импортированы")),this.emitSetResult(e.value)}))}emitSetResult(e){return e}emitCancel(){}toggleAll(){this.selected=this.allSelected?[]:this.imported}get reducedCollection(){return this.collection.reduceBy(new sv.u7(this.importCollection))}get importCollection(){return sv.$W.createFrom(this.imported)}get selectedCollection(){return sv.$W.createFrom(this.selected)}get importSelected(){return this.isActual?this.selectedCollection.mapBy(new qy.Z):this.selected}get importGroupMapper(){return new rv.Z(this.importSelected)}get isDisabled(){return 0===this.selected.length}get allSelected(){return this.selected.length===this.imported.length}get hasOverrides(){const e=this.reducedCollection.items.reduce(((e,t)=>{const n=t.items.reduce(((e,{name:t,version:n})=>[...e,{name:t,version:n}]),[]);return[...e,...n]}),[]);return this.selected.map((({name:e,version:t})=>({name:e,version:t}))).filter((t=>e.some((e=>t.name===e.name&&t.version===e.version)))).length>0}get allIndetermined(){return this.selected.length&&!this.allSelected}get importHiddenCols(){return[Gy.q.ACTUAL,Gy.q.ACTIONS]}get sourceHiddenCols(){return[Gy.q.ACTIONS]}};componentImportDiff_decorate([(0,rt.Prop)({type:Object,required:!0}),componentImportDiff_metadata("design:type",Object)],av.prototype,"collection",void 0),componentImportDiff_decorate([(0,rt.Prop)({type:Array,required:!0}),componentImportDiff_metadata("design:type",Array)],av.prototype,"imported",void 0),componentImportDiff_decorate([(0,fa.d9)("importComponents",{namespace:"components"}),componentImportDiff_metadata("design:type",Object)],av.prototype,"saveComponentList",void 0),componentImportDiff_decorate([(0,rt.Emit)("set-result"),componentImportDiff_metadata("design:type",Function),componentImportDiff_metadata("design:paramtypes",[Array]),componentImportDiff_metadata("design:returntype",Array)],av.prototype,"emitSetResult",null),componentImportDiff_decorate([(0,rt.Emit)("cancel"),componentImportDiff_metadata("design:type",Function),componentImportDiff_metadata("design:paramtypes",[]),componentImportDiff_metadata("design:returntype",void 0)],av.prototype,"emitCancel",null),av=componentImportDiff_decorate([(0,rt.Component)({components:{ComponentList:ov.Z}})],av);const lv=av;function registerModalComponents(){o().component("change-dismissed-receiver",(()=>n.e(2672).then(n.bind(n,52672)))),o().component("add-approving-receiver",(()=>n.e(209).then(n.bind(n,30209)))),o().component("routing-settings",(()=>n.e(2898).then(n.bind(n,32898)))),o().component("write-off-document",(()=>n.e(650).then(n.bind(n,40650)))),o().component("add-folder-info",(()=>n.e(7190).then(n.bind(n,77190)))),o().component("create-edit-folder-rule",(()=>n.e(1658).then(n.bind(n,91658)))),o().component("select-items",(()=>n.e(6500).then(n.bind(n,96500)))),o().component("select-receivers",(()=>n.e(1552).then(n.bind(n,31552)))),o().component("esign-detail",(()=>n.e(9663).then(n.bind(n,69663)))),o().component("select-documents",(()=>Promise.resolve().then(n.bind(n,53606)))),o().component("files-to-sign",(()=>n.e(5292).then(n.bind(n,85292)))),o().component("edited-files-viewer",(()=>n.e(2083).then(n.bind(n,32083)))),o().component("dashboard-settings-viewer",(()=>n.e(1994).then(n.bind(n,71994)))),o().component("dashboard-widgets-settings-viewer",(()=>n.e(3126).then(n.bind(n,73126)))),o().component("dashboard-widgets-list-viewer",(()=>n.e(6967).then(n.bind(n,76967)))),o().component("edit-roadmap-step",(()=>n.e(8717).then(n.bind(n,18717)))),o().component("freshdoc-survey",(()=>n.e(8603).then(n.bind(n,86177)))),o().component("custom-actions",(()=>n.e(1190).then(n.bind(n,11190)))),o().component("rename-file",(()=>n.e(4642).then(n.bind(n,54642)))),o().component("add-deputy-user",(()=>n.e(596).then(n.bind(n,40596)))),o().component("image-viewer",(()=>n.e(6801).then(n.bind(n,96801)))),o().component("search-text-viewer",(()=>n.e(9854).then(n.bind(n,9854)))),o().component("journal-settings",(()=>n.e(5066).then(n.bind(n,45066)))),o().component("document-data-modal",(()=>n.e(1016).then(n.bind(n,81016)))),o().component("add-file-template",(()=>n.e(7733).then(n.bind(n,47733)))),o().component("kanban-add-column",(()=>n.e(2060).then(n.bind(n,92060)))),o().component("kanban-add-task",(()=>n.e(9376).then(n.bind(n,99376)))),o().component("kanban-add-board",(()=>n.e(2112).then(n.bind(n,52112)))),o().component("edit-grid-columns",(()=>n.e(2344).then(n.bind(n,32344)))),o().component("files-check-single-esign",(()=>n.e(2457).then(n.bind(n,72457)))),o().component(Yy.name,(()=>n.e(1749).then(n.bind(n,21749)))),o().component(tv.name,(()=>n.e(2194).then(n.bind(n,22194)))),o().component(iv.name,(()=>n.e(6559).then(n.bind(n,46559)))),o().component(lv.name,(()=>n.e(9461).then(n.bind(n,89461)))),o().component("workspace",(()=>n.e(5935).then(n.bind(n,36184)))),o().component("instruction-page",(()=>n.e(5764).then(n.bind(n,85764)))),o().component("doc-viewer",(()=>n.e(2441).then(n.bind(n,32441)))),o().component("pdf-viewer",(()=>n.e(6177).then(n.bind(n,16177)))),o().component("r7-viewer",(()=>n.e(7380).then(n.bind(n,17380)))),o().component("stamp-viewer",(()=>n.e(9040).then(n.bind(n,19040)))),o().component("wrapper-catalogue",(()=>n.e(141).then(n.bind(n,10141))))}var main_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},main_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};function startApp(){var e;return main_awaiter(this,void 0,void 0,(function*(){const t=yield fetchConfig(),n=createContainer(t);let i=null;window.location.href.includes("login")||(i=yield fetchInitialState(t));const s=configureStore(n,i);s.commit(On.cl,t),s.commit(On.uC,null===i||void 0===i?void 0:i.currentUser),s.commit(`settings/${Zo}`,null===i||void 0===i?void 0:i.userSettings,{root:!0});const r=t.defaultSection===Le.S.Dashboard?"":t.defaultSection,a=createRouter(s,getRoutes,r);configureRouter(a,s),configureContainer(n,a);const l=n.get(je.t.Application);i&&l.startApp(),yield registerHelp(t),registerApp(l),registerPlugins(t),registerFilters(),registerComponents(),registerModalComponents(),registerLdComponents(),registerDirectives(),document.documentElement.setAttribute("lang",null!==(e=t.defLang)&&void 0!==e?e:"ru");let c=class VueRootComponent extends(o()){created(){this.$app.intro=this.$intro,l.vm=this}mounted(){this.$el.classList.add("fill-height");const e=document.getElementsByClassName("splash");e&&e.length&&e[0].parentNode.removeChild(e[0]),createHttpInterceptors(this.$router,this.$store,this.$log)}};return c=main_decorate([(0,gt.default)({router:a,store:s,config:t,vuetify:Ie,mixins:[sf],metaInfo:{title:"",titleTemplate:"LanDocs | %s"}}),(0,ot.D)(n)],c),new c({el:"#app-main",render:e=>e(an)})}))}startApp()},4022:(e,t,n)=>{"use strict";n.d(t,{tv:()=>CardCollection,ER:()=>CardCollectionMapper,Tw:()=>CardEmptySpecification,Qy:()=>CardGroupAccumulator});var i=n(50198);class CardCollection extends i.Z{constructor(e,t){super(t),this.identity=e}get name(){return this.identity.name}get cardId(){return this.identity.cardId}get fullName(){const{name:e="",cardId:t}=this;return`${e} (ID ${t})`}reduceBy(e){return new CardCollection(this.identity,this.filterItemsBy(e))}}var o=n(74082),s=n(69515);class CardVersionCollection extends o.Z{constructor(e,t){super(t),this.type=e}get id(){return this.type}get title(){return new s.Gc(this.type).value}}var __rest=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};class CardCollectionMapper{constructor(e=[]){this.cards=e}mapCollection(){return this.cards.map((e=>{var{name:t,cardId:n}=e,i=__rest(e,["name","cardId"]);return new CardCollection({name:t,cardId:n},Object.keys(i).map((e=>new CardVersionCollection(e,i[e]))))}))}}var r=n(69406);class CardEmptySpecification{constructor(){this.spec=new r.Z}isSpecifiedBy(e){return e.items.every((e=>this.spec.isSpecifiedBy(e)))}}class CardGroupAccumulator{constructor(e={}){this.accum=e}addVersion(e){return new CardGroupAccumulator(Object.assign(Object.assign({},this.accum),{[e.cardId]:[...this.accum[e.cardId]||[],e]}))}getGrouped(){return Object.entries(this.accum).map((([e,t])=>Object.assign({cardId:e,name:t[0].cardName},t.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.type]:[...e[t.type]||[],t]})),{}))))}}},88212:(e,t,n)=>{"use strict";n.d(t,{Z:()=>BaseCollection});class BaseCollection{constructor(e){this.elements=e}get items(){return[...this.elements]}get isEmpty(){return 0===this.elements.length}get hasMany(){return this.elements.length>1}get itemsIdx(){return this.elements.map(((e,t)=>t))}filterItemsBy(e){return this.elements.filter((t=>e.isSpecifiedBy(t)))}}},50198:(e,t,n)=>{"use strict";n.d(t,{Z:()=>TreeCollection});var i=n(88212);class TreeCollection extends i.Z{mapBy(e){return this.elements.reduce(((t,n)=>[...t,...e.mapVersions(n)]),[])}}},74082:(e,t,n)=>{"use strict";n.d(t,{Z:()=>VersionCollection});var i=n(88212);class VersionCollection extends i.Z{constructor(e){super([...e].sort((({version:e},{version:t})=>t-e)))}get actual(){return this.elements.find((e=>e.isActual))}get lastVersion(){return Math.max(...this.elements.map((({version:e})=>e)))}}},57123:(e,t,n)=>{"use strict";n.d(t,{$W:()=>ComponentCollection,U5:()=>ComponentCollectionMapper,u7:()=>ComponentSpecification,tT:()=>ComponentVersionCollection,zW:()=>VersionGroupAccumulator});var i=n(50198),o=n(74082),s=n(69515);class ComponentVersionCollection extends o.Z{constructor(e,t){super(t),this.component=e}get title(){return this.name}get id(){return this.code}get name(){return this.component.name}get code(){return this.component.code}get fullName(){return new s.$m(this.component).value}}class ComponentCollectionMapper{constructor(e=[]){this.components=e}mapCollection(){return this.components.map((({component:e,versions:t})=>new ComponentVersionCollection(e,t)))}}class ComponentGroupAccumulator{constructor(e={}){this.accum=e}addVersion(e){return new ComponentGroupAccumulator(Object.assign(Object.assign({},this.accum),{[e.code]:[...this.accum[e.code]||[],e]}))}getGrouped(){return Object.entries(this.accum).map((([e,t])=>({component:{code:e,name:t[0].name},versions:t})))}}var r=n(83020);class ComponentCollection extends i.Z{reduceBy(e){return new ComponentCollection(this.filterItemsBy(e))}}ComponentCollection.createFrom=e=>{const t=new r.Z(e),n=new ComponentCollectionMapper(t.mapGroup(new ComponentGroupAccumulator));return new ComponentCollection(n.mapCollection())};class ComponentSpecification{constructor(e){this.importCollection=e}isSpecifiedBy(e){return this.importCollection.items.find((({code:t})=>t===e.code))instanceof ComponentVersionCollection}}var __rest=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};class VersionGroupAccumulator{constructor(e={}){this.accum=e}addVersion(e){var t;return new VersionGroupAccumulator(Object.assign(Object.assign({},this.accum),{[e.code]:VersionGroupAccumulator.getComponentVersionCollection(e,null===(t=this.accum[e.code])||void 0===t?void 0:t.items)}))}getGrouped(){return Object.entries(this.accum).reduce(((e,[t,{component:n,items:i,actual:o,lastVersion:s}])=>[...e,...i.map((e=>({component:Object.assign(Object.assign({},n),{code:t,actualId:null===o||void 0===o?void 0:o.id,lastVersion:s}),version:e})))]),[])}}VersionGroupAccumulator.getComponentVersionCollection=(e,t=[])=>{var{code:n,name:i}=e,o=__rest(e,["code","name"]);return new ComponentVersionCollection({code:n,name:i},[...t,Object.assign({code:n,name:i},o)])}},69633:(e,t,n)=>{"use strict";n.d(t,{y:()=>DocumentCollection,a:()=>DocumentSpecification});var i=n(4022),o=n(88212),s=n(83020);class DocumentCollection extends o.Z{reduceBy(e){return new DocumentCollection(this.filterItemsBy(e))}mapBy(e){return this.elements.reduce(((t,n)=>[...t,...n.mapBy(e)]),[])}}DocumentCollection.createFrom=e=>{const t=new s.Z(e),n=new i.ER(t.mapGroup(new i.Qy));return new DocumentCollection(n.mapCollection())};class DocumentSpecification{constructor(e){this.importCollection=e}isSpecifiedBy(e){return this.importCollection.items.find((({cardId:t})=>t===e.cardId))instanceof i.tv}}},19061:(e,t,n)=>{"use strict";n.d(t,{Oo:()=>o.O,eT:()=>i.e});var i=n(87048),o=n(39481)},83020:(e,t,n)=>{"use strict";n.d(t,{Z:()=>GroupMapper});class GroupMapper{constructor(e){this.items=e}mapGroup(e){return this.items.reduce(((e,t)=>e.addVersion(t)),e).getGrouped()}}},52484:(e,t,n)=>{"use strict";n.d(t,{Z:()=>LastActualMapper});class LastActualMapper{mapVersions({lastVersion:e,items:t}){return[...t.map((t=>Object.assign(Object.assign({},t),{isActual:e===t.version})))]}}},69406:(e,t,n)=>{"use strict";n.d(t,{Z:()=>EmptySpecification});class EmptySpecification{isSpecifiedBy(e){return e.isEmpty}}},80763:(e,t,n)=>{"use strict";n.d(t,{Z:()=>NotSpecification});class NotSpecification{constructor(e){this.spec=e}isSpecifiedBy(e){return!this.spec.isSpecifiedBy(e)}}},98578:(e,t,n)=>{"use strict";n.d(t,{n:()=>ComponentTableFactory,J:()=>TableFactory});class TableExpanded{constructor(e){this.expanded=e}showRow({isLead:e,rowInfo:{collection:t}}){return this.isExpanded(t)||e}showTitle({isFirst:e,isLead:t,rowInfo:{collection:n}}){return this.isExpanded(n)?e:t}toggleExpanded({rowInfo:{collection:e}}){const t=this.getIndexOf(e);return t>-1?[...this.expanded.slice(0,t),...this.expanded.slice(t+1)]:[...this.expanded,e]}isExpanded(e){return this.getIndexOf(e)>-1}getIndexOf({id:e}){return this.expanded.findIndex((t=>t.id===e))}}var i=n(56060);class TableRow{constructor(e,t){this.version=e,this.collection=t}get id(){return this.version.id}get isLead(){return this.version===this.leadItem}get isFirst(){return this.version===this.firstItem}get rowInfo(){const{version:e,collection:t}=this;return{version:e,collection:t}}get fullInfo(){const{title:e,hasMany:t}=this.collection;return Object.assign(Object.assign({},this.version),{title:e,hasMany:t})}get leadItem(){return this.collection.actual||this.firstItem}get firstItem(){const[e]=this.collection.items;return e}}class TableMapper{constructor(e){this.collection=e}mapRows(){return this.collection.items.map((e=>new TableRow(e,this.collection)))}}class TableSelected{constructor(e=[]){this.selected=e}getFrom(e){return TableSelected.getSelectedRows(e,this.selectedIds)}getNewFrom(e,t){return[...this.getSelectedWithoutSelectedRows(e.map((({id:e})=>e))),...t.map((({rowInfo:{version:e}})=>e))]}getSelectedWithoutSelectedRows(e){return this.selected.filter((({id:t})=>!e.includes(t)))}get selectedIds(){return this.selected.map((({id:e})=>e))}}TableSelected.getSelectedRows=(e,t)=>e.filter((({id:e})=>t.includes(e)));class TableFactory{createRows(e){return e.items.map((e=>new TableMapper(e))).reduce(((e,t)=>[...e,...t.mapRows()]),[])}createTableHead(e,t){return new i.s(e.filter((({value:e})=>!t.includes(e))))}createTableSelected(e){return new TableSelected(e)}createTableExpanded(e){return new TableExpanded(e)}}class ComponentTableFactory extends TableFactory{}},56060:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>TableHead,q:()=>i}),function(e){e["NAME"]="cardType",e["VERSION"]="version",e["USER_NAME"]="editUserName",e["DATE"]="editDateTime",e["ACTUAL"]="isActual",e["ACTIONS"]="actions"}(i||(i={}));class TableHead{constructor(e){this.headers=e}get items(){return[...this.headers]}showSelection(e){return e instanceof Array}isNameColumn({value:e}){return e===i.NAME}isVersionColumn({value:e}){return e===i.VERSION}isUserColumn({value:e}){return e===i.USER_NAME}isDateColumn({value:e}){return e===i.DATE}isActualColumn({value:e}){return e===i.ACTUAL}isActionsColumn({value:e}){return e===i.ACTIONS}}},69515:(e,t,n)=>{"use strict";n.d(t,{Gc:()=>CardTypeTitle,$m:()=>ComponentTitle,$4:()=>DocumentTitle});var i,o,s,r,a=n(19061);class CardTypeTitle{constructor(e){this.type=e}get value(){return CardTypeTitle[this.type]}}i=a.eT.Create,o=a.eT.Edit,s=a.eT.View,r=a.eT.Item,CardTypeTitle[i]="Создание",CardTypeTitle[o]="Редактирование",CardTypeTitle[s]="Просмотр",CardTypeTitle[r]="Элемент списка";class DocumentTitle{constructor(e,t){this.card=e,this.title=t}get value(){const{cardId:e,name:t}=this.card;return`${t} ${e} (${this.title.value})`}}class ComponentTitle{constructor(e){this.component=e}get value(){return this.component.name?`${this.component.name} (${this.component.code})`:ComponentTitle.NEW_TITLE}}ComponentTitle.NEW_TITLE="Новый общий элемент"},30036:(e,t,n)=>{"use strict";n.d(t,{a$:()=>i,Hu:()=>o,_j:()=>s,hg:()=>r});const i=[".doc",".docm",".docx",".pdf",".rtf",".txt",".epub",".djvu",".dot",".dotm",".dotx",".fodt",".htm",".html",".mht",".odt",".ott",".xps"],o=[".xls",".xlsx",".csv",".fods",".ods",".ots",".xlt",".xltm",".xltx"],s=[".ppt",".pptm",".pptx",".fodp",".odp",".otp",".pot",".potm",".potx",".pps",".ppsm",".ppsx"],r=[...i,...o,...s]},38775:(e,t,n)=>{"use strict";n.d(t,{r:()=>a});var i=n(86700),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const o=17,s=25,r=68;let a=class DialogManager{constructor(){this._visibled=[],this._minimized=[],this._viewPortWidth=window.innerWidth,window.addEventListener("resize",this.onResizeHandler.bind(this))}setMinimized(e){this._minimized=e}tryToOpen(e){const t=this._visibled.concat(this._minimized).find((t=>{var n,i,o;return(null===(n=t.hostObject)||void 0===n?void 0:n.id)===e.id&&(null===(i=t.hostObject)||void 0===i?void 0:i.contentType)===e.contentType&&(null===(o=t.hostObject)||void 0===o?void 0:o.kind)===e.kind}));return!t}onResizeHandler(){this._viewPortWidth=window.innerWidth,this.refreshPositions()}dialogCreated(e){e&&(e.el=document.querySelector(`.${this.uniqKey(e)}`),this.shiftLeft(e),this.refreshPositions())}dialogModalChanged(e){if(e)if(e.noModal){let t;this.setDialogNomodal(e);let n=!1;const resizeEnd=()=>{clearTimeout(t),i.unobserve(e.el),this.refreshPositions(),n=!0},i=new window.ResizeObserver((e=>{e.length&&e[0].contentRect&&(clearTimeout(t),t=setTimeout(resizeEnd,50))}));i.observe(e.el),setTimeout((()=>{n||this.refreshPositions()}),300)}else this.setDialogModal(e)}dialogProcessing(e){e&&(e.minimized=!0,this.dialogMinimizeChanged(e))}dialogMinimizeChanged(e){if(e)if(e.minimized){e.noModal||(e._wasModal=!0,e.noModal=!0,this.setDialogNomodal(e));const t=this._visibled.indexOf(e);t>=0&&this._visibled.splice(t,1),this.addToMinimized(e),this.refreshPositions()}else this.removeFromMinimized(e),this.toggleDialogShow(e),this.shiftLeft(e),e._wasModal&&(e.noModal=!1,delete e._wasModal),e.noModal?this.refreshPositions():this.setDialogModal(e)}dialogClosed(e){try{if(this.removeFromMinimized(e))return;const t=this._visibled.indexOf(e);t>=0&&(this._visibled.splice(t,1),this.refreshPositions())}finally{}}activate(e){let t=this._minimized.findIndex((t=>t===e)),n=null;t>=0&&(n=this._minimized[t],this._minimized.splice(t,1)),n?(this.maximizeDialog(n),this.refreshPositions()):(t=this._visibled.indexOf(e),t>=0&&this._visibled.splice(t,1),this.shiftLeft(e),this.refreshPositions())}maximizeDialog(e){return e||(e=this._minimized.shift()),e?(e.minimized=!1,this.toggleDialogShow(e),this.shiftLeft(e),e):null}shiftLeft(e){this._visibled.push(e)}refreshPositions(){let e=0,t=-1,n=this._viewPortWidth;for(let i=this._visibled.length-1;i>=0;i--){const a=this._visibled[i];if(!a.noModal)continue;const l=a.el.clientWidth+o;if(n<l){const e=this._visibled.shift();e.el.style.bottom="unset",e.el.style.right="unset",setTimeout((()=>{this.addToMinimized(e)}),1)}else e=s+l*++t,n-=s+l,a.el.style.margin="0",a.el.style.position="absolute",a.el.style.bottom=`${r}px`,a.el.style.right=`${e}px`}}setDialogModal(e){if(!e)return;e.el.style.position="relative",e.el.style.top="unset",e.el.style.left="unset",e.el.style.bottom="unset",e.el.style.right="unset",e.el.parentElement.style.justifyContent="center",e.el.parentElement.style.alignItems="center";const t=Number(e.el.parentElement.style.zIndex)+1e3;e.el.parentElement.style.zIndex=String(t),setTimeout((()=>{const e=document.querySelector(".v-overlay--active");e&&(e.style.zIndex=String(t-1))}),100)}setDialogNomodal(e){if(!e)return;const t=Number(e.el.parentElement.style.zIndex);t>1e3&&(e.el.parentElement.style.zIndex=String(t-1e3))}addToMinimized(e){this.toggleDialogShow(e),e.minimized=!0,this._minimized.unshift(e)}removeFromMinimized(e){const t=this._minimized.indexOf(e);return t>=0&&(this._minimized.splice(t,1),!0)}toggleDialogShow(e){"none"!==e.el.parentElement.style.display?(e._lastDisplayProp=e.el.parentElement.style.display,e.el.parentElement.style.display="none"):e.el.parentElement.style.display=e._lastDisplayProp}uniqKey(e){return`dlg-${e.id}`}};a=__decorate([(0,i.b2)(),__metadata("design:paramtypes",[])],a)},34317:(e,t,n)=>{"use strict";function arrayToObject(e,t){let n;return Array.isArray(e)&&(n=e.reduce(((e,n)=>(e[n[t]]=n,e)),{})),n}n.d(t,{F:()=>arrayToObject})},73082:(e,t,n)=>{"use strict";n.d(t,{g:()=>delay});var __awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};function delay(e){return __awaiter(this,void 0,void 0,(function*(){let t;const n=new Promise((e=>t=e));return setTimeout((()=>t()),e),n}))}},98917:(e,t,n)=>{"use strict";n.d(t,{sH:()=>CustomError,vr:()=>EsignError,Mk:()=>CancelError,Ol:()=>CancelTransitionError,ao:()=>ReadError,UZ:()=>processException,WI:()=>getErrorCommandResult,_o:()=>throwCommandError,og:()=>getCommandError});var i=n(64447),o=n(9669),s=n.n(o);class CustomError extends Error{constructor(e){super(),this.message=e,this.name="CustomError",Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack}}class EsignError extends CustomError{constructor(e,t){super(e),this.message=e,this.displayableError=t,this.name="EsignError"}}class CancelError extends Error{constructor(e,t,n){super(),this.message=e,this.cause=t,this.displayableError=n,this.name="CancelError",this.cause&&(this.stack=t.stack),!this.stack&&Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack}}class CancelTransitionError extends Error{constructor(e,t){super(),this.message=e,this.cause=t,this.name="CancelTransitionError",this.cause&&(this.stack=t.stack),!this.stack&&Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack}}class ReadError extends CustomError{constructor(e,t){super(e),this.message=e,this.cause=t,this.name="ReadError",this.stack=t.stack}}function processException(e){if(s().isCancel(e))throw new CancelError("Отменено пользователем",e);throw"URIError"===e.name?new ReadError("Ошибка в URI",e):"SyntaxError"===e.name?new ReadError("Синтаксическая ошибка в данных",e):e}function getErrorMessage(e){if(!e)return"";let t="";e.message&&!e.message.includes("Request")&&(t=e.message);let n=!1;if(e.response&&e.response.data){t+=t?"; ":"";let i=null;"string"===typeof e.response.data?i=e.response.data:e.response.data.success?i=e.response.data.success.message||e.response.data.message:e.response.data.title?i=e.response.data.title:e.response.data.message&&(i=e.response.data.message),n=Boolean(i),n&&(t+=i)}return t}function getErrorCommandResult(e){var t,n;const o=getErrorMessage(e);let s=!1;void 0!==e.displayableError&&(s=!e.displayableError);const r=null===(n=null===(t=e.response)||void 0===t?void 0:t.data)||void 0===n?void 0:n.success,a=new i.yr(o,e,r||e.data,s);return new i.$Q({value:null,error:a})}function throwCommandError(e){const t=getErrorCommandResult(e);return Promise.reject(t)}function getCommandError(e){return getErrorCommandResult(e)}},73983:(e,t,n)=>{"use strict";function exhaustiveCheck(e){throw new Error("should not reach here")}n.d(t,{y:()=>exhaustiveCheck})},23116:(e,t,n)=>{"use strict";function isObjectEmpty(e){for(const t in e)return!1;return!0}n.d(t,{n:()=>isObjectEmpty})},86142:(e,t,n)=>{"use strict";function pluralizeNoun(e,t,n,i,o=!0){if(!e)return"";let s;return s="string"===typeof e?Number(e.match(/\d+\.?\d*/g)):Math.abs(e),s%=100,s>=5&&s<=20?o?`${e} ${i}`:`${i}`:(s%=10,1===s?o?`${e} ${t}`:`${t}`:s>=2&&s<=4?o?`${e} ${n}`:`${n}`:o?`${e} ${i}`:`${i}`)}n.d(t,{o:()=>pluralizeNoun})},13319:(e,t,n)=>{"use strict";function isNullOrWhitespace(e){return!e||/^\s*$/.test(e)}function capitalize(e){if(!e)return e;const t=e[0],n=e.substr(1);return`${t.toUpperCase()}${n}`}function camelCase(e){return e=e.replace(/[^\d A-Za-z]/g," "),e=e.replace(/([a-z](?=[A-Z]))/g,"$1 "),e=e.replace(/([^\d A-Za-z])|^\d+/g,"").trim().toLowerCase(),e=e.replace(/([\d ]+)([A-Za-z])/g,((e,t,n)=>t.trim()+n.toUpperCase())),e}function cropText(e,t=100){if(!e)return e;const n=[];return e.length>t?(e.split(" ").reduce(((e,i)=>(e+i.length<t&&n.push(i),e+i.length)),0),`${n.join(" ")}...`):e}function compareString(e){return(t,n)=>{const i=t[e],o=n[e];return i<o?-1:i>o?1:0}}function userNameShorting(e){if(!e)return e;let t=e.split(" ")[0];const n=["",""],i=new RegExp("^([a-zA-Z]*|[а-яА-ЯёЁ])*$");if(e.split(" ")[1]){if(n[0]=e.split(" ")[1],1===n[0].indexOf(".")&&4===n[0].length)return[n[0],n[1]]=n[0].split(" ").join("").split("."),t+=` ${n[0]}. ${n[1]}.`,t;if(1===n[0].indexOf(".")&&2===n[0].length)return n[1]=e.split(" ")[2],`${t} ${n[0]} ${n[1]}`;n[0]=n[0].search(i)>-1?n[0].toUpperCase()[0]:"",n[0]&&(t+=` ${n[0]}.`)}return e.split(" ")[2]&&(n[1]=e.split(" ")[2],n[1]=n[1].search(i)>-1?n[1].toUpperCase()[0]:"",n[1]&&(t+=` ${n[1]}.`)),t}n.d(t,{hr:()=>isNullOrWhitespace,kC:()=>capitalize,eV:()=>camelCase,Kj:()=>cropText,rR:()=>compareString,nO:()=>userNameShorting})},76196:(e,t,n)=>{"use strict";function uidGen(e=6,t){let n="",i="";switch(t){case"a-z":i="abcdefghijklmnopqrstuvwxyz";break;case"A-Z":i="ABCDEFGHIJKLMNOPQRSTUWVXYZ";break;case"0-9":i="1234567890";break;case"a-zA-Z":i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUWVXYZ";break;case"a-z0-9":i="abcdefghijklmnopqrstuvwxyz1234567890";break;case"A-Z0-9":i="ABCDEFGHIJKLMNOPQRSTUWVXYZ1234567890";break;default:i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUWVXYZ1234567890"}for(let t=0;t<e;t++)n+=i.charAt(Math.floor(Math.random()*i.length));return"0-9"===t?Number(n):n}n.d(t,{Z:()=>i});const i=uidGen},97529:(e,t,n)=>{"use strict";function getZIndex(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return 0;const t=Number(window.getComputedStyle(e).getPropertyValue("z-index"));return isNaN(t)?getZIndex(e.parentNode):t}n.d(t,{K:()=>getZIndex})},52479:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>I});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("external-component-renderer",{staticClass:"external-component-renderer",attrs:{folder:e.vocabularyName,context:e.actionContext,path:e.templatePath,props:{item:e.myItem,card:e.card,parent:e.parent,preview:e.preview,refresh:e.refreshCounter,validators:e.validators,isValid:e.isValid},mixin:e.mixin},on:{"external-component-created":e.onCardInstanceCreated,"set-result":e.onSetResult,"external-component-loading":function(t){return e.$emit("external-component-loading",t)},"external-component-emit":function(t){return e.onExternalComponentEmit(t)}}})},i=[],o=n(22713),s=n(22402),r=n(81695),a=n(40471),l=n(43867),c=n(2653),d=n(1869),u=n(23728),p=n(18220),h=n(20785),m=n(24783),f=n(47767),g=n(13319),y=n(54486),v=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const b="set-result";let C=class CatalogueTemplateRendererComponent extends m.Z{constructor(){super(...arguments),this.myItem=null,this.card=null,this.componentName="",this.templatePath="",this.oldTemplateType=-1,this.refreshCounter=0,this.suffix="_$IDS",this.validators=f.z2,this.transitToEditPromise=null,this.transitToEditResovle=null,this.mixin={created(){this.$templateRenderer=this.$parent.$parent},data(){return{}},methods:{getIds:h.s3,setListValues:h.SY,save(...e){try{return this.$templateRenderer.onSaveCounterChanged(...e)}catch(e){this.$log.error(e),this.$toasted.error(this.$gettext("Ошибка при сохранении элемента")),this.$emit(b)}},validate(){return this.$templateRenderer.validate()},refreshCard(){this.$templateRenderer.refreshCard()}},computed:{}},this.queryIds=d.M,this.commandIds=s.O}onItemChanged(e){return __awaiter(this,void 0,void 0,(function*(){if(!e&&this.templateType!==a.$.List)return;let t="";if(this.templateType===this.oldTemplateType||(t=yield this.getTemplatePath(this.vocabularyName),t)){if(this.templateType===a.$.List)return this.myItem={attributes:{},id:0,vocabularyValue:{id:0,value:null},cardId:null,files:null,journalID:null,type:null,uid:null,viewFlag:!1},void(this.templatePath=t);this.oldTemplateType=this.templateType,this.myItem=e,(0,h.BK)(e),this.card=this.createCard(e,this.metadata),this.storeOriginalCard(this.card),t&&(this.templatePath=t),this.transitToEditResovle&&(this.cardComponentInstance.card.attr=this.card.attr,this.cardComponentInstance.card.listAttr=this.card.listAttr,this.transitToEditResovle())}else this.$log.error(`Для словаря ${this.vocabularyName} не найден компонент ${a.$[this.templateType]}.\n          Проверьте наличие папки ${this.vocabularyName} (в таком же регистре)`)}))}onSaveCounterChanged(...e){return __awaiter(this,void 0,void 0,(function*(){try{const t=this.cardComponentInstance&&this.cardComponentInstance.beforeSave?this.cardComponentInstance.beforeSave.bind(this.cardComponentInstance):null,n=this.cardComponentInstance&&this.cardComponentInstance.afterSave?this.cardComponentInstance.afterSave.bind(this.cardComponentInstance):null;if(t){const n=yield t(...e);if(!1===n)return}const i="boolean"===typeof e[0]?e[0]:void 0;yield this.saveCard(i),n&&(yield n(...e))}finally{this.$emit("save-completed")}}))}created(){this.$emit("external-component-loading",!0);try{if(!this.item&&this.metadata){const e=o.Z.createEmptyAttributes(this.metadata.attributes);this.onItemChanged({attributes:e,id:0,vocabularyValue:{id:0,value:null},cardId:null,files:null,journalID:null,type:null,uid:null,viewFlag:!1,manyToManyRelations:this.metadata.manyToManyChildren,oneToManyChildren:this.metadata.oneToManyChildren})}}finally{this.$emit("external-component-loading",!1)}}onCardInstanceCreated(e){this.cardComponentInstance=e,this.$emit("external-component-created",e)}onExternalComponentEmit(e){e&&("card-updated"===e.name||e.name&&this.$emit(e.name,e.data))}onSetResult(e){this.$emit(b,e)}getTemplatePath(e){return __awaiter(this,void 0,void 0,(function*(){let t,n=null;try{t=yield this.queryBus.exec(new c.R0(e,"cards"))}catch(e){throw this.$log.error("Ошибка чтения манифеста",e),e}if(!t)return null;const i=a.$[this.templateType].toLowerCase();return n=t[i].toLowerCase(),n?(n.includes("/")||n.includes("\\")||(n=`${e}/${n}`),n):null}))}get actionContext(){if(this.context)return Object.assign(Object.assign({},this.context),{catalogue:[this.myItem]})}refreshCard(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchVocabularyItem(new u.AG(this.vocabularyName,Number(this.myItem.id)));this.onItemChanged(e)}))}saveCard(e=!1){return __awaiter(this,void 0,void 0,(function*(){const t=this.validate();if(!t)return;const n=this.card;let i=n.id,o=n.attr;o=(0,h.xc)(o,this.originalCard.attr);const s=(0,h.QT)(n,this.suffix),a=(0,h.m9)(n,this.suffix);let c,d=!1;try{if(i){const e=(0,h.QT)(this.originalCard,this.suffix),t=(0,h.m9)(this.originalCard,this.suffix),{referencesToAdd:l,referencesToDelete:d}=(0,h.G4)(s,e),{entitiesToAdd:u,entitiesToDelete:p}=(0,h.Xv)(a,t),m=this.catlogueItemFromCard(n);c=yield this.vocabularyItemSave(new r.ny(this.vocabularyName,o,l,d,u,p,i,m))}else d=!this.isModal,o.AccessID=1,o.ObjectTypeID=19,c=yield this.vocabularyItemSave(new r.ny(this.vocabularyName,o,s,null,a)),i=n.id=c.value.id;return this.onItemChanged(c.value),d?(this.transitToEditPromise=new Promise((e=>this.transitToEditResovle=e)),this.$app.editDoc(i,this.actionContext,!0),yield this.transitToEditPromise):this.$emit(b,c.value),e&&this.queryBus.exec(new l.m("",this.$gettext("Элемент справочника успешно сохранён"))),i}catch(e){throw this.$log.error(e.message?e.message:e),this.$toasted.error(e.message?e.message:e),e}finally{this.$emit("save-completed")}}))}createCard(e,t){var n,i,s;if(!e)return null;const r=e.attributes,a=Object.keys(r),l={};if(t&&t.manyToManyChildren&&t.manyToManyChildren.forEach((t=>{const n=(0,h.e9)(e,t.name,this.suffix);t.attrName=n;const i=e.data?e.data[t.name]:null;l[n]=[],l[t.name]=i,Array.isArray(i)&&(l[n]=i.map((e=>e.id)));const o=a.filter((e=>e.startsWith(t.name)));o.forEach((e=>{l[e]=r[e],delete r[e]}))})),t&&t.oneToManyChildren)for(const n of t.oneToManyChildren){const i=n.className,s=t.metadatas[i],r=(0,g.kC)(i),a=e.data&&(e.data[i]||e.data[n.name])||[];l[i]=a,l[`add${r}`]=e=>(e||(e=o.Z.createEmptyAttributes(s.attributes)),a.push(e),e),l[`remove${r}`]=e=>{const t=a.indexOf(e);return t>=0&&(a.splice(t,1),!0)}}return{id:null!==(n=e.id)&&void 0!==n?n:null===(i=e.vocabularyValue)||void 0===i?void 0:i.id,isVocabulary:!0,value:null!==(s=e.value)&&void 0!==s?s:e.vocabularyValue.value,uid:e.uid,attr:r,listAttr:l}}catlogueItemFromCard(e){if(!e)return null;const t=e.attr;return{id:e.id,uid:e.uid,vocabularyValue:{id:this.card.id,value:this.card.value},cardId:e.cardId,journalID:e.journalID,type:e.type,viewFlag:e.viewFlag,attributes:t,files:e.files,createDateTime:this.myItem.createDateTime,data:this.myItem.data,mainFile:this.myItem.mainFile,manyToManyRelations:this.myItem.manyToManyRelations,oneToManyChildren:this.myItem.oneToManyChildren,parentDocumentNode:this.myItem.parentDocumentNode}}storeOriginalCard(e){this.originalCard=JSON.parse(JSON.stringify(e))}};__decorate([(0,v.Prop)(),__metadata("design:type",String)],C.prototype,"vocabularyName",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Boolean)],C.prototype,"preview",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Object)],C.prototype,"item",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Object)],C.prototype,"parent",void 0),__decorate([(0,v.Prop)({type:Number,default:a.$.Item}),__metadata("design:type",Number)],C.prototype,"templateType",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Number)],C.prototype,"saveCounter",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Object)],C.prototype,"context",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Boolean)],C.prototype,"isModal",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Object)],C.prototype,"metadata",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Function)],C.prototype,"setIsChangedCallback",void 0),__decorate([(0,y.t)(d.M.IQueryBus),__metadata("design:type",Object)],C.prototype,"queryBus",void 0),__decorate([(0,y.t)(s.O.ICommandBus),__metadata("design:type",Object)],C.prototype,"commandBus",void 0),__decorate([(0,p.eI)("vocabularyItemSave"),__metadata("design:type",Object)],C.prototype,"vocabularyItemSave",void 0),__decorate([(0,p.eI)("fetchVocabularyItem"),__metadata("design:type",Object)],C.prototype,"fetchVocabularyItem",void 0),__decorate([(0,v.Watch)("item",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],C.prototype,"onItemChanged",null),__decorate([(0,v.Watch)("saveCounter"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],C.prototype,"onSaveCounterChanged",null),C=__decorate([(0,v.Component)({mixins:[m.Z]})],C);const w=C,_=w;var x=n(51900),S=(0,x.Z)(_,render,i,!1,null,"3ba786ce",null);const I=S.exports},21610:(e,t,n)=>{"use strict";n.d(t,{Z:()=>x});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"mt-2",staticStyle:{width:"100%"},attrs:{"no-gutters":"",id:e.versionViewer}},[n("div",{staticStyle:{width:"100%"}},[n("div",{staticClass:"body-2 font-weight-bold black--text lighten-1 mb-3"},[e._v("\n      "+e._s(e.$gettext("История изменений"))+" ("+e._s(e.versions?e.versions.length:"")+" "+e._s(e.$gettext(" версий"))+"):\n    ")]),e._v(" "),e._l(e.versions,(function(t,i){return n("div",{key:t.id+e._uid,staticClass:"mt-1 text-body-1"},[n("transition",{attrs:{name:"expand"}},[e.showVersionRow(i)||e.activeVersionId===t.id?[n("v-row",{class:{limited:e.isTablet},attrs:{"no-gutters":""}},[n("v-col",{staticClass:"primary--text file-name",class:{"col-xs-12":e.isMobile,"col-xs-4 col-sm-4 col-md-4 col-lg-4 col-xl-4":!e.isMobile}},[n("span",{staticClass:"file-version grey--text mr-2 pr-1"},[e._v(" "+e._s(t.majorVersion)+". ")]),e._v(" "),e.processedFiles?n("a",{staticClass:"primary--text",attrs:{href:e.onDownload(t.id),download:""}},[e._v(e._s(e.file.fullFileName))]):n("a",{staticClass:"primary--text",on:{click:function(n){return e.$emit("velsion-click",t)}}},[e._v(e._s(e.file.fullFileName))]),e._v(" "),e.activeVersionId&&e.activeVersionId===t.id?n("v-icon",{staticClass:"ml-2",attrs:{small:"",color:"warning"}},[e._v("\n                visibility\n              ")]):e._e()],1),e._v(" "),n("v-col",{staticClass:"d-flex align-center pl-2",attrs:{cols:"1"}},[n("span",[e._v(e._s(e._f("formatSize")(t.size)))])]),e._v(" "),n("v-col",{staticClass:"d-flex align-center pl-2",attrs:{cols:"2"}},[n("span",[e._v(e._s(e._f("date")(t.lastEditDateTime,"DD.MM.YYYY hh:mm")))])]),e._v(" "),n("v-col",{staticClass:"d-flex align-center pl-2",attrs:{cols:"2"}},[n("span",[e._v(e._s(t.versionCreatorName))])]),e._v(" "),n("v-col",{staticClass:"d-flex align-center pl-2",attrs:{cols:"3"}},[e.canDeleteVersion(e.file,t)?n("v-icon",{staticClass:"grey--text darken-3",attrs:{"data-testid":"fileDeleteVersion",size:"18"},on:{click:function(n){return e.onDeleteVersion(e.file,t)}}},[e._v("\n                delete\n              ")]):e._e()],1)],1)]:e._e()],2)],1)}))],2),e._v(" "),e.hasActionPrevious?n("div",{staticClass:"mb-2",staticStyle:{width:"100%"}},[n("a",{staticClass:"underlined grey--text body-1",on:{click:e.toggleAllVersions}},[n("translate",[e._v(e._s(e.textActionPrevious))])],1)]):e._e()])},i=[],o=n(98005),s=n(22337),r=n(1869),a=n(60601),l=n(2934),c=n.n(l),d=n(45904),u=n(54486),p=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let h=class FileVersionsViewerClass extends(c()){constructor(){super(...arguments),this.versions=null,this.loading=!1,this.showAllVersions=!1,this.onClickOutsideHandler=null,this.versionViewer="version-viewer"}created(){return __awaiter(this,void 0,void 0,(function*(){this.fileVersions&&this.fileVersions.length?this.versions=this.fileVersions:this.file&&this.file.id&&(yield this.refreshVersions())}))}onFileChanged(e,t){return __awaiter(this,void 0,void 0,(function*(){this.file&&e.id!==t.id&&(yield this.refreshVersions())}))}onFileVersionsChanged(e){this.versions=e}mounted(){this.viewerActivator&&(this.onClickOutsideHandler=this.onClickOutside.bind(this),document.addEventListener("click",this.onClickOutsideHandler,{passive:!0}))}onClickOutside(e){const t=e.target;null===t.closest(`#${this.versionViewer}`)&&null===t.closest(`.${this.viewerActivator}`)&&null!==t.closest(".v-application--wrap")&&this.$emit("close-viewer")}beforeDestroy(){this.onClickOutsideHandler&&document.removeEventListener("click",this.onClickOutsideHandler)}canDeleteVersion(e,t){return!!this.fileRights&&(!this.processedFiles||this.checkFileRight(e.id,o.K.DeleteFileVersion))}canViewVersion(e,t){return!!this.fileRights&&("pdf"===t.fileExtension.toLowerCase()&&(!this.processedFiles||!this.processedFiles[t.id]))}onDownload(e){return`${this.$config.apiPath()}files/${e}`}showVersionRow(e){return!!this.showAllVersions||e<3}onDeleteVersion(e,t){this.deleteVersion&&this.deleteVersion(e,t)}get endVersion(){switch(this.versions.length){case 1:return"я";case 2:case 3:case 4:return"и";default:return"й"}}get textActionPrevious(){return this.showAllVersions?"Скрыть предыдущие":"Показать предыдущие"}get hasActionPrevious(){return this.file&&this.file.versions&&this.file.versions.length>3||this.versions&&this.versions.length>3}toggleAllVersions(){this.showAllVersions=!this.showAllVersions}viewVersion(e,t){this.$log.debug("viewVersion"),this.preview?this.preview(t):this.$log.error("file preview callback is not installed")}checkFileRight(e,t){return this.fileRights&&this.fileRights[e]&&this.fileRights[e].includes(t)}refreshVersions(){return __awaiter(this,void 0,void 0,(function*(){this.loading=!0;const e=new s.MZ(this.file.id);this.versions=yield this.queryBus.exec(e),this.createLowercaseFields(),this.loading=!1}))}createLowercaseFields(){this.versions.forEach((e=>{e.majorVersion=e.MajorVersion,e.sizeKb=e.SizeKb,e.sizeKb&&!e.size&&(e.size=(0,a.MK)(e.sizeKb)),e.lastEditDateTime=e.LastEditDateTime,e.creator=e.Creator,e.id=e.ID,e.createDateTime=e.CreateDateTime}))}};__decorate([(0,p.Prop)(),__metadata("design:type",Object)],h.prototype,"file",void 0),__decorate([(0,p.Prop)(),__metadata("design:type",Array)],h.prototype,"fileVersions",void 0),__decorate([(0,p.Prop)(),__metadata("design:type",Object)],h.prototype,"fileRights",void 0),__decorate([(0,p.Prop)(),__metadata("design:type",Function)],h.prototype,"deleteVersion",void 0),__decorate([(0,p.Prop)(),__metadata("design:type",Function)],h.prototype,"preview",void 0),__decorate([(0,p.Prop)(),__metadata("design:type",Boolean)],h.prototype,"mobile",void 0),__decorate([(0,p.Prop)(),__metadata("design:type",Object)],h.prototype,"processedFiles",void 0),__decorate([(0,p.Prop)(),__metadata("design:type",Number)],h.prototype,"activeVersionId",void 0),__decorate([(0,p.Prop)(),__metadata("design:type",String)],h.prototype,"viewerActivator",void 0),__decorate([(0,u.t)(r.M.IQueryBus),__metadata("design:type",Object)],h.prototype,"queryBus",void 0),__decorate([(0,p.Watch)("file"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],h.prototype,"onFileChanged",null),__decorate([(0,p.Watch)("fileVersions"),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",void 0)],h.prototype,"onFileVersionsChanged",null),h=__decorate([d.default],h);const m=h,f=m;var g=n(51900),y=n(43453),v=n.n(y),b=n(17024),C=n(71100),w=n(57894),_=(0,g.Z)(f,render,i,!1,null,"207a91c3",null);const x=_.exports;v()(_,{VCol:b.Z,VIcon:C.Z,VRow:w.Z})},44122:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Ve});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"workspace-list",attrs:{id:e.containerId}},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.loading}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.filterApplied,expression:"filterApplied"}],ref:"flt",staticClass:"filter-applied sm-text pa-2"},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{"align-self":"center"}},[n("v-row",{attrs:{"no-gutters":""}},[e.filterNameApplied?n("v-col",{staticClass:"mb-1",attrs:{cols:"12"}},[n("span",{staticClass:"caption font-weight-bold"},[e._v(e._s(e.$gettext("Применён фильтр:")))]),e._v(" "),n("span",{staticClass:"caption ml-1"},[e._v(e._s(e.filterNameApplied))]),e._v(" "),n("v-icon",{staticClass:"ml-1",attrs:{size:"13"},on:{click:e.cancelFilter}},[e._v("close")])],1):e._e(),e._v(" "),n("v-col",{staticClass:"mb-1",attrs:{cols:"12"}},[e._l(e.filterParams,(function(t){return[t.value?n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-chip",e._g({staticClass:"params elevation-0 ml-0 mr-1 mb-1",attrs:{"text-color":"white",color:"primary_light",small:"",close:!t.required},on:{"click:close":function(n){return e.closeFilterParam(t)}}},o),[n("span",[e._v(" "+e._s(e.getFilterParamValue(t))+" ")])])]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.tipInfo))])]):e._e()]})),e._v(" "),e.dateRangeChip?n("v-chip",{staticClass:"params elevation-0 ml-0 mr-1 mb-1",attrs:{"text-color":"white",color:"primary_light",small:"",close:""},on:{"click:close":e.cancelDateRange}},[n("span",[e._v(e._s(e.dateRangeChip))])]):e._e()],2),e._v(" "),e.loading?e._e():n("v-col",{attrs:{cols:"12"}},[e.isInstruction?n("span",{staticClass:"caption"},[e._v("\n              "+e._s(e.$gettext("По запросу найдено"))+" "+e._s(e._f("pluralizeNoun")(e.pagerOptions.total,e.$gettext("сообщение"),e.$gettext("сообщения"),e.$gettext("сообщений")))+"\n            ")]):e._e(),e._v(" "),e.isDocument?n("span",{staticClass:"caption"},[e._v("\n              "+e._s(e.pagerOptions.total>1?e.$gettext("По запросу найдено"):e.$gettext("По запросу найден"))+" "+e._s(e._f("pluralizeNoun")(e.pagerOptions.total,e.$gettext("документ"),e.$gettext("документа"),e.$gettext("документов")))+"\n            ")]):e._e()])],1)],1),e._v(" "),n("v-col",{attrs:{cols:"auto ml-auto","align-self":"center"}},[n("v-btn",{attrs:{outlined:"",fab:"",color:"primary",small:""},on:{click:e.cancelAll}},[n("v-icon",[e._v("close")])],1)],1)],1)],1),e._v(" "),n("v-row",{ref:"row",staticStyle:{position:"relative",height:"100px",display:"flex","flex-flow":"column nowrap"},attrs:{"no-gutters":""}},[e.isListMode?n("div",{key:"list",ref:"list",staticClass:"workspace-list__list",attrs:{id:"ws-list"}},[n("data-iterator",{key:"iterator",ref:"iterator",class:{"marginless-list":e.isMobile,"margin-list":!e.preview||!e.isMobile},attrs:{items:e.rows,"removed-item":e.removedItem,page:e.pagerOptions.page,"to-last-page":e.toLastPage,"key-prop":"id",size:e.perPage,"entity-from-item":e.entityOf,"sort-field":e.fetchOptions.sortField,"selected-indices":e.selectedIndices,"first-item-select-counter":e.firstItemSelectCounter,"next-item-select-counter":e.nextItemSelectCounter,"min-row-height":e.minRowHeight,"row-height":"auto","active-item":e.iteratorActiveItem,"fix-top-active-item":e.showActiveItem,padding:e.iteratorPadding,"item-gap":e.preview||e.isMobile?0:5,"scroll-to-active-item":e.preview},on:{"loading-update":e.onIteratorLoadingUpdate,select:e.onItemSelect,dblclick:e.onDblClick,click:e.onClick,page:e.onIteratorPage,"page-items":e.onIteratorPageItems,"total-pages":e.onIteratorTotalPage,"update-enabled-pages":function(t){e.enabledPages=t},"update-to-last-enabled":function(t){e.enableToLastPage=t}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item,i=t.itemContext;return[e._t("listItem",null,{itemInfo:{item:n,itemContext:i,isSelected:e.isSelected,getContext:e.createActionContext}})]}}],null,!0)})],1):e.isTableAndHasData?n("div",{staticClass:"workspace-list__table",attrs:{id:"ws-table"}},[e.showTableToolbar?n("v-row",{key:"acts",staticClass:"table-toolbar elevation-2",attrs:{"no-gutters":""}},[n("div",{staticStyle:{display:"flex","align-items":"center","margin-left":"auto"}},[e.isDocument&&e.checkedListItemsArray.length?n("div",{staticStyle:{display:"none"},attrs:{id:"checkedList"}},e._l(e.checkedListItemsArray,(function(t){return n("document-template-renderer",{key:t.id,attrs:{id:t.id,document:t,"template-type":e.templateType,context:e.actionPanelTableContext,"lazy-card-actions-counter":e.lazyCheckedCardActionsCounter[t.id]},on:{"set-card-actions":function(n){return e.onSetCheckedCardActions(t,n)}}})})),1):e._e(),e._v(" "),e.isDocument&&e.document?n("div",{staticStyle:{display:"none"}},[n("document-template-renderer",{attrs:{document:e.document,"template-type":e.templateType,context:e.actionPanelTableContext,"lazy-card-actions-counter":e.lazyCardActionsCounter},on:{"set-card-actions":e.onSetCardActions,"set-card-actions-overlay":e.onSetCardActionsOverlay}})],1):e._e(),e._v(" "),e.showMultiActionPanel?[n("action-panel",{key:"act-panel1",attrs:{id:"grid-multi-actions-panel",visible:!0,context:e.multiRowContext,loading:e.loading,"custom-actions":e.customMultiActions,"custom-multi-actions":e.entitiesMultiActions}})]:e.showActionPanelGrid?[n("action-panel",{key:"act-panel",attrs:{id:"grid-actions-panel",visible:!0,context:e.actionPanelTableContext,loading:e.loading,"custom-actions":e.customActions,"action-overlays":e.actionOverlays,"lazy-entity-update":e.lazyEntityUpdate},on:{"action-result":e.onActionPanelResult}})]:[n("v-menu",{attrs:{"open-on-click":"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"square-sm-button menu-vert",attrs:{icon:""}},Object.assign({},i)),[n("v-icon",{staticClass:"theme--dark grey--text darken-1",attrs:{medium:""}},[e._v(" more_vert ")])],1)]}}],null,!1,1177356967)},[e._v(" "),n("v-list",[n("v-list-item",{staticClass:"action-panel-menu-item",on:{click:function(t){return e.onExport("excel")}}},[n("v-list-item-title",[e._v(" "+e._s(e.$gettext("Экспорт в .xlsx"))+" ")])],1),e._v(" "),n("v-list-item",{staticClass:"action-panel-menu-item",on:{click:function(t){return e.onExport("word")}}},[n("v-list-item-title",[e._v(" "+e._s(e.$gettext("Экспорт в .docx"))+" ")])],1)],1)],1)]],2)]):e._e(),e._v(" "),e.showActions?n("v-row",{staticStyle:{"margin-left":"auto","align-items":"center",height:"48px"},attrs:{"no-gutters":""}},[n("v-switch",{staticClass:"mr-2 px-0 py-0 mt-0",class:{"blue-label":e.onlyActualFilter},attrs:{label:e.$gettext("Только актуальные"),color:"primary"},on:{change:e.onOnlyActualFilterChanged},model:{value:e.onlyActualFilter,callback:function(t){e.onlyActualFilter=t},expression:"onlyActualFilter"}}),e._v(" "),e.hasEditAction?n("v-btn",{attrs:{text:"",icon:""},on:{click:e.onEditRow}},[n("v-icon",{staticClass:"ml-1"},[e._v("edit")])],1):e._e(),e._v(" "),e.hasRemoveAction?n("v-btn",{attrs:{text:"",icon:""},on:{click:e.onRemoveRow}},[n("v-icon",{staticClass:"ml-1"},[e._v("close")])],1):e._e()],1):e._e(),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"square-sm-button bordered-button white grey--border lighten-2",style:{"margin-top":e.showTableToolbar?"37px":0},attrs:{id:"wshColSetBtn",outlined:"",tile:""},on:{click:function(t){return e.columnSettingsEdit()}}},i),[n("svg-icon",{staticClass:"grey--text darken-3",attrs:{icon:"tableSettings",width:"17",height:"17"}})],1)]}}])},[e._v(" "),n("translate",[e._v("Настроить столбцы")])],1),e._v(" "),e.columnsUpdate?e._e():n("datatable",{ref:"table",staticClass:"material ngx-flex nowrap-text",attrs:{id:"datatable",loadingIndicator:e.loading,columnMode:"standard",groupRowsBy:e.columnsGroupBy,groupExpansionDefault:!0,groupRowHeight:26,sortType:e.sortType,headerHeight:32,rowHeight:26,rows:e.tableRows,"tree-from-relation":e.treeFromRelation,"tree-to-relation":e.treeToRelation,selectionType:"single",checkMode:"checkNoSelect",selected:e.tableSelected,checked:e.tableChecked,selectAllRowsOnPage:!0,rowClass:e.getRowClass,scrollbarH:!0,scrollbarV:!0,count:e.pagerOptions.total,offset:e.pagerOptions.page-1,rowIdentity:e.rowIdentity,sorts:e.tableSortProps,goToFirstAfterSort:!1,externalPager:!0},on:{"row-count":e.onRowCountChanged,reorder:e.onColumnReorder,resize:e.onColumnResize,sort:e.onColumnSort,activate:e.onActivate,select:function(t){return e.onSelectRow(t)},check:function(t){return e.onCheckRow(t)},"tree-action":function(t){return e.onTreeAction(t)},page:function(t){return e.onPage(t)}}},[e.isInstruction||e.isDocument?n("datatable-column",{key:"__check__",attrs:{width:30,sortable:!1,canAutoResize:!1,draggable:!1,resizeable:!1,headerCheckboxable:!0,checkboxable:!0,"frozen-left":e.hasFrozenColumns}}):e._e(),e._v(" "),e._l(e.columns,(function(t){return n("datatable-column",{key:t.prop,attrs:{name:t.name,prop:t.prop,resizeable:t.resizable,visible:t.visible,"is-tree-column":"Название"===t.name&&e.isHierarchicalVoc,"tree-level-indent":20,sortable:t.sortable,width:t.width,draggable:t.draggable,"frozen-left":t.frozen},on:{"update-width":function(n){return e.onColumnWidth(t,n)}},scopedSlots:e._u([{key:"default",fn:function(i){return i.row&&!e.cellValueFunc?[t.formatter?n("span",[e._v(" "+e._s(t.formatter(i.row[t.prop]))+" ")]):t.component?n(t.component.name,e._b({tag:"component",attrs:{value:i.row[t.prop],row:i.row}},"component",t.component.props,!1)):n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:i.row[t.prop]},expression:"{ content: scope.row[column.prop] }"}]},[e._v(e._s(i.row[t.prop]))])]:void 0}}],null,!0)})}))],2)],1):e.isCalendarAndHasData?n("div",{key:"calendar",staticClass:"workspace-list__calendar",attrs:{id:"calendar-list"}},[n("calendar-list",{ref:"calendar",attrs:{items:e.rows,"date-check":e.dateCheck,"start-date":e.startDate,"key-prop":"id","entity-from-item":e.entityOf,preview:e.preview},on:{select:e.onItemSelect,dblclick:e.onDblClick,click:e.onClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item,i=t.itemContext;return[e._t("listItem",null,{itemInfo:{item:n,mode:e.calendarListItemMode,itemContext:i,isSelected:e.isSelected,getContext:e.createActionContext}})]}}],null,!0)})],1):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isNoneState,expression:"!isNoneState"}],staticClass:"workspace-list__list emptybox"},[e.isErrorState?n("span",{staticClass:"emptybox-text"},[e._v(e._s(e.errorMessage))]):e.isSelectState?n("span",{staticClass:"emptybox-text"},[e._v(e._s(e.selectFolderMessage))]):e.isLoadingState?n("span",{staticClass:"emptybox-text"},[e._v(e._s(e.loadingMessage))]):e.isEmptyState?n("span",{staticClass:"emptybox-text"},[e._v(e._s(e.emptyFolderMessage)+"\n        "),n("br"),e._v(" "),n("v-row",{attrs:{justify:"center"}},[e.isEmptyState&&e.useUnreadOnlyFilter&&e.unreadOnlyFilter?n("v-btn",{staticClass:"mt-1 ml-0 font-weight-bold primary--text",attrs:{text:""},on:{click:e.unreadFilterChange}},[n("translate",[e._v("Показать все")])],1):e._e()],1)],1):n("span")])]),e._v(" "),e.isFooterShow?n("v-row",{staticClass:"workspace-list__footer pt-0 grey--border lighten-2",attrs:{"no-gutters":""}},[e.isPagerShow?n("pager",{staticClass:"pt-1 pb-1",attrs:{disabled:!e.loading,options:e.pagerOptions,preview:e.preview,sizes:e.rowsPerPage,"fixed-page-size":e.fixedPageSize,"count-pages":e.totalPages,"last-page-unknown":e.lastPageUnknown,"enabled-pages":e.enabledPages,"first-visible":e.firstVisibleItem,"last-visible":e.lastVisibleItem,"content-type":e.contentType,"to-last":e.enableToLastPage},on:{change:e.onChangePage}}):e._e()],1):e._e()],1)},i=[],o=n(95289),s=n(2557),r=n(97625),a=n(22402),l=n(10637),c=n(40471),d=n(50633),u=n(72835),p=n(42256),h=n(50103),m=n(84337),f=n(69332),g=n(45569),y=n(1869),v=n(508),b=n(18220),C=n(69585),w=n(83273),_=n(74769),x=n(69548),S=n(92673),iteratorVirtualvue_type_template_id_bc451a00_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"data-iteraror"},[e.fixedTopContext?n("div",{staticClass:"top-fixed-item-wrapper"},[n("iterator-item",{staticClass:"top-fixed-item",attrs:{id:"idx"+e.fixedTopContext.rowIndex,"data-uid":e.id(e.fixedTopContext.row),"data-test-id":"topFixedIeratorItem"},on:{click:function(t){return e.onClick(e.fixedTopContext.row)},dblclick:function(t){return e.onClick(e.fixedTopContext.row)},"update-height":e.onUpdateFixedTopHeight}},[e._t("default",[e._v(" "+e._s(e.entityFromItem(e.fixedTopContext.row)[e.keyProp])+" ")],null,{item:e.fixedTopContext.row})],2)],1):e._e(),e._v(" "),n("div",{ref:"list",staticClass:"iterator-list",attrs:{id:"iterator-list"}},[n("div",{ref:"scroller",staticClass:"scroller",class:{mobile:e.isMobile},style:e.scrollerStyles},e._l(e.visibleItems,(function(t){return n("iterator-item",{key:e.id(t.row),staticClass:"item",class:{"active-list-item":e.isItemActive(t),mobile:e.isMobile,blink:e.isItemRemoving(t)},style:e.itemStyles(t),attrs:{id:"idx"+t.rowIndex,"data-uid":e.id(t.row),"refresh-counter":e.refreshCounter,"data-test-id":"iteratorItem"},on:{click:function(n){return e.onClick(t)},dblclick:function(n){return e.onClick(t)},"update-height":function(n){return e.onUpdateItemHeight(t,n)}}},[e._t("default",[e._v("\n          "+e._s(e.entityFromItem(t.row)?e.entityFromItem(t.row)[e.keyProp]:"empty item")+"\n        ")],null,{item:t.row})],2)})),1)])])},I=[],D=n(31025),R=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const T="update-height",P=20;let O=class DataVirtualItemComponent extends R.Vue{constructor(){super(...arguments),this.height=0,this.width=0}onRefreshCounterChanged(){this.$emit(T,this.$el.clientHeight)}mounted(){this.setupResizeObserver(),this.elem=this.$el,this.resizeObserver.observe(this.$el)}beforeUpdate(){this.elem!==this.$el&&(this.resizeObserver.unobserve(this.elem),this.setupResizeObserver(),this.resizeObserver.observe(this.$el))}beforeDestroy(){this.resizeObserver.unobserve(this.$el)}setupResizeObserver(){const e=this;this.resizeObserver=new window.ResizeObserver((t=>{let n=0;t.length&&t[0].contentRect?(n=t[0].contentRect.height,e.width=t[0].contentRect.width):(n=e.$el.clientHeight,e.width=e.$el.clientWidth),n>P&&n!==e.height&&(e.height=n,e.$emit(T,e.height))}))}};__decorate([(0,R.Prop)(),__metadata("design:type",Number)],O.prototype,"refreshCounter",void 0),__decorate([(0,R.Watch)("refreshCounter"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],O.prototype,"onRefreshCounterChanged",null),O=__decorate([(0,R.Component)({template:'<div @click="$emit(\'click\', $event)" @dblclick="$emit(\'dblclick\', $event)">\n                <slot />\n                \x3c!-- <div :style="pointerStyles"></div>--\x3e\n             </div>'})],O);const k=O;var F=n(13319);const A={},$="undefined"!==typeof document?document.createElement("div").style:void 0,j=function(){const e="undefined"!==typeof window?window.getComputedStyle(document.documentElement,""):void 0,t="undefined"!==typeof e?Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/):null,n=null!==t?t[1]:void 0,i="undefined"!==typeof n?"WebKit|Moz|MS|O".match(new RegExp("("+n+")","i"))[1]:void 0;return i?{dom:i,lowercase:n,css:`-${n}-`,js:n[0].toUpperCase()+n.substr(1)}:void 0}();function getVendorPrefixedName(e){const t=(0,F.eV)(e);return A[t]||(void 0!==j&&void 0!==$[j.css+e]?A[t]=j.css+e:void 0!==$[e]&&(A[t]=e)),A[t]}const E="undefined"!==typeof window?getVendorPrefixedName("transform"):void 0,M="undefined"!==typeof window?getVendorPrefixedName("backfaceVisibility"):void 0,N="undefined"!==typeof window?Boolean(getVendorPrefixedName("transform")):void 0,V="undefined"!==typeof window?Boolean(getVendorPrefixedName("perspective")):void 0,B="undefined"!==typeof window?window.navigator.userAgent:"Chrome",L=B.includes("Safari/")&&!B.includes("Chrome/");function translateXY(e,t,n){"undefined"!==typeof E&&N?!L&&V?(e[E]=`translate3d(${t}px, ${n}px, 0)`,e[M]="hidden"):e[(0,F.eV)(E)]=`translate(${t}px, ${n}px)`:(e.top=`${n}px`,e.left=`${t}px`)}var U,iteratorVirtualvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},iteratorVirtualvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};(function(e){e[e["None"]=0]="None",e[e["Page"]=1]="Page",e[e["ActiveRow"]=2]="ActiveRow",e[e["DoubleCheck"]=3]="DoubleCheck"})(U||(U={}));const H="total-pages";let Q=0,z=0,Z=class DataVirtualIteratorComponent extends R.Vue{constructor(){super(...arguments),this.clicks=0,this.scrollbarV=!0,this.innerWidth=0,this.bodyHeight=0,this.offsetY=0,this.currentPage=0,this.activeRowIndex=-1,this.oldRowCount=0,this.rowContexts=[],this.visibleItems=[],this.afterEmptyItems=[],this.beforeEmptyItems=[],this.rowHeightsUpdate=[],this.lastRowOffsetY=0,this.enabledPages=null,this.itemsWaitingHeight=new Set,this.refreshCounter=0,this.fixedTopContext=null,this.firstVisible=0,this.lastVisible=0,this.loading=!1,this.scrollTo=U.None,this.removingIndex=-1,this.changedItemsPromise=Promise.resolve()}onLoadingChanged(){this.$emit("loading-update",this.loading)}onItemsChanged(e,t){return __awaiter(this,void 0,void 0,(function*(){if(e!==t){this.visibleItems=[],this.rowContexts=[],e!==t&&(yield this.$nextTick()),this.rowsChanged=!0,this.init(),this.sort(),this.oldRowCount=this.rowContexts.length,this.offsetY=-1,this.currentPage=-1,this.totalPages=this.rowCount&&this.page>=0?this.page+1:1,this.$emit(H,this.totalPages),this.listEl.scrollTop=0,e!==t&&(this.listEl.style["visibility"]="hidden"),this.waitingForFirstPageRendered=!0,z=0,Q=0,this.rowContexts.length?this.renderPromise=new Promise((e=>{this.renderResolve=e})):this.renderPromise=Promise.resolve();try{yield this.renderPromise,this.firstItemSelectCounter&&this.setSelected(0)}finally{this.listEl&&(this.listEl.style["visibility"]="unset"),this.waitingForFirstPageRendered=!1,this.rowContexts.length&&this.onPageChanged()}}else{yield this.changedItemsPromise;let t="updated";if(e.length<this.oldRowCount?t="removed":e.length>this.oldRowCount&&(t="added"),"removed"===t&&this.removedItem&&(this.changedItemsPromise=this.removeItem(),yield this.changedItemsPromise,this.removingIndex=-1),this.rowContexts.forEach(((t,n)=>{e[t.index]&&(t.row=e[t.index])})),"added"===t){const t=e.length-this.oldRowCount;for(let n=0;n<t;n++){const t=this.rowContexts[this.oldRowCount-1+n];this.rowContexts.push({index:this.oldRowCount+n,rowIndex:this.oldRowCount+n,offsetY:t?t.offsetY+this.approximateRowHeight:0,row:e[this.oldRowCount+n],rowHeight:this.approximateRowHeight})}this.sort(),this.updateRows(!0)}this.oldRowCount=this.rowContexts.length}}))}onScrollHeightChanged(){this.calcTotalPages()}onFixTopActiveItemChanged(){return __awaiter(this,void 0,void 0,(function*(){if(this.activeItem||this.fixTopActiveItem){if(this.fixTopActiveItem?this.fixedTopContext=this.excludeItem(this.activeItem):(this.includeItem(this.fixedTopContext),this.fixedTopContext=null),yield this.$nextTick(),this.listEl){const e=this.listEl.getBoundingClientRect();this.innerWidth=Math.floor(e.width),this.bodyHeight=e.height}this.updateRows(!0),this.updatePage(),yield this.$nextTick(),this.calcTotalPages()}}))}onMinRowHeightChanged(){this.onItemsChanged(this.items,null)}onPageChanged(){if(this.page===this.currentPage||this.waitingForFirstPageRendered||void 0===this.waitingForFirstPageRendered)return;if(Q=0,this.rowCount&&!this.visibleItems.length||!this.listEl)return this.callOnPageChanged=!0,void this.startCheckAllRowsIsRendered();let e=(this.page-1)*this.bodyHeight;e+=1;const t=Math.abs(this.currentPage-this.page);let n=this.getRowIndex(e);this.firstRowForPage=n,this.scrollTo=U.Page;const i=Math.min(n+this.visibleItems.length-1,this.rowHeightsUpdate.length-1);!(t>1||this.toLastPage&&!this.scrollToActiveItem)||this.rowHeightsUpdate[n]&&this.rowHeightsUpdate[i]||(this.loading=!0,n=this.getRowIndexByAverage(e),n>=this.items.length-1&&(n=this.items.length-10),this.firstRowForPage=n);const o=this.rowContexts[n];this.fromPager=!0,this.scrollToActiveItem&&this.currentPage<0&&(this.scrollTo=U.ActiveRow,this.firstRowForPage=null),this.currentPage=this.page,o&&(this.listEl.scrollTop=o.offsetY,this.shouldSetActiveRow&&(this.shouldSetActiveRow=!1,this.setSelected(n))),this.startCheckAllRowsIsRendered()}onSortFieldChanged(e,t){(null===e||void 0===e?void 0:e.cellName)===(null===t||void 0===t?void 0:t.cellName)&&(null===e||void 0===e?void 0:e.isAsc)===(null===t||void 0===t?void 0:t.isAsc)||(this.sort(),this.updateRows(!0))}onSelectedIndicesChanged(){if(Array.isArray(this.selectedIndices)&&this.selectedIndices.length){const e=this.selectedIndices[0],t=this.rowContexts.findIndex((t=>t.index===e));t>=0&&(this.activeRowIndex=t)}else this.activeRowIndex=-1}onFirstItemSelectCounterChanged(){return __awaiter(this,void 0,void 0,(function*(){yield this.renderPromise,this.setSelected(0)}))}onNextItemSelectCounterChanged(){this.activeRowIndex+1<this.rowContexts.length&&this.setSelected(this.activeRowIndex+1)}onInnerWidthChanged(e,t){return __awaiter(this,void 0,void 0,(function*(){t&&(this.updateRowOffsetsCache(0,!0),this.updateRows(!0),this.updatePage(),yield this.$nextTick(),this.calcTotalPages())}))}mounted(){window.ResizeObserver&&(this.resizeObserver=new window.ResizeObserver((e=>{e.length&&e[0].contentRect?(this.bodyHeight=e[0].contentRect.height,this.innerWidth=e[0].contentRect.width):(this.bodyHeight=this.$el.clientHeight,this.innerWidth=this.$el.clientWidth)})),this.resizeObserver.observe(this.$el)),this.listEl=this.$el.querySelector("#iterator-list");const e=this.listEl.getBoundingClientRect();this.innerWidth=Math.floor(e.width),this.bodyHeight=e.height,this.init(),this.offsetY=0,this.currentPage=-1,this.totalPages=1,this.onKeyDownHandler=this.onKeyDown.bind(this),document.addEventListener("keydown",this.onKeyDownHandler),this.tick()}beforeDestroy(){document.removeEventListener("keydown",this.onKeyDownHandler),this.resizeObserver&&this.resizeObserver.unobserve(this.$el)}tick(e=!1){if(requestAnimationFrame((()=>this.tick())),this.loading=this.waitingForFirstPageRendered||Boolean(this.scrollTo!==U.None),this.scrollbarV){if(!this.listEl)return;const t=this.listEl.scrollTop;if(!e&&this.offsetY===t)return;this.offsetY=t,clearTimeout(this.updatePageTimeoutId),this.scrollTo===U.Page?setTimeout((()=>this.updateRows()),10):this.updateRows(),this.updatePageTimeoutId=setTimeout((()=>this.updatePage()),100)}}isItemActive(e){return e.row===this.activeItem}isItemRemoving(e){return e.rowIndex===this.removingIndex}onClick(e){this.clicks++,1===this.clicks?this.timerId=setTimeout((()=>{this.$emit("click",e.row,e.index),this.clicks=0}),200):(clearTimeout(this.timerId),this.$emit("dblclick",e.row,e.index),this.clicks=0),this.setSelected(e.rowIndex)}onFocus(){this.isFocused=!0}onBlur(){this.isFocused=!1}onUpdateFixedTopHeight(e){this.fixedTopContext&&(this.fixedTopContext.rowHeight=e)}onUpdateItemHeight(e,t){try{if(t+=this.itemGap,this.rowHeightsUpdate[e.rowIndex]&&e.rowHeight===t)return;e.rowHeight=t,this.itemsWaitingHeight.delete(e.rowIndex),0===e.rowIndex&&(e.offsetY=0),clearTimeout(this.waitForAllRowsUpdatedTimer),this.waitForAllRowsUpdatedTimer=setTimeout((()=>{this.itemsWaitingHeight.size&&z<50?z++:this.waitingForFirstPageRendered?this.renderResolve():this.startCheckAllRowsIsRendered()}),50)}finally{this.rowHeightsUpdate[e.rowIndex]=!0,this.itemsWaitingHeight.size||this.updateRowOffsetsCache(this.firstVisible,!0)}}startCheckAllRowsIsRendered(e){this.stopCheckAllRowsIsRendered(),this.checkRowsUpdatedTimer=setTimeout((()=>this.checkRowsUpdated()),null!==e&&void 0!==e?e:50)}stopCheckAllRowsIsRendered(){clearTimeout(this.checkRowsUpdatedTimer)}checkRowsUpdated(){var e,t;if(this.itemsWaitingHeight.size||!this.listEl)return Q++,Q>50&&(this.itemsWaitingHeight.clear(),this.updateRowOffsetsCache(0,!0)),void this.startCheckAllRowsIsRendered();if(this.stopCheckAllRowsIsRendered(),this.$log.debug("checkRowsUpdated"),this.fromPager=!1,this.callOnPageChanged)return this.callOnPageChanged=!1,void this.$nextTick((()=>this.onPageChanged()));if(this.scrollTo===U.DoubleCheck){let t=null!==(e=this.firstRowForPage)&&void 0!==e?e:this.activeRowIndex;if((null===t||void 0===t||t<0)&&(this.onSelectedIndicesChanged(),t=this.activeRowIndex,this.setSelected(t)),t>=0&&this.rowHeightsUpdate[t]){const e=this.rowContexts[t],n=this.listEl,i=n.scrollTop+this.bodyHeight;e.offsetY>=n.scrollTop&&e.offsetY+e.rowHeight<=i?(this.scrollTo=U.None,this.firstRowForPage=null,this.updatePage(),this.toLastPage&&this.currentPage<this.totalPages&&Q<10&&(Q++,this.scrollTo=U.Page,this.firstRowForPage=this.rowCount-5)):n.scrollTop=e.offsetY}else this.scrollTo=U.None}if(this.scrollTo===U.Page||this.scrollTo===U.ActiveRow){let e=this.firstRowForPage;if(this.scrollTo===U.ActiveRow&&(this.activeRowIndex<0&&(this.onSelectedIndicesChanged(),this.setSelected(this.activeRowIndex)),e=this.activeRowIndex),this.scrollTo=U.DoubleCheck,e>=0){const n=this.rowContexts[e],i=this.listEl;i.scrollTop=null!==(t=null===n||void 0===n?void 0:n.offsetY)&&void 0!==t?t:0}}this.scrollTo!==U.None&&this.startCheckAllRowsIsRendered(100)}updateRowOffsetsCache(e,t){let n=this.rowContexts[e];if(!n)return;let i=n.offsetY,o=0;const s=t?this.rowContexts.length:this.lastVisible+1;while(n&&e<s)n.offsetY=i,this.rowContexts[e]=n,o=n.rowHeight,i+=o,e++,n=this.rowContexts[e];this.lastRowOffsetY=i}itemStyles(e){const t={};if(0===e.rowIndex)return translateXY(t,0,0),t;if(e.offsetY)return translateXY(t,0,e.offsetY),t;const n=this.rowContexts[e.rowIndex].offsetY;return translateXY(t,0,n),t}topFixedStyles(){var e;return{height:(null===(e=this.fixedTopContext)||void 0===e?void 0:e.rowHeight)+"px"}}emptyItemStyles(e){const t={height:e.rowHeight+"px"};return e.offsetY&&translateXY(t,0,e.offsetY),t}onKeyDown(e){var t;if(["ArrowUp","PageUp","ArrowDown","PageDown"].includes(e.code)&&(e.preventDefault(),e.stopPropagation()),["PageUp","PageDown"].includes(e.code)){if("PageUp"===e.code&&this.currentPage>0)return this.shouldSetActiveRow=!0,void this.$emit("page",this.currentPage-1);if("PageDown"===e.code&&this.currentPage<this.totalPages)return this.shouldSetActiveRow=!0,void this.$emit("page",this.currentPage+1)}let n=-1;const i=null===(t=this.rowContexts[this.rowContexts.length-1])||void 0===t?void 0:t.rowIndex;switch(e.code){case"ArrowUp":this.activeRowIndex>0&&(n=this.activeRowIndex-1);break;case"ArrowDown":this.activeRowIndex<this.rowContexts.length-1&&(n=this.activeRowIndex+1);break}if(n<0||n>i)return;const{offsetY:o,rowHeight:s}=this.rowContexts[n];if(!s)return;let r=0,a=this.listEl.scrollTop;"ArrowDown"===e.code?r=o+s-(a+this.bodyHeight):"ArrowUp"===e.code&&(r=o-s-a),r>0&&"ArrowDown"===e.code||r<0&&"ArrowUp"===e.code?a+=r:0===r&&"ArrowUp"===e.code&&[0,1,2].includes(this.activeRowIndex)&&(a=r),this.listEl.scrollTop=a,this.setSelected(n)}calcTotalPages(){let e=this.bodyHeight?this.scrollHeight/this.bodyHeight:1;const t=Math.floor(e),n=e-t,i=this.getAverageItemHeight();return e=n>=i/this.scrollHeight?Math.ceil(e):t,this.totalPages!==e&&(this.totalPages=e,this.$emit(H,e)),!this.scrollToActiveItem&&this.toLastPage&&this.currentPage<this.totalPages&&this.$emit("page",this.totalPages),e}updatePage(){var e;if(this.fromPager||this.currentPage<0||this.firstRowForPage||this.callOnPageChanged)return;let t,n=this.lastVisible;for(let e=this.lastVisible;e>=0;e--){const t=this.rowContexts[e];if(!t)throw new Error("nullll rowContext");if(this.offsetY+this.bodyHeight>=t.offsetY){n=e;break}}if(n>=this.rowCount-1||this.scrollHeight-this.bodyHeight===this.offsetY)t=this.totalPages,this.$emit(H,this.totalPages);else{const n=this.getRowIndex(this.offsetY),i=this.rowContexts&&this.rowContexts.length>n?null===(e=this.rowContexts[n])||void 0===e?void 0:e.rowHeight:this.approximateRowHeight;t=(this.offsetY+2*i)/this.bodyHeight,t=t<1?1:Math.ceil(t)}this.currentPage!==t&&(this.currentPage=t,this.$emit("page",t))}init(){var e;(null===(e=this.items)||void 0===e?void 0:e.length)?(this.rowContexts=new Array(this.items.length).fill(null),this.rowContexts.forEach(((e,t)=>{const n=0===t?0:this.rowContexts[t-1].offsetY+this.approximateRowHeight;this.$set(this.rowContexts,t,{offsetY:n,row:this.items[t],rowIndex:t,index:t,rowHeight:this.approximateRowHeight})})),this.rowHeightsUpdate=new Array(this.rowCount)):(this.rowContexts=[],this.rowHeightsUpdate=[]),this.itemsWaitingHeight.clear()}updateRows(e=!1,t=!1){return __awaiter(this,void 0,void 0,(function*(){const{first:t,last:n}=this.getIndexes();if(n<t)return;if(!e&&!this.rowsChanged&&this.firstVisible===t&&this.lastVisible===n)return;this.rowsChanged=!1,this.firstVisible=t,this.lastVisible=n;let i=t,o=0;const s=new Array(n-t);while(i<=n&&i<this.rowCount){const e=this.rowContexts[i];e&&(s[o]=e,o++,this.fixedRowHeight||this.rowHeightsUpdate[i]||this.itemsWaitingHeight.add(i)),i++,i%50===0&&(yield this.$nextTick())}this.pageSize=s.length-1,this.visibleItems=s}))}getIndexes(){let e=-1,t=-1;if(!this.rowContexts.length)return{first:e,last:t};if(this.scrollbarV){e=this.getRowIndex(this.offsetY),e=Math.max(e-1,0);while(e>0){if(this.rowHeightsUpdate[e-1])break;e--}for(let n=e;n<this.rowContexts.length;n++){const e=this.rowContexts[n];if(!e)throw new Error("nullll");if(-1===t&&this.offsetY+this.bodyHeight<=e.offsetY){t=n;break}}}return t=t>0?t:this.rowContexts.length-1,{first:e,last:t}}getRowIndexByAverage(e){if(0===e||!this.visibleItems.length)return 0;const t=this.getAverageItemHeight();return Math.floor(e/t)}getAverageItemHeight(){let e=0;for(const t of this.visibleItems)e+=t.rowHeight;return this.visibleItems.length?e/this.visibleItems.length:0}getRowIndex(e){if(0===e)return 0;let t=Math.floor(e/this.approximateRowHeight);t=t>=this.rowCount?this.rowCount-1:t;let n=0;const i=10;for(let o=t;o>0;o--)if(n=o,this.rowHeightsUpdate[o]&&this.rowContexts[o].offsetY-i<=e)return n;return 0}setSelected(e){if(e>=0){const t=this.rowContexts[e];t&&this.$emit("select",t.row,t.index)}}sort(){var e;(null===(e=this.rowContexts)||void 0===e?void 0:e.length)&&this.sortField&&this.entityFromItem&&(this.rowContexts.sort(((e,t)=>{try{const n=this.entityFromItem(e.row),i=this.entityFromItem(t.row);if(n&&i){let e=0;return e=this.sortField.isDate?D.C.compare(n[this.sortField.cellName],i[this.sortField.cellName]):n[this.sortField.cellName]?n[this.sortField.cellName].localeCompare(i[this.sortField.cellName]||""):-1,this.sortField.isAsc?e:-1*e}return 0}catch(e){this.$log.error(e)}})),this.rowContexts.forEach(((e,t)=>{e.rowIndex=t})),this.rowContexts[0].offsetY=0,this.updateRowOffsetsCache(0,!0))}id(e){const t=this.entityFromItem(e);return t?t[this.keyProp]:null}removeItem(){if(!this.removedItem)return Promise.resolve();const e=this.rowContexts.find((e=>e.index===this.removedItem.index));return e?(this.removingIndex=e.rowIndex,new Promise((t=>{setTimeout((()=>{e&&this.rowContexts.splice(e.rowIndex,1);for(const t of this.rowContexts)t.rowIndex>=e.rowIndex&&t.rowIndex--,t.index>this.removedItem.index&&t.index--;const n=e.rowIndex-1>=0?e.rowIndex-1:0;0===n&&this.rowContexts.length&&(this.rowContexts[0].offsetY=0),this.updateRowOffsetsCache(n,!0),this.updateRows(!0),t()}),500)}))):void 0}excludeItem(e){const t=this.rowContexts.findIndex((t=>t.row===e));if(t){const e=this.rowContexts[t];return this.rowContexts.splice(t,1),e}return null}includeItem(e){e&&this.rowContexts.splice(e.rowIndex,0,e)}get listStyles(){return{"padding-left":this.padding+"px","padding-right":this.padding+"px"}}get rowCount(){var e,t;return null!==(t=null===(e=this.rowContexts)||void 0===e?void 0:e.length)&&void 0!==t?t:0}get approximateRowHeight(){var e;return this.fixedRowHeight?this.rowHeight+this.itemGap:null!==(e=this.minRowHeight)&&void 0!==e?e:50}get fixedRowHeight(){return"number"===typeof this.rowHeight}get scrollHeight(){if(!this.bodyHeight)return 0;let e=0;if(this.scrollbarV&&this.rowCount)if(this.fixedRowHeight&&"number"===typeof this.rowHeight){const t=this.rowHeight;e=t*this.rowCount}else if(Array.isArray(this.rowContexts)&&this.rowContexts.length){const t=this.rowContexts[this.rowCount-1];e=(null===t||void 0===t?void 0:t.offsetY)+(null===t||void 0===t?void 0:t.rowHeight),e=Math.max(e,this.lastRowOffsetY-this.itemGap)}return e||(e=this.approximateRowHeight*this.rowCount),e}get scrollerStyles(){return{height:(this.scrollHeight||this.approximateRowHeight*this.rowCount)+"px",width:"100%"}}get hasActions(){return this.approximateRowHeight>80}};iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)({type:Array,default:()=>[]}),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Array)],Z.prototype,"items",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Number)],Z.prototype,"page",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)({required:!0}),iteratorVirtualvue_type_script_lang_js_metadata("design:type",String)],Z.prototype,"keyProp",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Object)],Z.prototype,"sortField",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)({type:Function,required:!0}),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function)],Z.prototype,"entityFromItem",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)({type:Array,default:()=>[]}),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Array)],Z.prototype,"selectedIndices",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Number)],Z.prototype,"firstItemSelectCounter",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Number)],Z.prototype,"nextItemSelectCounter",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Number)],Z.prototype,"minRowHeight",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Object)],Z.prototype,"rowHeight",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Object)],Z.prototype,"activeItem",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Boolean)],Z.prototype,"fixTopActiveItem",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Number)],Z.prototype,"padding",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)({default:5}),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Number)],Z.prototype,"itemGap",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)({default:!1}),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Boolean)],Z.prototype,"toLastPage",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Boolean)],Z.prototype,"scrollToActiveItem",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Prop)(),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Object)],Z.prototype,"removedItem",void 0),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("loading"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",void 0)],Z.prototype,"onLoadingChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("items",{immediate:!0}),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[Array,Array]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",Promise)],Z.prototype,"onItemsChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("scrollHeight"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",void 0)],Z.prototype,"onScrollHeightChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("fixTopActiveItem"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",Promise)],Z.prototype,"onFixTopActiveItemChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("minRowHeight"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",void 0)],Z.prototype,"onMinRowHeightChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("page"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",void 0)],Z.prototype,"onPageChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("sortField"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[Object,Object]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",void 0)],Z.prototype,"onSortFieldChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("selectedIndices",{immediate:!0}),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",void 0)],Z.prototype,"onSelectedIndicesChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("firstItemSelectCounter"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",Promise)],Z.prototype,"onFirstItemSelectCounterChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("nextItemSelectCounter"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",void 0)],Z.prototype,"onNextItemSelectCounterChanged",null),iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Watch)("innerWidth"),iteratorVirtualvue_type_script_lang_js_metadata("design:type",Function),iteratorVirtualvue_type_script_lang_js_metadata("design:paramtypes",[Number,Number]),iteratorVirtualvue_type_script_lang_js_metadata("design:returntype",Promise)],Z.prototype,"onInnerWidthChanged",null),Z=iteratorVirtualvue_type_script_lang_js_decorate([(0,R.Component)({components:{"iterator-item":k}})],Z);const W=Z,q=W;var G=n(51900),K=(0,G.Z)(q,iteratorVirtualvue_type_template_id_bc451a00_scoped_true_render,I,!1,null,"bc451a00",null);const Y=K.exports;var J=n(80055),X=n(71148),ee=n(67472),excel_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};function toExcel(e,t,i,o,s){return excel_awaiter(this,void 0,void 0,(function*(){if(!Array.isArray(i)||!Array.isArray(o))return;i=i.filter((e=>e.visible));const r=yield n.e(1411).then(n.t.bind(n,91411,23)),a=yield r.default.fromBlankAsync(),l=a.sheet("Sheet1");let c=1;if(e){const t=l.row(1).cell(1);t.style({bold:!0,verticalAlignment:"center",horizontalAlignment:"center",wrapText:!0});const n=l.row(1).cell(i.length);l.range(t,n).merged(!0),t.value(e),c++}if(t){const e=l.row(2).cell(1);e.style({bold:!0,verticalAlignment:"center",horizontalAlignment:"center",wrapText:!0});const n=l.row(2).cell(i.length);l.range(e,n).merged(!0),e.value(t),c++}i.forEach(((e,t)=>{const n=l.row(c).cell(t+1);n.value(e.name),n.style({border:!0,bold:!0,verticalAlignment:"center",horizontalAlignment:"center",wrapText:!0});const i=e.width?e.width/7:25;l.column(t+1).width(i||25).hidden(!1)})),o.forEach(((e,t)=>{const n=l.row(c+t+1);i.forEach(((t,i)=>{const o=t.printValue?t.printValue(t,e):e[t.prop],s=n.cell(i+1);s.value(o);let r="left",a="";switch(t.columnType){case ee.cV.Number:r="number"===typeof o?"right":"left";break;case ee.cV.Other:r="string"===typeof o?"left":"right";break;case ee.cV.Date:case ee.cV.DateTime:a="dd.mm.yyyy",r="center";break;default:break}s.style({border:!0,verticalAlignment:"top",horizontalAlignment:r,numberFormat:a,wrapText:!0})}))}));const d=yield a.outputAsync();if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(d,s?`${s}.xlsx`:"out.xlsx");else{const e=window.URL.createObjectURL(d),t=document.createElement("a");document.body.appendChild(t),t.href=e,t.download=s?`${s}.xlsx`:"out.xlsx",t.click(),window.URL.revokeObjectURL(e),document.body.removeChild(t)}return!0}))}const te={hassheafs:{printIfTrue:"Связан",printIfFalse:"",condition:e=>Number(e)},hasfiles:{printIfTrue:"Без файлов",printIfFalse:"",condition:e=>!Number(e)},overtime:{printIfTrue:"Просрочен",printIfFalse:"",condition:e=>Number(e)},iscontrol:{printIfTrue:"Контроль",printIfFalse:"",condition:e=>Boolean(e)},hasnotes:{printIfTrue:"Да",printIfFalse:"",condition:e=>Number(e)},executors:{printIfTrue:"Ответственный",printIfFalse:"",condition:e=>Number(e)}};function printValue(e,t){let n=t[e.prop];if(e.prop.toLowerCase()in te){const t=te[e.prop.toLowerCase()];n=t.condition(n)?t.printIfTrue:t.printIfFalse}if([ee.cV.Date,ee.cV.DateTime].includes(e.columnType))if("string"===typeof n)try{n=new Date(n).toLocaleString()}catch(i){n=t[e.prop]}else n instanceof Date&&(n=n.toLocaleString());return n.toString()}var ne=n(93162),word_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};function tableToWord(e,t,i,o,s){return word_awaiter(this,void 0,void 0,(function*(){if(!Array.isArray(i)||!Array.isArray(o))return;const r=yield n.e(3050).then(n.t.bind(n,23050,23));i=i.filter((e=>e.visible));const a=[];i.forEach(((e,t)=>{a.push(new r.TableCell({children:[new r.Paragraph({text:e.name,heading:r.HeadingLevel.HEADING_6,alignment:r.AlignmentType.CENTER})],verticalAlign:r.VerticalAlign.CENTER}))}));const l=[];o.forEach(((e,t)=>{const n=[];i.forEach(((t,i)=>{const o=t.printValue?t.printValue(t,e):e[t.prop];let s=r.AlignmentType.LEFT;switch(t.columnType){case ee.cV.Number:s=r.AlignmentType.RIGHT;break;case ee.cV.Date:case ee.cV.DateTime:s=r.AlignmentType.CENTER;break;default:break}n.push(new r.TableCell({children:[new r.Paragraph({text:o,alignment:s})],verticalAlign:r.VerticalAlign.CENTER}))})),l.push(new r.TableRow({children:n}))}));const c=new r.Table({rows:[new r.TableRow({children:[...a],tableHeader:!0}),...l]}),d={size:{orientation:r.PageOrientation.LANDSCAPE},properties:{page:{size:{orientation:r.PageOrientation.LANDSCAPE}}},children:[e?new r.Paragraph({alignment:r.AlignmentType.CENTER,children:[new r.TextRun({text:e,bold:!0})]}):void 0,t?new r.Paragraph({alignment:r.AlignmentType.CENTER,children:[new r.TextRun({text:t,bold:!0})]}):void 0,c]},u=new r.Document({title:s,sections:[d]});r.Packer.toBlob(u).then((e=>((0,ne.saveAs)(e,`${s}.docx`),null))).catch((e=>{console.error(e)}))}))}var ie=n(24377),calendarListvue_type_template_id_14d93006_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{ref:"wrapper",staticClass:"calendar pa-0"},[n("v-row",{staticClass:"justify-space-between",attrs:{"no-gutters":""}},e._l(e.days,(function(t,i){return n("v-col",{key:t.sDay},[n("div",{staticClass:"day"},[n("div",{staticClass:"day__caption"},[n("div",{staticClass:"font-weight-bold body-2 mr-1",class:{"primary--text":e.isToday(t)}},[e._v("\n            "+e._s(e.getFormatDate(t.sDate))+"\n            "),t.tDay?[e._v(" / "+e._s(e.getFormatDate(t.tDate))+" ")]:e._e(),e._v("\n            "+e._s(e.getMonth(t))+"\n          ")],2),e._v(" "),e.getItemsCount(i)?n("div",{staticClass:"day__caption-items-count"},[e._v(e._s(e.getItemsCount(i)))]):e._e()]),e._v(" "),n("div",{staticClass:"day__list"},e._l(e.itemsByDays[i],(function(t){return n("div",{key:e.id(t),staticClass:"day__list-item",attrs:{"data-uid":e.id(t),"data-test-id":"iteratorItem"},on:{click:function(n){return e.onClick(t)},dblclick:function(n){return e.onClick(t)}}},[e._t("default",[e._v(" "+e._s(e.entityFromItem(t)[e.keyProp])+" ")],{item:t})],2)})),0)])])})),1)],1)},oe=[],calendarListvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},calendarListvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let se=class CalendarListComponent extends R.Vue{constructor(){super(...arguments),this.days=[],this.itemsByDays=[],this.clickCounter=0,this.MONTH=[this.$gettext("января"),this.$gettext("февраля"),this.$gettext("марта"),this.$gettext("апреля"),this.$gettext("мая"),this.$gettext("июня"),this.$gettext("июля"),this.$gettext("августа"),this.$gettext("сентября"),this.$gettext("октября"),this.$gettext("ноября"),this.$gettext("декабря")],this.sMONTH=[this.$gettext("янв"),this.$gettext("фев"),this.$gettext("мар"),this.$gettext("апр"),this.$gettext("мая"),this.$gettext("июн"),this.$gettext("июл"),this.$gettext("авг"),this.$gettext("сен"),this.$gettext("окт"),this.$gettext("ноя"),this.$gettext("дек")]}mounted(){const e=this.$refs.wrapper;if(e){const t=Math.max(1115,e.clientWidth);e.style.minWidth=t+"px"}}onStartDateChanged(){let e=this.startDate;e||(e=new Date),this.days=[];const t=e.getDay();for(let n=1;n<=t;n++){const i=new Date(e);i.setDate(i.getDate()-t+n),this.days.push({sDate:i,sDay:i.toLocaleDateString()})}for(let n=1;n<=this.daysCount-t;n++){const t=new Date(e);t.setDate(t.getDate()+n),this.days.push({sDate:t,sDay:t.toLocaleDateString()})}if(this.lastDayAsTwoDays){const e=this.days[this.days.length-1];e.tDate=new Date(e.sDate),e.tDate.setDate(e.tDate.getDate()+1),e.tDay=e.tDate.toLocaleDateString()}this.setItemsByDays(),this.preview&&this.setActiveItem()}onItemsChanged(e){Array.isArray(e)&&e.length&&this.setItemsByDays()}setItemsByDays(){if(Array.isArray(this.items)){this.itemsByDays=[];for(const e of this.days){let t=this.executionDateFilteredItems.filter((t=>this.dateCheck(t,e.sDate)));if(e.tDate){const n=this.executionDateFilteredItems.filter((t=>this.dateCheck(t,e.tDate)));t=t.concat(n)}this.itemsByDays.push(t)}}}id(e){const t=this.entityFromItem(e);return t?t[this.keyProp]:null}onClick(e){this.clickCounter++,1===this.clickCounter?this.timer=setTimeout((()=>{this.$emit("click",e),this.clickCounter=0}),200):(clearTimeout(this.timer),this.$emit("dblclick",e),this.clickCounter=0),this.setSelected(e)}setActiveItem(){if(Array.isArray(this.items)&&this.items.length){let e=null;const t=!!e&&this.findItem(e);if(!t&&this.itemsByDays.length){e=null;let t=null;for(const e of this.itemsByDays)if(Array.isArray(e)&&e.length){t=e;break}t&&(e=t[0])}e?this.setSelected(e):this.setSelected(null)}}getItemsCount(e){return this.itemsByDays[e].length}getFormatDate(e){const t=e.getDay();let n=this.$gettext("Вс");switch(t){case 1:n=this.$gettext("Пн");break;case 2:n=this.$gettext("Вт");break;case 3:n=this.$gettext("Ср");break;case 4:n=this.$gettext("Чт");break;case 5:n=this.$gettext("Пт");break;case 6:n=this.$gettext("Сб");break}const i=e.getDate();return`${n}, ${i}`}getMonth(e){const t=e.tDate?e.tDate.getMonth():e.sDate.getMonth();return(this.isLargeView?this.MONTH:this.sMONTH)[t]}isToday(e){var t;const n=(new Date).toLocaleDateString();return n===e.sDate.toLocaleDateString()||n===(null===(t=e.tDate)||void 0===t?void 0:t.toLocaleDateString())}setSelected(e){this.$emit("select",e)}findItem(e){for(const t of this.itemsByDays){const n=t.find((t=>this.id(t)===this.id(e)));if(n)return!0}return!1}get executionDateFilteredItems(){return Array.isArray(this.items)&&this.items.length?this.items.filter((e=>e.instruction&&e.instruction.executionEndDate)):[]}get isLargeView(){return this.$vuetify.breakpoint.xlOnly}};calendarListvue_type_script_lang_js_decorate([(0,R.Prop)(),calendarListvue_type_script_lang_js_metadata("design:type",Array)],se.prototype,"items",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)(),calendarListvue_type_script_lang_js_metadata("design:type",Date)],se.prototype,"startDate",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)({type:Number,default:6}),calendarListvue_type_script_lang_js_metadata("design:type",Number)],se.prototype,"daysCount",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)(),calendarListvue_type_script_lang_js_metadata("design:type",Function)],se.prototype,"dateCheck",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)({type:Function,required:!0}),calendarListvue_type_script_lang_js_metadata("design:type",Function)],se.prototype,"entityFromItem",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)({required:!0}),calendarListvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"keyProp",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)(),calendarListvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"sortField",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)({type:Array,default:()=>[]}),calendarListvue_type_script_lang_js_metadata("design:type",Array)],se.prototype,"selected",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)(),calendarListvue_type_script_lang_js_metadata("design:type",Boolean)],se.prototype,"preview",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Prop)({type:Boolean,default:!0}),calendarListvue_type_script_lang_js_metadata("design:type",Boolean)],se.prototype,"lastDayAsTwoDays",void 0),calendarListvue_type_script_lang_js_decorate([(0,R.Watch)("startDate",{immediate:!0}),calendarListvue_type_script_lang_js_metadata("design:type",Function),calendarListvue_type_script_lang_js_metadata("design:paramtypes",[]),calendarListvue_type_script_lang_js_metadata("design:returntype",void 0)],se.prototype,"onStartDateChanged",null),calendarListvue_type_script_lang_js_decorate([(0,R.Watch)("items",{immediate:!0}),calendarListvue_type_script_lang_js_metadata("design:type",Function),calendarListvue_type_script_lang_js_metadata("design:paramtypes",[Array]),calendarListvue_type_script_lang_js_metadata("design:returntype",void 0)],se.prototype,"onItemsChanged",null),se=calendarListvue_type_script_lang_js_decorate([R.Component],se);const re=se,ae=re;var le=n(43453),ce=n.n(le),de=n(17024),ue=n(66530),pe=n(57894),he=(0,G.Z)(ae,calendarListvue_type_template_id_14d93006_scoped_true_render,oe,!1,null,"14d93006",null);const me=he.exports;ce()(he,{VCol:de.Z,VContainer:ue.Z,VRow:pe.Z});var fe,ge,ye=n(70294),ve=n(73765),be=n(73082),Ce=n(86700),we=n(42151),_e=n(54486),xe=n(51414),listvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},listvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},listvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};(function(e){e[e["None"]=0]="None",e[e["Error"]=1]="Error",e[e["Loading"]=2]="Loading",e[e["Empty"]=3]="Empty",e[e["Select"]=4]="Select"})(fe||(fe={})),function(e){e["Single"]="single",e["Multi"]="multi"}(ge||(ge={}));const Se="update-selected",Ie="update-state";let De=class ListComponent extends R.Vue{constructor(){super(...arguments),this.fetching=!0,this.loadingSettings=!1,this.dialog=!1,this.canceled=!1,this.containerId="workspace-list",this.initialLoading=!0,this.error=!1,this.errorMsg="",this.folderId="",this.entityViewMode=h.dS.None,this.selectedIndex=-1,this.firstItemSelectCounter=0,this.nextItemSelectCounter=0,this.selectedIndices=[],this.tableSelected=[],this.tableChecked=[],this.prevTableChecked=[],this.items=null,this.actionContexts=new Map,this.listPerPage=[10,15,20,30],this.gridPerPage=[10],this.pagerOptions={page:1,pageSize:0,total:0},this.listPerPageCount=10,this.gridPerPageCount=10,this.tableRowCount=0,this.filterApplied=!1,this.columns=[],this.columnsUpdate=!1,this.defaultColumnWidth=170,this.columnsAlreadyMoved=!1,this.sortType=ge.Single,this.refreshCounter=0,this.searchTerm=null,this.onlyActualFilter=!0,this.filter=null,this.sortField=null,this.folderInfo=null,this.dateRange=null,this.unreadOnlyFilter=!1,this.tempItems=null,this.fromServer=!0,this.tableSortProps=[],this.fetchOptionsWasChanged=!1,this.folderWasChanged=!1,this.collectionViewModeChangedCalled={},this.customActions=[],this.customMultiActions=[],this.allCustomActions={},this.entitiesMultiActions={},this.actionOverlays=[],this.actualItemStates=[m.H.Normal,m.H.System,m.H.Fixed,m.H.ReadOnly],this.allItemStates=[],this.totalPages=0,this.toLastPage=!1,this.lastPageUnknown=!1,this.enabledPages=null,this.enableToLastPage=!0,this.firstVisibleItem=0,this.lastVisibleItem=0,this.lazyUpdating=!1,this.fetchingItemsPromise=Promise.resolve(),this.selectedRowIsVisibleAsync=!1,this.lazyCardActionsCounter=0,this.lazyCheckedCardActionsCounter={},this.checkedListItems=new Map,this.checkedListItemsArray=[]}created(){var e,t;this.prevCollectionViewMode=this.collectionViewMode,this.userSettings&&(this.listPerPageCount=0===this.userSettings.listViewCountPerPage?this.userSettings.maxInstructionsLoadCount:Math.min(this.userSettings.listViewCountPerPage,this.userSettings.maxInstructionsLoadCount),this.gridPerPageCount=0===this.userSettings.gridViewCountPerPage?this.userSettings.maxInstructionsLoadCount:Math.min(this.userSettings.gridViewCountPerPage,this.userSettings.maxInstructionsLoadCount),this.listPerPage.includes(this.listPerPageCount)||this.listPerPage.push(this.listPerPageCount)),this.listPerPage.sort(((e,t)=>e-t)),X.X.$on("remove-from-folder",this.onRemoveFromFolder),Array.isArray(null===(e=this.fetchOptions)||void 0===e?void 0:e.entities)&&(this.entities=this.fetchOptions.entities,this.items={items:this.fetchOptions.entities,totalCount:this.fetchOptions.entities.length},this.pagerOptions.total=this.items.totalCount,this.onFetchOptionsChanged(this.fetchOptions,null)),(null===(t=this.fetchOptions)||void 0===t?void 0:t.folderInfo)?this.$nextTick((()=>this.fetchOptions.refreshCounter++)):this.fetching=!1,this.customMultiActions.push({uid:-1e5,disabled:!1,loading:!1,callback:()=>this.onExport("excel"),actionInfo:{id:s.k.CardCustomAction,icon:"print",title:this.$gettext("Экспорт в .xlsx"),type:_.i.Menu}}),this.customMultiActions.push({uid:-100001,disabled:!1,loading:!1,callback:()=>this.onExport("word"),actionInfo:{id:s.k.CardCustomAction,icon:"print",title:this.$gettext("Экспорт в .docx"),type:_.i.Menu}})}beforeDestroy(){X.X.$off("remove-from-folder",this.onRemoveFromFolder)}onInstructionsLogChanged(){var e;const t=this.instructionsLog[this.instructionsLog.length-1];if(this.$log.debug("last mutation",t),(null===t||void 0===t?void 0:t.type)===w.x.Remove&&Array.isArray(null===(e=this.fetchOptions)||void 0===e?void 0:e.entities)){const e=this.fetchOptions.entities.findIndex((e=>this.entityOf(e).id===(null===t||void 0===t?void 0:t.id)));e>=0&&this.fetchOptions.entities.splice(e,1),this.items={items:this.fetchOptions.entities,totalCount:this.fetchOptions.entities.length},this.pagerOptions.total=this.items.totalCount}}onRemovedItemChanged(){var e;return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.selectedIndex===(null===(e=this.removedItem)||void 0===e?void 0:e.index)){this.selectedIndex=-1,this.collectionViewMode===h.Ml.List&&(yield(0,be.g)(550));let e=this.rows[this.removedItem.index]?this.rows[this.removedItem.index]:null,t=this.removedItem.index;!e&&this.rows.length&&(t=0,e=this.rows[t]),this.onItemSelect(e,t),this.pagerOptions.total=this.rows.length}}))}onPreviewChanged(){this.toLastPage=!1}onColumnsChanged(e){this.isVocabulary&&0!==e.length&&"Name"!==e[0].prop&&this.makeNameColumnFirst(e)}onSoftRefreshCounterChanged(){this.userSettings&&(this.fromServer=!1,this.fetchOptions.refreshCounter++)}onStartFolderChanging(){this.fetching=!0}onSelectedIndexChange(){this.highlightActiveItem(this.selectedIndex>=0&&this.showActiveItem)}onShowActiveItemChange(){this.highlightActiveItem(this.selectedIndex>=0&&this.showActiveItem)}onCollectionViewModeChanged(e,t,n=!0){var i,o;return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(e!==t)if(this.folderInfo){if(this.actionContexts.clear(),this.pagerOptions.pageSize=this.perPage,this.collectionViewModeChangedCalled[this.fetchOptions.folderInfo.id]=!0,this.collectionViewMode===h.Ml.Grid)try{this.loadingSettings=!0,this.totalPages=0,this.lastPageUnknown=!1,this.enabledPages=null;const e=this.pagerOptions.page;this.pagerOptions.page=1,yield this.createUserGridSettings(null===(o=null===(i=this.fetchOptions)||void 0===i?void 0:i.folderInfo)||void 0===o?void 0:o.contentType),yield this.fetchingItemsPromise,this.pagerOptions.page=e,n&&this.rows.length&&(this.selectedIndex<0?this.onItemSelect(this.rows[0],0):this.onItemSelect(this.rows[this.selectedIndex],this.selectedIndex))}finally{this.loadingSettings=!1}}else this._needReadUserGridSettings=!0}))}onSelectIdChanged(){this.nextIndex=-1,this.findAndSetSelected(this.selectedId)}onTableRowCountChanged(){this.pagerOptions.total=this.tableRowCount}onFetchOptionsChanged(e,t){var n,i,o,s,r;return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.$log.debug("onFetchOptionsChanged");let e=!1;try{this.fetchOptionsWasChanged=!0;let a=!1,l=!1;if(this.fetchOptions.section===(null===t||void 0===t?void 0:t.section)&&this.folderInfo===(null===(n=this.fetchOptions)||void 0===n?void 0:n.folderInfo)||(this.toLastPage=!1,this.folderInfo!==(null===(i=this.fetchOptions)||void 0===i?void 0:i.folderInfo)&&(this.refreshCounter=this.fetchOptions.refreshCounter,e=!0,this.folderWasChanged=!0),a=!0),this.entities!==this.fetchOptions.entities&&(this.entities=this.fetchOptions.entities,Array.isArray(this.fetchOptions.entities)&&(this.initialLoading=!1,this.items={items:this.fetchOptions.entities,totalCount:this.fetchOptions.entities.length})),this.refreshCounter!==this.fetchOptions.refreshCounter){if(this.refreshCounter=this.fetchOptions.refreshCounter,this.folderWasChanged)return;this.fromServer&&this.isInstruction&&this.$config.folderStatistic&&this.userSettings.getNotifications&&(l=!0),a=!0}if(this.searchTerm!==this.fetchOptions.searchTerm&&(this.searchTerm=this.fetchOptions.searchTerm,this.filterApplied=!1,a=!0),this.filter!==this.fetchOptions.filter&&(this.filter=this.fetchOptions.filter,a=!0),!this.folderInfo||this.folderInfo!==this.fetchOptions.folderInfo){const e=this.folderInfo;this.folderInfo=this.fetchOptions.folderInfo,this.onFolderInfoChanged(this.folderInfo,e,!0),a=!0}if(this.dateRange!==this.fetchOptions.dateRange&&(this.dateRange=this.fetchOptions.dateRange,a=!0),this.filterApplied=Boolean(this.filter||this.dateRange),this.folderInfo||(a=!1,this.tempItems=null,this.fetching=!1,this.initialLoading=!1),a&&!this.entities){let e;this.pagerOptions.page=-1,this.firstItemSelectCounter=0,this.actionContexts.clear(),this.items={items:[],totalCount:0},this.setSelected(null),this.fetching=!0,this.fetchingItemsPromise=new Promise((t=>e=t)),this.tempItems=yield this.fetchData(this.fromServer,this.searchTerm,this.filter,this.dateRange),e(),l&&this.queryBus.exec(new f.z5([this.fetchOptions.folderInfo.id],!0))}let c=a||Boolean(this.entities&&this.selectedId);if(this.tempItems&&(this.unreadOnlyFilter!==this.fetchOptions.unreadOnlyFilter||a)&&(c=!0,this.unreadOnlyFilter=this.fetchOptions.unreadOnlyFilter,this.unreadOnlyFilter&&this.useUnreadOnlyFilter?(this.items={items:(null===(o=this.tempItems)||void 0===o?void 0:o.items)?this.tempItems.items.filter((e=>!this.entityOf(e).viewFlag)):[],totalCount:0},this.items.totalCount=this.items.items.length):this.items=Object.assign({},this.tempItems)),0===(null===(s=this.items)||void 0===s?void 0:s.totalCount)&&this.onItemSelect(null,-1),this.pagerOptions.total=this.rowCount,this.pagerOptions.pageSize=this.perPage,this.pagerOptions.page!==this.fetchOptions.page){const e=this.fetchOptions.page;this.$nextTick((()=>{this.pagerOptions.page=e}))}(null===(r=this.items)||void 0===r?void 0:r.totalCount)&&(c||this.preview)&&(!this.selectedId&&this.selectedIndex<0?this.firstItemSelectCounter++:this.findAndSetSelected(this.selectedId)||(this.nextIndex>=0?this.nextItemSelectCounter++:this.firstItemSelectCounter++))}catch(e){this.$log.error(e)}finally{this.$emit("list-refreshed"),this.canceled||(this.fetching=!1),this.fromServer=!0,e&&(this.folderWasChanged=!1)}}))}onOnlyActualFilterChanged(){this.fetchOptions.refreshCounter++}onTreeAction(e){const t=e.row;"collapsed"===t.treeStatus?t.treeStatus="expanded":t.treeStatus="collapsed",this.items.items=[...this.items.items]}onFolderInfoChanged(e,t,n=!0){this.$log.debug("workspace list: onFolderInfoChanged",e),this.tableChecked=[],(this._needReadUserGridSettings||this.columnsByFolder)&&(this._needReadUserGridSettings=!1,e&&(this.collectionViewModeChangedCalled[e.id]||this.onCollectionViewModeChanged(this.collectionViewMode,h.Ml.None,n),this.collectionViewModeChangedCalled={})),this.folderId=e?String(e.id):"",(!t||!e||t&&e&&e.id!==t.id)&&(this.filterApplied=!1,Number(this.folderId)||(this.fetching=!1))}onRemoveFromFolder(e,t){this.$log.debug("onRemoveFromFolder",e,t),this.pagerOptions.total=this.rows.length}onActionPanelResult(e,t){return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.collectionViewMode===h.Ml.Grid){const e=this.selectedIndex;this.selectedIndex=-1,yield this.$nextTick(),this.selectedIndex=e}}))}onItemSelect(e,t){this.isMobile&&this.isSelected(e)&&(e=null);const n=this.entityOf(e);this.$emit(Se,{entity:e,id:n?n.id:null}),this.setSelected(e,t)}onColumnReorder(e){if(e){if(e.newValue--,e.prevValue--,!this.columnsAlreadyMoved){const t=this.columns.findIndex((t=>t.prop===e.column.prop)),n=this.columns[t];if(!n)return this.$log.error(`Не найден перемещаемый столбец ${e.column.name}`);if(e.newValue>t){for(let n=t;n<e.newValue;n++)this.columns[n]=this.columns[n+1];this.columns[e.newValue]=n}else{for(let n=t;n>e.newValue;n--)this.columns[n]=this.columns[n-1];this.columns[e.newValue]=n}}this.columnsAlreadyMoved=!1,this.saveGridSettings()}}onSelectRow({selected:e}){let t=null,n=-1;if(e.length){const i=this.rowIdentity(e[0]),{item:o,index:s}=this.findListItem(null===i||void 0===i?void 0:i.toString());o&&(t=o,n=s)}this.onItemSelect(t,n)}onCheckRow({checked:e}){if(Array.isArray(e)){const t=this.prevTableChecked.filter((t=>!e.includes(t)));t.forEach((e=>{const t=this.rowIdentity(e),n=this.checkedListItems.get(t);this.checkedListItems.delete(t),n>=0&&(this.checkedListItemsArray.splice(n,1),this.checkedListItems.forEach(((e,t)=>{e>n&&this.checkedListItems.set(t,e-1)})))})),this.tableChecked=[...e],this.prevTableChecked=[...e],this.tableChecked.forEach((e=>{const t=this.rowIdentity(e);if(!this.checkedListItems.has(t)){const{item:e}=this.findListItem(null===t||void 0===t?void 0:t.toString());Promise.resolve(e).then((e=>(this.checkedListItemsArray.push(e),this.checkedListItems.set(t,this.checkedListItemsArray.length-1),setTimeout((()=>this.lazyCheckedCardActionsCounter[t]?this.lazyCheckedCardActionsCounter[t]++:this.$set(this.lazyCheckedCardActionsCounter,t,1)),0),e))).catch((e=>this.$log.error(e)))}}))}}columnSettingsEdit(){return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=new g.c({title:this.$gettext("Настройки таблицы"),componentName:"edit-grid-columns",componentProps:{model:null,columns:this.columns,multiSort:this.sortType===ge.Multi},fullHeight:!1,closable:!0,width:"33%"}),t=yield this.queryBus.exec(e);t&&(this.sortType=t.multiSort?ge.Multi:ge.Single,this.columns=t.columns,this.$emit("update-show-grid-columns"),this.saveGridSettings(),this.columnsUpdate=!0,this.$nextTick((()=>{this.columnsUpdate=!1})))}))}onActivate({row:e,type:t}){if(!this.disableDoubleClick&&"dblclick"===t){if(this.hasActions)return void this.onEditRow(e,0);const{item:t}=this.findListItem(String(this.rowIdentity(e)));this.onDblClick(t)}}onRowCountChanged(e){return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.$log.debug("onRowCountChanged",e),yield this.$nextTick(),this.tableRowCount=e}))}onColumnResize(e){const t=this.columns.find((t=>t.prop===e.column.prop));t.width=e.newValue,this.saveGridSettings()}onColumnWidth(e,t){e&&(e.width=t)}onColumnSort(e){this.columns.forEach((e=>{e.sortOrder=null,e.sortDir=null})),e.sorts&&e.sorts.forEach(((e,t)=>{const n=this.columns.find((t=>t.prop===e.prop));n&&(n.sortOrder=t,n.sortDir=e.dir)})),this.saveGridSettings()}onDblClick(e){this.isMobile||this.$emit("list-dblclick",e,this.createActionContext(e))}onClick(e){this.isMobile&&this.$emit("list-click",e,this.createActionContext(e))}onEditRow(e,t){e||(e=this.rowOf(this.rows[this.selectedIndex])),e&&(this.$log.debug("onEditRow",e,t),this.$emit("list-edit-row",e,t))}onRemoveRow(e,t){e||(e=this.rowOf(this.rows[this.selectedIndex])),e&&(this.$log.debug("onRemoveRow",e,t),this.$emit("list-remove-row",e,t))}createActionContext(e){var t,n,i;let o;if(e=e||this.rows[this.selectedIndex],this.collectionViewMode===h.Ml.List&&(o=this.actionContexts.get(e),o))return o;let s="entity",r=null===(n=null===(t=this.fetchOptions)||void 0===t?void 0:t.folderInfo)||void 0===n?void 0:n.contentType;if((null===r||void 0===r)&&this.hasInitalItems){const e=null===(i=this.fetchOptions)||void 0===i?void 0:i.entities[0];"instruction"in e?r=h.zc.Instruction:"journalID"in e?r=h.zc.Document:"fastReportInfo"in e?r=h.zc.FastReport:"vocabularyValue"in e&&(r=h.zc.Vocabulary)}switch(r){case h.zc.Instruction:s="instructionInfo";break;case h.zc.Document:s="document";break;case h.zc.FastReport:s="fastReport";break;case h.zc.Vocabulary:s="catalogue";break;default:break}return o=Object.assign(Object.assign({},this.context),{contentType:r,[s]:[e],entity:[e],collectionViewMode:this.collectionViewMode}),this.actionContexts.set(e,o),o}onIteratorLoadingUpdate(e){this.loadingSettings=e}onIteratorPage(e){this.$emit(Ie,{page:e})}onIteratorPageItems({first:e,last:t}){this.firstVisibleItem=e,this.lastVisibleItem=t}onIteratorTotalPage(e,t){this.totalPages=e,this.lastPageUnknown=t}onChangePage({page:e,size:t,toLast:n}){this.toLastPage=n,this.onPage({offset:e-1,pageSize:t})}onPage(e){var t;this.pagerOptions.page<0||!(null===(t=null===this||void 0===this?void 0:this.items)||void 0===t?void 0:t.totalCount)||(this.collectionViewMode===h.Ml.Grid?(e.pageSize&&(this.pagerOptions.pageSize=e.pageSize),this.$emit(Ie,{page:e.offset+1})):this.$emit(Ie,{page:e.offset+1,pageSize:e.pageSize}),this.collectionViewMode!==h.Ml.Grid||this.gridPerPage.includes(e.pageSize)||(this.gridPerPage=[e.pageSize]))}onSetCardActionsOverlay(e){Array.isArray(e)&&(this.actionOverlays=e)}onSetCardActions(e){this.processCustomActions(e,this.customActions),this.document&&(this.allCustomActions[this.document.id]=this.customActions,delete this.entitiesMultiActions[this.document.id],this.$set(this.entitiesMultiActions,this.document.id,this.customActions.filter((e=>e.uid>=0))))}onSetCheckedCardActions(e,t){let n=this.entitiesMultiActions[e.id];n||(n=[]),this.processCustomActions(t,n),delete this.entitiesMultiActions[e.id],this.$set(this.entitiesMultiActions,e.id,n),e&&(this.allCustomActions[e.id]=n)}processCustomActions(e,t){if(!Array.isArray(t))return;const n=this.container.get(s.k.CardCustomAction);null===e||void 0===e||e.forEach((e=>{e.actionInfo={id:s.k.CardCustomAction,action:n,data:e.action,icon:e.icon,title:e.title,type:e.type,multi:e.multi};const i=t.findIndex((t=>t.uid===e.uid));i>=0?t[i]=e:t.push(e)}))}isSelected(e){const t=this.selectedIndex>=0?this.rows[this.selectedIndex]:null;return this.isSelectedFunc?this.isSelectedFunc(e,t):t&&e&&this.entityOf(t).id===this.entityOf(e).id}unreadFilterChange(){this.$emit("update-unread-only",!1)}cancelFilter(){this.filterApplied=!1,this.$emit("update-cancel-filter",!0)}cancelDateRange(){this.$emit("update-cancel-date-range")}cancelAll(){this.cancelFilter(),this.cancelDateRange()}getFilterParamValue(e){const t=e.listType?e.title:e.value;return t instanceof Date?t.toLocaleDateString():"string"===typeof t&&["pInitiatorID","pCreatorID","pReceiverID","pAuditorID"].includes(e.name)?r.X.userNameShorting(t):t}closeFilterParam(e){e.value=null;const t=this.filter.filterValues.filter((e=>e.value));t.length?this.filter=null:this.cancelFilter()}lazyEntityUpdate(){return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.selectedIndex<0||!this.fetchItem)return null;try{this.lazyUpdating=!0,this.lazyCardActionsCounter++;const e=this.rows[this.selectedIndex],t=yield this.fetchItem(e,this.fetchOptions.folderInfo,!0);return[t]}catch(e){this.$log.error(e)}finally{this.lazyUpdating=!1}}))}getRowClass(e){if(e)return{"unread-row":"viewFlag"in e&&!e.viewFlag}}onExport(e){var t,n,i;const o=this.tableChecked.length?this.tableChecked:this.$refs.table.internalRows;let s=null;(null===(t=this.fetchOptions)||void 0===t?void 0:t.dateRange)&&(s=`с ${null===(n=this.fetchOptions.dateRange.dateStart)||void 0===n?void 0:n.toLocaleString()} по ${null===(i=this.fetchOptions.dateRange.dateFinish)||void 0===i?void 0:i.toLocaleString()}`),"excel"===e?toExcel(this.fetchOptions.folderInfo.name,s,this.columns,o,this.fetchOptions.folderInfo.name):tableToWord(this.fetchOptions.folderInfo.name,s,this.columns,o,this.fetchOptions.folderInfo.name)}saveGridSettings(){const e={[this.folderId]:this.columns.map((e=>({fieldName:(0,F.kC)(e.prop),caption:e.name,columnType:e.columnType,enabled:e.visible,sortOrder:e.sortOrder,sortDir:e.sortDir,groupLevel:e.groupLevel,groupOrder:e.groupOrder,width:e.width,frozen:e.frozen})))},t={[this.namePropertyColumns]:e,gridMultipleSorting:{[this.folderId]:this.sortType===ge.Multi}},n=new l.Wj(t);return this.commandBus.exec(n)}waitForElement(e){return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e)return Promise.reject();const t=10,n=50;let i=null,o=null;const s=new Promise(((e,t)=>{i=e,o=t}));let r=0,a=null;const findElement=()=>{setTimeout((()=>{if(r++,r>t&&o(),a||(a=this.$el.querySelector(`#${e}`)),a)return i();findElement()}),n)};return findElement(),s}))}get minRowHeight(){return this.preview||this.isMobile?30:this.isFastReport?40:90}get loading(){return this.hasInitalItems?this.fetching||this.loadingSettings||this.loadingStatus:Boolean(this.folderId)&&(this.fetching||this.loadingSettings||this.loadingStatus||this.initialLoading)}get fixedPageSize(){return!0}get rowsPerPage(){return this.collectionViewMode===h.Ml.Grid?this.gridPerPage:this.listPerPage}get perPage(){return this.collectionViewMode===h.Ml.Grid?this.gridPerPage[0]:this.fetchOptions&&this.fetchOptions.pageSize?this.fetchOptions.pageSize:this.listPerPageCount}get contentType(){var e,t;return this.collectionViewMode===h.Ml.List?null===(t=null===(e=this.fetchOptions)||void 0===e?void 0:e.folderInfo)||void 0===t?void 0:t.contentType:null}get isInstruction(){var e,t;return(null===(t=null===(e=this.fetchOptions)||void 0===e?void 0:e.folderInfo)||void 0===t?void 0:t.contentType)===h.zc.Instruction}get isDocument(){var e,t;return(null===(t=null===(e=this.fetchOptions)||void 0===e?void 0:e.folderInfo)||void 0===t?void 0:t.contentType)===h.zc.Document}get isVocabulary(){var e,t;return(null===(t=null===(e=this.fetchOptions)||void 0===e?void 0:e.folderInfo)||void 0===t?void 0:t.contentType)===h.zc.Vocabulary}get isFastReport(){var e,t;return(null===(t=null===(e=this.fetchOptions)||void 0===e?void 0:e.folderInfo)||void 0===t?void 0:t.contentType)===h.zc.FastReport}get showTableToolbar(){return!this.disableTableToolbar&&(this.isInstruction||this.isDocument)}get columnsGroupBy(){let e=this.columns.filter((e=>null!==e.groupLevel&&void 0!==e.groupLevel));e=e.sort(((e,t)=>e.groupLevel-t.groupLevel));const t=[];let n,i=-1;e.forEach((e=>{e.groupLevel!==i&&(i=e.groupLevel,n=[],t.push(n)),n.push(e)}));const o=t.map((e=>(e.sort(((e,t)=>e.groupOrder-t.groupOrder)),e.map((({name:e,prop:t,groupFormatter:n})=>({title:e,prop:t,valueGetter:n}))))));return o.length?o:null}get rowCount(){return this.columnsGroupBy&&this.columnsGroupBy.length?this.tableRowCount:this.items&&this.items.items?this.items.items.length:0}get rows(){return this.items&&this.items.items?this.items.items:[]}get tableRows(){return this.rows.map((e=>this.rowOf(e)))}get pageLimit(){return this.isHierarchicalVoc?null:this.perPage}get selectedRowIsVisible(){if(this.selectedIndex>=0&&this.tableRowCount&&this.pagerOptions.page){const e=this.rowOf(this.rows[this.selectedIndex]);if(this.$refs.table)return this.$refs.table.isRowVisible(e);this.waitForElement("datatable").then((()=>{const t=this.$refs.table.isRowVisible(e);return this.selectedRowIsVisibleAsync=t,t})).catch((e=>this.$log.error(e)))}return!1}get showActionPanelGrid(){var e;return!(null===(e=this.tableChecked)||void 0===e?void 0:e.length)&&(this.lazyUpdating||!this.hasActions&&!this.preview&&this.selectedIndex>=0&&(this.selectedRowIsVisible||this.selectedRowIsVisibleAsync))}get showMultiActionPanel(){return this.tableChecked.length>0}get showActions(){return this.hasActions&&!this.preview}get loadingMessage(){return this.$gettextInterpolate(this.$gettext("Загрузка %{contentName}..."),{contentName:this.contentName})}get errorMessage(){return this.errorMsg?this.errorMsg:this.$gettext("Извините, произошла ошибка при чтении данных. Пожалуйста, обновите страницу.")}get selectFolderMessage(){return this.selectMessage?this.selectMessage:this.fetchOptions.section===p.S.Archive?this.$gettext("Выберите папку для просмотра"):this.$gettextInterpolate(this.$gettext("Выберите папку для просмотра %{content}"),{content:this.contentName})}get emptyFolderMessage(){if(this.emptyMessage)return this.emptyMessage;if(this.isDocumentSearchFolder)return this.$gettext("Пожалуйста, измените условия фильтрации документов");const e=this.unreadOnlyFilter?this.$gettextInterpolate(this.$gettext("нет непрочитанных %{content}"),{content:this.contentName}):this.$gettextInterpolate(this.$gettext("нет %{content}"),{content:this.contentName});return this.$gettextInterpolate(this.$gettext("В данной папке  %{condition}"),{condition:this.useUnreadOnlyFilter?e:this.$gettext("нет ")+this.contentName})}get hasItems(){return this.rows&&this.rows.length>0}get hasInitalItems(){var e,t;return Array.isArray(null===(e=this.fetchOptions)||void 0===e?void 0:e.entities)&&Boolean(null===(t=this.fetchOptions)||void 0===t?void 0:t.entities.length)}get isNoneState(){return!this.loading&&this.state===fe.None}get isListMode(){return this.collectionViewMode===h.Ml.List}get isTableMode(){return this.collectionViewMode===h.Ml.Grid}get isCalendarVisible(){return this.collectionViewMode===h.Ml.Calendar}get namePropertyColumns(){var e,t;switch(null===(t=null===(e=this.fetchOptions)||void 0===e?void 0:e.folderInfo)||void 0===t?void 0:t.contentType){case h.zc.Document:return"journalsColumnSettings";case h.zc.Instruction:return"foldersColumnSettings"}}get isListAndHasData(){return this.isListMode&&this.isNoneState}get isTableAndHasData(){return this.isTableMode&&this.isNoneState}get isCalendarAndHasData(){return this.isCalendarVisible&&this.isNoneState}get actionPanelTableContext(){let e=null;return this.collectionViewMode===h.Ml.Grid&&this.selectedIndex>=0&&(e=this.rows[this.selectedIndex]),this.createActionContext(e)}get multiRowContext(){const e=[];return this.tableChecked.forEach((t=>{const n=this.rowIdentity(t);if(n){const{item:t}=this.findListItem(n.toString());e.push(t)}})),Object.assign(Object.assign({},this.context),{instructionInfo:null,document:null,fastReport:null,catalogue:null,entity:e,collectionViewMode:this.collectionViewMode})}get filterParams(){var e;if(this.filterApplied)return null===(e=this.fetchOptions.filter)||void 0===e?void 0:e.filterValues}get dateRangeChip(){var e,t;return this.dateRange?`${null===(e=this.dateRange.dateStart)||void 0===e?void 0:e.toLocaleDateString()} - ${null===(t=this.dateRange.dateFinish)||void 0===t?void 0:t.toLocaleDateString()}`:null}get state(){return this.error?fe.Error:this.folderId||this.hasInitalItems?this.loading?fe.Loading:this.hasItems||this.folderWasChanged?fe.None:fe.Empty:fe.Select}get isErrorState(){return this.state===fe.Error}get isSelectState(){return this.state===fe.Select}get isLoadingState(){return this.state===fe.Loading}get isEmptyState(){return this.state===fe.Empty}get hasActions(){return this.rowActions&&this.rowActions.length}get hasEditAction(){return this.hasActions&&this.selectedIndex>=0&&this.rowActions.includes(o.Us.Edit)}get hasRemoveAction(){return this.hasActions&&this.selectedIndex>=0&&this.rowActions.includes(o.Us.Remove)}get templateType(){return c.$.Item}get document(){const e=this.rows[this.selectedIndex];return e?(0,we.Z)(e):null}get iteratorActiveItem(){return this.rows[this.selectedIndex]}get iteratorPadding(){return this.preview||this.isMobile?0:10}get dateCheck(){return this.isInstruction?(e,t)=>{let n=this.entityOf(e).executionEndDate;return"string"===typeof n&&(n=new Date(n)),n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()}:this.isDocument?(e,t)=>{var n;let i=null===(n=this.entityOf(e).attributes)||void 0===n?void 0:n.RegistrationDate;return!!i&&("string"===typeof i&&(i=new Date(i)),i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()&&i.getDate()===t.getDate())}:(e,t)=>!1}get isFooterShow(){return!this.footerIsHidden&&!this.isCalendarAndHasData}get isPagerShow(){return!this.isHierarchicalVoc&&!this.isCalendarVisible}get calendarListItemMode(){return x.H.Calendar}get treeFromRelation(){return this.isVocabulary&&this.isHierarchicalVoc?"ParentID":null}get treeToRelation(){return this.isVocabulary&&this.isHierarchicalVoc?"id":null}get isDocumentSearchFolder(){var e;return(null===(e=this.fetchOptions.folderInfo)||void 0===e?void 0:e.nodeType)===u.J.DocumentSearchFolder}get hasFrozenColumns(){return Boolean(this.columns.find((e=>e.frozen)))}findListItem(e){let t=-1;const n=this.rows.find(((n,i)=>{const o=this.entityOf(n);if(o){const o=this.rowIdentity(this.rowOf(n)),s=o.toString()===e.toString();return s&&(t=i),s}return!1}));return{item:n,index:t}}findAndSetSelected(e){if(this.rows.length){const t=this.selectedIndex>=0?this.rows[this.selectedIndex]:null;if(t&&this.entityOf(t).id==e)return!0;let n=null;if(e){const{item:t}=this.findListItem(e);n=t}return this.setSelected(n),Boolean(n)}}setSelected(e,t=-1){var n,i,o;if(e&&(null===(i=null===(n=this.fetchOptions)||void 0===n?void 0:n.folderInfo)||void 0===i?void 0:i.contentType)===h.zc.Instruction){const t=this.entityOf(e);t&&!t.folder&&(t.folder={id:Number(this.folderId),name:this.folderInfo?this.folderInfo.name:null})}if(this.actionOverlays=[],e){this.customActions=null!==(o=this.allCustomActions[Number(this.entityOf(e).id)])&&void 0!==o?o:[],this.selectedIndex=t>=0?t:this.rows.findIndex((t=>this.entityOf(t).id===this.entityOf(e).id));const n=this.selectedIndices.find((e=>e===this.selectedIndex));!n&&this.selectedIndex>=0&&(this.selectedIndices.length=0,this.selectedIndices.push(this.selectedIndex));const i=this.rowOf(e),s=this.tableSelected.find((e=>e===i));!s&&this.selectedIndex>=0&&(this.tableSelected.length=0,this.tableSelected.push(i)),this.customMultiActions.forEach((e=>this.customActions.push(e))),this.selectedIndex+1>=this.rows.length&&(this.nextIndex=0),this.nextIndex=this.selectedIndex+1}else this.customActions=[],this.selectedIndex=-1,this.tableSelected=[],this.selectedIndices=[]}fetchData(e,t,n,i){var o;return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let s;this.error=!1,this.$app.cancelQueries();try{return s=yield this.fetchItems(this.fetchOptions.folderInfo,e,t,n,this.onlyActualFilter?this.actualItemStates:this.allItemStates,i),this.canceled=!1,s}catch(e){this.errorMsg="","CancelError"===e.name?this.canceled=!0:(403===(null===(o=e.response)||void 0===o?void 0:o.status)&&(this.errorMsg=this.$gettext("Недостаточно для прав для получения списка")),this.error=!0,this.$log.error(this.$gettextInterpolate(this.$gettext("Ошибка получения данных: %{msg} %{err}"),{msg:e.message,err:e}),e.stack),this.$toasted.error(`${this.$gettext("Ошибка получения элементов списка")} ${this.errorMsg}`))}finally{this.initialLoading=!1}}))}changeOrderColumnsBySettings(e,t){let n=[];if(e&&e.length===t.length){for(let i=0;i<e.length;i++)for(let o=0;o<t.length;o++)if(e[i].name===t[o].prop){Number(t[o].width)!==e[i].width&&(t[o].width=e[i].width),n.push(t[o]);break}}else{e=[];for(const n of t)e.push({name:n.prop,width:Number(n.width)||this.defaultColumnWidth});n=t,this.tableSettings.columns=e}return n}highlightActiveItem(e){}createUserGridSettings(e){return listvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.columns=[];try{if(this.fetchColumns)return this.columns=yield this.fetchColumns(this.folderInfo);const t=e===h.zc.Document?"Document":"Instruction";this.tableSettings||(this.tableSettings=yield this.fetchTableSettings(new v.Wd(e,Number(this.folderId))));const n={contentType:e,templateType:d.ET[t],topLevelParentId:Number(this.folderInfo.topLevelFolderId),nestedPrefix:`${t.toLowerCase()}.`,removeColumns:["readDate"],folderId:Number(this.folderId),cardId:this.fetchOptions.folderInfo.cardId},i=new v.Pn(n,!1),o=yield this.fetchUserGridSettings(i);let s=o.columns;this.tableSettings&&(s=this.changeOrderColumnsBySettings(this.tableSettings.columns,s));const r=[];if(Array.isArray(s)&&s.forEach((e=>{r.find((t=>t.prop===e.prop))||(e.draggable=!0,e.groupBy=null!==e.groupLevel&&void 0!==e.groupLevel,r.push(e))})),this.isDocument){const e=r.filter((e=>e.sortDir));if(!e.length){const e=r.findIndex((e=>"RegistrationDate"===e.prop));if(e>=0){const t=r[e];t.sortable=!0,t.sortDir="desc",t.sortOrder=0,e>0&&(r.splice(e,1),r.splice(0,0,t))}}}this.sortType=o.multipleSorting?ge.Multi:ge.Single,this.columns=r.map((e=>(e.printValue=printValue,e)))}finally{const e=this.columns.filter((e=>null!==e.sortOrder&&void 0!==e.sortOrder));e.sort(((e,t)=>e.sortOrder-t.sortOrder)),this.tableSortProps=[],e.forEach((e=>{this.tableSortProps.push({prop:e.prop,dir:e.sortDir})}))}}))}makeNameColumnFirst(e){const t=e.findIndex((e=>"Name"===e.prop));if(-1!==t){const n=e[t];this.columns.splice(t,1),this.columns.splice(0,0,n)}}};listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"context",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"fetchOptions",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",String)],De.prototype,"selectedId",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Number)],De.prototype,"collectionViewMode",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"preview",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"showActiveItem",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"filterParamPanel",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",String)],De.prototype,"filterNameApplied",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Number)],De.prototype,"startFolderChanging",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Number)],De.prototype,"softRefreshCounter",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",String)],De.prototype,"contentName",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"useUnreadOnlyFilter",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"isHierarchicalVoc",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"columnsByFolder",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)({type:Function,default:e=>e}),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"entityOf",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)({type:Function,default:e=>e}),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"rowOf",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)({type:Function,default:e=>e}),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"rowIdentity",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"isSelectedFunc",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)({type:Function,default:e=>e}),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"unreadStatus",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"fetchItems",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"fetchItem",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"fetchColumns",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"removedItem",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Function)],De.prototype,"cellValueFunc",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Array)],De.prototype,"rowActions",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)({default:!1}),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"loadingStatus",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",Date)],De.prototype,"startDate",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)({default:!1}),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"footerIsHidden",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",String)],De.prototype,"emptyMessage",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)(),listvue_type_script_lang_js_metadata("design:type",String)],De.prototype,"selectMessage",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)({default:!1}),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"disableTableToolbar",void 0),listvue_type_script_lang_js_decorate([(0,R.Prop)({default:!1}),listvue_type_script_lang_js_metadata("design:type",Boolean)],De.prototype,"disableDoubleClick",void 0),listvue_type_script_lang_js_decorate([(0,b.Vw)("getUserInfo"),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"getUserInfo",void 0),listvue_type_script_lang_js_decorate([(0,b.r5)("fetchTableSettings"),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"fetchTableSettings",void 0),listvue_type_script_lang_js_decorate([(0,b.r5)("fetchUserGridSettings"),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"fetchUserGridSettings",void 0),listvue_type_script_lang_js_decorate([(0,C.x)("userSettings"),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"userSettings",void 0),listvue_type_script_lang_js_decorate([(0,xe.ZM)("log",{namespace:"instructions"}),listvue_type_script_lang_js_metadata("design:type",Array)],De.prototype,"instructionsLog",void 0),listvue_type_script_lang_js_decorate([(0,_e.t)(y.M.IQueryBus),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"queryBus",void 0),listvue_type_script_lang_js_decorate([(0,_e.t)(a.O.ICommandBus),listvue_type_script_lang_js_metadata("design:type",Object)],De.prototype,"commandBus",void 0),listvue_type_script_lang_js_decorate([(0,_e.t)(S.t.Container),listvue_type_script_lang_js_metadata("design:type",Ce.W2)],De.prototype,"container",void 0),listvue_type_script_lang_js_decorate([(0,R.Watch)("instructionsLog"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onInstructionsLogChanged",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("removedItem"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",Promise)],De.prototype,"onRemovedItemChanged",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("preview"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onPreviewChanged",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("columns"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[Array]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onColumnsChanged",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("softRefreshCounter"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onSoftRefreshCounterChanged",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("startFolderChanging"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onStartFolderChanging",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("selectedIndex"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onSelectedIndexChange",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("showActiveItem"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onShowActiveItemChange",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("collectionViewMode",{immediate:!0}),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[Number,Number,Boolean]),listvue_type_script_lang_js_metadata("design:returntype",Promise)],De.prototype,"onCollectionViewModeChanged",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("selectedId",{immediate:!0}),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onSelectIdChanged",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("tableRowCount"),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[]),listvue_type_script_lang_js_metadata("design:returntype",void 0)],De.prototype,"onTableRowCountChanged",null),listvue_type_script_lang_js_decorate([(0,R.Watch)("fetchOptions",{immediate:!1,deep:!0}),listvue_type_script_lang_js_metadata("design:type",Function),listvue_type_script_lang_js_metadata("design:paramtypes",[Object,Object]),listvue_type_script_lang_js_metadata("design:returntype",Promise)],De.prototype,"onFetchOptionsChanged",null),De=listvue_type_script_lang_js_decorate([(0,R.Component)({components:{pager:J.Z,IconColumn:ve.Z,"data-iterator":Y,"action-panel":ie.default,"document-list-item":ye.Z,"calendar-list":me}})],De);const Re=De,Te=Re;var Pe=n(82127),Oe=n(93462),ke=n(71100),Fe=n(54983),Ae=n(53760),$e=n(45903),je=n(51333),Ee=n(56721),Me=n(7442),Ne=(0,G.Z)(Te,render,i,!1,null,"1488fb90",null);const Ve=Ne.exports;ce()(Ne,{VBtn:Pe.Z,VChip:Oe.Z,VCol:de.Z,VIcon:ke.Z,VList:Fe.Z,VListItem:Ae.Z,VListItemTitle:$e.V9,VMenu:je.Z,VRow:pe.Z,VSwitch:Ee.Z,VTooltip:Me.Z})},35709:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i,render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"loader",class:e.cssClasses,style:e.styles},[e.isSandGlass?n("i",{staticClass:"fa fa-spin fa-hourglass-o fa-3x fa-fw loader__icon"}):e.isCircle?n("div",{staticClass:"circle",class:e.size}):e.isCssClass?n("div",{class:e.imgClass}):n("i",{staticClass:"fa fa-clock-o fa-3x fa-fw loader__icon loader__icon-gray"})])},o=[],s=n(97529),r=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};(function(e){e[e["SandGlass"]=0]="SandGlass",e[e["Clock"]=1]="Clock",e[e["Circle"]=2]="Circle",e[e["Css"]=3]="Css"})(i||(i={}));let a=class Loader extends r.Vue{created(){if(this.options.size||(this.options.size="big"),this.indicator)switch(this.indicator){case"circle":this.options.type=i.Circle;break;case"sand":this.options.type=i.SandGlass;break;case"clock":this.options.type=i.Clock;break;case"css":this.options.type=i.Css;break;default:this.options.type=i.SandGlass;break}}get isSandGlass(){return"sand"===this.indicator||this.options.type===i.SandGlass}get isCircle(){return"circle"===this.indicator||this.options.type===i.Circle}get isCssClass(){return"css"===this.indicator||this.options.type===i.Css}get imgClass(){return this.css}get isTransparent(){return!!this.options&&this.options.transparent}get isGlobal(){return!!this.options&&this.options.global}get styles(){return{"z-index":(0,s.K)(this.$parent.$el)+2}}get size(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.size)&&void 0!==t?t:"big"}get color(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.color)&&void 0!==t?t:"primary"}get isRelative(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.relative)&&void 0!==t&&t}get cssClasses(){const e=[];return this.isTransparent||e.push("loader__white-bg"),this.isGlobal&&e.push("loading-mask-global"),this.isRelative?e.push("loader__relative"):e.push("loading-mask"),e.push(`loader__color-${this.color}`),e}};__decorate([(0,r.Prop)({type:Object,default:{size:"big"}}),__metadata("design:type",Object)],a.prototype,"options",void 0),__decorate([(0,r.Prop)({type:Boolean,default:"false"}),__metadata("design:type",Boolean)],a.prototype,"visible",void 0),__decorate([(0,r.Prop)({type:String,default:"circle",validator:e=>["sand","circle","clock","css"].includes(e)}),__metadata("design:type",String)],a.prototype,"indicator",void 0),__decorate([(0,r.Prop)({type:String,default:""}),__metadata("design:type",String)],a.prototype,"css",void 0),a=__decorate([r.Component],a);const l=a,c=l;var d=n(51900),u=(0,d.Z)(c,render,o,!1,null,"df9136a4",null);const p=u.exports},80055:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"pager no-gutters",class:{column:e.isMobile}},[n("v-col",[n("ul",{staticClass:"pages",class:{"ml-3":!e.isMobile}},[e.toFirst?n("li",{staticClass:"arrow",attrs:{disabled:!e.canPrevious}},[n("i",{staticClass:"material-icons",class:{"pager__btn--disabled":!e.canPrevious},on:{click:function(t){return e.selectPage(1)}}},[e._v("first_page")])]):e._e(),e._v(" "),n("li",{staticClass:"arrow",attrs:{disabled:!e.canPrevious}},[n("i",{staticClass:"material-icons mb-0 grey--text",class:{"pager__btn--disabled lighten-9":!e.canPrevious,"darken-7":e.canPrevious},on:{click:e.prevPage}},[e._v("arrow_back")])]),e._v(" "),e._l(e.pages,(function(t){return n("li",{key:t.number,staticClass:"pager__btn sm-text",class:{"pager__btn--active primary":t.number===e.page,"primary--text grey--border lighten-3":t.number!==e.page&&t.enabled,"secondary--text grey lighten-2":e.pageDisabled(t.number)},attrs:{role:"button","aria-label":"page "+t.number,disabled:e.pageDisabled(t.number)},on:{click:function(n){return e.selectPage(t.number)}}},[n("span",[e._v(e._s(t.text))])])})),e._v(" "),n("li",{staticClass:"arrow",attrs:{disabled:!e.canNext}},[n("i",{staticClass:"material-icons mb-0 grey--text",class:{"pager__btn--disabled lighten-9":!e.canNext," darken-7":e.canNext},on:{click:e.nextPage}},[e._v("arrow_forward")])]),e._v(" "),e.toLast?n("li",{staticClass:"arrow",attrs:{disabled:!e.canLast}},[n("i",{staticClass:"material-icons",class:{"pager__btn--disabled":!e.canLast},on:{click:function(t){return e.selectPage(e.totalPages,!0)}}},[e._v("last_page")])]):e._e()],2)]),e._v(" "),n("v-col",{staticStyle:{"margin-left":"auto"}},[n("v-row",{attrs:{align:"center","no-gutters":""}},[e.showFromTo?n("div",{key:"fromTo",staticClass:"grey--text darken-2 font-weight-bold",staticStyle:{"margin-left":"auto","margin-right":"20px"}},[e.first?n("span",[e._v(e._s(e.first)+" "),e.last?n("span",[e._v(" - "+e._s(e.last))]):e._e()]):e._e(),e._v(" "),e.count?n("span",{staticClass:"grey--text darken-4 font-weight-regular",staticStyle:{display:"inline-flex"}},[e._v(e._s(e.$gettext("из"))+" \n          "),n("span",{staticClass:"grey--text darken-2 font-weight-bold"},[e._v(e._s(e.count))])]):e._e()]):e.showOnlyTotal?n("div",{key:"onlyCount",staticClass:"grey--text darken-2 font-weight-bold",staticStyle:{"margin-left":"auto","margin-right":"17px"}},[e.entityName?n("span",{staticClass:"grey--text darken-4 font-weight-regular",staticStyle:{display:"inline-flex"}},[e._v("\n          "+e._s(e.$gettext("Всего"))+" "+e._s(e.count)+" "+e._s(e.entityName)+"\n        ")]):n("span",{staticClass:"sm-text grey--text darken-1 font-weight-regular",staticStyle:{display:"inline-flex"}},[e._v("\n          "+e._s(e.$gettext("Всего"))+" "+e._s(e.count)+" "+e._s(e.rowsNounForm)+"\n        ")])]):e._e(),e._v(" "),e.showSizes?n("div",{staticClass:"pager-sizes",class:{"mr-0":e.isMobile}},[e.isMobile?e._e():n("span",{staticClass:"grey--text darken-4"},[e._v(e._s(e.$gettext("На странице:")))]),e._v(" "),e.fixedPageSize||1===e.sizes.length?n("span",[e._v("  "+e._s(e.rowsRepPage))]):n("v-select",{staticClass:"pager-select grey--text darken-2 elevation-0",attrs:{solo:"",dense:"",items:e.sizes},on:{change:e.onPageSizeChange},model:{value:e.rowsRepPage,callback:function(t){e.rowsRepPage=t},expression:"rowsRepPage"}})],1):e._e()])],1)],1)},i=[],o=n(50103),s=n(73983),r=n(86142),a=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let l=class PagerComponent extends a.Vue{constructor(){super(...arguments),this.pages=[],this.page=0,this.count=0,this.size=10,this.from=1,this.to=10}onLastPageUnknownChanged(){this.pages=this.calcPages()}onCountPagesChanged(){"number"===typeof this.countPages&&isFinite(this.countPages)&&this.countPages>0&&(this.pages=this.calcPages(),this.onOptionsChanged())}onOptionsChanged(){let e=!1;this.page!==this.options.page&&(this.options.page>=this.totalPages+1?this.page=this.totalPages:(this.page=this.options.page?this.options.page:1,e=!0)),this.size!==this.options.pageSize&&(this.size=this.options.pageSize?this.options.pageSize:10,e=!0),this.count!==this.options.total&&(this.count=this.options.total,e=!0),e&&(this.pages=this.calcPages())}get totalPages(){if(this.countPages)return this.countPages;const e=this.size<1||0===this.size?1:Math.ceil(this.count/this.size);return Math.max(e||0,1)}get canPrevious(){return this.page>1}get canNext(){return this.page<this.totalPages}get canLast(){return Array.isArray(this.enabledPages)&&this.enabledPages.length>=this.totalPages?this.enabledPages[this.totalPages]&&this.page<this.totalPages:this.page<this.totalPages}get showSizes(){return!this.fixedPageSize&&Array.isArray(this.sizes)&&this.sizes.length}get showFromTo(){return!this.isMobile&&this.size>1&&!this.preview&&(!this.fixedPageSize||this.firstVisible&&this.lastVisible)}get showOnlyTotal(){return!this.isMobile&&this.fixedPageSize&&this.count}get rowsRepPage(){return this.fixedPageSize&&Array.isArray(this.sizes)&&this.sizes.length?this.sizes[0]||"-":this.size||"-"}set rowsRepPage(e){}get first(){var e;return null!==(e=this.firstVisible)&&void 0!==e?e:this.from}get last(){var e;return null!==(e=this.lastVisible)&&void 0!==e?e:this.to}get entityName(){if(null===this.contentType||void 0===this.contentType||!this.count)return null;let e="";switch(this.contentType){case o.zc.Document:e=(0,r.o)(this.count,"документ","документа","документов",!1);break;case o.zc.Instruction:e=(0,r.o)(this.count,"сообщение","сообщения","сообщений",!1);break;case o.zc.FastReport:e=(0,r.o)(this.count,"отчет","отчета","отчетов",!1);break;case o.zc.Vocabulary:e=(0,r.o)(this.count,"элемент","элемента","элементов",!1);break;case o.zc.Settings:e=(0,r.o)(this.count,"настройка","настройки","настроек",!1);break;case o.zc.Task:e=(0,r.o)(this.count,"задача","задачи","задач",!1);break;default:(0,s.y)(this.contentType)}return e}get rowsNounForm(){return(0,r.o)(this.count,"строка","строки","строк",!1)}updateToFrom(e){const t=this.pages.find((t=>t.number===e));if(!t)return this.from=0,void(this.to=0);this.from=(t.number-1)*this.size,this.from=this.from?this.from+1:1,this.to=this.from+this.size-1,this.to=this.to<this.count?this.to:this.count,this.to||(this.from=0)}prevPage(){this.selectPage(this.page-1)}nextPage(){this.selectPage(this.page+1)}onPageSizeChange(e){setTimeout((()=>this.$emit("change",{page:this.page,size:e})),100)}selectPage(e,t=!1){this.pageDisabled(e)||e>0&&e<=this.totalPages&&e!==this.page&&(this.page=e,this.pages=this.calcPages(e),this.updateToFrom(e),this.$emit("change",{page:e,size:this.size,toLast:t}))}calcPages(e){const t=[];let n=1;const i=this.totalPages;let o=i;const s=5,r=s<this.totalPages;e=e||this.page,r&&(n=e-Math.floor(s/2),o=e+Math.floor(s/2),n<1?(n=1,o=Math.min(n+s-1,i)):o>i&&(n=Math.max(i-s+1,1),o=i));for(let e=n;e<=o;e++)t.push({number:e,text:e.toString()});return this.lastPageUnknown&&t.push({number:o+1,text:"..."}),t}pageDisabled(e){if(Array.isArray(this.enabledPages)&&this.enabledPages.length)return!this.enabledPages[e-1]}};__decorate([(0,a.Prop)(),__metadata("design:type",Object)],l.prototype,"options",void 0),__decorate([(0,a.Prop)({type:Array,default:()=>[10,20,30]}),__metadata("design:type",Array)],l.prototype,"sizes",void 0),__decorate([(0,a.Prop)({type:Boolean,default:!0}),__metadata("design:type",Boolean)],l.prototype,"toFirst",void 0),__decorate([(0,a.Prop)({type:Boolean,default:!0}),__metadata("design:type",Boolean)],l.prototype,"toLast",void 0),__decorate([(0,a.Prop)(),__metadata("design:type",Boolean)],l.prototype,"preview",void 0),__decorate([(0,a.Prop)({default:!1}),__metadata("design:type",Boolean)],l.prototype,"fixedPageSize",void 0),__decorate([(0,a.Prop)({default:0}),__metadata("design:type",Number)],l.prototype,"countPages",void 0),__decorate([(0,a.Prop)({default:!1}),__metadata("design:type",Boolean)],l.prototype,"lastPageUnknown",void 0),__decorate([(0,a.Prop)(),__metadata("design:type",Array)],l.prototype,"enabledPages",void 0),__decorate([(0,a.Prop)(),__metadata("design:type",Number)],l.prototype,"firstVisible",void 0),__decorate([(0,a.Prop)(),__metadata("design:type",Number)],l.prototype,"lastVisible",void 0),__decorate([(0,a.Prop)(),__metadata("design:type",Number)],l.prototype,"contentType",void 0),__decorate([(0,a.Watch)("lastPageUnknown"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],l.prototype,"onLastPageUnknownChanged",null),__decorate([(0,a.Watch)("countPages"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],l.prototype,"onCountPagesChanged",null),__decorate([(0,a.Watch)("options",{immediate:!0,deep:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],l.prototype,"onOptionsChanged",null),l=__decorate([a.Component],l);const c=l,d=c;var u=n(51900),p=n(43453),h=n.n(p),m=n(17024),f=n(57894),g=n(83694),y=(0,u.Z)(d,render,i,!1,null,"f93d9018",null);const v=y.exports;h()(y,{VCol:m.Z,VRow:f.Z,VSelect:g.Z})},24377:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>K});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{class:{"action-panel fill-height align-center":!e.isCalendarMode&&!e.isColumnMode},attrs:{"no-gutters":"",justify:"space-between"},on:{click:function(e){e.preventDefault()},dblclick:function(e){e.stopPropagation(),e.preventDefault()}}},[e.processing?n("div",{staticClass:"progress-mask",class:{transparent:e.isViewOrEdit},on:{click:function(e){e.preventDefault()},dblclick:function(e){e.stopPropagation(),e.preventDefault()}}}):e._e(),e._v(" "),e.isTablet||e.isMobile||e.isLimitedMode?[n("v-row",{staticClass:"action-panel-list float-left no-gutters",style:e.visible?{}:{display:"block"},attrs:{align:"center"}},[n("div",{staticClass:"list-buttons"},e._l(e.mobileButtons,(function(t){return n("div",{key:e.getId(t),staticClass:"quick-access"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-btn",e._g({staticClass:"small-button button-mobile main-buttons text-body-1 text-capitalize font-weight-regular rounded-button elevation-0 white--text",attrs:{small:"",color:e.color(t),loading:e.isLoading(t),disabled:e.isDisabled(t)},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),e.clickMenuItem(t)}}},o),[n("v-icon",{staticClass:"main-buttons-icon",class:{"theme--dark":e.dark},attrs:{size:"20"}},[e._v("\n              "+e._s(t.actionInfo.icon)+"\n            ")])],1)]}}],null,!0)},[e._v(" "),n("span",{staticClass:"text-body-1"},[e._v(e._s(e.caption(t)))])])],1)})),0),e._v(" "),e.hasMobileMenu?n("v-menu",{staticClass:"menu-vert",attrs:{"open-on-click":"",top:!e.isViewOrEdit,bottom:e.isViewOrEdit,left:e.isViewOrEdit,right:!e.isViewOrEdit,"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""}},Object.assign({},i)),[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.menuProcessing,expression:"!menuProcessing"}],class:e.cssClass,attrs:{size:"24"}},[e._v(" more_vert ")]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.menuProcessing,expression:"menuProcessing"}],attrs:{value:18,color:"primary",indeterminate:""}})],1)]}}],null,!1,258749304),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[e._v(" "),e.lazyLoading?n("div",{staticClass:"menu-loader"},[n("v-progress-circular",{attrs:{width:3,size:30,color:"primary",indeterminate:""}})],1):n("v-list",e._l(e.mobileMenu,(function(t){return n("v-list-item",{key:e.getId(t),staticClass:"action-panel-menu-item",attrs:{id:e.getId(t),disabled:e.isDisabled(t)},on:{click:function(n){return e.clickMenuItem(t)}}},[n("v-list-item-title",[e._v(" "+e._s(e.caption(t))+" ")])],1)})),1)],1):e._e()],1)]:n("v-row",{class:{"action-panel-list float-left align-center":!e.isCalendarMode&&!e.isColumnMode},style:e.visible?{}:{display:"block"},attrs:{"no-gutters":""}},[e.isLimitedMode||e.isCalendarMode||e.isColumnMode?e._e():n("div",{staticClass:"quick-access"},e._l(e.filteredButtons(!1),(function(t,i){return n("v-btn",{key:"button-"+i,staticClass:"small-button rounded-button elevation-0 white--text",class:{"ml-2":i>0},attrs:{id:e.getId(t),small:"",color:e.color(t),loading:e.isLoading(t),disabled:e.isDisabled(t)},on:{click:function(n){return n.preventDefault(),e.clickMenuItem(t)}}},[n("v-icon",[e._v(" "+e._s(t.actionInfo.icon)+" ")]),e._v(" "),n("span",{staticClass:"success-text hidden-sm-and-down"},[e._v(" "+e._s(e.caption(t))+" ")])],1)})),1),e._v(" "),e._l(e.filteredIcons,(function(t,i){return e.isCalendarMode||e.isColumnMode?e._e():n("div",{key:t.name,staticClass:"quick-access",attrs:{id:e.getId(t)}},[n("v-tooltip",{attrs:{top:"","open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(o){var s=o.on;return[n("v-btn",e._g({staticClass:"small-round-button",class:{"ml-2":i>0},attrs:{icon:"",disabled:e.isDisabled(t)},on:{click:function(n){return n.preventDefault(),e.clickMenuItem(t)}}},s),[n("v-icon",{class:e.cssClass,attrs:{size:"20"}},[e._v(" "+e._s(t.actionInfo.icon)+" ")])],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(e.caption(t)))])])],1)})),e._v(" "),e.hasMenuItems?n("v-menu",{staticClass:"menu-vert",attrs:{"open-on-click":"",top:e.isShowMenuTop,bottom:e.isShowMenuBottom,left:e.isShowMenuLeft,right:e.isShowMenuRight,"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""}},Object.assign({},i)),[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.menuProcessing,expression:"!menuProcessing"}],class:e.cssClass,attrs:{size:"24"}},[e._v(" more_vert ")]),e._v(" "),n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.menuProcessing,expression:"menuProcessing"}],attrs:{value:18,color:"primary",indeterminate:""}})],1)]}}],null,!1,258749304),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[e._v(" "),e.lazyLoading?n("div",{staticClass:"menu-loader"},[n("v-progress-circular",{attrs:{width:3,size:30,color:"primary",indeterminate:""}})],1):n("v-list",e._l(e.menuItems,(function(t){return n("v-list-item",{key:e.getId(t),staticClass:"action-panel-menu-item",attrs:{id:e.getId(t),disabled:e.isDisabled(t)},on:{click:function(n){return e.clickMenuItem(t)}}},[n("v-list-item-title",[e._v(" "+e._s(e.caption(t))+" ")])],1)})),1)],1):e._e()],2),e._v(" "),e.isMobile||e.isViewGrid||e.isCalendarMode||e.isColumnMode?e._e():n("div",{staticClass:"right-buttons"},e._l(e.rightIcons,(function(t){return n("div",{key:t.name,attrs:{id:e.getId(t)}},[n("v-tooltip",{attrs:{top:"","open-delay":e.tooltipDelay},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-icon",e._g({attrs:{size:"24",color:"primary",disabled:e.isDisabled(t)},on:{click:function(n){return n.preventDefault(),e.clickMenuItem(t)}}},o),[e._v("\n            "+e._s(t.actionInfo.icon)+"\n          ")])]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(e.caption(t)))])])],1)})),0)],2)},i=[],o=n(95289),s=n(2557),r=n(40051),a=n(42256),l=n(50103),c=n(1869),d=n(4381),u=n(54519),p=n(76764),h=n(83149),m=n(49216),f=n(65779),g=n(37272),y=n(98005),v=n(74769);const b="envelope-square",C={DownloadResult:{id:s.k.DownloadResult,title:"Скачать файл",iconMobile:"get_app",icon:"get_app",type:v.i.Button,forMobile:!0,access(e,t){if(!t)return;const n=null===t||void 0===t?void 0:t.fastReportTaskInfo;return n&&!n.errorText&&n.taskStatus===m.ui.Complete}},RepeatReport:{id:s.k.RepeatReport,title:"Повторить отчёт",iconMobile:"replay",icon:"replay",type:v.i.Button,forMobile:!0,access(e,t){if(!t)return;const n=null===t||void 0===t?void 0:t.fastReportTaskInfo;return n&&n.taskStatus===m.ui.Complete}}},w={editDoc:{id:s.k.EditDoc,title:"Изменить",iconMobile:"edit",icon:"edit",type:v.i.Button,forMobile:!0,access(e,t){if(e&&e.document&&e.document.length)return!(!e.entityViewMode||e.entityViewMode===l.dS.Create||e.entityViewMode===l.dS.Edit||e.entityViewMode===l.dS.List)&&(!!t&&(!!Array.isArray(e.rights)&&e.rights.includes(y.K.EditDocument)))}},CreateShortcut:{id:s.k.CreateShortcut,title:"Создать ярлык",iconMobile:"label_outline",icon:"label_outline",type:v.i.Icon,forMobile:!0,access(e,t){return"DOCUMENTSHORTCUT"!==(null===t||void 0===t?void 0:t.type)}},SendMessage:{id:s.k.SendMessage,title:"Создать сообщение",iconMobile:"mail_outline",icon:"mail_outline",type:v.i.Icon,forMobile:!0},Read:{id:s.k.SetDocReaded,title:"Пометить как прочитанное",icon:b,type:v.i.Menu,forMobile:!0,access(e,t){return!(null===t||void 0===t?void 0:t.viewFlag)}},Unread:{id:s.k.SetDocUnreaded,title:"Пометить как непрочитанное",icon:b,type:v.i.Menu,forMobile:!0,access(e,t){return null===t||void 0===t?void 0:t.viewFlag}},Delete:{id:s.k.DeleteDoc,title:"Удалить",icon:"remove",type:v.i.Menu,forMobile:!0,access(e,t){var n;return e.section===a.S.Documents&&(null===(n=null===e||void 0===e?void 0:e.rights)||void 0===n?void 0:n.includes(y.K.DeleteDocument))}},RemoveShortcut:{id:s.k.RemoveShortcut,title:"Удалить ярлык",icon:"remove",type:v.i.Menu,forMobile:!0,access(e,t){return"DOCUMENTSHORTCUT"===(null===t||void 0===t?void 0:t.type)&&(null===t||void 0===t?void 0:t.viewFlag)}},ViewAction:{id:s.k.ViewDoc,title:"Просмотр документа",iconMobile:"expand",icon:"chevron_right",type:v.i.RightIcon,forEntityViewMode:[l.dS.Preview,l.dS.None,l.dS.List],redirectData:e=>{const t=e.document,n=commonParams(e);return n.context.entityViewMode=l.dS.View,t?{name:"viewDocument",params:Object.assign({id:String(t[0].id),actionType:h._.View},n)}:null}},ArchiveDoc:{id:s.k.ArchiveDoc,title:"Перенести в архив",type:v.i.Menu,icon:"archive",access:(e,t)=>{var n;return e.section===a.S.Documents&&(null===(n=null===e||void 0===e?void 0:e.rights)||void 0===n?void 0:n.includes(y.K.ArchiveDocument))}},RestoreDoc:{id:s.k.ArchiveDoc,title:"Восстановить",icon:"unarchive",type:v.i.Menu,access:(e,t)=>{var n;return e.section===a.S.Archive&&(null===(n=null===e||void 0===e?void 0:e.rights)||void 0===n?void 0:n.includes(y.K.RestoreDocument))}},ViewDocumentData:{id:s.k.ViewDocumentData,title:"Свойства",icon:"",type:v.i.Menu,access:(e,t)=>{var n;return null===(n=null===e||void 0===e?void 0:e.rights)||void 0===n?void 0:n.includes(y.K.EditDocument)}}},_={AcceptReport:{id:s.k.AcceptReport,title:"Принять отчет",icon:"check",access:"canAcceptReport",type:v.i.Button,forMobile:!0,relatedActions:[s.k.RepeatInstruction,s.k.RepeatChain,s.k.RedirectReportAsReport,s.k.RedirectReportAsInstruction,s.k.MoveToFolder]},SendReport:{id:s.k.SendReport,title:"",iconMobile:"check",icon:"done",access:"canSendReport",type:v.i.Button,relatedActions:[s.k.CreateReport,s.k.SendRejectionReport],data:f.g.Success,forMobile:!0},SendRejectionReport:{id:s.k.SendRejectionReport,title:"Отказать",iconMobile:"times",icon:"clear",access:"canSendReport",type:v.i.Button,relatedActions:[s.k.CreateReport,s.k.SendReport],data:f.g.Reject,forMobile:!0},CreateReport:{id:s.k.CreateReport,title:"Создать отчет",iconMobile:"check-square-o",icon:"create_report",access:"canCreateReport",type:v.i.Menu,forMobile:!0,relatedActions:[s.k.SendReport,s.k.SendRejectionReport]},EditReport:{id:s.k.EditReport,title:"Изменить отчет",iconMobile:"check-square-o",icon:"create_report",access:"canEditReport",type:v.i.Menu,forMobile:!0,relatedActions:[s.k.SendReport,s.k.SendRejectionReport]},RepeatMessage:{id:s.k.RepeatInstruction,title:"Повторить задание",iconMobile:"reply",icon:"reply",access:"canRepeatInstruction",forMobile:!0,type:v.i.Button},ViewAction:{id:s.k.ViewMessage,title:"Просмотр сообщения ",iconMobile:"expand",icon:"chevron_right",type:v.i.RightIcon,forEntityViewMode:[l.dS.List,l.dS.Preview,l.dS.None],redirectData:e=>{const t=e.instructionInfo[0].instruction;if(t){const n=commonParams(e);return n.context.entityViewMode=l.dS.View,{name:"viewMessage",params:Object.assign({id:String(t.id),actionType:g.xK.View},n)}}return null}},Edit:{id:s.k.Edit,title:"Изменить",icon:"pencil",access:"canEditInstruction",type:v.i.Menu,forMobile:!0,params(e){const t=e.instructionInfo[0].instruction;return t?Object.assign({id:String(t.id),actionType:g.xK.Edit},commonParams(e)):null}},Replace:{id:s.k.Replace,title:"Заменить",icon:"pencil",access:"canReplaceInstruction",type:v.i.Menu,forMobile:!0},Redirect:{id:s.k.RedirectInstruction,title:"Перенаправить сообщение",icon:"forward",access:"canRedirectInstruction",type:e=>e.entityViewMode===l.dS.View?v.i.Button:v.i.Icon,forMobile:!0},RedirectReportAsReport:{id:s.k.RedirectReportAsReport,title:"Перенаправить отчет как отчет",icon:"share",access:"canRedirectReportAsReport",type:v.i.Menu,forMobile:!0},MoveToFolder:{id:s.k.MoveToFolder,title:"Переместить в папку",icon:"folder_open",access:"canMoveInstructionToFolder",type:e=>e.entityViewMode===l.dS.View?v.i.Menu:v.i.Icon,forMobile:!1},RedirectReportAsInstruction:{id:s.k.RedirectReportAsInstruction,title:"Перенаправить отчет как сообщение",icon:"share",access:"canRedirectReportAsInstruction",type:v.i.Menu,forMobile:!0},RepeatChain:{id:s.k.RepeatChain,title:"Повторить цепочку",icon:"reply-all",access:"canRepeatChain",type:v.i.Menu,forMobile:!0},Remove:{id:s.k.RemoveMessage,title:"Удалить",icon:"trash-o",access:"canDeleteInstruction",type:v.i.Menu,forMobile:!0},ToWork:{id:s.k.ToWork,title:"Взять в работу",icon:"briefcase",access:"canTakeInstructionInWork",type:v.i.Menu,forMobile:!0},Revoke:{id:s.k.Revoke,title:"Отозвать",icon:"undo",type:v.i.Menu,forMobile:!0,access(e){if(!e||!e.instructionInfo||!e.instructionInfo.length)return!1;const t=e.instructionInfo[0];return t&&t.permissions&&(t.permissions.canRevokeInstruction||t.permissions.canRevokeChain)}},Archive:{id:s.k.Archive,title:"Переместить в архив",icon:"archive",access:"canArchiveInstruction",type:v.i.Button,forMobile:!0},Restore:{id:s.k.Restore,title:"Восстановить из архива",icon:"unarchive",type:v.i.Menu,forMobile:!0,access:"canRestoreInstructionFromArchive"},Read:{id:s.k.SetMessageReaded,title:"Пометить как прочитанное",icon:b,access:"canReadInstruction",type:v.i.Menu,forMobile:!0},Unread:{id:s.k.SetMessageUnreaded,title:"Пометить как непрочитанное",icon:b,access:"canUnreadInstruction",type:v.i.Menu,forMobile:!0}},x={Restore:{id:s.k.Restore,title:"Восстановить из архива",icon:"unarchive",type:v.i.Menu,forMobile:!0,access:(e,t)=>!(!t||!("permissions"in t))&&t.permissions.canRestoreInstructionFromArchive},ArchiveDoc:{id:s.k.ArchiveDoc,title:"Восстановить",icon:"unarchive",type:v.i.Menu,access:(e,t)=>!e.instructionInfo&&e.rights&&e.rights.includes(y.K.RestoreDocument)},MoveToFolder:{id:s.k.MoveToFolder,title:"Переместить в папку",icon:"folder_open",access:(e,t)=>!(!t||!("permissions"in t))&&t.permissions.canMoveInstructionToFolder,type:v.i.Icon,forMobile:!1}};function commonParams(e){return{folderId:String(e.folderId),folderName:e.folderName,context:e}}var S=n(69548),I=n(92673),D=n(71148),R=n(86700),T=n(79882),P=n(73718),O=n(54486),k=n(29339),F=n(51414),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let A=0,$=class ActionPanelComponent extends k.Vue{constructor(){super(...arguments),this.items=[],this.isReadOnly=!1,this.processing=!1,this.menuProcessing=!1,this.showMenu=!1,this.allowMultiActions=[s.k.ArchiveDoc,s.k.Archive,s.k.AcceptReport,s.k.SendMessage,s.k.RedirectInstruction,s.k.RedirectReportAsInstruction],this.allowedMultiActionsConditions={[(0,r.o)(s.k.AcceptReport)]:e=>!e.permissions.canRedirectReportAsReport},this.id=0,this.entities=null,this.lazyLoading=!1,this.tooltipDelay=500}onContextChanged(e,t){var n,i,o;e&&!(0,P.Z)(e,this.lastContext)&&(this.lastContext=(0,T.Z)(this.context,(e=>{if(e instanceof R.W2)return e})),this.entities=this.context.entity,this.context&&!this.entities&&(this.context.section===a.S.Archive?this.entities=[].concat(this.context.document).concat(this.context.instructionInfo):(this.entities=null!==(o=null!==(i=null!==(n=this.context.instructionInfo)&&void 0!==n?n:this.context.document)&&void 0!==i?i:this.context.fastReport)&&void 0!==o?o:this.context.catalogue,this.context.entity=this.entities)),Array.isArray(this.entities)?(this.entities=this.entities.filter(Boolean),this.entities.length?0===this.items.length?(this.createActionItems(),this.onCustomActionsChanged()):this.refreshActionItems():this.items=[]):this.entities=[])}onShowMenuChanged(e){return __awaiter(this,void 0,void 0,(function*(){if(e&&this.isSingleEntity&&this.lazyEntityUpdate)try{const e=this.getFirstEntity();if(!e.fullyRead){this.lazyLoading=!0;const e=yield this.lazyEntityUpdate();if(!e)return;this.setEntityToContext(e),this.showMenu=!1,this.$nextTick((()=>{this.showMenu=!0}))}}catch(e){this.$log.error(e)}finally{this.lazyLoading=!1}}))}onCustomMultiActionsChanged(){this.refresh()}onResetCounterChanged(){var e;this.items&&this.items.forEach((e=>{e.disabled=!1,e.loading=!1})),(null===(e=this.context)||void 0===e?void 0:e.entity)&&this.refresh()}onCustomActionsChanged(){Array.isArray(this.customActions)&&this.customActions.forEach((e=>{const t=this.items.findIndex((t=>t.actionInfo.id===s.k.CardCustomAction&&t.uid===e.uid));if(t<=0)this.items.push(e);else{const n=this.items[t];e!==n&&this.$set(this.items,t,e)}}))}onActionOverlaysChanged(){let e=!1;Array.isArray(this.actionOverlays)&&this.actionOverlays.forEach((t=>{const n=this.items.findIndex((e=>e.actionInfo.id===t.id));if(n>=0){const i=this.items[n];"disabled"in t&&(this.$set(i,"disabled",t.disabled),e=!0),"visibled"in t&&(this.$set(i,"visibled",t.visibled),e=!0),"title"in t&&(i.actionInfo.title=t.title,e=!0),"type"in t&&(i.actionInfo.type=t.type,e=!0),"icon"in t&&(i.actionInfo.icon=t.icon,e=!0),"beforeExec"in t&&i.actionInfo.action&&(i.actionInfo.beforeExec=t.beforeExec)}})),e&&this.$forceUpdate()}created(){D.X.$on("refresh-action-panel",this.refresh),this.id=A++}mounted(){const e=document.getElementById("iterator-list");e&&(this.onScrollHandler=this.onScroll.bind(this),e.addEventListener("scroll",this.onScrollHandler,{passive:!0}))}beforeDestroy(){this.onScrollHandler&&document.removeEventListener("scroll",this.onScrollHandler),D.X.$off("refresh-action-panel",this.refresh)}setEntityToContext(e){if(e)switch(this.context.entity=e,this.context.contentType){case l.zc.Instruction:this.context.instructionInfo=e;break;case l.zc.Document:this.context.document=e;break;case l.zc.FastReport:this.context.fastReport=e;break;case l.zc.Vocabulary:this.context.catalogue=e;break;default:break}}refresh(){this.refreshActionItems()}onScroll(){this.showMenu=!1}checkAccess(e,t){return!(!t||!("permissions"in t))&&(null===t||void 0===t?void 0:t.permissions[e])}filteredButtons(e=!1){let t=this.items.filter((t=>{const n=e?this.isButtonMobile(t):this.isButton(t);return this.show(t)&&n}));const n=t.findIndex((e=>e.actionInfo.id===s.k.Archive));return n>0&&(t=[...t.splice(n,1),...t]),t}createActionItems(){var e,t,n;let i=this.items;if(this.items=[],this.context.contentType===l.zc.Instruction&&this.isSingleEntity){const n=null!==(e=this.context.entity[0])&&void 0!==e?e:this.context.instructionInfo[0],o=this.getInstructionActionMenuItems(Number(this.context.folderId),Number(null===(t=n.instruction)||void 0===t?void 0:t.id));o&&(i=o.filter((e=>e.actionInfo.id!==s.k.CardCustomAction)))}let o=null,r=this.entities,getId=e=>null;this.isSingleEntity?(this.context.contentType===l.zc.Instruction&&(o=_,r=null!==r&&void 0!==r?r:this.context.instructionInfo,getId=e=>e.instruction.id),this.context.contentType===l.zc.Document&&(o=w,r=null!==r&&void 0!==r?r:this.context.document,getId=e=>e.id),this.context.contentType===l.zc.FastReport&&(o=C,r=null!==r&&void 0!==r?r:this.context.fastReport,getId=e=>e.id)):(this.context.section===a.S.Messages&&(o=_,r=null!==r&&void 0!==r?r:this.context.instructionInfo,getId=e=>e.instruction.id),this.context.section===a.S.Documents&&(o=w,r=null!==r&&void 0!==r?r:this.context.document,getId=e=>e.id),this.context.section===a.S.Reports&&(o=C,r=null!==r&&void 0!==r?r:this.context.fastReport,getId=e=>e.id),this.context.section===a.S.Archive&&(o=x,r=null!==r&&void 0!==r?r:this.context.document,r=null!==r&&void 0!==r?r:(r||[]).concat(this.context.instructionInfo),getId=e=>"id"in e?e.id:"instruction"in e?e["instruction"].id:null)),(r||[]).forEach((e=>{var t;let n=this.getActionsForEntity(o,e);this.customMultiActions&&(n=n.concat(null!==(t=this.customMultiActions[getId(e)])&&void 0!==t?t:[])),this.accumulateActions(this.items,n,e)})),this.isSingleEntity&&(this.context.contentType===l.zc.Instruction&&Array.isArray(this.context.instructionInfo)?this.setInstructionMenuActions({folderId:Number(this.context.folderId),id:Number(null===(n=this.context.instructionInfo[0].instruction)||void 0===n?void 0:n.id),items:this.items}):this.context.contentType===l.zc.Document&&Array.isArray(this.context.document)?this.setDocumentMenuActions({journalId:Number(this.context.folderId),id:this.context.document[0].id,items:this.items}):this.context.contentType===l.zc.FastReport&&Array.isArray(this.context.fastReport)&&this.setFastReportMenuActions({items:this.items})),i&&i.length&&this.items.forEach((e=>{const t=i.find((t=>t.actionInfo.id===e.actionInfo.id));t&&(e.disabled=t.disabled,"visibled"in t&&(e.visibled=t.visibled),e.loading=t.loading)}))}accumulateActions(e,t,n){(t||[]).forEach((t=>{if(!this.isSingleEntity){if(t.actionInfo.id===s.k.CardCustomAction&&!t.actionInfo.multi)return;if(t.actionInfo.id!==s.k.CardCustomAction&&!this.allowMultiActions.includes(t.actionInfo.id))return;if(this.allowedMultiActionsConditions[(0,r.o)(t.actionInfo.id)]&&!this.allowedMultiActionsConditions[(0,r.o)(t.actionInfo.id)](n))return}let i=null;this.isSingleEntity||(i=e.find((e=>t.actionInfo.id===s.k.CardCustomAction?e.actionInfo.id===t.actionInfo.id&&e.uid===t.uid:e.actionInfo.id===t.actionInfo.id))),i?i.entities.push(n):(t.entities=[n],e.push(t))}))}getActionsForEntity(e,t){const n=[];return Object.keys(e).forEach((i=>{const o=e[i],s=Boolean(o.access);let r=!s;r=!s||("function"===typeof o.access?o.access(this.context,t):this.checkAccess(o.access,t)),this.context.section===a.S.Kanban&&(r=r&&!d.g.excludeActions.includes(i)),r&&(o.redirectData||(o.action=this.container.get(o.id)),(o.redirectData||o.action)&&n.push({actionInfo:o,loading:!1,disabled:!1}))})),n}refreshActionItems(){this.isSingleEntity&&(this.context.contentType===l.zc.Instruction&&Array.isArray(this.context.instructionInfo)&&this.context.instructionInfo.length?this.setInstructionMenuActions({folderId:Number(this.context.folderId),id:Number(this.context.instructionInfo[0].instruction.id),items:null}):this.context.contentType===l.zc.Document&&Array.isArray(this.context.document)&&this.context.document.length&&this.setDocumentMenuActions({journalId:Number(this.context.folderId),id:this.context.document[0].id,items:null})),this.createActionItems(),this.onCustomActionsChanged()}show(e){return!(e.actionInfo.forEntityViewMode&&!e.actionInfo.forEntityViewMode.includes(this.context.entityViewMode))&&(!("visibled"in e)||e.visibled)}caption(e){if(e.actionInfo.title)return!this.isSingleEntity&&Array.isArray(e.entities)&&e.entities.length?`${e.actionInfo.title}(${e.entities.length})`:e.actionInfo.title;try{return e.actionInfo.action.caption(this.context)}catch(e){this.$log.error(e)}}count(e){return!this.isSingleEntity&&Array.isArray(e.entities)&&e.entities.length?e.entities.length:null}color(e){switch(e.actionInfo.id){case s.k.AcceptReport:case s.k.SendReport:return"success";case s.k.SendRejectionReport:case s.k.RepeatInstruction:return"warning";case s.k.EditDoc:return"primary";default:return"grey"}}clickMenuItem(e){var t,n,i,s,r,a;return __awaiter(this,void 0,void 0,(function*(){if(!e)return;let c=!0;if(this.isSingleEntity){const t=this.getFirstEntity();if(!t.fullyRead&&this.lazyEntityUpdate){this.changeStatus(e,"loading",!0);const t=yield this.lazyEntityUpdate();this.setEntityToContext(t),c=!1}}this.context.container=this.container;const d=Object.assign({},this.context);if(c&&e.entities)switch(d.entity=e.entities,d.contentType){case l.zc.Instruction:d.instructionInfo=e.entities;break;case l.zc.Document:d.document=e.entities;break;case l.zc.FastReport:d.fastReport=e.entities;break;default:break}if(null===(t=e.actionInfo)||void 0===t?void 0:t.redirectData){const t=null===(n=null===e||void 0===e?void 0:e.actionInfo)||void 0===n?void 0:n.redirectData(d);if(!t)throw new Error(`Not found route to "${e.actionInfo.title}" action`);t.params&&(t.params.collectionViewMode=Number(d.collectionViewMode)),yield this.$app.goto(e.actionInfo.id,d,t.params)}else if(null===(s=null===(i=e.actionInfo)||void 0===i?void 0:i.action)||void 0===s?void 0:s.execAsync){if((null===(r=e.actionInfo)||void 0===r?void 0:r.beforeExec)&&!(yield null===(a=e.actionInfo)||void 0===a?void 0:a.beforeExec(d)))return;let t;const n=e.actionInfo.relatedActions,i=[e.actionInfo.id];try{this.$emit("action-processing",!0),this.processing=!0,this.isMenu(e)&&(this.menuProcessing=!0),this.changeStatus(e,"loading",!0),Array.isArray(e.entities)&&e.entities.forEach((e=>{switch(d.contentType){case l.zc.Instruction:this.updateInstrActionsMutation({folderId:Number(this.context.folderId),id:Number(e.instruction.id),status:!0,disabledItems:n,loadingItems:i});break;case l.zc.Document:this.updateDocActionsMutation({folderId:Number(this.context.folderId),id:Number(e.id),status:!0,disabledItems:n,loadingItems:i});break;default:break}})),d.data=e.actionInfo.data;let s={vm:this};"function"===typeof e.actionInfo.params&&(s=Object.assign(s,e.actionInfo.params(d))),t=yield this.$app.do(e.actionInfo.id,d,s),t||(t={status:o.Ao.None,type:o.uE.Error})}catch(e){this.$log.error(e),t={status:o.Ao.None,message:e.message,type:o.uE.Error}}finally{this.$emit("action-processing",!1),this.processing=!1,this.menuProcessing=!1,e=this.items.find((t=>t.actionInfo.id===e.actionInfo.id&&t.uid===e.uid)),this.changeStatus(e,"loading",!1),this.$emit("action-result",t,d),Array.isArray(null===e||void 0===e?void 0:e.entities)&&e.entities.forEach((e=>{switch(d.contentType){case l.zc.Instruction:this.updateInstrActionsMutation({folderId:Number(this.context.folderId),id:Number(e.instruction.id),status:!1,disabledItems:n,loadingItems:i});break;case l.zc.Document:this.updateDocActionsMutation({folderId:Number(this.context.folderId),id:Number(e.id),status:!1,disabledItems:n,loadingItems:i});break;default:break}})),t&&"object"===typeof t&&([o.Ao.None,o.Ao.Updated].includes(t.status)||this.$emit("refresh",d,t.status))}}else if(null===e||void 0===e?void 0:e.callback)try{e.callback(d),this.$emit("action-result",{type:o.uE.Completed,status:o.Ao.None},d)}catch(e){this.$log.error(e)}}))}abortRedirect(e){D.X.$emit("abort-transition",e)}isDisabled(e){return e.disabled}isLoading(e){return e.loading}changeStatus(e,t,n,i=!1){e&&(e[t]=!!n,e.actionInfo.relatedActions&&!i&&e.actionInfo.relatedActions.forEach((e=>{const t=this.items.find((t=>t.actionInfo.id===e));t&&this.changeStatus(t,"disabled",n,!0)})))}unlockActions(){this.items.forEach((e=>{e.disabled=!1,e.loading=!1}))}lockAction(e){const t=this.items.find((t=>t.actionInfo.id===e));t&&this.changeStatus(t,"disabled",!0)}checkType(e,t){return"function"===typeof e?e(this.context)===t:e===t}isIcon(e){return this.checkType(e.actionInfo.type,v.i.Icon)}isRightIcon(e){return this.checkType(e.actionInfo.type,v.i.RightIcon)}isButton(e){return this.checkType(e.actionInfo.type,v.i.Button)}isButtonMobile(e){return this.isButton(e)&&e.actionInfo.forMobile}isMenu(e){return this.checkType(e.actionInfo.type,v.i.Menu)}isArchiveItem(e){return e.actionInfo.id===s.k.Archive}getId(e){return e.actionInfo.id===s.k.CardCustomAction?`${Symbol.keyFor(e.actionInfo.id)}-${e.uid}`:Symbol.keyFor(e.actionInfo.id)}getFirstEntity(){var e,t,n;let i=this.context.entity;return this.context&&!i&&(i=this.context.section===a.S.Archive?[].concat(this.context.document).concat(this.context.instructionInfo):null!==(n=null!==(t=null!==(e=this.context.instructionInfo)&&void 0!==e?e:this.context.document)&&void 0!==t?t:this.context.fastReport)&&void 0!==n?n:this.context.catalogue),Array.isArray(i)&&i.length?i[0]:null}get isSingleEntity(){var e,t;if((null===(t=null===(e=this.context)||void 0===e?void 0:e.entity)||void 0===t?void 0:t.length)>1)return!1;const n=["instructionInfo","document","catalogue","fastReport"];return n.forEach((e=>{var t;if(this.context&&(null===(t=this.context[e])||void 0===t?void 0:t.length)>1)return!1})),!0}get isViewOrEdit(){switch(this.context.entityViewMode){case l.dS.View:case l.dS.Create:case l.dS.Edit:return!0;default:return!1}}get isViewGrid(){var e,t;return this.isSingleEntity&&(null===(e=this.context)||void 0===e?void 0:e.collectionViewMode)===l.Ml.Grid&&(null===(t=this.context)||void 0===t?void 0:t.entityViewMode)!==l.dS.Preview}get isLimitedMode(){return!!this.context&&this.context.limitedMode}get cssClass(){if(this.dark)return["white--text"];const e=["grey--text"];return this.isCalendarMode||this.isColumnMode?e.push("lighten-6"):e.push("darken-3"),e}get visibleItems(){return this.items.filter((e=>this.show(e)&&!this.isDisabled(e)))}get filteredIcons(){let e=this.items.filter((e=>this.isIcon(e)&&this.show(e)));const t=e.findIndex((e=>e.actionInfo.id===s.k.Archive));return t>0&&(e=[...e.splice(t,1),...e]),e}get rightIcons(){return this.items.filter((e=>this.isRightIcon(e)&&this.show(e)))}get menuItems(){return this.isCalendarMode?this.items:this.isColumnMode?this.items.filter((e=>!this.isButton(e))):this.items.filter((e=>this.isMenu(e)&&this.show(e)))}get hasMenuItems(){return this.menuItems.length>0}get mobileMenu(){return this.items.filter((e=>this.isMenu(e)&&this.show(e)||!this.isRightIcon(e)&&!e.actionInfo.forMobile))}get hasMobileMenu(){return this.mobileMenu.length>0}get mobileButtons(){let e=this.items.filter((e=>e.actionInfo.forMobile&&(this.isButton(e)||this.isIcon(e))&&this.show(e)));const t=e.findIndex((e=>e.actionInfo.id===s.k.Archive));return t>0&&(e=[...e.splice(t,1),...e]),e}get isMobile(){return null!=this.forceIsMobile?this.forceIsMobile:this.$root.isMobile}get isTablet(){return null!=this.forceIsTablet?this.forceIsTablet:this.$root.isTablet}get isCalendarMode(){return this.mode===S.H.Calendar}get isColumnMode(){return this.mode===S.H.Kanban}get isShowMenuTop(){return!this.isViewOrEdit}get isShowMenuBottom(){return!this.isShowMenuTop}get isShowMenuLeft(){return this.isViewOrEdit}get isShowMenuRight(){return!this.isShowMenuLeft}};__decorate([(0,k.Prop)({type:Object,default:{}}),__metadata("design:type",Object)],$.prototype,"context",void 0),__decorate([(0,k.Prop)({type:Boolean,default:!0}),__metadata("design:type",Boolean)],$.prototype,"visible",void 0),__decorate([(0,k.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],$.prototype,"dark",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Boolean)],$.prototype,"loading",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Number)],$.prototype,"resetCounter",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Number)],$.prototype,"mode",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Array)],$.prototype,"customActions",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Object)],$.prototype,"customMultiActions",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Array)],$.prototype,"actionOverlays",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Boolean)],$.prototype,"forceIsMobile",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Boolean)],$.prototype,"forceIsTablet",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Function)],$.prototype,"lazyEntityUpdate",void 0),__decorate([(0,O.t)(I.t.Container),__metadata("design:type",R.W2)],$.prototype,"container",void 0),__decorate([(0,O.t)(c.M.IQueryBus),__metadata("design:type",Object)],$.prototype,"queryBus",void 0),__decorate([(0,p.Y)("getInstructionActionMenuItems"),__metadata("design:type",Object)],$.prototype,"getInstructionActionMenuItems",void 0),__decorate([(0,u.k)("getDocActionMenuItems"),__metadata("design:type",Object)],$.prototype,"getDocActionMenuItems",void 0),__decorate([(0,F.mm)("SET_MENU_ACTIONS",{namespace:"instructions"}),__metadata("design:type",Function)],$.prototype,"setInstructionMenuActions",void 0),__decorate([(0,F.mm)("UPDATE_ACTIONS",{namespace:"instructions"}),__metadata("design:type",Function)],$.prototype,"updateInstrActionsMutation",void 0),__decorate([(0,F.mm)("SET_MENU_ACTIONS",{namespace:"documents"}),__metadata("design:type",Function)],$.prototype,"setDocumentMenuActions",void 0),__decorate([(0,F.mm)("UPDATE_ACTIONS",{namespace:"documents"}),__metadata("design:type",Function)],$.prototype,"updateDocActionsMutation",void 0),__decorate([(0,F.mm)("SET_MENU_ACTIONS",{namespace:"reports"}),__metadata("design:type",Function)],$.prototype,"setFastReportMenuActions",void 0),__decorate([(0,F.mm)("SET_ARCHIVE_MENU_ACTIONS"),__metadata("design:type",Function)],$.prototype,"setArchiveMenuActions",void 0),__decorate([(0,k.Watch)("context",{immediate:!0,deep:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",void 0)],$.prototype,"onContextChanged",null),__decorate([(0,k.Watch)("showMenu"),__metadata("design:type",Function),__metadata("design:paramtypes",[Boolean]),__metadata("design:returntype",Promise)],$.prototype,"onShowMenuChanged",null),__decorate([(0,k.Watch)("customMultiActions"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],$.prototype,"onCustomMultiActionsChanged",null),__decorate([(0,k.Watch)("resetCounter"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],$.prototype,"onResetCounterChanged",null),__decorate([(0,k.Watch)("customActions"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],$.prototype,"onCustomActionsChanged",null),__decorate([(0,k.Watch)("actionOverlays"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],$.prototype,"onActionOverlaysChanged",null),$=__decorate([k.Component],$);const j=$,E=j;var M=n(51900),N=n(43453),V=n.n(N),B=n(82127),L=n(71100),U=n(54983),H=n(53760),Q=n(45903),z=n(51333),Z=n(95467),W=n(57894),q=n(7442),G=(0,M.Z)(E,render,i,!1,null,"050a3b82",null);const K=G.exports;V()(G,{VBtn:B.Z,VIcon:L.Z,VList:U.Z,VListItem:H.Z,VListItemTitle:Q.V9,VMenu:z.Z,VProgressCircular:Z.Z,VRow:W.Z,VTooltip:q.Z})},38484:(e,t,n)=>{"use strict";n.d(t,{Z:()=>j});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"attach-doc-wrapper",class:{mobile:e.isMobile}},[e.isMobile?[n("div",{staticStyle:{height:"100%"}},[n("v-row",{staticClass:"no-gutters"},[e.hasDocument?n("v-row",{staticClass:"no-gutters"},[n("v-text-field",{staticClass:"small-input rounded-border body-1 font-weight-light base-document-input",attrs:{type:"text","data-testid":"documentName",flat:"",solo:"","single-line":"",outlined:"",disabled:""},model:{value:e.documentName,callback:function(t){e.documentName=t},expression:"documentName"}})],1):e._e(),e._v(" "),e.hasDocument?n("v-row",{staticClass:"no-gutters button-width",attrs:{justify:"end"}},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"rounded-button square-sm-button mx-0 elevation-0 my-0 ml-2",attrs:{outlined:"",color:"primary","data-testid":"documentPreview"},on:{click:e.openDocument}},i),[n("svg-icon",{staticClass:"svg-icon primary--text",attrs:{icon:"substract-document"}})],1)]}}],null,!1,1085484220)},[e._v(" "),n("translate",[e._v("Просмотр документа")])],1),e._v(" "),n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"rounded-button font-weight-regular square-sm-button mx-0 elevation-0 my-0 ml-2",attrs:{outlined:"",color:"warning","data-testid":"clearBtn",disabled:!e.docChangeable},on:{click:e.clearSelectedDocument}},i),[n("v-icon",{attrs:{color:"warning"}},[e._v("clear")])],1)]}}],null,!1,2311563987)},[e._v(" "),n("translate",[e._v("Очистить")])],1)],1):e._e()],1),e._v(" "),!e.modal&&e.files&&e.files.length?n("v-row",{staticClass:"mt-2 no-gutters"},[n("v-col",{attrs:{cols:"12"}},[e.showDownloadBtn?n("v-col",{staticClass:"px-0 py-0 mb-2",attrs:{disabled:!e.hasFilesToView,xl:"12",lg:"12",md:"12",sm:"12",cols:"12"}},[n("v-btn",{staticClass:"ml-0 small-button downloadBtn black--text lighten-1",attrs:{id:"adDownloadAll",outlined:""},on:{click:e.downloadAll}},[n("v-icon",{staticClass:"grey--text darken-3",staticStyle:{transform:"rotate(180deg)"}},[e._v(" publish ")]),e._v(" "),n("translate",[e._v("Скачать все файлы")])],1)],1):e._e(),e._v(" "),n("v-row",{staticClass:"new-message-form-group-files pl-0 pt-0 no-gutters"},[n("v-col",{attrs:{md:"12"}},[n("ul",{staticClass:"message-attachment-list pl-0 sm-text"},e._l(e.files,(function(t){return n("li",{staticClass:"message-attachment-item-info message-attachment-item ml-0 py-0"},[n("div",{staticClass:"d-flex align-center"},[n("div",{staticClass:"attachment"},[n("ld-attachment",{attrs:{file:t,short:e.short},on:{click:e.downloadFile}})],1),e._v(" "),e.checkToPreview(t)?n("div",{staticClass:"file-action"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""},on:{click:function(n){return e.openFilePreview(t)}}},o),[n("v-icon",{staticClass:"medium-icon grey--text darken-3",attrs:{size:"18",outlined:""}},[e._v(" remove_red_eye ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Просмотр файла")])],1)],1):e._e(),e._v(" "),e.showDownloadBtn?n("div",{staticClass:"file-action"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""},on:{click:function(n){return e.downloadFile(t)}}},o),[n("v-icon",{staticClass:"medium-icon grey--text darken-3",attrs:{size:"18",outlined:""}},[e._v(" get_app ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Скачать файл")])],1)],1):e._e()])])})),0)])],1)],1)],1):e._e(),e._v(" "),e.canAddFiles&&e.showDropzone?n("v-row",{staticClass:"mt-2 no-gutters",attrs:{column:"",id:"dropzone"}},[!e.modal&&e.showSelectDocButton?n("v-col",{staticClass:"mb-1"},[e._v(e._s(e.$gettext("или загрузите файлы")))]):e._e(),e._v(" "),n("v-col",{attrs:{cols:"12"}},[e.hasDocument?e._e():n("div",{staticClass:"px-0"},[n("file-upload",{ref:"upload",staticClass:"upload",attrs:{drop:!0,"allowed-file-extensions":e.filteredAllowedExtensions},on:{"file-loaded":e.uploadFile}})],1)])],1):e._e(),e._v(" "),e.modal&&e.hasFilesToView?n("div",{staticClass:"mt-1 mobile-files-list"},[n("ul",{staticClass:"files-list"},e._l(e.filesToView,(function(t,i){return n("li",{key:t.id||t.uid||t.name},[n("div",{staticClass:"file-info",class:{"new-file":e.isNewFile(t)}},[n("v-row",{staticClass:"no-gutters justify-space-between align-center",staticStyle:{width:"100%"}},[n("v-col",{staticStyle:{"max-width":"15px"}},[n("v-icon",[e._v(e._s(e.extIco(t)))])],1),e._v(" "),n("v-col",{staticClass:"col-10"},[n("div",{staticClass:"file-name ml-1"},[n("span",{staticClass:"file-name__text",class:e.fileNameClass(t)},[e._v(" "+e._s(e.fileName(t))+" ")]),e._v(" "),t.size||t.sizeKb?n("span",{staticClass:"file-status",class:e.fileNameClass(t)},[e._v("\n                  "+e._s(e.fileStatus(t))+"\n                ")]):e._e()])]),e._v(" "),n("v-col",{staticClass:"col-1"},[n("v-icon",{staticClass:"deleteIcon",on:{click:function(n){return e.removeUploadFile(t)}}},[e._v("close")])],1)],1)],1)])})),0)]):e._e()],1)]:e.isMobile?e._e():[n("v-row",{staticClass:"no-gutters flex-nowrap"},[e.hasDocument?n("div",{staticClass:"pr-3 d-flex align-center flex-basis-100"},[n("v-text-field",{staticClass:"small-input rounded-border body-1 font-weight-light base-document-input",attrs:{type:"text","data-testid":"documentName",flat:"",solo:"","single-line":"",outlined:"",disabled:""},model:{value:e.documentName,callback:function(t){e.documentName=t},expression:"documentName"}})],1):e._e(),e._v(" "),e.hasDocument?n("div",{staticClass:"d-flex align-center justify-end flex-shrink-0 pr-1"},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"rounded-button font-weight-regular square-sm-button mx-0 elevation-0 my-0",attrs:{description:"",outlined:"",color:"primary","data-testid":"chooseDocBtn",disabled:!e.docChangeable},on:{click:e.showSelectDocumentModal}},i),[n("v-icon",{attrs:{color:"primary"}},[e._v("description")])],1)]}}],null,!1,3904164062)},[e._v(" "),n("translate",[e._v("Выбрать документ")])],1),e._v(" "),n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"rounded-button square-sm-button mx-0 elevation-0 my-0 ml-2",attrs:{outlined:"",color:"primary","data-testid":"documentPreview"},on:{click:e.openDocument}},i),[n("v-icon",{attrs:{color:"primary"}},[e._v("open_in_browser")])],1)]}}],null,!1,3219092479)},[e._v(" "),n("translate",[e._v("Просмотр документа")])],1),e._v(" "),n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"rounded-button font-weight-regular square-sm-button mx-0 elevation-0 my-0 ml-2",attrs:{outlined:"",color:"warning","data-testid":"clearBtn",disabled:!e.docChangeable},on:{click:e.clearSelectedDocument}},i),[n("v-icon",{attrs:{color:"warning"}},[e._v("clear")])],1)]}}],null,!1,2311563987)},[e._v(" "),n("translate",[e._v("Очистить")])],1)],1):e._e(),e._v(" "),e.showSelectDocButton?n("v-col",{attrs:{cols:"12"}},[!e.modal&&e.docChangeable?n("v-btn",{staticClass:"rounded-button font-weight-regular small-button mx-0 elevation-0 my-0",attrs:{color:"primary","data-testid":"chooseDocBtn"},on:{click:e.showSelectDocumentModal}},[n("translate",[e._v("Выбрать")])],1):e.modal?n("v-btn",{staticClass:"rounded-button font-weight-regular small-button mx-0 elevation-0 my-0",attrs:{outlined:"",color:"primary","data-testid":"chooseDocBtn",disabled:e.isInstructionReplaceOrRepeat},on:{click:e.showSelectDocumentModal}},[n("v-icon",{attrs:{color:"primary-text"}},[e._v("description")]),e._v(" "),n("span",[e._v(" "+e._s(e.isReport?e.$gettext("Ответный документ"):e.$gettext("Документ-основание"))+" ")])],1):e._e()],1):e._e()],1),e._v(" "),!e.canAddFiles&&e.files&&e.files.length&&!e.isDocument?n("v-row",{staticClass:"mt-2 no-gutters"},[n("v-col",{attrs:{cols:"12"}},[e.showDownloadBtn?n("v-col",{staticClass:"px-0 py-0 mb-2",attrs:{disabled:!e.hasFilesToView,cols:"12"}},[n("v-btn",{staticClass:"ml-0 small-button downloadBtn black--text lighten-1",attrs:{id:"adDownloadAll",outlined:""},on:{click:e.downloadAll}},[n("v-icon",{staticClass:"grey--text darken-3",staticStyle:{transform:"rotate(180deg)"}},[e._v(" publish ")]),e._v(" "),n("translate",[e._v("Скачать все файлы")])],1)],1):e._e(),e._v(" "),n("v-row",{staticClass:"new-message-form-group-files pl-0 pt-0 no-gutters"},[n("v-col",{attrs:{md:"12"}},[n("ul",{staticClass:"message-attachment-list pl-0 sm-text"},e._l(e.files,(function(t){return n("li",{staticClass:"message-attachment-item-info message-attachment-item ml-0 py-0"},[n("div",{staticClass:"d-flex align-center"},[n("div",{staticClass:"attachment"},[n("ld-attachment",{attrs:{file:t,short:e.short},on:{click:e.downloadFile}})],1),e._v(" "),e.checkToPreview(t)?n("div",{staticClass:"file-action"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""},on:{click:function(n){return e.openFilePreview(t)}}},o),[n("v-icon",{staticClass:"medium-icon grey--text darken-3",attrs:{size:"18",outlined:""}},[e._v(" remove_red_eye ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Просмотр файла")])],1)],1):e._e(),e._v(" "),e.showDownloadBtn?n("div",{staticClass:"file-action"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""},on:{click:function(n){return e.downloadFile(t)}}},o),[n("v-icon",{staticClass:"medium-icon grey--text darken-3",attrs:{size:"18",outlined:""}},[e._v(" get_app ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Скачать файл")])],1)],1):e._e()])])})),0)])],1)],1)],1):e._e(),e._v(" "),e.templateBtnShow?n("v-row",{staticClass:"mt-1",attrs:{"no-gutters":"",column:""}},[n("v-col",{attrs:{cols:"12"}},[n("v-btn",{staticClass:"small-button black--text lighten-1 grey--border lighten-3",attrs:{outlined:""},on:{click:e.addTemplate}},[n("v-icon",{attrs:{color:"grey"}},[e._v(" add ")]),e._v(" "),n("translate",[e._v("Шаблон")])],1)],1)],1):e._e(),e._v(" "),e.canAddFiles&&e.showDropzone?n("v-row",{staticClass:"mt-2 no-gutters",attrs:{column:"",id:"dropzone"}},[!e.modal&&e.showSelectDocButton?n("v-col",{staticClass:"mb-1"},[e._v(e._s(e.$gettext("или загрузите файлы")))]):e._e(),e._v(" "),n("v-col",{attrs:{cols:"12"}},[e.hasDocument?e._e():n("div",{staticClass:"px-0"},[n("file-upload",{ref:"upload",staticClass:"upload",attrs:{drop:!0,"allowed-file-extensions":e.filteredAllowedExtensions},on:{"file-loaded":e.onFileLoaded}})],1)])],1):e._e(),e._v(" "),e.canAddFiles&&e.hasFilesToView?n("div",{staticClass:"mt-1"},[n("ul",{staticClass:"files-list"},e._l(e.filesToView,(function(t,i){return n("li",{key:t.id||t.uid||t.name},[n("div",{staticClass:"file-info",class:{"new-file":e.isNewFile(t)}},[n("v-row",{staticClass:"no-gutters justify-space-between align-center",staticStyle:{width:"100%"}},[n("v-col",{staticStyle:{"max-width":"15px"}},[n("v-icon",[e._v(e._s(e.extIco(t)))])],1),e._v(" "),n("v-col",{attrs:{cols:"9"}},[n("div",{staticClass:"file-name ml-1"},[n("span",{staticClass:"file-name__text",class:e.fileNameClass(t)},[e._v(" "+e._s(e.fileName(t))+" ")]),e._v(" "),t.size||t.sizeKb?n("span",{staticClass:"file-status",class:e.fileNameClass(t)},[e._v("\n                    "+e._s(e.fileStatus(t))+"\n                  ")]):e._e()])]),e._v(" "),n("v-col",{staticClass:"d-flex justify-end align-center",attrs:{cols:"2"}},[n("v-icon",{on:{click:function(n){return e.downloadFile(t)}}},[e._v("get_app")]),e._v(" "),n("v-icon",{staticClass:"ml-2",on:{click:function(n){return e.removeUploadFile(t)}}},[e._v("close")])],1)],1)],1)])})),0)]):e._e()]],2)},i=[],o=n(2557),s=n(69798),r=n(97625),a=n(37272),l=n(50103),c=n(69332),d=n(8107),u=n(1732),p=n(13560),h=n(18361),m=n(1869),f=n(16273),g=n(28517),y=n(60601),v=n(30036),b=n(21883),C=n(54486),w=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let _=class AttachDocComponent extends w.Vue{constructor(){super(...arguments),this.uploadedFiles=[],this.toUploadFiles=[],this.selectedDocument=null,this.extensionsToPreview=["pdf"],this.entity=null,this.entityChanged=!1,this.r7enable=!1,this.fileTemplates=[]}onUpdateDownloadFilesCounter(){this.downloadAll()}onFilesChanged(){if(Array.isArray(this.files)){const e=[],t=[];this.files.forEach((n=>{n.id?e.push(n):t.push(n)})),this.toUploadFiles=t,this.entityChanged||this.isInstruction&&this.entity!==this.instruction||this.isDocument&&this.entity!==this.document?this.uploadedFiles=e:this.uploadedFiles=this.unionArray(this.uploadedFiles,e),this.entityChanged=!1}}onFilesToCopyChanged(){Array.isArray(this.filesToCopy)&&(this.uploadedFiles=this.unionArray(this.uploadedFiles,this.filesToCopy))}onFileTemplatesChanged(e){this.$emit("file-templates-changed",e)}onInstructionChanged(e){this.entity=e,this.entityChanged=!0}onDocumentChanged(e){var t;e&&this.selectedDocument!==e&&(this.selectedDocument=e,this.entity=e,this.entityChanged=!0,this.uploadedFiles=this.unionArray(this.files||[],null===(t=this.selectedDocument)||void 0===t?void 0:t.files))}created(){this.r7enable=this.$config.enableR7}showSelectDocumentModal(){return __awaiter(this,void 0,void 0,(function*(){const e=new h.j(this.$gettext("Поиск документа"),!1,this.selectedDocument?[this.selectedDocument]:[],!1),t=yield this.queryBus.exec(e);t&&(this.onDocumentChanged(t),this.$emit("document-select",this.selectedDocument))}))}clearSelectedDocument(){const e=this.selectedDocument.files||[];this.uploadedFiles=this.uploadedFiles.filter((t=>!e.includes(t))),this.selectedDocument=null,this.$emit("clear-base-document")}openFilePreview(e){this.r7enable?this.openR7Viewer(e):this.openPdfViewer(e)}openR7Viewer(e){return __awaiter(this,void 0,void 0,(function*(){const t=new u.s(this.$gettext("Просмотр файла"),e);yield this.queryBus.exec(t)}))}openPdfViewer(e){return __awaiter(this,void 0,void 0,(function*(){const t=new d.a(this.$gettext("Просмотр файла"),e);yield this.queryBus.exec(t)}))}openDocument(){const e=this.document||this.selectedDocument;e&&(this.$app.state===s.Z.CreatingReport?this.$app.view(this.actionContext,l.zc.Document,null,e.id):this.$app.goto(o.k.ViewDoc,Object.assign(Object.assign({},this.actionContext),{entityViewMode:l.dS.View}),{id:String(e.id)}))}extIco(e){const t=e,n=e;let i="";if("object"===typeof e)if(n.fileExtension)i=n.fileExtension;else{const e=n.fullFileName||t.fullPath;i=(0,f.mD)(e)}return i||(i="unknown_ext"),g.C.extentionIco(i)}extensionFile(e){return e&&(e.fileExtension||(0,f.mD)(e.fullFileName)).toLowerCase()}onFileLoaded(e){e&&(this.toUploadFiles.push(e),this.$nextTick((()=>{this.$emit("upload-files",this.toUploadFiles),this.$emit("list-files-changed",this.allFiles)})))}removeUploadFile(e){const t=e,n=e.id;if(n){const e=this.fileTemplates.findIndex((e=>e.id===n));if(e>-1)return void this.fileTemplates.splice(e,1)}let i=this.toUploadFiles.indexOf(t);-1!==i&&(this.toUploadFiles.splice(i,1),this.$emit("upload-files",this.toUploadFiles)),i=this.uploadedFiles.indexOf(t),-1!==i&&(this.uploadedFiles.splice(i,1),this.$emit("updated-files",this.uploadedFiles)),i=(this.files||[]).indexOf(t),-1!==i&&this.files.splice(i,1),this.$emit("list-files-changed",this.allFiles)}addTemplate(){return __awaiter(this,void 0,void 0,(function*(){const e=new p.F({title:this.$gettext("Выбор шаблона"),componentName:"add-file-template",componentProps:{disabledItems:[],selectedItems:[],multiselect:!0},width:"50%",height:"100%"});this.fileTemplates=yield this.queryBus.exec(e)}))}downloadFile(e){return __awaiter(this,void 0,void 0,(function*(){let t=!1;try{const n=yield this.instructionService.checkFileVersions(e);n&&(t=yield this.instructionService.newFileVersionAlert(null,`${this.$gettext("Существуют более актуальные версии файла. Скачать последнюю версию?")}`))}catch(e){this.$log.error(e)}const n=t?e.fileId:e.id,i=document.createElement("a");i.href=`${this.$config.apiPath()}files/${n}`,i.download="download",document.body.appendChild(i),i.click(),setTimeout((()=>{document.body.removeChild(i),window.URL.revokeObjectURL(`${this.$config.apiPath()}files/${n}`)}),0)}))}downloadAll(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.queryBus.exec(new c.I1(this.instruction.id,!0));let t=!1;try{const n=this.instructionService.checkFilesVersions(e);let i;Array.isArray(n)&&n.length&&(i=this.$gettext("Существуют более актуальные версии файлов:<br>"),n.forEach((e=>{i+=`<span class="ml-2 primary--text">${e.fullFileName}</span><br>`})),i+=this.$gettext("Скачать последние версии файлов?"),t=yield this.instructionService.newFileVersionAlert(null,i))}catch(e){this.$log.error(e)}const n=this.allFiles.map((e=>t&&e.fileId>0?e.fileId:e.id)),i=new URLSearchParams;n.forEach((e=>i.append("id",String(e))));const o=document.createElement("a");o.href=`${this.$config.apiPath()}files/archive?${i}`,o.download="archive.zip",document.body.appendChild(o),o.click(),setTimeout((()=>{document.body.removeChild(o),window.URL.revokeObjectURL(`${this.$config.apiPath()}files/archive?${i}`)}),0)}))}fileNameClass(e){return e.notAllowed?"error--text":""}fileName(e){const t=e,n=e;if(t.name)return t.name;if(n.fileName){let e=this.extensionFile(n);return e.startsWith(".")||(e="."+e),n.fileName.toLowerCase().endsWith(`${e.toLowerCase()}`)?n.fileName:`${n.fileName}${e}`}return this.$gettext("Без имени")}fileStatus(e){if(!e)return"";if(e.size)return e.status?`${e.status} ${(0,y.BU)(e.size)}`:`${(0,y.BU)(e.size)}`;if(e.sizeKb){const t=(0,y.MK)(e.sizeKb);return e.status?`${e.status} ${(0,y.BU)(t)}`:`${(0,y.BU)(t)}`}}checkToPreview(e){const t=null===e||void 0===e?void 0:e.fileExtension,n=t?t.toLowerCase():this.extensionFile(e);if(this.r7enable){const e=n.startsWith(".")?n:`.${n}`;return v.hg.includes(e)}return this.extensionsToPreview.includes(n)}unionArray(e,t){if(e&&!t)return e;if(!e&&t)return t;const n=[],i={};return e.concat(t).forEach((e=>{const t=e.id||e.fileId||e.fullFileName||e.fileName;i[t]||(i[t]=e,n.push(e))})),n}isNewFile(e){return!e.id}get allFiles(){return[...this.uploadedFiles,...this.toUploadFiles]}get hasToUploadFiles(){return Array.isArray(this.toUploadFiles)&&this.toUploadFiles.length>0}get filesToView(){return[...this.allFiles,...this.fileTemplates]}get hasFilesToView(){return this.filesToView.length>0}get documentName(){const e=this.document||this.selectedDocument;return e?e.attributes?e.attributes.Name:"name"in e?e.name:null:null}get filesChangeable(){return this.actionType!==a.xK.View}get isDocument(){return this.contentType===l.zc.Document}get isInstruction(){return this.contentType===l.zc.Instruction}get isView(){return this.actionType===a.xK.View}get isInstructionReplace(){return!!this.actionType&&this.actionType===a.xK.Replace}get isInstructionRepeat(){return!!this.actionType&&(this.actionType===a.xK.RepeatMessage||this.actionType===a.xK.RepeatChain)}get hasDocument(){return Boolean(this.selectedDocument)}get showSelectDocButton(){return!this.hasDocument&&!this.hasToUploadFiles&&!this.isDocument}get canAddFiles(){return!this.isView&&!this.isInstructionReplaceOrRepeat&&this.docChangeable}get isInstructionReplaceOrRepeat(){return this.isInstructionReplace||this.isInstructionRepeat}get filteredAllowedExtensions(){return Array.isArray(this.allowedFileExtensions)?this.allowedFileExtensions.filter(Boolean).map((e=>e.toLowerCase())):null}get templateBtnShow(){return this.canAddFiles&&this.showTemplateBtn&&this.$app.config.fileTemplatesEnabled}};__decorate([(0,w.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],_.prototype,"modal",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Object)],_.prototype,"document",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Object)],_.prototype,"instruction",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Array)],_.prototype,"files",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Array)],_.prototype,"filesToCopy",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Array)],_.prototype,"allowedFileExtensions",void 0),__decorate([(0,w.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],_.prototype,"docChangeable",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Number)],_.prototype,"actionType",void 0),__decorate([(0,w.Prop)({default:l.zc.Instruction}),__metadata("design:type",Number)],_.prototype,"contentType",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Object)],_.prototype,"actionContext",void 0),__decorate([(0,w.Prop)({type:Boolean,default:!0}),__metadata("design:type",Boolean)],_.prototype,"showDropzone",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Number)],_.prototype,"updateDownloadFilesCounter",void 0),__decorate([(0,w.Prop)({type:Boolean,default:!0}),__metadata("design:type",Boolean)],_.prototype,"showDownloadBtn",void 0),__decorate([(0,w.Prop)({type:Boolean,default:!0}),__metadata("design:type",Boolean)],_.prototype,"showTemplateBtn",void 0),__decorate([(0,w.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],_.prototype,"short",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Boolean)],_.prototype,"limitedMode",void 0),__decorate([(0,w.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],_.prototype,"isReport",void 0),__decorate([(0,C.t)(m.M.IQueryBus),__metadata("design:type",Object)],_.prototype,"queryBus",void 0),__decorate([(0,C.t)(r.X),__metadata("design:type",r.X)],_.prototype,"instructionService",void 0),__decorate([(0,w.Watch)("updateDownloadFilesCounter",{deep:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],_.prototype,"onUpdateDownloadFilesCounter",null),__decorate([(0,w.Watch)("files",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],_.prototype,"onFilesChanged",null),__decorate([(0,w.Watch)("filesToCopy",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],_.prototype,"onFilesToCopyChanged",null),__decorate([(0,w.Watch)("fileTemplates"),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",void 0)],_.prototype,"onFileTemplatesChanged",null),__decorate([(0,w.Watch)("instruction",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],_.prototype,"onInstructionChanged",null),__decorate([(0,w.Watch)("document",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],_.prototype,"onDocumentChanged",null),_=__decorate([(0,w.Component)({components:{"file-upload":b.Z}})],_);const x=_,S=x;var I=n(51900),D=n(43453),R=n.n(D),T=n(82127),P=n(17024),O=n(71100),k=n(57894),F=n(22528),A=n(7442),$=(0,I.Z)(S,render,i,!1,null,"45e16fd5",null);const j=$.exports;R()($,{VBtn:T.Z,VCol:P.Z,VIcon:O.Z,VRow:k.Z,VTextField:F.Z,VTooltip:A.Z})},87938:(e,t,n)=>{"use strict";n.d(t,{Z:()=>A});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-expansion-panels",{staticClass:"expansion-panel-border",attrs:{value:e.expanded,accordion:"",multiple:""}},e._l(e.collection.items,(function(t,i){return n("v-expansion-panel",{key:i,staticClass:"dev-card-list"},[n("v-expansion-panel-header",[n("template",{slot:"actions"},[n("v-icon",{staticClass:"dev-card-expand"},[e._v("chevron_right")])],1),e._v(" "),n("div",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"text-body-1 dev-card-title pl-2"},[e._v(e._s(t.fullName))])],2),e._v(" "),n("v-expansion-panel-content",[n("CardItem",{attrs:{selected:e.selected,collection:t,"hide-actions":e.hideActions,"hidden-columns":e.hiddenColumns},on:{activate:e.activate,create:e.create,edit:e.edit,delete:e.remove,input:e.input}})],1)],1)})),1)},i=[],cardItemvue_type_template_id_5ab237bc_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"elevation-0"},[n("v-card-text",{staticClass:"pa-0"},[e.notEmptySpec.isSpecifiedBy(e.collection)?n("CardTable",{attrs:{selected:e.selected,collection:e.collection,"hidden-columns":e.hiddenColumns,factory:e.factory},on:{activate:e.activate,edit:e.edit,delete:e.remove,input:e.input}}):n("div",{staticClass:"subheading text-center"},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"font-italic text-body-1"},[e._v("Нет сохраненных карточек")])]),e._v(" "),e.hideActions?e._e():n("v-list",{staticClass:"py-0",attrs:{dense:""}},e._l(e.emptyCollection.items,(function(t,i){return n("v-list-item",{key:i},[n("v-list-item-content",{staticClass:"text-body-1 black--text lighten-1"},[e._v(e._s(t.title))]),e._v(" "),n("v-list-item-action",{staticClass:"card-item-action"},[n("v-icon",{staticClass:"ma-0 medium-icon",attrs:{color:"primary"},on:{click:function(n){return e.create(t)}}},[e._v("add_circle")])],1)],1)})),1)],1)],1)},o=[],s=n(80763),r=n(69406),a=n(98578),l=n(62393),c=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let d=class CardItemComponent extends c.Vue{create({type:e}){const{cardId:t}=this.collection;return{cardId:t,type:e}}edit(e){return e}activate(e){return e}remove(e){return e}input(e){return e}get notEmptySpec(){return new s.Z(new r.Z)}get emptyCollection(){return this.collection.reduceBy(new r.Z)}get factory(){return new a.J}};__decorate([(0,c.Model)("input",{type:Array}),__metadata("design:type",Array)],d.prototype,"selected",void 0),__decorate([(0,c.Prop)({type:Object,required:!0}),__metadata("design:type",Object)],d.prototype,"collection",void 0),__decorate([(0,c.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],d.prototype,"hideActions",void 0),__decorate([(0,c.Prop)({type:Array}),__metadata("design:type",Array)],d.prototype,"hiddenColumns",void 0),__decorate([(0,c.Emit)("create"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],d.prototype,"create",null),__decorate([(0,c.Emit)("edit"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],d.prototype,"edit",null),__decorate([(0,c.Emit)("activate"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],d.prototype,"activate",null),__decorate([(0,c.Emit)("delete"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],d.prototype,"remove",null),__decorate([(0,c.Emit)("input"),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Array)],d.prototype,"input",null),d=__decorate([(0,c.Component)({components:{CardTable:l.Z}})],d);const u=d,p=u;var h=n(51900),m=n(43453),f=n.n(m),g=n(85893),y=n(5255),v=n(71100),b=n(54983),C=n(53760),w=n(73444),_=n(45903),x=(0,h.Z)(p,cardItemvue_type_template_id_5ab237bc_scoped_true_render,o,!1,null,"5ab237bc",null);const S=x.exports;f()(x,{VCard:g.Z,VCardText:y.ZB,VIcon:v.Z,VList:b.Z,VListItem:C.Z,VListItemAction:w.Z,VListItemContent:_.km});var cardListvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},cardListvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let I=class CardListComponent extends c.Vue{create(e){return e}edit(e){return e}activate(e){return e}remove(e){return e}input(e){return e}};cardListvue_type_script_lang_ts_decorate([(0,c.Model)("input",{type:Array}),cardListvue_type_script_lang_ts_metadata("design:type",Array)],I.prototype,"selected",void 0),cardListvue_type_script_lang_ts_decorate([(0,c.Prop)({type:Object,required:!0}),cardListvue_type_script_lang_ts_metadata("design:type",Object)],I.prototype,"collection",void 0),cardListvue_type_script_lang_ts_decorate([(0,c.Prop)({type:Boolean,default:!1}),cardListvue_type_script_lang_ts_metadata("design:type",Boolean)],I.prototype,"hideActions",void 0),cardListvue_type_script_lang_ts_decorate([(0,c.Prop)({type:Array}),cardListvue_type_script_lang_ts_metadata("design:type",Array)],I.prototype,"hiddenColumns",void 0),cardListvue_type_script_lang_ts_decorate([(0,c.Prop)({type:Array,default(){return[]}}),cardListvue_type_script_lang_ts_metadata("design:type",Array)],I.prototype,"expanded",void 0),cardListvue_type_script_lang_ts_decorate([(0,c.Emit)("create"),cardListvue_type_script_lang_ts_metadata("design:type",Function),cardListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),cardListvue_type_script_lang_ts_metadata("design:returntype",Object)],I.prototype,"create",null),cardListvue_type_script_lang_ts_decorate([(0,c.Emit)("edit"),cardListvue_type_script_lang_ts_metadata("design:type",Function),cardListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),cardListvue_type_script_lang_ts_metadata("design:returntype",Object)],I.prototype,"edit",null),cardListvue_type_script_lang_ts_decorate([(0,c.Emit)("activate"),cardListvue_type_script_lang_ts_metadata("design:type",Function),cardListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),cardListvue_type_script_lang_ts_metadata("design:returntype",Object)],I.prototype,"activate",null),cardListvue_type_script_lang_ts_decorate([(0,c.Emit)("delete"),cardListvue_type_script_lang_ts_metadata("design:type",Function),cardListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),cardListvue_type_script_lang_ts_metadata("design:returntype",Object)],I.prototype,"remove",null),cardListvue_type_script_lang_ts_decorate([(0,c.Emit)("input"),cardListvue_type_script_lang_ts_metadata("design:type",Function),cardListvue_type_script_lang_ts_metadata("design:paramtypes",[Array]),cardListvue_type_script_lang_ts_metadata("design:returntype",Array)],I.prototype,"input",null),I=cardListvue_type_script_lang_ts_decorate([(0,c.Component)({components:{CardItem:S}})],I);const D=I,R=D;var T=n(44557),P=n(94694),O=n(86131),k=n(29442),F=(0,h.Z)(R,render,i,!1,null,"6ec8707e",null);const A=F.exports;f()(F,{VExpansionPanel:T.Z,VExpansionPanelContent:P.Z,VExpansionPanelHeader:O.Z,VExpansionPanels:k.Z,VIcon:v.Z})},87924:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{ref:"form",attrs:{value:e.form.isValid,"lazy-validation":""},on:{input:e.onFormValidate}},[n("v-text-field",{attrs:{value:e.form.code,rules:e.codenameRules,label:e.$gettext("Кодовое имя"),disabled:e.form.disabledCode},on:{input:e.onCodenameInput}}),e._v(" "),n("v-text-field",{attrs:{value:e.form.name,rules:e.titleRules,label:e.$gettext("Название")},on:{input:e.onTitleInput}})],1)},i=[],o=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let s=class ComponentForm extends o.Vue{constructor(){super(...arguments),this.codenameRules=[e=>Boolean(e)||this.$gettext("Кодовое имя обязательно"),e=>/^[\dA-Za-z-]+$/.test(e)||this.$gettext("Разрешены только латинские символы и цифры")],this.titleRules=[e=>Boolean(e)||this.$gettext("Название обязательно")]}onFormValidate(e){return this.emitInput(Object.assign(Object.assign({},this.form),{isValid:e}))}onCodenameInput(e){return this.emitInput(Object.assign(Object.assign({},this.form),{code:e}))}onTitleInput(e){return this.emitInput(Object.assign(Object.assign({},this.form),{name:e}))}validate(){return this.$refs.form.validate()}emitInput(e){return e}};__decorate([(0,o.Model)("input",{type:Object,default:!0}),__metadata("design:type",Object)],s.prototype,"form",void 0),__decorate([(0,o.Emit)("input"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],s.prototype,"emitInput",null),s=__decorate([o.Component],s);const r=s,a=r;var l=n(51900),c=n(43453),d=n.n(c),u=n(83240),p=n(22528),h=(0,l.Z)(a,render,i,!1,null,null,null);const m=h.exports;d()(h,{VForm:u.Z,VTextField:p.Z})},23323:(e,t,n)=>{"use strict";n.d(t,{Z:()=>I});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.collection.isEmpty?e._e():n("ComponentTable",{attrs:{selected:e.selected,collection:e.collection,"hidden-columns":e.hiddenColumns,factory:e.factory},on:{activate:e.activate,edit:e.edit,delete:e.remove,input:e.input,"edit-component":e.editComponent}})],1)},i=[],componentItemvue_type_template_id_5ce45c6a_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-card-text",{staticClass:"pa-0"},[e.collection.isEmpty?n("div",{staticClass:"subheading text-center"},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"font-italic text-body-1"},[e._v("Нет сохраненных общих элементов")])]):n("ComponentTable",{attrs:{selected:e.selected,collection:e.collection,"hidden-columns":e.hiddenColumns,factory:e.factory},on:{activate:e.activate,edit:e.edit,delete:e.remove,input:e.input,"edit-component":e.editComponent}}),e._v(" "),e.hideActions?e._e():n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[e.collection.isEmpty?n("v-btn",{staticClass:"ma-0 text-body-1 small-round-button",attrs:{color:"primary"},on:{click:e.create}},[n("translate",[e._v("Добавить")])],1):e._e()],1)],1)],1)],1)},o=[],s=n(98578),r=n(62393),a=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let l=class ComponentItem extends a.Vue{create(){const{code:e}=this.collection;return{code:e}}edit(e){return e}editComponent(){const{component:e}=this.collection;return e}activate(e){return e}remove(e){return e}input(e){return e}get factory(){return new s.n}};__decorate([(0,a.Model)("input",{type:Array}),__metadata("design:type",Array)],l.prototype,"selected",void 0),__decorate([(0,a.Prop)({type:Object,required:!0}),__metadata("design:type",Object)],l.prototype,"collection",void 0),__decorate([(0,a.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],l.prototype,"hideActions",void 0),__decorate([(0,a.Prop)({type:Array}),__metadata("design:type",Array)],l.prototype,"hiddenColumns",void 0),__decorate([(0,a.Emit)("create"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Object)],l.prototype,"create",null),__decorate([(0,a.Emit)("edit"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],l.prototype,"edit",null),__decorate([(0,a.Emit)("edit-component"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Object)],l.prototype,"editComponent",null),__decorate([(0,a.Emit)("activate"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],l.prototype,"activate",null),__decorate([(0,a.Emit)("delete"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],l.prototype,"remove",null),__decorate([(0,a.Emit)("input"),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Array)],l.prototype,"input",null),l=__decorate([(0,a.Component)({components:{ComponentTable:r.Z}})],l);const c=l,d=c;var u=n(51900),p=n(43453),h=n.n(p),m=n(82127),f=n(85893),g=n(5255),y=n(17024),v=n(57894),b=(0,u.Z)(d,componentItemvue_type_template_id_5ce45c6a_render,o,!1,null,null,null);const C=b.exports;h()(b,{VBtn:m.Z,VCard:f.Z,VCardText:g.ZB,VCol:y.Z,VRow:v.Z});var componentListvue_type_script_lang_ts_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},componentListvue_type_script_lang_ts_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let w=class ComponentList extends a.Vue{create(e){return e}edit(e){return e}editComponent(e){return e}activate(e){return e}remove(e){return e}input(e){return e}get factory(){return new s.n}};componentListvue_type_script_lang_ts_decorate([(0,a.Model)("input",{type:Array}),componentListvue_type_script_lang_ts_metadata("design:type",Array)],w.prototype,"selected",void 0),componentListvue_type_script_lang_ts_decorate([(0,a.Prop)({type:Object,required:!0}),componentListvue_type_script_lang_ts_metadata("design:type",Object)],w.prototype,"collection",void 0),componentListvue_type_script_lang_ts_decorate([(0,a.Prop)({type:Boolean,default:!1}),componentListvue_type_script_lang_ts_metadata("design:type",Boolean)],w.prototype,"hideActions",void 0),componentListvue_type_script_lang_ts_decorate([(0,a.Prop)({type:Array}),componentListvue_type_script_lang_ts_metadata("design:type",Array)],w.prototype,"hiddenColumns",void 0),componentListvue_type_script_lang_ts_decorate([(0,a.Prop)({type:Array,default(){return[]}}),componentListvue_type_script_lang_ts_metadata("design:type",Array)],w.prototype,"expanded",void 0),componentListvue_type_script_lang_ts_decorate([(0,a.Emit)("create"),componentListvue_type_script_lang_ts_metadata("design:type",Function),componentListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),componentListvue_type_script_lang_ts_metadata("design:returntype",Object)],w.prototype,"create",null),componentListvue_type_script_lang_ts_decorate([(0,a.Emit)("edit"),componentListvue_type_script_lang_ts_metadata("design:type",Function),componentListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),componentListvue_type_script_lang_ts_metadata("design:returntype",Object)],w.prototype,"edit",null),componentListvue_type_script_lang_ts_decorate([(0,a.Emit)("edit-component"),componentListvue_type_script_lang_ts_metadata("design:type",Function),componentListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),componentListvue_type_script_lang_ts_metadata("design:returntype",Object)],w.prototype,"editComponent",null),componentListvue_type_script_lang_ts_decorate([(0,a.Emit)("activate"),componentListvue_type_script_lang_ts_metadata("design:type",Function),componentListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),componentListvue_type_script_lang_ts_metadata("design:returntype",Object)],w.prototype,"activate",null),componentListvue_type_script_lang_ts_decorate([(0,a.Emit)("delete"),componentListvue_type_script_lang_ts_metadata("design:type",Function),componentListvue_type_script_lang_ts_metadata("design:paramtypes",[Object]),componentListvue_type_script_lang_ts_metadata("design:returntype",Object)],w.prototype,"remove",null),componentListvue_type_script_lang_ts_decorate([(0,a.Emit)("input"),componentListvue_type_script_lang_ts_metadata("design:type",Function),componentListvue_type_script_lang_ts_metadata("design:paramtypes",[Array]),componentListvue_type_script_lang_ts_metadata("design:returntype",Array)],w.prototype,"input",null),w=componentListvue_type_script_lang_ts_decorate([(0,a.Component)({components:{ComponentItem:C,ComponentTable:r.Z}})],w);const _=w,x=_;var S=(0,u.Z)(x,render,i,!1,null,null,null);const I=S.exports},62393:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",{staticClass:"dev-card-table",class:{"no-rows":!e.rows.length},attrs:{dense:"",value:e.tableSelected.getFrom(e.rows),headers:e.tableHead.items,items:e.rows,"show-select":e.showCheckBox(e.selected),"hide-default-footer":"","items-per-page":e.rows.length},on:{input:e.input},scopedSlots:e._u([{key:"header.data-table-select",fn:function(e){var t=e.props,i=e.on;return[n("v-simple-checkbox",{attrs:{ripple:!1,"on-icon":"check_box","off-icon":"check_box_outline_blank",value:t.value,color:"primary"},on:{input:function(e){return i.input(!t.value)}}})]}},{key:"item",fn:function(t){return[e.tableExpanded.showRow(t.item)?n("tr",{staticClass:"black--text lighten-1 border"},[e.tableHead.showSelection(e.selected)?n("td",[n("v-simple-checkbox",{attrs:{ripple:!1,"on-icon":"check_box","off-icon":"check_box_outline_blank",value:t.isSelected,color:"primary"},on:{input:function(e){return t.select(!t.isSelected)}}})],1):e._e(),e._v(" "),e._l(e.tableHead.items,(function(i,o){return[e.tableHead.isNameColumn(i)?n("th",{key:o,staticClass:"text-body-1 black--text lighten-1"},[e.tableExpanded.showTitle(t.item)?n("div",{staticClass:"d-flex flex-row align-center"},[t.item.fullInfo.hasMany?n("v-icon",{staticClass:"expand-icon d-flex",attrs:{id:"expandIcon"+t.item.fullInfo.id},on:{click:function(n){return n.stopPropagation(),e.toggle(t.item,t.item.fullInfo.id)}}},[e._v("keyboard_arrow_right")]):e._e(),e._v(" "),n("translate",[e._v(e._s(t.item.fullInfo.title))])],1):e._e()]):e.tableHead.isVersionColumn(i)?n("td",{key:o,staticClass:"text-body-1 black--text lighten-1"},[e._v("\n          "+e._s(t.item.fullInfo.version)+"\n        ")]):e.tableHead.isUserColumn(i)?n("td",{key:o,staticClass:"text-body-1 black--text lighten-1"},[e._v("\n          "+e._s(t.item.fullInfo.editUserName)+"\n        ")]):e.tableHead.isDateColumn(i)?n("td",{key:o,staticClass:"text-body-1 black--text lighten-1"},[e._v("\n          "+e._s(e._f("date")(t.item.fullInfo.editDateTime,"DD.MM.YYYY hh:mm"))+"\n        ")]):e.tableHead.isActualColumn(i)?n("td",{key:o,staticClass:"text-body-1 black--text lighten-1"},[t.item.fullInfo.isActual?n("v-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.$gettext("Активна")},expression:"{ content: $gettext('Активна') }"}],staticClass:"medium-icon",attrs:{color:"success"}},[e._v("check_circle")]):e._e()],1):e.tableHead.isActionsColumn(i)?n("td",{key:o,staticClass:"align-center layout text-body-1 black--text lighten-1 pl-2"},[n("v-btn",{staticClass:"ma-0",attrs:{small:"",icon:""},on:{click:function(n){return n.stopPropagation(),e.activate(t.item)}}},[n("v-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.createTootip("activate")},expression:"{ content: createTootip('activate') }"}],attrs:{small:""}},[e._v("check")])],1),e._v(" "),n("v-btn",{staticClass:"ma-0",attrs:{small:"",icon:""},on:{click:function(n){return n.stopPropagation(),e.edit(t.item)}}},[n("v-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.createTootip("edit")},expression:"{ content: createTootip('edit') }"}],attrs:{small:""}},[e._v("edit")])],1),e._v(" "),n("v-btn",{staticClass:"ma-0",attrs:{small:"",icon:""},on:{click:function(n){return n.stopPropagation(),e.remove(t.item)}}},[n("v-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.createTootip("delete")},expression:"{ content: createTootip('delete') }"}],attrs:{small:""}},[e._v("delete")])],1),e._v(" "),n("v-menu",{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("v-btn",e._g({staticClass:"ma-0",attrs:{small:"",icon:""}},Object.assign({},i,o)),[n("v-icon",[e._v("more_vert")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Дополнительные действия")])],1)]}}],null,!0)},[e._v(" "),n("v-list",[n("v-list-item",{on:{click:function(n){return e.copyVersion(t.item.version)}}},[n("v-list-item-title",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Копировать")])],1),e._v(" "),t.item.collection.type?n("v-list-item",{attrs:{disabled:!e.cardVersionBuffer||t.item.collection.type!==e.cardVersionBuffer.type},on:{click:function(n){return e.pasteCard(t.item.version)}}},[n("v-list-item-title",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Вставить")])],1):t.item.collection.component?n("v-list-item",{attrs:{disabled:!e.componentVersionBuffer},on:{click:function(n){return e.pasteComponent(t.item.version.code)}}},[n("v-list-item-title",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Вставить")])],1):e._e(),e._v(" "),t.item.collection.component?n("v-list-item",{on:{click:function(t){return e.$emit("edit-component")}}},[n("v-list-item-title",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Редактировать метаданные")])],1):e._e()],1)],1)],1):e._e()]}))],2):e._e()]}}],null,!0)},[n("template",{slot:"no-data"},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:!0}})],1)],2)},i=[],o=n(34170),s=n(66422),r=n(44893),a=n(54235),l=n(18220),c=n(37920),d=n(52469),u=n(56060),p=n(29339),h=n(77924),m=n(51414),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))},__rest=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};let f=class CardTableComponent extends p.Vue{constructor(){super(...arguments),this.expanded=[]}created(){this.headers=[{text:this.$gettext("Название"),value:u.q.NAME,sortable:!1},{text:this.$gettext("Версия"),value:u.q.VERSION,sortable:!1},{text:this.$gettext("Активна"),value:u.q.ACTUAL,sortable:!1},{text:this.$gettext("Пользователь"),value:u.q.USER_NAME,sortable:!1},{text:this.$gettext("Дата"),value:u.q.DATE,sortable:!1},{text:this.$gettext("Действия"),value:u.q.ACTIONS,sortable:!1,align:"right"}]}copyVersion(e){e.type?this.copyCardVersion(e):e.code&&this.copyComponentVersion(e)}pasteComponent(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.componentVersionBuffer,{root:n}=t,i=__rest(t,["root"]);try{yield this.createComponentVersion(new s.QM(e,n,JSON.parse(i.data))),yield this.fetchComponentList(new a.K),this.$toasted.success(this.$gettext("Компонент успешно скопирован"))}catch(e){throw this.$toasted.error(e.message),e}}))}pasteCard({type:e,cardId:t}){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.fetchCardVersion(new r.dw(this.cardVersionBuffer.cardId,this.cardVersionBuffer.type,this.cardVersionBuffer.id,!0));yield this.createCardVersion(new o.FJ(t,e,JSON.parse(n.data),n.components)),this.$toasted.success(this.$gettext("Карточка успешно скопирована"))}catch(e){throw this.$toasted.error(e.message),e}}))}createTootip(e){return"edit"===e?this.$gettext("Редактировать"):"delete"===e?this.$gettext("Удалить"):"activate"===e?this.$gettext("Активировать"):void 0}edit({rowInfo:{version:e}}){return e}activate({rowInfo:{version:e}}){return e}remove({rowInfo:{version:e}}){return e}input(e){return this.tableSelected.getNewFrom(this.rows,e)}toggle(e,t){this.expanded=this.tableExpanded.toggleExpanded(e);const n=document.getElementById("expandIcon"+t);this.tableExpanded.isExpanded(e.rowInfo.collection)?n.classList.add("expand-icon--active"):n.classList.remove("expand-icon--active")}showCheckBox(e){return!this.rows.length||this.tableHead.showSelection(e)}get rows(){return this.factory.createRows(this.collection)}get tableHead(){return this.factory.createTableHead(this.headers,this.hiddenColumns)}get tableExpanded(){return this.factory.createTableExpanded(this.expanded)}get tableSelected(){return this.factory.createTableSelected(this.selected)}};__decorate([(0,p.Model)("input",{type:Array}),__metadata("design:type",Array)],f.prototype,"selected",void 0),__decorate([(0,p.Prop)({type:[Object,Array],required:!0}),__metadata("design:type",Object)],f.prototype,"collection",void 0),__decorate([(0,p.Prop)({type:Array,default(){return[]}}),__metadata("design:type",Array)],f.prototype,"hiddenColumns",void 0),__decorate([(0,p.Prop)({type:Object,required:!0}),__metadata("design:type",Object)],f.prototype,"factory",void 0),__decorate([(0,d.d)("versionBuffer"),__metadata("design:type",Object)],f.prototype,"componentVersionBuffer",void 0),__decorate([(0,c.u)("versionBuffer"),__metadata("design:type",Object)],f.prototype,"cardVersionBuffer",void 0),__decorate([(0,l.lY)("fetchCardVersion"),__metadata("design:type",Object)],f.prototype,"fetchCardVersion",void 0),__decorate([(0,l.lY)("createCardVersion"),__metadata("design:type",Object)],f.prototype,"createCardVersion",void 0),__decorate([(0,l.d9)("createComponentVersion"),__metadata("design:type",Object)],f.prototype,"createComponentVersion",void 0),__decorate([(0,l.d9)("fetchComponentList"),__metadata("design:type",Object)],f.prototype,"fetchComponentList",void 0),__decorate([(0,m.mm)("COPY_COMPONENT_VERSION",{namespace:"components"}),__metadata("design:type",Function)],f.prototype,"copyComponentVersion",void 0),__decorate([(0,m.mm)("COPY_CARD_VERSION",{namespace:"cards"}),__metadata("design:type",Function)],f.prototype,"copyCardVersion",void 0),__decorate([(0,p.Emit)("edit"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],f.prototype,"edit",null),__decorate([(0,p.Emit)("activate"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],f.prototype,"activate",null),__decorate([(0,p.Emit)("delete"),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Object)],f.prototype,"remove",null),__decorate([(0,p.Emit)("input"),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Array)],f.prototype,"input",null),f=__decorate([(0,p.Component)({components:{VDataTable:h.Z}})],f);const g=f,y=g;var v=n(51900),b=n(43453),C=n.n(b),w=n(82127),_=n(71100),x=n(54983),S=n(53760),I=n(45903),D=n(51333),R=n(83429),T=n(7442),P=(0,v.Z)(y,render,i,!1,null,null,null);const O=P.exports;C()(P,{VBtn:w.Z,VDataTable:h.Z,VIcon:_.Z,VList:x.Z,VListItem:S.Z,VListItemTitle:I.V9,VMenu:D.Z,VSimpleCheckbox:R.Z,VTooltip:T.Z})},53600:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>T});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("list",{attrs:{context:e.actionContext,"fetch-options":e.fetchOptions,filterParamPanel:e.filterParamPanel,"selected-id":e.selectedId,"collection-view-mode":e.collectionViewMode,filterNameApplied:e.filterNameApplied,preview:e.preview,"show-active-item":e.showActiveItem,"start-folder-changing":e.startFolderChanging,"soft-refresh-counter":e.softRefreshCounter,"content-name":e.$gettext("документов"),"use-unread-only-filter":!1,"entity-of":e.entityOf,"row-of":e.rowOf,"fetch-items":e.fetchItems,"fetch-item":e.readDocument,"removed-item":e.myLastRemovedItem,"columns-by-folder":!0,rowIdentity:e.rowId,"start-date":e.startDate,"footer-is-hidden":e.footerIsHidden,"empty-message":e.emptyMessage,"select-message":e.selectMessage,"disable-table-toolbar":e.disableTableToolbar,"disable-double-click":e.disableDoubleClick},on:{"update-state":function(t){return e.$emit("update-state",t)},"update-selected":function(t){return e.$emit("update-selected",t)},"update-cancel-filter":function(t){return e.$emit("update-cancel-filter",t)},"update-cancel-date-range":function(t){return e.$emit("update-cancel-date-range")},"update-unread-only":function(t){return e.$emit("update-unread-only",t)},"update-show-grid-columns":function(t){return e.$emit("update-show-grid-columns",t)},"list-dblclick":e.onDblClick,"list-refreshed":function(t){return e.$emit("list-refreshed",t)}},scopedSlots:e._u([{key:"listItem",fn:function(t){var i=t.itemInfo;return[n("document-list-item",{attrs:{document:i.item,selected:i.isSelected(i.item),"action-context":i.getContext(i.item),mode:i.mode||e.listItemMode,"show-active-item":e.showActiveItem,"force-is-mobile":e.forceIsMobile},on:{"update-height":function(e){return i.updateHeight(e)}}})]}}])})},i=[],o=n(2557),s=n(22402),r=n(25173),a=n(72835),l=n(50103),c=n(77896),d=n(1869),u=n(31025),p=n(18220),h=n(69585),m=n(69548),f=n(44122),g=n(85236),y=n(70294),v=n(2934),b=n.n(v),C=n(54486),w=n(29339),_=n(51414),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let x=class DocumentListComponent extends(b()){constructor(){super(...arguments),this.softRefreshCounter=0,this.fetching=!1,this.documentRights=[],this.displayMainFile=this.$config.displayMainFile,this.myLastRemovedItem=null,this.list=null}onStateChanged(){var e,t,n,i;if(this.userSettings)return this.myLastRemovedItem===this.lastRemovedItem||(null===(e=this.lastRemovedItem)||void 0===e?void 0:e.folderId)!==(null===(n=null===(t=this.fetchOptions)||void 0===t?void 0:t.folderInfo)||void 0===n?void 0:n.id)&&(null===(i=this.fetchOptions)||void 0===i?void 0:i.folderInfo)?void(this.fetching||this.softRefreshCounter++):(Array.isArray(this.fetchOptions.entities)?this.lastRemovedItem.index=this.fetchOptions.entities.findIndex((e=>this.entityOf(e).id===this.lastRemovedItem.id)):this.lastRemovedItem.index<0&&(this.lastRemovedItem.index=this.list.items.findIndex((e=>e.id===this.lastRemovedItem.id))),void(this.myLastRemovedItem=this.lastRemovedItem))}entityOf(e){return e||null}rowOf(e){return e?(e.attributes.viewFlag=e.viewFlag,e.attributes):null}rowId(e){const t=e?e.id||e.ID||e.Id:null;return t||null}fetchItems(e,t,n,i,o,s){var r,l;return __awaiter(this,void 0,void 0,(function*(){this.fetching=!0;try{this.context.folderId&&(null===(l=null===(r=this.fetchOptions)||void 0===r?void 0:r.folderInfo)||void 0===l?void 0:l.nodeType)===a.J.Journal&&(this.documentRights=yield this.fetchRights(this.context.folderId)),t=!!this.tempList||t;const o=this.checkDisplayFiles;switch(e.nodeType){case a.J.DocumentFolder:this.list=yield this.fetchFolderDocuments(new c.N8(Number(e.id),t,!this.tempList,this.tempList));break;case a.J.Journal:this.list=yield this.fetchDocuments(new c.m$(Number(e.id),e.archive,this.createListInfo(n,i),e.cardId,t,!this.tempList,u.C.toServerString(null===s||void 0===s?void 0:s.dateStart),u.C.toServerString(null===s||void 0===s?void 0:s.dateFinish),o,this.tempList));break;case a.J.DocumentSearchFolder:this.list=i?yield this.fetchdDocumentSearch(new c.rP(e.id,e.cardId,e.archive,this.createListInfo(n,i),t,u.C.toServerString(null===s||void 0===s?void 0:s.dateStart),u.C.toServerString(null===s||void 0===s?void 0:s.dateFinish),o,!this.tempList,this.tempList)):{items:[],totalCount:0};break;default:throw new Error(`Unknown node type ${e.nodeType}`)}return this.list.items&&this.list.items.length&&this.list.items.forEach((e=>e.attributes.id=e.id)),this.list}catch(e){this.$log.error(e)}finally{this.fetching=!1}}))}readDocument(e,t,n=!1){return __awaiter(this,void 0,void 0,(function*(){if(!e)return null;n=!e.fullyRead&&n;const i=e.type,o=yield this.fetchDocument(new c.U_(e.id,l.dS.View,Number(null===t||void 0===t?void 0:t.id),n));return i===r.i&&(o.documentEntityName=o.type,o.document=o,o.type=r.i),o}))}get listItemMode(){return this.preview?m.H.Preview:m.H.Full}onDblClick(e,t){this.isMobile||this.$app.goto(o.k.ViewDoc,Object.assign(Object.assign({},t),{entityViewMode:l.dS.View}),{id:String(e.id),folderId:String(this.fetchOptions.folderInfo.id),folderName:this.fetchOptions.folderInfo.name})}createListInfo(e,t){var n,i;const o=1,s=this.fetchOptions.pageSize,r=(o-1)*s;return{page:o,take:s,maxTake:null!==(i=null===(n=this.userSettings)||void 0===n?void 0:n.maxInstructionsLoadCount)&&void 0!==i?i:100,skip:r,searchText:e,filter:(0,g.Z)(t)}}fetchRights(e){return __awaiter(this,void 0,void 0,(function*(){return this.queryBus.exec(new c.Ml(Number(e)))}))}get actionContext(){return Object.assign(Object.assign({},this.context),{entityViewMode:l.dS.List,rights:this.documentRights})}get checkDisplayFiles(){return this.context.entityViewMode===l.dS.List&&this.displayMainFile}};__decorate([(0,w.Prop)(),__metadata("design:type",Object)],x.prototype,"context",void 0),__decorate([(0,w.Prop)({default:!1}),__metadata("design:type",Boolean)],x.prototype,"tempList",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Object)],x.prototype,"fetchOptions",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",String)],x.prototype,"selectedId",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Number)],x.prototype,"collectionViewMode",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Boolean)],x.prototype,"preview",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Boolean)],x.prototype,"showActiveItem",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Boolean)],x.prototype,"filterParamPanel",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",String)],x.prototype,"filterNameApplied",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Number)],x.prototype,"startFolderChanging",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Date)],x.prototype,"startDate",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",String)],x.prototype,"emptyMessage",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",String)],x.prototype,"selectMessage",void 0),__decorate([(0,w.Prop)({default:!1}),__metadata("design:type",Boolean)],x.prototype,"footerIsHidden",void 0),__decorate([(0,w.Prop)(),__metadata("design:type",Boolean)],x.prototype,"forceIsMobile",void 0),__decorate([(0,w.Prop)({default:!1}),__metadata("design:type",Boolean)],x.prototype,"disableTableToolbar",void 0),__decorate([(0,w.Prop)({default:!1}),__metadata("design:type",Boolean)],x.prototype,"disableDoubleClick",void 0),__decorate([(0,p.jI)("fetchDocuments"),__metadata("design:type",Object)],x.prototype,"fetchDocuments",void 0),__decorate([(0,p.jI)("fetchDocument"),__metadata("design:type",Object)],x.prototype,"fetchDocument",void 0),__decorate([(0,p.jI)("fetchFolderDocuments"),__metadata("design:type",Object)],x.prototype,"fetchFolderDocuments",void 0),__decorate([(0,p.jI)("fetchdDocumentSearch"),__metadata("design:type",Object)],x.prototype,"fetchdDocumentSearch",void 0),__decorate([(0,_.ZM)("docs",{namespace:"documents"}),__metadata("design:type",Object)],x.prototype,"documentsState",void 0),__decorate([(0,_.ZM)("archiveDocs",{namespace:"documents"}),__metadata("design:type",Object)],x.prototype,"archiveDocuments",void 0),__decorate([(0,_.ZM)("lastRemovedItem",{namespace:"documents"}),__metadata("design:type",Object)],x.prototype,"lastRemovedItem",void 0),__decorate([(0,h.x)("userSettings"),__metadata("design:type",Object)],x.prototype,"userSettings",void 0),__decorate([(0,C.t)(s.O.ICommandBus),__metadata("design:type",Object)],x.prototype,"commandBus",void 0),__decorate([(0,C.t)(d.M.IQueryBus),__metadata("design:type",Object)],x.prototype,"queryBus",void 0),__decorate([(0,w.Watch)("documentsState"),(0,w.Watch)("archiveDocuments"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],x.prototype,"onStateChanged",null),x=__decorate([(0,w.Component)({components:{list:f.Z,"document-list-item":y.Z}})],x);const S=x,I=S;var D=n(51900),R=(0,D.Z)(I,render,i,!1,null,"2bd13ce3",null);const T=R.exports},70294:(e,t,n)=>{"use strict";n.d(t,{Z:()=>T});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isMobile?[e.innerDocument?n("v-row",{staticClass:"mb-1",class:{"docum-list-item__container-preview":e.isPreviewMode,"docum-list-item__container":!e.isPreviewMode},attrs:{"no-gutters":""}},[e.isFullMode?n("v-col",{staticStyle:{overflow:"hidden"},attrs:{md:"12"}},[n("v-card",{staticClass:"elevation-0"},[n("v-row",{attrs:{align:"center","no-gutters":""}},[n("v-row",{staticClass:"card-mobile",attrs:{"no-gutters":""}},[n("v-card-title",{staticClass:"px-0 py-0 card-tile"},[n("v-row",{attrs:{justify:"space-between","no-gutters":""}},[n("v-col",[n("div",{staticClass:"card-header"},[e.fromInstruction?n("v-icon",{staticClass:"description",attrs:{color:"primary",size:"22"}},[e._v("description")]):e._e(),e._v(" "),n("document-template-renderer",{attrs:{document:e.innerDocument,"template-type":e.templateType,context:e.actionPanelContext,"lazy-card-actions-counter":e.lazyCardActionsCounter},on:{"set-card-actions":e.onSetCardActions,"set-card-actions-overlay":e.onSetCardActionsOverlay,"card-mounted":e.onCardMounted,"card-updated":e.onCardMounted}}),e._v(" "),n("v-spacer"),e._v(" "),e.fromInstruction?n("v-btn",{staticClass:"square-sm-button rounded-button elevation-0 grey document-button",class:{"lighten-2":e.selected,"grey lighten-3":e.fromInstruction&&!e.selected},on:{click:function(t){return e.$emit("open-origin-document")}}},[n("v-icon",{staticClass:"chrome-reader-mode",attrs:{color:"grey darken-2"}},[e._v("chrome_reader_mode")])],1):e._e()],1)]),e._v(" "),n("v-col",{attrs:{cols:"auto"}},[e.innerDocument.viewFlag?e._e():n("v-avatar",{staticClass:"ml-2 mt-1",attrs:{size:"12",color:"error"}})],1)],1)],1),e._v(" "),e.isContentTypeDocument?n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"selected"}]},[e.displayMainFile?n("v-col",{staticClass:"grey lighten-5"},[n("ld-attachment",{attrs:{file:e.innerDocument.mainFile}})],1):e._e()],1):e._e()],1)],1),e._v(" "),e.isContentTypeDocument?n("v-card-actions",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"selected"}],staticClass:"px-0 pt-1 pb-2 action-mobile",attrs:{flat:""}},[n("action-panel",{attrs:{visible:!0,context:e.actionPanelContext,selected:e.selected,"custom-actions":e.customActions,"action-overlays":e.actionOverlays},on:{refresh:e.refreshItem}})],1):e._e()],1)],1):e._e()],1):e._e()]:[e.innerDocument?n("v-row",{class:{"docum-list-item__container-preview":e.isPreviewMode,"docum-list-item__container":!e.isPreviewMode,"mx-2":!e.isPreviewMode},attrs:{"no-gutters":""}},[e.isFullMode?n("v-col",{staticStyle:{overflow:"hidden"},attrs:{md:"12"}},[n("v-card",{staticClass:"elevation-0"},[n("div",{staticClass:"card"},[n("v-card-title",{key:"card-title",staticClass:"px-0 py-0 card-tile"},[n("v-row",{attrs:{justify:"space-between","no-gutters":""}},[n("v-col",[n("div",{key:"dtr",staticClass:"renderer-container"},[e.fromInstruction?n("v-icon",{staticClass:"description",attrs:{color:"primary",size:"22"}},[e._v("description")]):e._e(),e._v(" "),n("document-template-renderer",{key:e.innerDocument.id,attrs:{document:e.innerDocument,"template-type":e.templateType,context:e.actionPanelContext,"lazy-card-actions-counter":e.lazyCardActionsCounter},on:{"set-card-actions":e.onSetCardActions,"set-card-actions-overlay":e.onSetCardActionsOverlay,"card-mounted":e.onCardMounted,"card-updated":e.onCardMounted}}),e._v(" "),n("v-spacer"),e._v(" "),e.fromInstruction?n("v-btn",{staticClass:"square-sm-button rounded-button elevation-0 grey document-button",class:{"lighten-2":e.selected,"grey lighten-3":e.fromInstruction&&!e.selected},on:{click:function(t){return e.$emit("open-origin-document")}}},[n("v-icon",{attrs:{color:"grey darken-2"}},[e._v("chrome_reader_mode")])],1):e._e()],1)]),e._v(" "),n("v-col",{attrs:{cols:"auto"}},[e.innerDocument.viewFlag?e._e():n("v-avatar",{staticClass:"ml-2 mt-1 hidden-xs-only",attrs:{size:"12",color:"error"}})],1)],1)],1),e._v(" "),e.isContentTypeDocument?n("v-card-text",[e.displayMainFile?n("v-col",{staticClass:"grey lighten-5"},[n("ld-attachment",{attrs:{file:e.innerDocument.mainFile},on:{click:e.downloadFile}})],1):e._e()],1):e._e()],1),e._v(" "),e.isContentTypeDocument?n("v-card-actions",{key:"actions",staticClass:"px-0 pt-1 pb-0 grey lighten-2",attrs:{flat:""}},[n("action-panel",{attrs:{visible:!0,context:e.actionPanelContext,"force-is-mobile":e.forceIsMobile,selected:e.selected,"custom-actions":e.customActions,"action-overlays":e.actionOverlays,"lazy-entity-update":e.lazyEntityUpdate},on:{refresh:e.refreshItem}})],1):e._e()],1)],1):e._e(),e._v(" "),e.isPreviewMode?n("v-col",{staticStyle:{overflow:"hidden"},attrs:{md:"12"}},[n("v-card",{staticClass:"card-preview elevation-0",class:{"grey lighten-3":e.selected}},[n("div",{staticClass:"card"},[n("v-card-title",{staticClass:"px-0 py-0 card-tile"},[n("v-row",{attrs:{justify:"space-between","no-gutters":""}},[n("div",{staticClass:"renderer-container"},[e.fromInstruction?n("v-icon",{staticClass:"description",attrs:{color:"primary",size:"22"}},[e._v("description")]):e._e(),e._v(" "),n("document-template-renderer",{attrs:{document:e.innerDocument,"template-type":e.templateType,preview:e.isPreviewMode,context:e.actionPanelContext,"lazy-card-actions-counter":e.lazyCardActionsCounter},on:{"set-card-actions":e.onSetCardActions,"set-card-actions-overlay":e.onSetCardActionsOverlay,"card-mounted":e.onCardMounted,"card-updated":e.onCardMounted}}),e._v(" "),n("v-spacer"),e._v(" "),e.fromInstruction?n("v-btn",{staticClass:"square-sm-button rounded-button elevation-0 grey document-button",class:{"lighten-2":e.selected,"grey lighten-3":e.fromInstruction&&!e.selected},on:{click:function(t){return e.$emit("open-origin-document")}}},[n("v-icon",{attrs:{color:"grey darken-2"}},[e._v("chrome_reader_mode")])],1):e._e()],1),e._v(" "),e.innerDocument.viewFlag?e._e():n("v-avatar",{staticClass:"ml-2 mt-1 hidden-xs-only",attrs:{size:"12",color:"error"}})],1)],1)],1)])],1):e._e()],1):e._e()]],2)},i=[],o=n(97625),s=n(25173),r=n(40471),a=n(50103),l=n(77896),c=n(1869),d=n(18220),u=n(54519),p=n(69548),h=n(92673),m=n(43206),f=n(24377),g=n(86700),y=n(45904),v=n(54486),b=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let C=class DocumentListItemComponent extends((0,y.mixins)(m.r)){constructor(){super(...arguments),this.loading=!1,this.processing=!1,this.displayMainFile=this.$config.displayMainFile,this.actionPanelContext=null,this.lazyCardActionsCounter=0,this.templateType=r.$.Item}updated(){this.$log.debug("DocumentListItemComponent updated")}onCardMounted(){}onDocIdChanged(){var e;return __awaiter(this,void 0,void 0,(function*(){this.documentId&&(yield this.readDocument(),this.typeDocument=null===(e=this.innerDocument)||void 0===e?void 0:e.type,this.actionPanelContext=this.getActionPanelContext())}))}onDocumentChanged(e){e&&(e.fullyRead||(this.typeDocument=e.type),this.actionPanelContext=this.getActionPanelContext())}readDocument(){return __awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{const e=[a.dS.None,a.dS.List].includes(this.actionContext.entityViewMode)?a.dS.View:this.actionContext.entityViewMode;yield this.fetchDocument(new l.U_(this.documentId,e,this.actionContext.folderId))}finally{this.loading=!1}}))}lazyEntityUpdate(){return __awaiter(this,void 0,void 0,(function*(){if(!this.$config.displayMainFile){let e;if(this.lazyCardActionsCounter++,Array.isArray(this.actionContext.document)&&this.actionContext.document.length&&(e=this.actionContext.document[0].id),e)try{const t=yield this.fetchDocument(new l.U_(e,a.dS.View,this.actionContext.folderId));return this.typeDocument===s.i&&(t.documentEntityName=t.type,t.document=t,t.type=s.i),[t]}catch(e){this.$log.error(e)}}}))}getActionPanelContext(){const e=Object.assign(Object.assign({},this.actionContext),{document:[this.innerDocument],entity:[this.innerDocument]});return this.typeDocument===s.i&&this.fetchRightsForShortcut(this.innerDocument.journalID).then((t=>(e.rights=t,t))).catch((e=>this.$log.error(e))),e}downloadFile(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.instructionService.checkFileVersions(e);let n=!1;t&&(n=yield this.instructionService.newFileVersionAlert(null,this.$gettext("Существуют более актуальные версии файла. Скачать последнюю версию?")));const i=n?e.fileId:e.id,o=document.createElement("a");o.href=`${this.$config.apiPath()}files/${i}`,o.download=e.fullFileName||"download",document.body.appendChild(o),o.click(),setTimeout((()=>{document.body.removeChild(o),window.URL.revokeObjectURL(`${this.$config.apiPath()}files/${i}`)}),0)}))}refreshItem(){}openDocument(){this.$app.viewDoc(this.document.id,this.actionContext)}fetchRightsForShortcut(e){return __awaiter(this,void 0,void 0,(function*(){return this.queryBus.exec(new l.Ml(e))}))}get innerDocument(){return this.document?this.document:this.documentId?this.getDocument(this.documentId):void 0}get fromInstruction(){var e;return(null===(e=this.actionContext)||void 0===e?void 0:e.contentType)===a.zc.Instruction}get isContentTypeDocument(){return this.parentContentType===a.zc.Document}get isFullMode(){return this.mode===p.H.Full}get isPreviewMode(){return this.mode===p.H.Preview}get isCardMode(){return this.mode===p.H.Card}};__decorate([(0,b.Prop)({default:a.zc.Document}),__metadata("design:type",Number)],C.prototype,"parentContentType",void 0),__decorate([(0,b.Prop)(),__metadata("design:type",Object)],C.prototype,"document",void 0),__decorate([(0,b.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],C.prototype,"selected",void 0),__decorate([(0,b.Prop)(),__metadata("design:type",Object)],C.prototype,"actionContext",void 0),__decorate([(0,b.Prop)(),__metadata("design:type",Boolean)],C.prototype,"showActiveItem",void 0),__decorate([(0,b.Prop)(),__metadata("design:type",Number)],C.prototype,"documentId",void 0),__decorate([(0,b.Prop)({type:Number,default:p.H.Full}),__metadata("design:type",Number)],C.prototype,"mode",void 0),__decorate([(0,b.Prop)(),__metadata("design:type",Boolean)],C.prototype,"forceIsMobile",void 0),__decorate([(0,d.jI)("fetchDocument"),__metadata("design:type",Object)],C.prototype,"fetchDocument",void 0),__decorate([(0,u.k)("getDocument"),__metadata("design:type",Object)],C.prototype,"getDocument",void 0),__decorate([(0,v.t)(o.X),__metadata("design:type",o.X)],C.prototype,"instructionService",void 0),__decorate([(0,v.t)(h.t.Container),__metadata("design:type",g.W2)],C.prototype,"container",void 0),__decorate([(0,v.t)(c.M.IQueryBus),__metadata("design:type",Object)],C.prototype,"queryBus",void 0),__decorate([(0,b.Watch)("documentId",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],C.prototype,"onDocIdChanged",null),__decorate([(0,b.Watch)("document",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],C.prototype,"onDocumentChanged",null),C=__decorate([(0,b.Component)({components:{"action-panel":f.default}})],C);const w=C,_=w;var x=n(51900),S=n(4479),I=n.n(S);const D=I();var R=(0,x.Z)(_,render,i,!1,null,"43d638b5",null);"function"===typeof D&&D(R);const T=R.exports},70832:(e,t,n)=>{"use strict";n.d(t,{Z:()=>A});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"esign-viewer-wrapper no-gutters",class:{"px-2":e.isDocument}},[n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.loading}}),e._v(" "),e.loading||e.esigns[0]?e._e():n("div",{staticClass:"emptybox"},[n("span",{staticClass:"emptybox-text"},[e._v(e._s(e.$gettext("Нет доступных элементов для отображения")))])]),e._v(" "),e.isDocument&&e.esigns[0]?n("v-row",{staticClass:"mb-2",attrs:{"no-gutters":""}},[n("v-col",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"col-lg-4 col-sm-6"},[n("card-combobox",{attrs:{items:e.files,multiselect:"","input-hint":"Выберите файл","input-size":10,"initial-items":e.fileInitial,"persistent-hint":""},model:{value:e.filters.filesIds,callback:function(t){e.$set(e.filters,"filesIds",t)},expression:"filters.filesIds"}})],1),e._v(" "),n("v-col",{staticClass:"col-lg-4 col-sm-6"},[n("card-combobox",{attrs:{items:e.operations,multiselect:"","input-hint":"Выберите операцию","input-size":10,"persistent-hint":""},model:{value:e.filters.operationType,callback:function(t){e.$set(e.filters,"operationType",t)},expression:"filters.operationType"}})],1),e._v(" "),n("v-col",{staticClass:"col-lg-4 col-sm-12",class:{"mt-2":e.$vuetify.breakpoint.mdAndDown}},[n("v-switch",{staticClass:"px-0 py-0 mt-0 body-1",class:{"blue-label":e.lastVersionOnly},attrs:{label:e.$gettext("Только последние версии"),color:"primary",ripple:!1},model:{value:e.filters.lastVersion,callback:function(t){e.$set(e.filters,"lastVersion",t)},expression:"filters.lastVersion"}})],1)],1),e._v(" "),e.displayedEsigns.length?n("v-row",[n("v-col",[e.isAllcheck?n("v-btn",{staticClass:"small-button rounded-button elevation-0 grey darken-2 white--text mx-0 px-2 font-weight-regular black--text",attrs:{disabled:""}},[n("translate",[e._v(" Проверка завершена ")])],1):n("v-btn",{staticClass:"small-button rounded-button elevation-0 grey darken-2 white--text mx-0 px-2 font-weight-regular",on:{click:e.checkAll}},[n("v-icon",{attrs:{small:"",white:""}},[e._v(" verified_user ")]),e._v(" "),n("translate",[e._v(" Проверить все ")])],1),e._v(" "),e.isDocument?n("v-btn",{staticClass:"small-button rounded-button mx-1 px-2",attrs:{outlined:"",color:"primary"},on:{click:e.print}},[n("v-icon",{attrs:{small:"",color:"primary"}},[e._v("local_printshop")]),e._v(" "),n("translate",{staticClass:"text-capitalize font-weight-regular mr-1"},[e._v(" Печать ")])],1):e._e()],1)],1):e._e()],1)],1):e._e(),e._v(" "),e.esigns[0]?n("v-row",{staticClass:"scroller",attrs:{"no-gutters":""}},[n("v-card",{staticClass:"esigns-card elevation-0 bordered-card grey--border lighten-4",attrs:{width:"100%"}},[n("v-card-title",{staticClass:"grey lighten-4 subheading font-weight-bold pa-1"},e._l(e.cardHeader,(function(t,i){return n("v-col",{key:i,staticClass:"px-1 py-0",attrs:{cols:t.colSize||2}},[n("span",{staticClass:"sm-text font-weight-regular grey--text"},[e._v(e._s(t.name))])])})),1),e._v(" "),e.displayedEsigns.length?n("v-card-text",e._l(e.displayedEsigns,(function(t,i){return n("div",{key:i+":"+t.operationId},[n("v-row",{staticClass:"sm-text",class:{"mb-5":!e.singelElement(i)},attrs:{"no-gutters":""}},[e.isDocument?n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"px-2 py-0 col col-3 column",class:{"success--text":"success"===e.printSignCheckResult(t).color,"warning--text":"warning"===e.printSignCheckResult(t).color}},[n("span",[e._v(e._s(e.printSignCheckResult(t).text))]),e._v(" "),e.isSignChecked(t)?n("v-btn",{staticClass:"small-button rounded-button px-2 my-1 show-esign-btn",attrs:{outlined:"",color:"grey"},on:{click:function(n){return e.viewSignDetails(t)}}},[n("v-icon",{attrs:{small:"",color:"grey"}},[e._v("verified_user")]),e._v(" "),n("translate",{staticClass:"text-capitalize font-weight-regular mr-1"},[e._v(" Посмотреть ЭП ")])],1):n("v-btn",{staticClass:"small-button rounded-button px-2 my-1 show-esign-btn",attrs:{outlined:"",color:"primary",loading:e.isChecking(t)},on:{click:function(n){return e.checkSign(t)}}},[n("v-icon",{attrs:{small:"",color:"primary"}},[e._v("verified_user")]),e._v(" "),n("translate",{staticClass:"text-capitalize font-weight-regular mr-1"},[e._v(" Проверить ЭП ")])],1)],1),e._v(" "),n("v-col",{staticClass:"px-1 py-0 col col-2"},[n("span",[e._v(e._s(e.compareUsers(t).text)),n("br"),e._v("\n                  "+e._s(e.compareUsers(t).text2))])]),e._v(" "),n("v-col",{staticClass:"px-1 py-0 col col-2"},[n("span",[e._v(e._s(t[e.cardHeader[2].field]))])]),e._v(" "),n("v-col",{staticClass:"px-1 py-0 col col-2"},[n("span",[e._v(e._s(e._f("date")(t[e.cardHeader[3].field],"DD.MM.YYYY hh:mm")))])]),e._v(" "),n("v-col",{staticClass:"px-1 py-0 col col-2"},[n("span",{staticClass:"stringBreak",class:{"primary--text":"primary"===e.cardHeader[4].color}},[e._v(e._s(t[e.cardHeader[4].field]))])]),e._v(" "),n("v-col",{staticClass:"px-1 py-0 col col-1"},[n("span",[e._v(e._s(t[e.cardHeader[5].field]))])])],1):n("v-row",{staticClass:"mt-1",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"px-2 py-0 col col-2",class:[{"success--text":"success"===e.printSignCheckResult(t).color,"warning--text":"warning"===e.printSignCheckResult(t).color},"px-1"]},[n("span",[e._v(e._s(e.printSignCheckResult(t).text))])]),e._v(" "),n("v-col",{staticClass:"px-2 py-0 col col-3"},[n("span",{staticClass:"stringBreak"},[e._v(e._s(e.compareUsers(t).text)),n("br"),e._v("\n                  "+e._s(e.compareUsers(t).text2))])]),e._v(" "),n("v-col",{staticClass:"px-1 py-0 col col-2"},[n("span",[e._v(e._s(t[e.cardHeader[2].field]))])]),e._v(" "),n("v-col",{staticClass:"px-1 py-0 col col-3"},[n("span",[e._v(e._s(e._f("date")(t[e.cardHeader[3].field],"DD.MM.YYYY hh:mm")))])]),e._v(" "),n("v-col",{staticClass:"px-0 py-0 col col-2"},[n("span",[e._v(e._s(t[e.cardHeader[4].field]))])])],1)],1),e._v(" "),e.isInstruction?n("v-row",{staticClass:"mb-2 mx-1",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"pb-0"},[e.isSignChecked(t)?e._e():n("v-btn",{staticClass:"small-button rounded-button mx-1 px-2",attrs:{loading:e.isChecking(t),outlined:"",color:"primary"},on:{click:function(n){return e.checkSign(t)}}},[n("v-icon",{attrs:{small:"",color:"primary"}},[e._v("verified_user")]),e._v(" "),n("translate",{staticClass:"text-capitalize font-weight-regular mr-1"},[e._v(" Проверить ЭП ")])],1),e._v(" "),e.isSignChecked(t)?n("v-btn",{staticClass:"small-button rounded-button mx-1 px-2",attrs:{outlined:"",color:"grey"},on:{click:function(n){return e.viewSignDetails(t)}}},[n("v-icon",{attrs:{small:"",color:"grey"}},[e._v("verified_user")]),e._v(" "),n("translate",{staticClass:"text-capitalize font-weight-regular mr-1"},[e._v(" Посмотреть ЭП ")])],1):e._e(),e._v(" "),n("v-btn",{staticClass:"small-button rounded-button mx-1 px-2",attrs:{outlined:"",color:"primary"},on:{click:e.print}},[n("v-icon",{attrs:{small:"",color:"primary"}},[e._v("local_printshop")]),e._v(" "),n("translate",{staticClass:"text-capitalize font-weight-regular mr-1"},[e._v(" Печать ")])],1)],1)],1):e._e()],1)})),0):n("v-card-text",[n("translate",{staticClass:"px-1 text-body-1"},[e._v("Для выбранных объектов подписи не найдены")])],1)],1)],1):e._e(),e._v(" "),e.isDocument?n("v-row",{staticClass:"mt-2 justify-center align-end",attrs:{"no-gutters":""}},[n("v-btn",{staticClass:"small-button rounded-button mx-1 px-2",attrs:{color:"primary"},on:{click:function(t){return e.close("")}}},[n("translate",{staticClass:"text-capitalize font-weight-regular mr-1"},[e._v(" Закрыть ")])],1)],1):e._e()],1)},i=[],o=n(24578),s=n(50103),r=n(77896),a=n(80174),l=n(69332),c=n(99778),d=n(1869),u=n(6259),p=n(77312),h=n(18220),m=n(15137),f=n(2934),g=n.n(f),y=n(54486),v=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let b=class EsignViewerComponent extends(g()){constructor(){super(...arguments),this.esigns=[],this.entity="",this.lastVersionOnly=!1,this.cardHeader=[],this.isAllcheck=!1,this.loading=!1,this.checking={},this.filesInfo=[],this.files=[],this.operations=[{id:1,value:this.$gettext("Все")}],this.filters={lastVersion:null,filesIds:[],operationType:null},this.fileInitial=null}onEntityChange(){this.isDocument?this.entity="document":this.isInstruction&&(this.entity="instruction"),this.fetchEsigns()}onIdCnahge(){this.fetchEsigns()}setEsignOperations(){this.esigns.forEach((e=>{this.operations.push({id:e.operTypeId,value:e.operTypeName})}))}setEsignFileInfo(){let e=[];this.esigns.forEach((t=>{t.esignRows.forEach((t=>{e.push(t.fileName)}))}));const t=new Set(e);e=Array.from(t);const n=[];for(let t=0;t<e.length;t++)n.push({id:t,value:e[t]});this.documentFiles.files.forEach((e=>{n.forEach((t=>{e.fullFileName===t.value&&this.filesInfo.push({id:e.id,value:e.fullFileName,majorVersion:e.versions[0].majorVersion})}))})),this.files=this.files.concat(this.filesInfo,{id:this.files.length+1,value:this.$gettext("Все")});const i=this.files.filter((e=>this.fileSelected.includes(e.id)));(null===i||void 0===i?void 0:i.length)&&(this.fileInitial=i,this.filters.filesIds=i.map((e=>e.id)))}compareUsers(e){return e.physicalUser===e.logicalUser?{text:`${e.physicalUser}`}:e.physicalUser!==e.logicalUser?{text:`${e.physicalUser}`,text2:`за ${e.logicalUser}`}:void 0}createCardHeader(){return this.isDocument?[{name:this.$gettext("Статус ЭП"),field:"",colSize:3},{name:this.$gettext("Подписант"),field:""},{name:this.$gettext("Операция"),field:"operationName"},{name:this.$gettext("Дата подписания"),field:"signDate"},{name:this.$gettext("Файл"),field:"fileName",color:"primary"},{name:this.$gettext("Версия"),field:"version",colSize:1}]:this.isInstruction?[{name:this.$gettext("Статус ЭП"),field:""},{name:this.$gettext("Подписант"),field:"",colSize:3},{name:this.$gettext("Операция"),field:"operationName"},{name:this.$gettext("Дата подписания"),field:"signDate",colSize:3},{name:this.$gettext("Объект"),field:"objectTypeDisplayLabel"}]:void 0}checkSign(e){return __awaiter(this,void 0,void 0,(function*(){try{this.$set(this.checking,this.signKey(e),!0);let t=new a.qK({entityName:this.entity,entityId:e.objectId,objectId:e.objectId,operationId:e.operationId});return this.contentType===s.zc.Document&&(t=new a.qK({entityName:this.entity,entityId:this.id,objectId:e.objectId,operationId:e.operationId})),this.queryBus.exec(t).then((t=>{const n=JSON.parse(JSON.stringify(t));return this.$set(e,"signDate",n.response.signDate),this.$set(e,"checkResult",n.response.verifyResult),this.$set(e,"checkResultMessage",n.response.errorMessage),this.checking[this.signKey(e)]=!1,t})).catch((t=>{this.$set(e,"checkResult",3)}))}finally{this.checking[this.signKey(e)]=!1}}))}isChecking(e){return this.checking[this.signKey(e)]}signKey(e){return`${e.objectId}-${e.operationId}`}checkAll(){for(const e of this.esigns)for(const t of e.esignRows)t.checkResult||this.checkSign(t);this.isAllcheck=!0}printSignCheckResult(e){return e.checkResult===o.do.Success?{text:this.$gettext("Подпись верна"),color:"success"}:e.checkResult===o.do.SignInvalid?{text:this.$gettext("Подпись не верна"),color:"warning"}:e.checkResult===o.do.OtherError&&e.checkResultMessage?{text:e.checkResultMessage,color:"warning"}:{text:this.$gettext("Не проверена"),color:"warning"}}isSignChecked(e){return e.checkResult||e.checkResult===o.do.NoSign}viewSignDetails(e){return __awaiter(this,void 0,void 0,(function*(){const t=new c.u(this.$gettext("Результат проверки ЭП"),this.contentType,`${this.id}`,e.objectId,e.operTypeID,e.operationId,e,this.isDocument?this.documentInfo.attributes:null);yield this.queryBus.exec(t)}))}print(){return __awaiter(this,void 0,void 0,(function*(){for(const e of this.esigns)for(const t of e.esignRows)t.esignStatus=this.printSignCheckResult(t).text;const e=yield this.fetchCurrentUser(new u.by(!1)),t=yield this.queryBus.exec(new p.zD([e.effectiveId])),n=t[0].departmentName;let i={};if(this.isDocument)i={title:this.$gettext("Электронные подписи файлов документа"),contentType:this.contentType,currentUser:t[0],document:this.documentInfo.attributes,esignsInfo:this.displayedEsigns};else{const t=yield this.queryBus.exec(new l.oE(this.id));i={title:this.$gettext("Электронная подпись сообщения"),contentType:this.contentType,currentUser:e,instructionInfo:t,departmentName:n,esignsInfo:this.displayedEsigns}}this.$printExtComponent("esign-report",i,"eSign",{mode:this.$config.esignReportToFile?m.z.Word:m.z.Standard})}))}fetchDocumentInfo(){return __awaiter(this,void 0,void 0,(function*(){return this.documentInfo=yield this.queryBus.exec(new r.U_(this.id,s.dS.View)),this.documentInfo}))}fetchEsigns(){return __awaiter(this,void 0,void 0,(function*(){if(this.entity&&this.id){this.loading=!0;try{this.cardHeader=this.createCardHeader();const e=new a.AX(this.entity,this.id);this.esigns=yield this.queryBus.exec(e);for(const e of this.esigns)for(const t of e.esignRows){const e=yield this.queryBus.exec(new p.zD([t.userID]));if(this.documentFiles&&this.documentFiles.files.length)for(const e of this.documentFiles.files)t.fileName===e.fullFileName&&(t.majorVersion=e.versions[0].majorVersion);yield this.checkActualEsigns(t),t.departmentName=e[0].departmentName,t.positionName=e[0].positionName,t.visibled=!0}}finally{this.isDocument&&(this.fetchDocumentInfo(),this.filters.lastVersion=!0,this.filters.operationType=[1],this.setEsignFileInfo()),this.setEsignOperations(),this.loading=!1}}}))}checkActualEsigns(e){return __awaiter(this,void 0,void 0,(function*(){if(e.majorVersion&&e.version===e.majorVersion){if(!this.fileSelected)return void(yield this.checkSign(e));this.fileSelected&&this.fileSelected.includes(e.objectId)&&(yield this.checkSign(e))}}))}singelElement(e){return Boolean(e===this.displayedEsigns.length-1)}get isDocument(){return this.contentType===s.zc.Document}get isInstruction(){return this.contentType===s.zc.Instruction}close(e){this.$emit("set-result",{event:e||"cancel",data:{}})}get displayedEsigns(){let e=[];if(this.esigns.forEach((t=>e.push(...t.esignRows))),this.isInstruction)return e;if(!this.files.length)return[];if(!this.filters.filesIds.length)return[];if(!this.filters.lastVersion&&!this.filters.operationType)return e;this.filters.lastVersion&&(e=e.filter((e=>e.version===e.majorVersion)));const t=this.filters.filesIds.includes(this.files[this.files.length-1].id);this.filters.filesIds.length&&!t&&(e=e.filter((e=>this.filters.filesIds.includes(e.objectId))));const n=1,i=this.filters.operationType.includes(n);return this.filters.operationType&&!i&&(e=e.filter((e=>this.filters.operationType.includes(e.operTypeID)))),this.filters.lastVersion,e}};__decorate([(0,v.Prop)(),__metadata("design:type",Number)],b.prototype,"contentType",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Number)],b.prototype,"id",void 0),__decorate([(0,v.Prop)(),__metadata("design:type",Object)],b.prototype,"documentFiles",void 0),__decorate([(0,v.Prop)({type:Array,default:[]}),__metadata("design:type",Array)],b.prototype,"fileSelected",void 0),__decorate([(0,y.t)(d.M.IQueryBus),__metadata("design:type",Object)],b.prototype,"queryBus",void 0),__decorate([(0,h.jI)("fetchDocumentFiles"),__metadata("design:type",Object)],b.prototype,"fetchDocumentFiles",void 0),__decorate([(0,h.g4)("fetchCurrentuser"),__metadata("design:type",Object)],b.prototype,"fetchCurrentUser",void 0),__decorate([(0,v.Watch)("contentType",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],b.prototype,"onEntityChange",null),__decorate([(0,v.Watch)("id"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],b.prototype,"onIdCnahge",null),b=__decorate([v.Component],b);const C=b,w=C;var _=n(51900),x=n(43453),S=n.n(x),I=n(82127),D=n(85893),R=n(5255),T=n(17024),P=n(71100),O=n(57894),k=n(56721),F=(0,_.Z)(w,render,i,!1,null,"51fbd49a",null);const A=F.exports;S()(F,{VBtn:I.Z,VCard:D.Z,VCardText:R.ZB,VCardTitle:R.EB,VCol:T.Z,VIcon:P.Z,VRow:O.Z,VSwitch:k.Z})},21883:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-panel px-1 primary--border",class:{"py-3":!e.loading,"py-1":e.loading,"upload-panel-no-dropzone":!e.drop}},[n("div",{staticClass:"d-flex align-center justify-center drop fill-height",attrs:{id:"drop"}},[e.loading?n("v-progress-circular",{attrs:{size:50,width:4,color:"primary",indeterminate:""}}):e._e(),e._v(" "),n("vue-file-upload",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],ref:"upload",staticStyle:{display:"inline-flex"},attrs:{"input-id":e.inputId,"post-action":e.postAction,"put-action":e.putAction,accept:e.accept,multiple:e.multiple,directory:!1,thread:3,headers:{},data:{},drop:e.drop,"drop-directory":!0,"add-index":!1},on:{"input-file":e.uploadFile},model:{value:e.uploadedFiles,callback:function(t){e.uploadedFiles=t},expression:"uploadedFiles"}},[e._t("default",[n("span",{staticClass:"grey--text lighten-7 font-weight-regular pr-1 body-1",staticStyle:{"text-align":"center",cursor:"pointer"}},[e._v("\n          "+e._s(e.$gettext("Перетащите файлы в это окно или"))+"\n          "),n("a",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"primary--text",attrs:{href:"#"}},[e._v("выберите")])])])],2)],1)])},i=[],o=n(16273),s=n(18220),r=n(29339),a=n(42948),l=n.n(a),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let c=1,d=class FileUploadComponent extends r.Vue{constructor(){super(...arguments),this.myAllowedFileExtensions=[],this.uploadedFiles=[],this.loading=!1,this.inputId="vueFilelUp-"+c++,this.typeNotAllowedMsg=this.$gettext("Недопустимый тип файла")}created(){return __awaiter(this,void 0,void 0,(function*(){if(Array.isArray(this.allowedFileExtensions))this.myAllowedFileExtensions=this.allowedFileExtensions.filter(Boolean).map((e=>e.toLowerCase()));else{this.loading=!0;try{const e=yield this.fetchFileTypes({fromRemote:!1});this.myAllowedFileExtensions=e.filter((e=>e.Extension)).map((e=>e.Extension.toLowerCase()))}finally{this.loading=!1}}}))}uploadFile(e){if(!this.putAction&&!this.postAction)return this.validate(e),void this.$nextTick((()=>this.$emit("file-loaded",this.toFileInfo(e))));if(!e.handled)if(this.$refs.upload.active&&(this.loading=!0),this.validate(e),this.handleErrors(e))e.handled=!0;else{(this.putAction||this.postAction)&&(this.$refs.upload.active=!0);try{if(e.success&&!e.error){e.handled=!0;const{name:t}=e;this.$toasted.success(this.$gettextInterpolate(this.$gettext("Файл %{name} успешно добавлен"),{name:t})),this.$nextTick((()=>this.$emit("file-loaded",this.toFileInfo(e)))),this.loading=!1}this.$nextTick((()=>{this.$refs.upload.active||(this.loading=!1)}))}catch(e){this.$log.debug(e)}}}handleErrors(e){let t=!1;if(e.notAllowed||e.error)if(e.status===this.typeNotAllowedMsg){const n=(0,o.mD)(e.name);this.$toasted.error(this.$gettextInterpolate(this.$gettext("При загрузке файла %{name} произошла ошибка: Недопустимый тип файла %{extension}"),{name:e.name,extension:n})),e.active=!1,this.uploadedFiles.splice(this.uploadedFiles.indexOf(e),1),this.loading=!1,t=!0}else this.$toasted.error(`${e.response}`),e.active=!1,this.uploadedFiles.splice(this.uploadedFiles.indexOf(e),1),this.loading=!1,t=!0;else t=!1;return t}validate(e){const t=(0,o.mD)(e.name);this.myAllowedFileExtensions.includes(t)||(e.notAllowed=!0,e.status=this.typeNotAllowedMsg)}toFileInfo(e){const t=(0,o.mD)(e.name).toLowerCase();return{fileExtension:t,fullFileName:e.name,fileName:e.name,file:e.file,sizeKb:e.size.toString(),size:e.size,uid:String(e.id),createDateTime:new Date,creator:null,creatorId:0,curEditorID:0,curEditorName:null,fileId:Number(e.id),fileType:0,id:0,majorVersion:null,minorVersion:null,state:null,verN:null,versionN:null,versions:[]}}};__decorate([(0,r.Prop)(),__metadata("design:type",String)],d.prototype,"postAction",void 0),__decorate([(0,r.Prop)(),__metadata("design:type",String)],d.prototype,"putAction",void 0),__decorate([(0,r.Prop)({default:!0}),__metadata("design:type",Boolean)],d.prototype,"multiple",void 0),__decorate([(0,r.Prop)({default:!0}),__metadata("design:type",Boolean)],d.prototype,"drop",void 0),__decorate([(0,r.Prop)(),__metadata("design:type",Array)],d.prototype,"allowedFileExtensions",void 0),__decorate([(0,r.Prop)({type:String,default:"*"}),__metadata("design:type",String)],d.prototype,"accept",void 0),__decorate([(0,s.p$)("fetchFileTypes"),__metadata("design:type",Object)],d.prototype,"fetchFileTypes",void 0),d=__decorate([(0,r.Component)({components:{"vue-file-upload":l()}})],d);const u=d,p=u;var h=n(51900),m=n(43453),f=n.n(m),g=n(95467),y=(0,h.Z)(p,render,i,!1,null,"0784091b",null);const v=y.exports;f()(y,{VProgressCircular:g.Z})},70178:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ke});var i,render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.filesViewerClass,attrs:{"no-gutters":""}},[e.canAddFiles?n("div",{staticClass:"document-file-versions-version-upload"},[n("file-upload",{staticClass:"upload",attrs:{"post-action":e.saveUrl},on:{"file-loaded":e.fileLoadedHandler}}),e._v(" "),n("input",{staticStyle:{display:"none"},attrs:{id:"file-versions",type:"file"},on:{change:e.onAddFile}})],1):e._e(),e._v(" "),n("div",{staticClass:"d-flex flex-wrap"},[e.templateBtnShow?n("v-btn",{staticClass:"mr-2 mb-2 small-button black--text lighten-1 grey--border lighten-3",attrs:{outlined:""},on:{click:e.addTemplate}},[n("v-icon",{staticClass:"grey--text darken-3"},[e._v(" add ")]),e._v(" "),n("translate",[e._v(" Шаблон ")])],1):e._e(),e._v(" "),n("v-btn",{staticClass:"mr-2 mb-2 small-button black--text lighten-1 grey--border lighten-3",attrs:{disabled:!e.hasFiles,outlined:""},on:{click:e.downloadAll}},[n("v-icon",{staticClass:"grey--text darken-3"},[e._v("get_app ")]),e._v(" "),n("translate",[e._v(" Скачать все файлы ")])],1),e._v(" "),e.nativeApp&&e.canAddFiles?n("v-btn",{staticClass:"mr-2 mb-2 small-button black--text lighten-1 grey--border lighten-3",attrs:{disabled:e.nativeScanIsRunning,outlined:""},on:{click:e.scanFileNative}},[n("v-icon",{staticClass:"grey--text darken-3"},[e._v("scanner")]),e._v(" "),n("translate",[e._v("Сканировать")])],1):e._e(),e._v(" "),e.showEsignButton?n("v-btn",{staticClass:"mr-2 mb-2 small-button black--text lighten-1 grey--border lighten-3",attrs:{disabled:!e.hasFiles,outlined:""},on:{click:e.signFiles}},[n("translate",[e._v("Подписать ЭП")])],1):e._e(),e._v(" "),e.showEsignButton&&!e.isMobile?n("v-btn",{staticClass:"mb-2 small-button black--text lighten-1 grey--border lighten-3",attrs:{disabled:!e.hasFiles,outlined:""},on:{click:function(t){return e.checkSign(null,!1)}}},[n("v-icon",{staticClass:"grey--text darken-3"},[e._v("done")]),e._v(" "),n("translate",[e._v("Проверить ЭП")])],1):e._e()],1),e._v(" "),n("div",{staticClass:"mb-3 files-viewer--table"},[n("v-card",{staticClass:"elevation-0 bordered-card grey--border lighten-3",staticStyle:{position:"relative","min-width":"600px",height:"100%"}},[n("v-card-title",{staticClass:"grey lighten-4"},[n("v-row",{staticClass:"flex-nowrap",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"col--filename",attrs:{cols:"4"}},[n("span",{staticClass:"body-1 grey--text"},[e._v(e._s(e.$gettext("Файл")))])]),e._v(" "),e.isLimitedMode||e.isMobile?e._e():[n("v-col",{attrs:{cols:"1"}},[n("span",{staticClass:"body-1 grey--text text-no-wrap"},[e._v(e._s(e.$gettext("Размер")))])]),e._v(" "),n("v-col",{attrs:{cols:"2"}},[n("span",{staticClass:"body-1 grey--text"},[e._v(e._s(e.$gettext("Дата загрузки")))])]),e._v(" "),n("v-col",{attrs:{cols:"2"}},[n("span",{staticClass:"body-1 grey--text"},[e._v(e._s(e.$gettext("Автор")))])])]],2)],1),e._v(" "),e.loading||e.hasFiles?e._e():n("div",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"body-1 emptybox-alert py-3"},[e._v("Файлы документа отсутствуют")]),e._v(" "),n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.loading}}),e._v(" "),n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.processing}}),e._v(" "),n("div",{staticStyle:{"max-height":"100%","overflow-y":"auto"}},[!e.loading&&e.hasFiles?n("v-expansion-panels",{staticClass:"elevation-0",attrs:{accordion:"",flat:""}},e._l(e.files,(function(t){return n("v-expansion-panel",{key:t.id,staticClass:"elevation-0 px-2",class:{"limited-expansion-panel":e.isLimitedMode},attrs:{focusable:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},[n("v-expansion-panel-header",{staticClass:"file-info-caption black--text lighten-1 body-1",class:{"file-info-limited":e.isLimitedMode},attrs:{"expand-icon":e.limitedModeIcon}},[n("v-row",{staticClass:"align-center",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"col col--filename",class:{"col-xs-12":e.isLimitedMode&&e.isMobile,"col-xs-4 col-sm-4 col-md-4 col-lg-4 col-xl-4":!e.isLimitedMode&&!e.isMobile}},[n("div",{staticClass:"d-flex align-center"},[e.isLimitedMode?e._e():n("svg-icon",{staticClass:"svg-icon svg-doc mr-2",attrs:{icon:e.extentionIcon(t)}}),e._v(" "),e.currFileId===t.id?n("v-icon",{staticClass:"ml-2",attrs:{color:"warning",small:""}},[e._v(" visibility ")]):e._e(),e._v(" "),n("span",{staticClass:"filename primary--text",class:{"files-mobile":e.isMobile},attrs:{"data-testid":"fileName"}},[e._v("\n                      "+e._s(t.fullFileName)+"\n                    ")])],1),e._v(" "),t.curEditorName?n("div",{staticClass:"grey--text"},[n("v-icon",{staticClass:"grey--text mini-icon"},[e._v("lock")]),e._v(" "),t.curEditorID===e.currentUser.id?n("span",[e._v(e._s(e.$gettext("Заблокировано мной")))]):n("span",[e._v(" "+e._s(e.$gettext("Заблокировано:"))+" "+e._s(t.curEditorName)+" ")])],1):e._e()]),e._v(" "),e.isLimitedMode||e.isMobile?e._e():[n("v-col",{staticClass:"col",attrs:{cols:"1",sm:"1",md:"1",lg:"1",xl:"1"}},[n("span",{staticClass:"body-1"},[e._v(e._s(t.sizeKb))])]),e._v(" "),n("v-col",{staticClass:"col",attrs:{cols:"2",sm:"2",md:"2",lg:"2",xl:"2"}},[n("span",{staticClass:"body-1"},[e._v(e._s(e._f("date")(t.createDateTime,"DD.MM.YYYY hh:mm")))])]),e._v(" "),n("v-col",{staticClass:"col",attrs:{cols:"2",sm:"2",md:"2",lg:"2",xl:"2"}},[n("span",{staticClass:"body-1"},[e._v(e._s(t.creator))])])],e._v(" "),n("v-col",{staticClass:"d-flex align-center pl-2",attrs:{cols:"3"}},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[e.displayCloudButton(t)&&e.checkExistLocalFileInCloud(t,!0)?n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""},on:{click:function(n){return n.stopPropagation(),e.exportFileCloudToLocal(t)}}},o),[n("v-icon",{staticClass:"grey--text darken-3 mr-3",attrs:{size:"18"}},[e._v(" cloud_download ")])],1):e._e()]}}],null,!0)},[e._v(" "),n("translate",[e._v("Выгрузить файл из 365")])],1),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[e.showEsignButton&&!e.isMobile?n("v-btn",e._g({staticClass:"small-round-button mr-3",attrs:{icon:""},on:{click:function(n){return e.checkSign(t.id,!0)}}},o),[n("v-icon",{staticClass:"grey--text darken-3",attrs:{size:"18"}},[e._v("check_circle")])],1):e._e()]}}],null,!0)},[e._v(" "),n("translate",[e._v("Проверить ЭП файла")])],1),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[e.displayCloudButton(t)?n("v-btn",e._g({staticClass:"small-round-button mr-3",attrs:{"data-testid":"fileDownload",tag:"a",href:e.onDownload(t.id),download:"",icon:""},on:{click:function(n){return n.stopPropagation(),e.openFileCloud(t)}}},o),[n("v-icon",{staticClass:"grey--text darken-3",attrs:{size:"18"}},[e._v(" cloud ")])],1):e._e()]}}],null,!0)},[e._v(" "),n("translate",[e._v("Просмотр файла в 365")])],1),e._v(" "),e.displayOpenFileButton(t)?n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-btn",e._g({staticClass:"small-round-button mr-3",attrs:{icon:""},on:{click:function(n){return n.stopPropagation(),e.openFileView(t,e.typeView.View)}}},o),[n("v-icon",{staticClass:"grey--text darken-3",attrs:{size:"18"}},[e._v(" "+e._s(e.openFileIcon)+" ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Просмотр файла")])],1):e._e(),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{"data-testid":"fileDownload",tag:"a",href:e.onDownload(t.id),download:"",icon:""}},o),[n("v-icon",{staticClass:"grey--text darken-3",attrs:{size:"18"}},[e._v(" get_app ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Скачать файл")])],1)],1)],2)],1),e._v(" "),n("v-expansion-panel-content",[e.isLimitedMode?e._e():n("v-card",{staticClass:"elevation-0 mt-1"},[n("v-card-text",{staticClass:"px-0 py-0"},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"d-flex align-center",attrs:{cols:"12"}},[e.nativeApp&&t.canEdit?n("ld-btn",{key:"toWork1",staticClass:"ml-0 my-0",attrs:{testid:"toEditButton",disabled:e.toWorkButtonDisabled(t),color:"primary",tooltip:e.$gettext("Копировать в буфер обмена")},on:{click:function(n){return e.onEditNative(t)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("v-icon",{attrs:{color:"white"}},[e._v(e._s(e.toWorkButtonIcon(t)))])]},proxy:!0},{key:"text",fn:function(){return[n("translate",[e._v(e._s(e.toWorkButtonName(t)))])]},proxy:!0}],null,!0)}):e._e(),e._v(" "),e.blockedByAnother(t)?n("ld-btn",{key:"toWork4",staticClass:"ml-0 my-0",attrs:{testid:"toEditButton",color:"primary",disabled:e.toWorkButtonDisabled(t),tooltip:e.$gettext("Копировать в буфер обмена")},on:{click:function(n){return e.forceUnlock(t)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("v-icon",{attrs:{color:"white"}},[e._v(e._s(e.toWorkButtonIcon(t)))])]},proxy:!0},{key:"text",fn:function(){return[n("translate",[e._v("Принудительно снять с редактирования")])]},proxy:!0}],null,!0)}):e._e(),e._v(" "),e.nativeApp||e.plugin||!t.canEdit?e._e():n("ld-btn",{key:"toWork3",staticClass:"ml-0 my-0",attrs:{testid:"toEditButton",disabled:e.toWorkButtonDisabled(t),color:"primary",tooltip:e.$gettext("Копировать в буфер обмена")},on:{click:function(n){return e.onEdit(t)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("v-icon",{attrs:{color:"white"}},[e._v(e._s(e.toWorkButtonIcon(t)))])]},proxy:!0},{key:"text",fn:function(){return[n("translate",[e._v(e._s(e.toWorkButtonName(t)))])]},proxy:!0}],null,!0)}),e._v(" "),e.canRemoveFromEditing(t)&&e.nativeApp&&!e.plugin&&t.canEdit?n("ld-btn",{key:"loadNew1",staticClass:"rounded-button ml-0 my-0 elevation-0 font-weight-regular small-button ml-2",class:{"square-sm-button":e.isLimitedMode||e.isMobile,"small-button":!e.isLimitedMode},attrs:{outlined:"",color:"primary"},on:{click:function(n){return e.loadNewVersionByNative(t,n)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("v-icon",{attrs:{color:"primary"}},[e._v("publish")]),e._v(" "),e.canLoadFilesFromDiskNative?n("input",{ref:"loadFileInputNative",refInFor:!0,staticClass:"file-version-input",class:{"input-mobile":e.isMobile},attrs:{accept:t.fileExtension,type:"file",name:"file"},on:{input:function(n){return e.onVersionDownload(n,t.fullFileName,t.id)}}}):e._e()]},proxy:!0},{key:"text",fn:function(){return[n("translate",[e._v(" Загрузить новую версию ")]),e._v(" "),e.canLoadFilesFromDiskNative?n("input",{ref:"loadFileInputNative",refInFor:!0,staticClass:"file-version-input",class:{"input-mobile":e.isMobile},attrs:{accept:t.fileExtension,type:"file",name:"file"},on:{input:function(n){return e.onVersionDownload(n,t.fullFileName,t.id)}}}):e._e()]},proxy:!0}],null,!0)}):e._e(),e._v(" "),e.canRemoveFromEditing(t)&&!e.nativeApp?n("ld-btn",{key:"loadNew2",staticClass:"rounded-button ml-0 my-0 elevation-0 font-weight-regular ml-2",class:{"square-sm-button":e.isLimitedMode||e.isMobile,"small-button":!e.isLimitedMode},attrs:{outlined:"",color:"primary"},on:{click:function(n){return e.loadNewVersion(t,n)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("v-icon",{attrs:{color:"primary"}},[e._v("publish")]),e._v(" "),e.canLoadFilesFromDisk?n("input",{ref:"loadFileInput",refInFor:!0,staticClass:"file-version-input",class:{"input-mobile":e.isMobile},attrs:{accept:t.fileExtension,type:"file",name:"file"},on:{input:function(n){return e.onVersionDownload(n,t.fullFileName,t.id)}}}):e._e()]},proxy:!0},{key:"text",fn:function(){return[n("translate",[e._v(" Загрузить новую версию ")]),e._v(" "),e.canLoadFilesFromDisk?n("input",{ref:"loadFileInput",refInFor:!0,staticClass:"file-version-input",class:{"input-mobile":e.isMobile},attrs:{accept:t.fileExtension,type:"file",name:"file"},on:{input:function(n){return e.onVersionDownload(n,t.fullFileName,t.id)}}}):e._e()]},proxy:!0}],null,!0)}):e._e(),e._v(" "),e.displayStampsButton(t)&&e.isFileStampsEnabled?n("ld-btn",{key:"stamps",staticClass:"rounded-button ml-0 my-0 elevation-0 font-weight-regular ml-2",class:{"square-sm-button":e.isLimitedMode||e.isMobile,"small-button":!e.isLimitedMode},attrs:{color:"primary",outlined:""},on:{click:function(n){return n.stopPropagation(),e.openFileView(t,e.typeView.Stamp)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("svg-icon",{staticClass:"svg-icon primary--text",attrs:{icon:"stamp"}})]},proxy:!0},{key:"text",fn:function(){return[n("translate",{staticClass:"pl-1"},[e._v("Штампы ЭП")])]},proxy:!0}],null,!0)}):e._e(),e._v(" "),e.displayRenameButton?n("ld-btn",{key:"rename",staticClass:"rounded-button ml-0 my-0 ml-2 elevation-0 font-weight-regular",class:{"square-sm-button":e.isLimitedMode||e.isMobile,"small-button":!e.isLimitedMode},attrs:{testid:"renameButton",outlined:"",color:"primary"},on:{click:function(n){return e.onRename(t)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("svg-icon",{staticClass:"svg-icon primary--text",attrs:{icon:"rename"}})]},proxy:!0},{key:"text",fn:function(){return[n("translate",[e._v("Переименовать")])]},proxy:!0}],null,!0)}):e._e(),e._v(" "),e.displayConvertButton(t)?n("v-btn",{key:"toPdf",staticClass:"rounded-button ml-0 my-0 ml-2 elevation-0 font-weight-regular",class:{"square-sm-button":e.isLimitedMode||e.isMobile,"small-button":!e.isLimitedMode},attrs:{disabled:e.processingConvertFile,loading:e.processingConvertFile,color:"primary",outlined:""},on:{click:function(n){return e.onConvert(t)}}},[n("v-row",{class:{"justify-center":e.isLimitedMode||e.isMobile},attrs:{align:"center","no-gutters":""}},[n("v-icon",{attrs:{color:"primary"}},[e._v("add")]),e._v(" "),e.isMobile?e._e():[n("translate",[e._v("Создать PDF/A")])]],2)],1):e._e(),e._v(" "),e.canDelete(t)?n("v-btn",{key:"del",staticClass:"rounded-button square-sm-button my-0 ml-0 px-2 elevation-0 font-weight-regular ml-2",attrs:{"data-testid":"deleteButton",color:"warning"},on:{click:function(n){return e.onDelete(t)}}},[n("v-icon",{attrs:{color:"white",size:"18"}},[e._v("delete")])],1):e._e()],1),e._v(" "),n("v-col",{attrs:{cols:"12"}},[n("file-version-viewer",{attrs:{file:t,fileVersions:t.versions,fileRights:e.fileRights,preview:e.preview,deleteVersion:e.deleteVersion,mobile:e.isMobile||e.isLimitedMode,processedFiles:e.processedFiles}})],1),e._v(" "),e.isFileStampsEnabled?n("v-col",{attrs:{cols:"12"}},[e.showCollapsedStampsData&&!e.isMobile?n("file-stamps",{attrs:{file:t,document:e.myCard,isPreviewMode:e.isPreview,esings:e.eSigns}}):e._e()],1):e._e()],1)],1)],1)],1)],1)})),1):e._e()],1)],1)],1)])},o=[],s=n(60917),r=n(64447),a=n(22402),l=n(45154),c=n(29256),d=n(86418),u=n(24578),p=n(36378),h=n(98005),m=n(42256),f=n(50103),g=n(77896),y=n(80174),v=n(22337),b=n(43867),C=n(20386),w=n(45569),_=n(23800),x=n(86949),S=n(54626),I=n(8107),D=n(13560),R=n(70068),T=n(2653),P=n(1869),O=n(71354),k=n(26744),F=n(40551),A=n(16273),$=n(28517),j=n(18220),E=n(21610),M=n(60601),N=n(30036),fileStampsvue_type_template_id_37635c99_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"file-stamps",attrs:{"no-gutters":""}},[n("v-expansion-panels",{staticClass:"elevation-0"},[n("v-expansion-panel",[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("div",{staticClass:"body-2 font-weight-bold"},[n("translate",[e._v("Данные для штампа")])],1)]),e._v(" "),n("v-expansion-panel-content",[n("ul",{staticClass:"stamps body-1 black--text lighten-1"},[n("li",{staticClass:"stamp mb-2",class:{"mobile-stamp":e.isTablet,"no-stamps":!e.eSignsFile}},[n("translate",{staticClass:"stamp-name"},[e._v(" Рег.штамп: ")]),e._v(" "),n("v-row",{staticClass:"ml-2",attrs:{justify:"start","no-gutters":""}},[n("v-col",{staticClass:"d-flex",attrs:{cols:"12"}},[n("ld-btn",{staticClass:"ml-0 my-0 px-2",attrs:{outlined:!0,color:"primary",tooltip:e.$gettext("Копировать в буфер обмена")},on:{click:function(t){return e.copyImage(0,0)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("svg-icon",{staticClass:"svg-icon primary--text",attrs:{icon:"copy_content"}})]},proxy:!0},{key:"text",fn:function(){return[n("translate",[e._v("Копировать в буфер обмена")])]},proxy:!0},{key:"hidden",fn:function(){return[n("div",{staticClass:"copyable-img-wr copyable-img-wr-0"},[n("img",{staticClass:"copyable-img-0",attrs:{src:""}})])]},proxy:!0}])}),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"stamp-view square-sm-button",attrs:{color:"primary"},on:{click:function(t){return e.openImage(0,0)}}},i),[n("v-icon",{staticClass:"white--text"},[e._v("remove_red_eye")])],1)]}}])},[e._v(" "),n("translate",[e._v("Просмотр изображения")])],1)],1)],1)],1),e._v(" "),e._l(e.eSignsLastFile,(function(t,i){return n("li",{staticClass:"stamp mb-2",class:{"mobile-stamp":e.isTablet}},[n("v-row",{attrs:{"no-gutters":"",align:"center"}},[n("v-col",{class:{"col-xs-6 col-sm-6 col-lg-7 col-md-7 col-xl-6":e.isPreviewMode,"col-xs-6 col-sm-6 col-lg-4 col-xl-3 col-md-6":!e.isPreviewMode}},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("span",e._g({staticClass:"stamp-name black--text lighten-1 body-1"},o),[n("b",[e._v("Штамп ЭП")]),e._v(", "+e._s(t.operationName)+" ("+e._s(t.physicalUser)+")\n                    ")])]}}],null,!0)},[e._v(" "),n("span",[n("b",[e._v("Штамп ЭП")]),e._v(", "+e._s(t.operationName)+" ("+e._s(t.physicalUser)+") ")])])],1),e._v(" "),n("v-col",{staticClass:"d-flex align-center"},[n("ld-btn",{staticClass:"ml-0 my-0 px-2 copy-btn",attrs:{outlined:!0,color:"primary",tooltip:e.$gettext("Копировать в буфер обмена")},on:{click:function(t){return e.copyImage(i,1)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("svg-icon",{staticClass:"svg-icon primary--text",attrs:{icon:"copy_content"}})]},proxy:!0},{key:"hidden",fn:function(){return[n("div",{staticClass:"copyable-img-wr",class:"copyable-img-wr-"+i},[n("img",{class:"copyable-img-"+i,attrs:{src:""}})])]},proxy:!0}],null,!0)}),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("v-btn",e._g({staticClass:"stamp-view square-sm-button",attrs:{color:"primary"},on:{click:function(t){return e.openImage(i,1)}}},o),[n("v-icon",{attrs:{color:"white--text"}},[e._v("remove_red_eye")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Просмотр изображения")])],1)],1)],1)],1)}))],2)])],1)],1)],1)},V=[],B=n(2934),L=n.n(B),U=n(45904),H=n(54486),Q=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};(function(e){e[e["Reg"]=0]="Reg",e[e["ESign"]=1]="ESign"})(i||(i={}));let z=class FileStamps extends(L()){constructor(){super(...arguments),this.eSignsLastFile=[],this.regStampSrc="",this.eSignsLastFileWithStamps=[],this.stampsImages=[]}onDocumentChanged(){this.regStampSrc=`${this.$config.apiPath()}WebStamp/regnumber.png?documentId=${this.document.id}&versionId=${this.file.id}`}onESingnsChanged(){Array.isArray(this.esings)&&this.esings.length&&(this.eSignsLastFile=this.formateEsigns()),Array.isArray(this.eSignsLastFile)&&this.eSignsLastFile.length&&this.eSignsLastFile.forEach(((e,t)=>{const n=`${this.$config.apiPath()}WebStamp/esign.png?documentId=${this.document.id}&versionId=${e.objectId}&operTypeId=${e["operTypeID"]}&userid=${e.userID}`;this.eSignsLastFileWithStamps[t]=Object.assign(Object.assign({},e),{stampImageUrl:n})}))}formateEsigns(){const e=[];this.esings.forEach((t=>{for(const n of t.esignRows)e.push(n)}));const t=[];e.forEach((e=>{let n=!1;t.forEach((t=>{e.objectId===t.objectId&&(n=!0)})),n||t.push(e)})),t.forEach(((e,n)=>{t[n].lastVersion=0})),t.forEach(((n,i)=>{let o=0;e.forEach((e=>{n.objectId===e.objectId&&e.version>o&&(o=e.version)})),t[i].lastVersion=o}));const n={};return t.forEach(((t,i)=>{n[t.objectId]=[],e.forEach((e=>{e.version===t.lastVersion&&e.objectId===t.objectId&&n[`${e.objectId}`].push(e)}))})),n[this.file.id]}copyImage(e,t){let n="";t===i.Reg&&(n=this.regStampSrc),t===i.ESign&&(n=this.eSignsLastFileWithStamps[e].stampImageUrl?this.eSignsLastFileWithStamps[e].stampImageUrl:"");try{const t=this.$el.getElementsByClassName("copyable-img-"+e)[0],i=this.$el.getElementsByClassName("copyable-img-wr-"+e)[0];t&&i?(t.setAttribute("src",n),i.setAttribute("contenteditable","true"),this.selectStamp(i),document.execCommand("copy"),window.getSelection().removeAllRanges(),i.removeAttribute("contenteditable"),this.$toasted.success(`${this.$gettext("Штамп успешно скопирован")}`)):this.$toasted.error(`${this.$gettext("Ошибка копирования штампа")}`)}catch(e){this.$toasted.error(`${this.$gettext("Ошибка копирования штампа")}`)}}selectStamp(e){const t=document.body;if(t.createTextRange){const n=t.createTextRange();n.moveToElementText(e),n.select()}else if(window.getSelection){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}}openImage(e,t){return __awaiter(this,void 0,void 0,(function*(){let n="";t===i.Reg&&(n=this.regStampSrc),t===i.ESign&&(n=this.eSignsLastFileWithStamps[e].stampImageUrl?this.eSignsLastFileWithStamps[e].stampImageUrl:"");try{const t={model:null,index:e,image:n},i=new S._({title:this.$gettext("Просмотр изображения"),component:"image-viewer",componentProps:t,width:"30%"});yield this.queryBus.exec(i)}catch(e){this.$toasted.error(`${this.$gettext("Ошибка просмотра штампа")}`)}}))}imageToString(e){return`data:image/png;base64,${e}`}get eSignsFile(){return Array.isArray(this.eSignsLastFile)&&this.eSignsLastFile.length>0}};__decorate([(0,Q.Prop)(),__metadata("design:type",Object)],z.prototype,"document",void 0),__decorate([(0,Q.Prop)(),__metadata("design:type",Object)],z.prototype,"file",void 0),__decorate([(0,Q.Prop)(),__metadata("design:type",Boolean)],z.prototype,"isPreviewMode",void 0),__decorate([(0,Q.Prop)(),__metadata("design:type",Array)],z.prototype,"esings",void 0),__decorate([(0,H.t)(P.M.IQueryBus),__metadata("design:type",Object)],z.prototype,"queryBus",void 0),__decorate([(0,j.p$)("fetchFileStampRegNumber"),__metadata("design:type",Object)],z.prototype,"fetchFileStampRegNumber",void 0),__decorate([(0,j.p$)("fetchFileStampEsign"),__metadata("design:type",Object)],z.prototype,"fetchFileStampEsign",void 0),__decorate([(0,Q.Watch)("file",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],z.prototype,"onDocumentChanged",null),__decorate([(0,Q.Watch)("esings",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],z.prototype,"onESingnsChanged",null),z=__decorate([U.default],z);const Z=z,W=Z;var q=n(51900),G=n(43453),K=n.n(G),Y=n(82127),J=n(17024),X=n(44557),ee=n(94694),te=n(86131),ne=n(29442),ie=n(71100),oe=n(57894),se=n(7442),re=(0,q.Z)(W,fileStampsvue_type_template_id_37635c99_render,V,!1,null,null,null);const ae=re.exports;K()(re,{VBtn:Y.Z,VCol:J.Z,VExpansionPanel:X.Z,VExpansionPanelContent:ee.Z,VExpansionPanelHeader:te.Z,VExpansionPanels:ne.Z,VIcon:ie.Z,VRow:oe.Z,VTooltip:se.Z});var le,ce=n(21883),de=n(9669),ue=n.n(de),pe=n(53029),he=n(50423),me=n(51414),filesViewervue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},filesViewervue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},filesViewervue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};(function(e){e[e["View"]=0]="View",e[e["Stamp"]=1]="Stamp"})(le||(le={}));const fe=[".pdf",".docx"],ge=[".pdf"],ye=[".tif",".tiff",".jpg",".jpeg",".png",".txt",".rtf",".doc",".docx",".xls",".xlsx",".html",".xml"],ve=[".pdf",".doc",".docx",".xls",".xlsx",".txt",".ppt",".pptx"],be="update-files",Ce="update-editor-files",we="files-changed",_e="new-file-version",xe="lock-file",Se="unlock-file";let Ie=class FilesViewerComponent extends Q.Vue{constructor(){super(...arguments),this.myCard=null,this.processing=!1,this.processedFiles={},this.documentFiles=null,this.addFileVerionArray=[],this.saveUrl="",this.loading=!1,this.panel=null,this.previewName="",this.previewUrl="",this.showAllVersions=!1,this.plugin=null,this.nativeApp=!1,this.pluginScanIsRunning=!1,this.nativeScanIsRunning=!1,this.loadNewVersionFromDisk=!1,this.loadNewVersionFromDiskNative=!1,this.loadNewVersionFileExtension="*",this.typeView=le,this.processingConvertFile=!1,this.db=null,this.eventsCloud=[],this.showCollapsedStampsData=!1,this.journalRights=[],this.refreshCounter=0,this.r7enable=!1,this.onClickOutsideHandler=null,this.filesViewerClass="files-viewer",this.eSigns=[],this.processFile=(e,t)=>filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.processedFiles[e])try{this.processing=!0,this.$set(this.processedFiles,e,!0),yield t()}catch(e){this.$log.debug(e)}finally{this.$set(this.processedFiles,e,!1),yield this.fetchFilesEdited(new x.b),this.processing=!1}}))}onCurrFileIdChanged(){if(!this.currFileId)return;const e=this.documentFiles.files.find((e=>e.id===this.currFileId));e||this.refresh()}onCurrEditorNameChanged(){const e=this.documentFiles.files.find((e=>e.id===this.currFileId));"edit"===this.operationMode?(this.$set(e,"curEditorID",this.currentUser.effectiveId),this.$set(e,"curEditorName",this.currentUser.effectiveName)):(e.curEditorID=null,e.curEditorName=null)}onCardChanged(e){e&&(this.myCard=e,this.saveUrl=`${this.$config.apiPath()}instructions/document/${this.myCard.id}/files`,this.refreshCounter++,this.$nextTick((()=>this.refresh())))}onDocumentChanged(){this.document&&this.onCardChanged(this.document)}onDocumentFilesChanged(e,t){this.onCardFilesChanged(e,t)}onCardFilesChanged(e,t){let n=!1;if(e&&this.documentFiles&&this.documentFiles.files&&e.length===this.documentFiles.files.length){const t=new Set(e.map((e=>e.id)));n=!0;for(const e of this.documentFiles.files)if(!t.has(e.id)){n=!1;break}}n||(this.refreshCounter++,this.$nextTick((()=>this.refresh())))}onPanelChange(){this.showAllVersions=!1}onLoadNewVersionFromDiskChange(){!0===this.loadNewVersionFromDisk&&(this.loadNewVersionFromDisk=!1,this.$nextTick((()=>{const e=this.$refs.loadFileInput[0];e.setAttribute("accept",`${this.loadNewVersionFileExtension}`),e.click()})))}onLoadNewVersionFromDiskNativeChange(){!0===this.loadNewVersionFromDiskNative&&this.$nextTick((()=>{const e=this.$refs.loadFileInputNative[0];e.setAttribute("accept",`${this.loadNewVersionFileExtension}`),e.click()}))}created(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.r7enable=this.$config.enableR7,this.checkPlugin(),this.checkNativeApp(),yield this.initializeDatabaseCloudEvents(),yield this.refreshEventsCloud(),this.showCollapsedStampsData=yield this.showCollapsedStamps(),this.isFileStampsEnabled&&(this.eSigns=yield this.fetchEsigns(new y.AX("document",this.myCard.id))),this.$config.microsoftCloud.enable){const{MicrosoftCloudService:e}=yield Promise.all([n.e(8008),n.e(7421)]).then(n.bind(n,17421));this.microsoftCloudService=new e(this.$config)}}))}mounted(){try{this.fileVersionsEl=document.getElementById("file-versions");const e=localStorage.getItem("dss_signFiles");e&&(localStorage.removeItem("dss_signFiles"),this.signFiles())}catch(e){this.$log.error(e)}this.viewerActivator&&(this.onClickOutsideHandler=this.onClickOutside.bind(this),document.addEventListener("click",this.onClickOutsideHandler,{passive:!0}))}beforeDestroy(){this.pluginHandler&&window.removeEventListener("message",this.pluginHandler),this.onClickOutsideHandler&&document.removeEventListener("click",this.onClickOutsideHandler)}onClickOutside(e){const t=e.target;null===t.closest(`.${this.filesViewerClass}`)&&null===t.closest(`.${this.viewerActivator}`)&&null!==t.closest(".v-application--wrap")&&this.$emit("close-viewer",t)}getFilesExtensions(){for(const e of this.documentFiles.files){let t;e.fullFileName&&(t=e.fullFileName.split("."));let n="*";Array.isArray(t)&&t.length>1&&(n="."+t[t.length-1].toLowerCase()),e.fileExtension=n}}loginCloud(){return this.microsoftCloudService.login()}showCollapsedStamps(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.queryBus.exec(new v.jY);return e&&e.isEnabled}))}refresh(e=!0){var t;return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.refreshCounter--,!(this.refreshCounter>0)){this.refreshCounter=0;try{if(this.loading=e,this.myCard&&(this.documentFiles=yield this.fetchFiles(),Array.isArray(null===(t=this.documentFiles)||void 0===t?void 0:t.files))){this.documentFiles.files.forEach((e=>{e.sizeKb&&!e.size&&(e.size=(0,M.MK)(e.sizeKb))})),this.getFilesExtensions(),yield this.checkUserRights(),this.documentRights=yield this.fetchRights({objectIds:[this.myCard.journalID]}),this.journalRights=yield this.fetchRights(new O._Y([this.myCard.journalID]));let e=this.myCard.files.length===this.documentFiles.files.length;e&&(e=this.myCard.files.every((e=>this.documentFiles.files.find((t=>t.id===e.id))))),e||(this.$emit(be,this.documentFiles.files),this.$emit(Ce,this.documentFiles),this.$emit(we))}}finally{this.loading=!1}}}))}refreshEventsCloud(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{this.loading=!0;const e=yield this.getEventsCloud();this.eventsCloud=e}finally{}}))}fetchFiles(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{return this.cancellationService.cancel(P.M.DocumentFilesQuery),yield this.fetchDocumentFiles(new g.G4(this.myCard.id,this.cardId?this.cardId:this.myCard.cardId,!0))}catch(e){this.$log.error(e)}}))}onFileLoaded(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){clearTimeout(this.refreshTimeoutId);let e=1500;return this.lastPickedUploadVersionFile&&(e=0),new Promise((t=>this.refreshTimeoutId=setTimeout(t,e)))}))}fileLoadedHandler(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.onFileLoaded(),this.refresh()}))}onAddFile(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!this.lastPickedUploadVersionFile)return void(this.fileVersionsEl.value="");const t=yield this.onSelectFileVersion(e.target),n=`${this.$config.apiPath()}proxy/files/${this.lastPickedUploadVersionFile.id}/versions`;t.forEach((e=>e.postAction=n)),this.addFileVerionArray=[...t],this.fileVersionsEl.value=""}))}onDelete(e){this.processFile(e.id,(()=>this.deleteFile(e)))}onDownloadFileNative(e){const t=JSON.stringify(e);ue().post(`${this.$config.nativeAppAddress}`,t).then((e=>(this.handleDownloadNativeResponse(e.data),e.data))).catch((e=>{this.$toasted.error(this.$gettext("Не удалось скачать версию файла"))}))}handleDownloadNativeResponse(e){if("error"!==e["status"])if(e["fileName"]&&e["fileName"].length>1){const t=e["fileName"],n=e["fileLocalPath"].replace(t,"");this.$toasted.success(this.$gettextInterpolate(this.$gettext("Файл %{fileName} скачан в папку %{fileLocalPath}"),{fileName:t,fileLocalPath:n}))}else this.$toasted.error(this.$gettext("Неизвестная ошибка при скачивании файла 1"));else this.$toasted.error(e["statusDescription"])}onUploadFileNative(e,t,n){const i=JSON.stringify(e);ue().post(`${this.$config.nativeAppAddress}`,i).then((e=>filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){var i,o,s,r;if("error"!==(null===(i=null===e||void 0===e?void 0:e.data)||void 0===i?void 0:i.status)&&"notchanged"!==(null===(o=null===e||void 0===e?void 0:e.data)||void 0===o?void 0:o.status)){this.loadNewVersionFromDiskNative=!1;const i=yield this.queryBus.exec(new C.l(this.warningHeader,this.$gettext("В заблокированный Вами файл внесены изменения. Использовать данный файл для добавления новой версии?")));i&&(this.processFile(t.id,(()=>this.unlockFile(t))),yield this.handleUploadedFileNative(e.data,t)),"toWork"===n&&this.processFile(t.id,(()=>this.unlockFile(t)))}if("error"===(null===(s=null===e||void 0===e?void 0:e.data)||void 0===s?void 0:s.status)||"notchanged"===(null===(r=null===e||void 0===e?void 0:e.data)||void 0===r?void 0:r.status)){if("toWork"===n){const e=yield this.queryBus.exec(new C.l(this.warningHeader,this.$gettextInterpolate(this.$gettext("Снять файл %{file} с редактирования?"),{file:t.fullFileName})));e&&this.processFile(t.id,(()=>this.unlockFile(t)))}"newVersion"===n&&(this.loadNewVersionFromDiskNative=!0,this.loadNewVersionFileExtension=t.fileExtension)}return e.data})))).catch((e=>{this.$toasted.error(this.$gettext("Не удалось загрузить отредактированный файл"))}))}loadNewVersionByNative(e,t){const n={Command:"upload_file",FileName:e.fullFileName,FileID:e.id,FileVersionId:e.verN};this.$refs.loadFileInputNative&&t.target===this.$refs.loadFileInputNative[0]?this.loadNewVersionFromDiskNative=!1:(this.loadNewVersionFromDiskNative&&(this.loadNewVersionFromDiskNative=!1),this.onUploadFileNative(n,e,"newVersion"))}handleUploadedFileNative(e,t){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if("error"===e["status"])return void this.$toasted.error(e["statusDescription"]);if("notchanged"===e["status"])return;if(!e["fileName"]||e["fileName"].length<1||!e["fileBase64"]||e["fileBase64"].length<1)return void this.$toasted.error(this.$gettext("Вернулись некорректные данные от нативного приложения."));this.loading=!0;const n=e["fileName"],i=e["fileBase64"],o=n.split("."),s=o[o.length-1].toLowerCase(),r=yield this.fetchFileTypes(new v.uL),a=r.filter((e=>e.Extension)).map((e=>e.Extension.toLowerCase()));let c=!1;if(a.forEach((e=>{e===s&&(c=!0)})),c)try{const e=atob(i),o=new Array(e.length);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);const s=new Uint8Array(o),r=new Blob([s]),a=new File([r],n),c=new FormData;c.append("file",a);const d=new l.gL(t.id,c),u=yield this.commandBus.exec(d);u.message?this.$toasted.error(this.$gettextInterpolate(this.$gettext("%{err}"),{err:u.error.message})):(this.$toasted.success(this.$gettextInterpolate(this.$gettext("Добавлена версия файла %{fileName}"),{fileName:n})),yield this.onFileLoaded(),yield this.refresh(),this.hasFiles&&(this.panel=this.documentFiles.files.length-1),this.$emit(_e,[t.id,t]))}catch(e){this.$toasted.error(this.addFileErrorMessage)}else yield this.queryBus.exec(new b.m(this.warningHeader,`${s} - запрещенный формат файла`))}))}getFileBytes(e){ue().get(`${this.$config.apiPath()}files/${e.id}`,{responseType:"arraybuffer",headers:{"Content-Type":"application/json"}}).then((t=>(this.handleFileBytes(e,t.data),t.data))).catch((e=>{this.$toasted.error(this.$gettext("Не удалось скачать файл"))}))}handleFileBytes(e,t){const n=new Uint8Array(t),i=n.reduce(((e,t)=>e+String.fromCharCode.apply(null,[t])),""),o=btoa(i),s={Command:"download_file",FileName:e.fullFileName,FileBase64:o,FileID:e.id,FileVersionId:e.verN};this.onDownloadFileNative(s)}onEditNative(e){if(!e.curEditorName&&this.canEdit(e))this.processFile(e.id,(()=>this.editFile(e))),this.getFileBytes(e);else{const t={Command:"upload_file",FileName:e.fullFileName,FileID:e.id,FileVersionId:e.verN};this.onUploadFileNative(t,e,"toWork")}}scanFileNative(){this.nativeScanIsRunning=!0,ue().post(`${this.$config.nativeAppAddress}`,JSON.stringify({Command:"lanimage"})).then((e=>filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){return yield this.scanFileNativeResultHandler(e.data),e.data})))).catch((e=>{this.nativeScanIsRunning=!1,this.$toasted.error(this.$gettext("Неизвестная ошибка при сканировании"))}))}scanFileNativeResultHandler(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(this.nativeScanIsRunning=!1,"error"===e["status"])return void this.$toasted.error(e["statusDescription"]);if(!e["fileName"]||e["fileName"].length<1||!e["fileBase64"]||e["fileBase64"].length<1)return void this.$toasted.error(this.$gettext("Не удалось отсканировать файл"));this.loading=!0;const t=e["fileName"],n=e["fileBase64"],i=t.split("."),o=i[i.length-1].toLowerCase(),s=yield this.fetchFileTypes(new v.uL),r=s.filter((e=>e.Extension)).map((e=>e.Extension.toLowerCase())),a=this.isAllow(r,o);if(a)try{const e=atob(n),i=new Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);const o=new Uint8Array(i),s=new Blob([o]),r=new File([s],t),a=new FormData;a.append("file",r);const l=yield this.commandBus.exec(new c.eY(this.documentFiles.documentId,a));l&&!l.error?this.$toasted.success(this.$gettextInterpolate(this.$gettext("Файл %{fileName} добавлен к документу"),{fileName:t})):(l.error&&l.error.message&&this.$toasted.error(this.$gettextInterpolate(this.$gettext("%{err}"),{err:l.error.message})),l.error&&!l.error.message&&this.$toasted.error(this.$gettextInterpolate(this.$gettext("%{err}"),{err:l.error})))}catch(e){this.$toasted.error(this.addFileErrorMessage)}else yield this.queryBus.exec(new b.m(this.warningHeader,this.$gettext("%{fileExtension} - запрещенный формат файла")));this.loading=!1,this.refresh()}))}checkNativeApp(){if(!this.$config.nativeAppVersion)return;const e={Command:"connect",Version:this.$config.nativeAppVersion},t=JSON.stringify(e);this.$config.nativeAppAddress&&this.$config.nativeAppAddress.length>0&&ue().post(`${this.$config.nativeAppAddress}`,t).then((e=>(e&&"success"===e.data.status&&(this.nativeApp=!0,this.$log.info(e.data.statusDescription)),e&&"error"===e.data.status&&(this.nativeApp=!1,this.$log.info(e.data.statusDescription)),e))).catch((e=>{this.nativeApp=!1}))}blockedByAnother(e){let t=!1;return this.currentUser.isAdmin&&!1===e.canEdit&&e.curEditorID>=1&&e.curEditorID!==this.currentUser.effectiveId&&(t=!0),t}forceUnlock(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=yield this.queryBus.exec(new C.l(this.warningHeader,this.$gettextInterpolate(this.$gettext("Снять принудительно файл %{file} с редактирования?"),{file:e.fullFileName})));if(t)try{const t=yield this.commandBus.exec(new l.uO(e.id));if(t){e.curEditorName=null,e.curEditorID=null;const t=this.myCard.files.find((t=>t.id===e.id));t&&(t.curEditorID=null,t.curEditorName=null),this.$emit(Se,e),e.canEdit=!0}else this.$toasted.error(`${this.$gettext("Произошла ошибка разблокировки файла")}`)}catch(e){this.$toasted.error(this.$gettext("Произошла ошибка разблокировки файла"))}}))}scanFilePlugin(){window.postMessage({type:"ld_scan_file"},"*"),this.pluginScanIsRunning=!0}onEditPlugin(e){!e.curEditorName&&this.canEdit(e)?(this.processFile(e.id,(()=>this.editFile(e))),this.plugin&&(this.loading=!0,this.openFileWithPlugin(e))):this.onUnlock(e)}checkRightsID(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchCurrentUserRights();return Object.keys(e).some((t=>e[Number(t)].includes(h.K.EditDocument)))}))}checkUserRights(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.checkRightsID();if(this.documentFiles&&this.documentFiles.files&&this.documentFiles.files.length>0)for(const t of this.documentFiles.files)t.curEditorID&&t.curEditorID!==this.currentUser.effectiveId||!this.canEdit(t)||!e?t.canEdit=!1:t.canEdit=!0}))}onEdit(e){!e.curEditorName&&this.canEdit(e)?this.processFile(e.id,(()=>this.editFile(e))):this.onUnlock(e)}toWorkButtonName(e){return e.curEditorName?this.$gettext("Снять с редактирования"):this.$gettext("Взять на редактирование")}toWorkButtonIcon(e){return e.curEditorName?"lock_open":"lock"}onConvert(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.processingConvertFile=!0;const t=yield this.addFileToConvert(new l.Of(e.id,p.x.LibreOffice,this.card.id));if(t.error)this.$log.error(t.error),this.processingConvertFile=!1,this.$toasted.error(`${this.$gettext("Произошла ошибка при отправке файла на конвертацию")}`);else{const onFileAttachedHandler=e=>{this.pubSubService.off(t.value),this.onFileAttached(e)};this.pubSubService.on(t.value,onFileAttachedHandler),this.$toasted.success(`${this.$gettext("Началась конвертация файла")}`)}}))}onFileAttached(e){this.processingConvertFile=!1,e.error?this.$log.error(`Ошибка при конвертации файла для документа ${e.documentId}: ${e.error}, status=${e.status}`):(this.$toasted.success(`${this.$gettext("Файл успешно создан и прикреплен к документу")}`),this.refresh())}onRename(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{const t={model:e.fileName,originalFileName:e.fileName},n=yield this.queryBus.exec(new w.c({title:"Переименование файла",componentName:"rename-file",componentProps:t,fullHeight:!1,width:"40%"}));if(!n)return;yield this.renameFile(new l.xC(e.id,`${n}`)),this.refresh()}catch(e){this.$toasted.error(this.$gettext("Ошибка переименования файла"))}}))}openFileCloud(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.isAuthenticatedCloud||(yield this.loginCloud());const t=this.checkExistLocalFileInCloud(e);if(t){const e=yield this.microsoftCloudService.getFile(t.cloudFileId);this.goToLink(e.webUrl)}else yield this.moveLocalToCloud(e)}))}readFile(e){return new Promise(((t,n)=>{const i=new FileReader;i.onload=function(e){const n=";base64,",i=e.target.result,o=i.substr(i.indexOf(n)+n.length);t(o)},i.readAsDataURL(e)}))}execute(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){window.FileReader||this.$log.error("The File APIs are not fully supported in this browser.");const e=this.$el.querySelector("#signedFile"),t=this.$el.querySelector("#selectFile");if(!t||!e)return;if(!e.files.length)return void this.$log.error("Выберите подписанный файл");if(!t.files.length)return void this.$log.error("Выберите исходный файл");const n=e.files[0],i=t.files[0],o=yield this.readFile(n);this.$log.debug("esign = ",o);const s=new Promise((e=>{const t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsArrayBuffer(i)})),r=yield s,a=yield this.cryptoProService.verifyHash(o,r);a&&this.$log.info("подпись верна")}))}moveLocalToCloud(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=`${this.$config.apiPath()}files/${e.id}`,n=yield fetch(t),i=yield n.blob(),o=yield this.microsoftCloudService.uploadFile(i,e.fullFileName);o&&(yield this.addEventCloud(e,o),this.goToLink(o.webUrl))}))}checkExistLocalFileInCloud(e){const t=this.eventsCloud.find((t=>t.localFileId===e.id));if(t)return t}getEventsCloud(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=yield this.db.get("documents",this.myCard.id);return e||[]}))}exportFileCloudToLocal(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.isAuthenticatedCloud||(yield this.loginCloud());const t=this.eventsCloud.find((t=>t.localFileId===e.id));if(!t)return void(yield this.queryBus.exec(new b.m(this.$gettext("Ошибка"),this.$gettext("Файл не загружен в облако"))));const n=yield this.microsoftCloudService.getFile(t.cloudFileId),i=yield fetch(n["@microsoft.graph.downloadUrl"]),o=yield i.blob();yield this.uploadFileVersion(o,e.fileName,e.id),yield this.microsoftCloudService.deleteFile(t.cloudFileId),yield this.deleteEventCloud(e,n),yield this.refreshEventsCloud()}))}addEventCloud(e,t){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){yield this.db.put("documents",[...this.eventsCloud,{localFileId:e.id,cloudFileId:t.id}],this.myCard.id),yield this.refreshEventsCloud()}))}deleteEventCloud(e,t){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const n=this.eventsCloud.filter((n=>n.cloudFileId!==t.id&&n.localFileId!==e.id));yield this.db.delete("documents",this.myCard.id),yield this.db.put("documents",[...n],this.myCard.id),yield this.refreshEventsCloud()}))}initializeDatabaseCloudEvents(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.db=yield(0,pe.X3)("events-cloud-db",1,{upgrade(e){e.createObjectStore("documents")}})}))}lastVersion(e){return e.versions.find((t=>t.id===e.id))}goToLink(e){window.open(e,"_blank")}onUnlock(e){this.unlockFileWithConfirmation(e)}onReplace(e){this.processFile(e.id,(()=>this.replaceFile(e)))}onDownload(e){return`${this.$config.apiPath()}files/${e}`}toWorkButtonDisabled(e){return!(!Array.isArray(this.workButtonDisabledFiles)||!this.workButtonDisabledFiles.length)&&this.workButtonDisabledFiles.includes(e.id)}onVersionDownload(e,t,n){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const i=e.target.files[0],o=(0,A.mD)(i.name),s=(0,A.mD)(t);o===s?yield this.uploadFileVersion(i,t,n):this.$toasted.error(this.$gettext("Выбран неверный тип файла, загрузка новой версии невозможна!"))}))}addTemplate(){var e,t;return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const n=new D.F({title:this.$gettext("Выбор шаблона"),componentName:"add-file-template",componentProps:{disabledItems:[],selectedItems:[],multiselect:!0},width:"50%",height:"100%"}),i=yield this.queryBus.exec(n);if(!i||!i.length)return;const o=[];for(const e of i)o.push(this.attachFileTemplateToDoc(new l.O_(this.myCard.id,e.fullPath)));try{this.processing=!0,yield Promise.all(o),yield this.refresh(!1),this.$toasted.success(this.$gettext("Выбранные файлы были успешно прикреплены к документу!"))}catch(n){this.$log.error(n);const i=this.$gettext("Не удалось прикрепить все выбранные файлы к документу");this.$toasted.error((null===(t=null===(e=n.response)||void 0===e?void 0:e.data)||void 0===t?void 0:t.message)||i)}finally{this.processing=!1}}))}downloadAll(){if(this.hasFiles){const e=this.files.map((e=>e.id)),t=new URLSearchParams;e.forEach((e=>t.append("id",String(e))));const n=document.createElement("a");n.href=`${this.$config.apiPath()}files/archive?${t}`,n.download="archive.zip",document.body.appendChild(n),n.click(),setTimeout((()=>{document.body.removeChild(n),window.URL.revokeObjectURL(`${this.$config.apiPath()}files/archive?${t}`)}),0)}}canRemoveFromEditing(e){return!!this.currentUser&&(this.currentUser.deputyUserId?e.curEditorName&&e.curEditorID===this.currentUser.deputyUserId:e.curEditorName&&e.curEditorID===this.currentUser.id)}signFiles(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const e=this.selectedFileIds?this.files:this.myCard.files,t=new S._({title:this.$gettext("Подписание файлов документа"),component:"files-to-sign",componentProps:{disabledItems:[],selectedItems:[],files:e,docId:this.myCard.id},width:"60%",closeButton:!1}),n=yield this.queryBus.exec(t);return this.$emit(we,n),n}))}checkSign(e,t){var n;return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const i={disabledItems:[],selectedItems:[]};if(!t){const t=new D.F({title:"Выберите файл для проверки электронной подписи",componentName:"files-check-single-esign",componentProps:{selectedItems:[],disabledItems:[],files:this.files},fullHeight:!1,selectAsOk:!0}),n=yield this.queryBus.exec(t);if(!(null===n||void 0===n?void 0:n.length))return;e=n}let o="ld-sign-viewer";const s=yield this.queryBus.exec(new T.Yf);(null===(n=null===s||void 0===s?void 0:s.esign)||void 0===n?void 0:n.extDocFilesDetail)&&(o="extDocFilesDetail");const r=new D.F({title:this.$gettext("Электронные подписи файлов документа"),componentName:o,componentProps:Object.assign({contentType:f.zc.Document,id:this.myCard.id,card:this.myCard,documentFiles:this.documentFiles,fileSelected:e},i),width:"60%",fullHeight:!1,selectAsOk:!0}),a=yield this.queryBus.exec(r);a&&"no-data"===a.event&&(yield this.queryBus.exec(new b.m("","Выбранный документ не имеет электронных подписей!")))}))}openFileView(e,t){if(this.currFileId)this.$emit("view-btn-clicked",e);else if(t===le.Stamp)this.openStampViewer(e);else if(this.r7enable)this.$emit("open-file",e);else{const t=(0,A.mD)(e.fullFileName);switch(t){case"pdf":this.openPdfViewer(e);break;case"docx":this.openDocPreview(e);break}}}openDocPreview(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t="."+(0,A.mD)(e.fullFileName),n=e&&e.versions&&e.versions[0],i=e?e.fileName:n?n.fileName:"",o=new _.D(this.previewModalTitle+" "+i+t,e);yield this.queryBus.exec(o)}))}openPdfViewer(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=e&&e.versions&&e.versions[0],n=e?e.fileName:t?t.fileName:"",i=new I.a(this.previewModalTitle+" "+n,e,t,!1);yield this.queryBus.exec(i)}))}openStampViewer(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){const t=e&&e.versions&&e.versions[0],n=e?e.fileName:t?t.fileName:"",i=new R.D(this.previewModalTitle+" "+n,e,t,!1);yield this.queryBus.exec(i)}))}onSelectFileVersion(e){var t;return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e||!this.lastPickedUploadVersionFile)return;const n=[];if(e.files&&e.files.length)for(const i of e.files){const e=i;n.push({size:i.size,sizeKb:null===(t=i.size)||void 0===t?void 0:t.toString(),fileExtension:"."+(0,A.mD)(i.name),fileName:e.webkitRelativePath||e.relativePath||i.name,fullFileName:e.webkitRelativePath||e.relativePath||i.name,fileType:Number(i.type),file:i,createDateTime:new Date,creator:null,creatorId:0,curEditorID:0,curEditorName:null,fileId:0,id:0,majorVersion:null,minorVersion:null,state:null,uid:null,verN:null,versionN:null,versions:null})}else if(e.value){const t=e.value.replace(/\\/g,"/").split("/");n.push({fileName:t[t.length-1],fullFileName:t[t.length-1],size:0,sizeKb:null,fileExtension:null,fileType:0,file:null,createDateTime:new Date,creator:null,creatorId:0,curEditorID:0,curEditorName:null,fileId:0,id:0,majorVersion:null,minorVersion:null,state:null,uid:null,verN:null,versionN:null,versions:null})}if(n.length){const e=new RegExp(`.${this.lastPickedUploadVersionFile.fileExtension}$`,"i"),t=n.filter((t=>!e.test(t.fileExtension)));if(t.length>0){const i=n.filter((t=>e.test(t.fileExtension)));n.length=0,i.forEach((e=>n.push(e)));const o=t.map((e=>e.fileName)).join(", ");yield this.queryBus.exec(new b.m(this.$gettext("Ошибка"),this.$gettextInterpolate(this.$gettext("Добавляемая версия файла должна быть с раширением %{last}, файлы %{wrongExt}"),{last:this.lastPickedUploadVersionFile.fileExtension,wrongExt:o}))),n.length>0&&n.forEach((e=>e.uploadFile=this.lastPickedUploadVersionFile))}}return n}))}canEdit(e){return!this.processedFiles[e.id]&&this.checkFileRight(e.id,h.K.EditFile)}canDelete(e){return this.checkFileRight(e.id,h.K.DeleteFile)}canReplace(e){return!this.processedFiles[e.id]&&this.checkFileRight(e.id,h.K.EditFile)}canPreview(e){return!this.processedFiles[e.id]&&fe.includes(e.fileExtension.toLowerCase())}canDownload(e){return!this.processedFiles[e.id]}canDeleteVersion(e,t){return!this.processedFiles[t.id]&&this.checkFileRight(e.id,h.K.DeleteFileVersion)}extentionIcon(e){let t="";return"object"===typeof e&&(e.fileExtension?t=e.fileExtension:e.fullFileName&&(t=(0,A.mD)(e.fullFileName))),t||(t="unknown_ext"),$.C.extentionSvgIcon(t)}lockedByMe(e){return e.curEditorID===this.currentUser.effectiveId}locked(e){return Boolean(e.curEditorID)}deleteVersion(e,t){this.processFile(t.id,(()=>filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){var n;const i=this.$gettext("Вы действительно хотите удалить файл"),o=yield this.queryBus.exec(new C.l(this.warningHeader,`${i} <strong>"${t.fileName}"</strong>?`));if(o)try{this.loading=!0,yield this.commandBus.exec(new l.gm(this.myCard.id,e.id,t.id)),e.versions=e.versions.filter((e=>t!==e)),this.hasFiles&&(e.versions.length?e.id===t.id&&(yield this.refresh()):(this.documentFiles.files=this.documentFiles.files.filter((t=>t!==e)),this.$emit(be,null===(n=this.documentFiles)||void 0===n?void 0:n.files))),this.$emit("delete-version",{file:e,fileVersion:t}),this.$emit(we)}catch(e){this.$log.error(e),this.showError(e)}finally{this.loading=!1,this.processedFiles[t.id]=!1}}))))}preview(e){this.previewName=e.fileName,this.openPdfViewer(null)}showVersionRow(e){return!!this.showAllVersions||e<3}displayStampsButton(e){return ge.includes(this.extensionFile(e))}displayPreviewButton(e){return fe.includes(this.extensionFile(e))}displayOpenFileButton(e){const t=N.hg.includes(this.extensionFile(e)),n=this.displayPreviewButton(e);return this.currFileId?this.currFileId&&this.currFileId!==e.id&&t:this.r7enable&&t||n}displayConvertButton(e){return ye.includes(this.extensionFile(e))}displayCloudButton(e){if(this.isEnabledMicrosoftCloud)return ve.includes(this.extensionFile(e))}extensionFile(e){return(e.fileExtension||(0,A.mD)(e.fullFileName)).toLowerCase()}scanFile(){window.postMessage({type:"ld_scan_file"},"*"),this.pluginScanIsRunning=!0}loadNewVersion(e,t){e.fileExtension&&(this.loadNewVersionFileExtension=e.fileExtension),this.plugin&&(this.$refs.loadFileInput&&t.target===this.$refs.loadFileInput[0]?this.loadNewVersionFromDisk=!1:(this.loadNewVersionFromDisk&&(this.loadNewVersionFromDisk=!1),window.postMessage({type:"ld_check_edit_time",fileId:e.id,emittedBy:"load_new_version"},"*")))}uploadFileVersion(e,t,n){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading=!0;const i=this.myCard.files.find((e=>e.id===n));i&&(i.curEditorID=null,i.curEditorName=null);const o=t.split("."),s=o[o.length-1].toLowerCase(),r=yield this.fetchFileTypes(new v.uL),a=r.filter((e=>e.Extension)).map((e=>e.Extension.toLowerCase())),c=this.isAllow(a,s),d=new FormData;if(d.append(t,e),c)try{const i=new l.gL(n,d),o=yield this.commandBus.exec(i);o.message?this.$toasted.error(this.$gettextInterpolate(this.$gettext("%{err}"),{err:o.error.message})):(this.$toasted.success(this.$gettextInterpolate(this.$gettext("Добавлена версия файла %{fileName}"),{fileName:t})),yield this.onFileLoaded(),yield this.refresh(),this.hasFiles&&(this.panel=this.documentFiles.files.length-1),this.$emit(_e,[n,e]))}catch(e){this.$toasted.error(this.addFileErrorMessage)}else yield this.queryBus.exec(new b.m(this.warningHeader,this.$gettextInterpolate(this.$gettext("%{ext} - запрещенный формат файла"),{ext:s})));this.loading&&(this.loading=!1)}))}checkFileRight(e,t){return this.fileRights&&this.fileRights[e]&&this.fileRights[e].includes(t)}replaceFile(e){this.lastPickedUploadVersionFile=e;const t=document.getElementById("file-versions");t.setAttribute("accept",`.${e.fileExtension}`),t.click()}deleteFile(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(yield this.queryBus.exec(new C.l(this.warningHeader,this.$gettextInterpolate(this.$gettext("Вы действительно хотите удалить файл %{file}?"),{file:e.fullFileName}))))try{if(this.loading=!0,yield this.commandBus.exec(new l.Hq(this.myCard.id,e.id)),this.hasFiles){const t=this.documentFiles.files.indexOf(e);t>=0&&this.documentFiles.files.splice(t,1),this.$emit(be,this.documentFiles.files),this.$emit(we),this.$emit("delete-file",e)}}catch(e){this.showError(e)}finally{this.loading=!1,this.processedFiles[e.id]=!1}}))}editFile(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.commandBus.exec(new d.n(e.id)),this.$set(e,"curEditorID",this.currentUser.effectiveId),this.$set(e,"curEditorName",this.currentUser.effectiveName);const t=this.myCard.files.find((t=>t.id===e.id));t&&(t.curEditorID=e.curEditorID,t.curEditorName=e.curEditorName),this.$emit(xe,e),this.onDownload(e.id),this.loading=!1}catch(e){this.$log.error(e),this.showError(e)}}))}unlockFileWithConfirmation(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){(this.plugin||(yield this.queryBus.exec(new C.l(this.warningHeader,this.$gettextInterpolate(this.$gettext("Снять файл %{file} с редактирования?"),{file:e.fullFileName})))))&&this.processFile(e.id,(()=>this.unlockFile(e)))}))}unlockFile(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){try{yield this.commandBus.exec(new d.rn(e.id)),e.curEditorName=null,e.curEditorID=null;const t=this.myCard.files.find((t=>t.id===e.id));t&&(t.curEditorID=null,t.curEditorName=null),this.$emit(Se,e)}catch(e){this.$log.error(e),this.showError(e)}this.plugin&&window.postMessage({type:"ld_check_edit_time",fileId:e.id,emittedBy:"unlock_file"},"*")}))}showError(e){let t=this.$gettext("Не удалось выполнить операцию. Попробуйте позже."),n=!1;if(e&&(e instanceof r.$Q?(t=e.error?e.error.message:t,n=e.error.notDisplayError):t=e.message),this.$log.error(t),!n)return this.queryBus.exec(new b.m(this.warningHeader,t))}openFileWithPlugin(e){const t={url:`${this.onDownload(e.id)}`,file:e.fullFileName,type:"ld_download",fileVersionId:e.id};window.postMessage(t,"*")}checkPlugin(){window.postMessage({type:"ld_plugin_request"},"*"),this.pluginHandler=this.handlePluginMessages.bind(this),window.addEventListener("message",this.pluginHandler)}handlePluginMessages(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){switch(e.data.type){case"ld_plugin_loaded":this.handlePluginLoaded(e.data);break;case"ld_file_changed":yield this.handleFileChanged(e.data);break;case"ld_no_file_changed":this.handleNoFileChanged(e.data);break;case"ld_file_uploaded":yield this.handleFileUploaded(e.data);break;case"ld_file_upload_error":yield this.handleFileUploadError();break;case"ld_file_size_error":yield this.handleFileSizeError();break;case"ld_file_not_found":case"ld_not_a_blob":case"ld_file_id_not_found":yield this.handleFileNotFoundError();break;case"ld_native_app_connect_error":yield this.handleAppErrorConnect();break;case"ld_download_ended":this.handleDownloadEnded();break;case"ld_scanned_file_upload":yield this.handleScannedFileUpload(e.data);break}}))}handlePluginLoaded(e){this.plugin=e.pluginId,this.pluginScanIsRunning=!1}handleFileChanged(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){let t;"unlock_file"===e.emittedBy?t=yield this.queryBus.exec(new C.l(this.warningHeader,this.$gettext("В заблокированный Вами файл внесены изменения. Добавить новую версию?"))):"load_new_version"===e.emittedBy&&(t=yield this.queryBus.exec(new C.l(this.warningHeader,this.$gettext("В заблокированный Вами файл внесены изменения. Использовать данный файл для добавления новой версии?")))),t?(this.loading=!0,window.postMessage({type:"ld_file_upload",fileId:e.fileId},"*")):t||"load_new_version"!==e.emittedBy||(this.loadNewVersionFromDisk=!0),this.pluginScanIsRunning=!1}))}handleNoFileChanged(e){"load_new_version"===e.emittedBy&&(this.loadNewVersionFromDisk=!0),this.pluginScanIsRunning=!1}handleFileUploaded(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e.file)return;const t=yield fetch(e.file),n=yield t.blob(),i=e.fileId,o=e.filename;yield this.uploadFileVersion(n,o,i),this.pluginScanIsRunning=!1}))}handleFileSizeError(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading&&(this.loading=!1),yield this.queryBus.exec(new b.m(this.warningHeader,this.$gettext("Превышен допустимый размер файла. Загрузите файл с диска вручную"))),this.pluginScanIsRunning=!1}))}handleFileUploadError(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading&&(this.loading=!1),yield this.queryBus.exec(new b.m(this.warningHeader,this.$gettext("Неизвестная ошибка при загрузке отсканированного файла."))),this.pluginScanIsRunning=!1}))}handleFileNotFoundError(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading&&(this.loading=!1),yield this.queryBus.exec(new b.m(this.warningHeader,this.$gettext("Сканированный файл не обнаружен"))),this.pluginScanIsRunning=!1}))}handleAppErrorConnect(){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){this.loading&&(this.loading=!1),yield this.queryBus.exec(new b.m(this.warningHeader,this.$gettext("Не удалось подключиться к нативному приложению"))),this.pluginScanIsRunning=!1}))}handleDownloadEnded(){this.loading&&(this.loading=!1),this.pluginScanIsRunning=!1}handleScannedFileUpload(e){return filesViewervue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(!e.file)return;this.loading=!0;const t=yield fetch(e.file),n=yield t.blob(),i=e.filename,o=i.split("."),s=o[o.length-1].toLowerCase(),r=yield this.fetchFileTypes(new v.uL),a=r.filter((e=>e.Extension)).map((e=>e.Extension.toLowerCase())),l=this.isAllow(a,s),d=new File([n],i),u=new FormData;if(u.append("file",d),l)try{const e=yield this.commandBus.exec(new c.eY(this.documentFiles.documentId,u));e&&!e.error?this.$toasted.success(this.$gettextInterpolate(this.$gettext("Файл %{filename} добавлен к документу"),{filename:i})):(e.error&&e.error.message&&this.$toasted.error(this.$gettextInterpolate(this.$gettext("%{err}"),{err:e.error.message})),e.error&&!e.error.message&&this.$toasted.error(this.$gettextInterpolate(this.$gettext("%{err}"),{err:e.error}))),yield this.refresh()}catch(e){this.$toasted.error(this.$gettext("Ошибка при загрузке файла"))}else yield this.queryBus.exec(new b.m(this.warningHeader,this.$gettext("%{fileExtension} - запрещенный формат файла")));this.pluginScanIsRunning=!1,this.loading&&(this.loading=!1)}))}isAllow(e,t){let n=!1;return e.forEach((e=>{e===t&&(n=!0)})),n}get canAddFiles(){if(!this.docChangable)return!1;const e=this.journalRights&&this.myCard&&this.myCard.journalID&&this.journalRights[this.myCard.journalID]&&this.journalRights[this.myCard.journalID].includes(h.K.CreateFile);return this.$templateRenderer?e&&this.$templateRenderer.context.section!==m.S.Archive:e}get templateBtnShow(){return this.canAddFiles&&this.$app.config.fileTemplatesEnabled}get hasFiles(){return this.documentFiles&&this.documentFiles.files&&0!==this.documentFiles.files.length}get fileRights(){return this.documentFiles&&this.documentFiles.rights}get limitedModeIcon(){return this.isLimitedMode?"":"chevron_right"}get isLimitedMode(){var e;return null===(e=this.context)||void 0===e?void 0:e.limitedMode}get showEsignButton(){return this.userSettings.esignMode!==u.Ky.Disabled}get canLoadFilesFromDisk(){return!this.plugin||this.plugin&&this.loadNewVersionFromDisk}get canLoadFilesFromDiskNative(){return!this.nativeApp||this.nativeApp&&this.loadNewVersionFromDiskNative}get isAuthenticatedCloud(){return this.microsoftCloudService&&this.microsoftCloudService.state.isAuthenticated}get isEnabledMicrosoftCloud(){return this.$config.microsoftCloud.enable}get isFileStampsEnabled(){return this.$config.fileStampsEnabled}get displayRenameButton(){var e,t;return null===(t=null===(e=this.context)||void 0===e?void 0:e.rights)||void 0===t?void 0:t.includes(h.K.RenameFile)}get addFileErrorMessage(){return this.$gettext("Ошибка при добавлении версии файла")}get warningHeader(){return this.$gettext("Внимание!")}get previewModalTitle(){return this.$gettext("Просмотр файла")}get openFileIcon(){return this.document?"web_asset":"remove_red_eye"}get isPreview(){return this.context.entityViewMode===f.dS.Preview}get files(){return this.selectedFileIds&&this.selectedFileIds.length&&this.hasFiles?this.documentFiles.files.filter((e=>this.selectedFileIds.includes(e.id))):this.documentFiles.files}};filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)({type:Number,default:0}),filesViewervue_type_script_lang_js_metadata("design:type",Number)],Ie.prototype,"cardId",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"document",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"card",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"context",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",Number)],Ie.prototype,"currFileId",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",String)],Ie.prototype,"operationMode",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",Array)],Ie.prototype,"allowedFileExtensions",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",String)],Ie.prototype,"viewerActivator",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",Array)],Ie.prototype,"workButtonDisabledFiles",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)({type:Boolean,default:!0}),filesViewervue_type_script_lang_js_metadata("design:type",Boolean)],Ie.prototype,"docChangable",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Prop)(),filesViewervue_type_script_lang_js_metadata("design:type",Array)],Ie.prototype,"selectedFileIds",void 0),filesViewervue_type_script_lang_js_decorate([(0,H.t)(P.M.IQueryBus),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"queryBus",void 0),filesViewervue_type_script_lang_js_decorate([(0,H.t)(a.O.ICommandBus),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"commandBus",void 0),filesViewervue_type_script_lang_js_decorate([(0,H.t)(k.h),filesViewervue_type_script_lang_js_metadata("design:type",k.h)],Ie.prototype,"cancellationService",void 0),filesViewervue_type_script_lang_js_decorate([(0,H.t)(s.h),filesViewervue_type_script_lang_js_metadata("design:type",s.h)],Ie.prototype,"pubSubService",void 0),filesViewervue_type_script_lang_js_decorate([(0,H.t)(F.b),filesViewervue_type_script_lang_js_metadata("design:type",F.b)],Ie.prototype,"cryptoProService",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.Hg)("fetchRights"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"fetchRights",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.Hg)("fetchEsigns"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"fetchEsigns",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.Hg)("fetchCurrentUserRights"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"fetchCurrentUserRights",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.jI)("fetchDocumentFiles"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"fetchDocumentFiles",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.p$)("addFileToConvert"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"addFileToConvert",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.p$)("renameFile"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"renameFile",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.p$)("fetchFileTypes"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"fetchFileTypes",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.p$)("fetchFilesEdited"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"fetchFilesEdited",void 0),filesViewervue_type_script_lang_js_decorate([(0,j.p$)("attachFileTemplateToDoc"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"attachFileTemplateToDoc",void 0),filesViewervue_type_script_lang_js_decorate([(0,me.aD)("currentUser"),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"currentUser",void 0),filesViewervue_type_script_lang_js_decorate([(0,me.aD)("userSettings",{namespace:"settings"}),filesViewervue_type_script_lang_js_metadata("design:type",Object)],Ie.prototype,"userSettings",void 0),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("currFileId"),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onCurrFileIdChanged",null),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("operationMode"),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onCurrEditorNameChanged",null),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("card",{immediate:!0}),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[Object]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onCardChanged",null),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("document",{immediate:!0}),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onDocumentChanged",null),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("document.files",{deep:!0}),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[Array,Array]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onDocumentFilesChanged",null),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("card.files",{deep:!0}),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[Array,Array]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onCardFilesChanged",null),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("panel"),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onPanelChange",null),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("loadNewVersionFromDisk"),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onLoadNewVersionFromDiskChange",null),filesViewervue_type_script_lang_js_decorate([(0,Q.Watch)("loadNewVersionFromDiskNative"),filesViewervue_type_script_lang_js_metadata("design:type",Function),filesViewervue_type_script_lang_js_metadata("design:paramtypes",[]),filesViewervue_type_script_lang_js_metadata("design:returntype",void 0)],Ie.prototype,"onLoadNewVersionFromDiskNativeChange",null),Ie=filesViewervue_type_script_lang_js_decorate([(0,Q.Component)({components:{"file-upload":ce.Z,"file-version-viewer":E.Z,pdf:he.Z,"file-stamps":ae}})],Ie);const De=Ie,Re=De;var Te=n(85893),Pe=n(5255),Oe=(0,q.Z)(Re,render,o,!1,null,"7c260c2e",null);const ke=Oe.exports;K()(Oe,{VBtn:Y.Z,VCard:Te.Z,VCardText:Pe.ZB,VCardTitle:Pe.EB,VCol:J.Z,VExpansionPanel:X.Z,VExpansionPanelContent:ee.Z,VExpansionPanelHeader:te.Z,VExpansionPanels:ne.Z,VIcon:ie.Z,VRow:oe.Z,VTooltip:se.Z})},73765:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%",display:"flex"},style:e.inlineStyle},[e.iconName?n("v-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.title,expression:"title"}],attrs:{size:"18"}},[e._v("\n    "+e._s(e.iconName)+"\n  ")]):e.mark?n("div",{staticClass:"d-flex align-center justify-center circle",class:e.markClass},[e.isRedirectedIcon?n("v-icon",{style:"white"===e.markClass?{color:"var(--grey-darken-3)"}:{color:"var(--white)"},attrs:{size:"14"}},[e._v("\n      call_missed_outgoing\n    ")]):e._e()],1):e._e(),e._v(" "),n("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.title,expression:"title"}],class:e.className},[e._v(e._s(e.text))])],1)},i=[],o=n(97625),s=n(28517),r=n(31716),a=n(18220),l=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let c=class IconColumnComponent extends l.Vue{constructor(){super(...arguments),this.title=null,this.innerIcon=null,this.innerText=null,this.mark=!1,this.markClass="",this.badge=null}onTitleMethodChanged(){if(!this.titleMethod)return null;const e=this.titleMethod.lastIndexOf("$"),t=e===this.titleMethod.length-1;this[this.titleMethod]&&(t&&this.$nextTick((()=>__awaiter(this,void 0,void 0,(function*(){this.title=yield this[this.titleMethod]()})))),this.title=this[this.titleMethod]())}onTooltipChanged(e){if(!e)return null;"userInfo"===e&&this.field?this.$nextTick((()=>__awaiter(this,void 0,void 0,(function*(){this.title=yield this.userInfo$()})))):this.title="sendType"===e?this.sentType():"value"===e?this.value:e}boolSprite(){return s.C.toBoolSprite(this.value,this.iconTrue,this.iconFalse)}stateSprite(){return s.C.toStateSprite(this.value)}sentTypeSprite(){const e=this.field?this.row[this.field]:this.value;return s.C.toSentTypeSprite(e)}sentType(){const e=this.field?this.row[this.field]:this.value;return o.X.getSentType(e)}userInfo$(){return __awaiter(this,void 0,void 0,(function*(){const e=this.field?this.row[this.field]:this.value;if(!e)return"";const t=yield this.getUserInfo(e);return(0,r.F)(t)}))}get text(){return this.innerText?this.innerText:this.showText?this.value:""}get className(){const e=[];return this[this.iconMethod]&&e.push(this[this.iconMethod]()),this.badge&&(e.push("badge"),e.push(this.badge)),e}get iconName(){var e;return this.iconMethod?null:this.innerIcon?this.innerIcon:(this.icon||this.iconTrue)&&this.value?null!==(e=this.icon)&&void 0!==e?e:this.iconTrue:this.iconFalse&&!this.value?this.iconFalse:null}get inlineStyle(){this.mark=!1,this.innerText=null,this.innerIcon=null,this.badge=null,this.markClass=null;let e={};return this.showText||(e["text-align"]="center"),this.color&&(e["color"]=this.color),Array.isArray(this.conditions)&&this.conditions.forEach((t=>{if(Array.isArray(t.fields)){let n=!0;const i=t.fields.reduce(((e,t)=>{let i=!1;return i=t.contain?this.row[t.field].includes(t.value):t.starts?this.row[t.field].startsWith(t.value):t.ends?this.row[t.field].endsWith(t.value):this.row[t.field]==t.value,e=n?e&&i:e||i,n=!("and"in t)||t.and,e}),!0);i&&(t.mark&&(this.mark=!0,this.markClass=t.mark),t.badge&&(this.badge=t.badge),t.styles&&(e=Object.assign(Object.assign({},e),t.styles)),t.icon&&(this.innerIcon=t.icon),t.text&&(this.innerText=t.text),t.tooltip&&this.onTooltipChanged(t.tooltip))}})),e}get isRedirectedIcon(){return"1"===this.row.redirectFlag}};__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"type",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"titleMethod",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"tooltip",void 0),__decorate([(0,l.Prop)({type:[String,Number,Boolean,Date,Object]}),__metadata("design:type",Object)],c.prototype,"value",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",Object)],c.prototype,"row",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"iconMethod",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"iconTrue",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"iconFalse",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"icon",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"field",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",Boolean)],c.prototype,"showText",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",String)],c.prototype,"color",void 0),__decorate([(0,l.Prop)(),__metadata("design:type",Array)],c.prototype,"conditions",void 0),__decorate([(0,a.Vw)("getUserInfo"),__metadata("design:type",Object)],c.prototype,"getUserInfo",void 0),__decorate([(0,l.Watch)("titleMethod",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],c.prototype,"onTitleMethodChanged",null),__decorate([(0,l.Watch)("tooltip",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],c.prototype,"onTooltipChanged",null),c=__decorate([l.Component],c);const d=c,u=d;var p=n(51900),h=n(43453),m=n.n(h),f=n(71100),g=(0,p.Z)(u,render,i,!1,null,"5fe8d0a3",null);const y=g.exports;m()(g,{VIcon:f.Z})},80141:(e,t,n)=>{"use strict";n.d(t,{Z:()=>I});var i,render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"i-agree-list pt-0"},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.loading}}),e._v(" "),e.loading||e.agreeData&&e.agreeData.length?n("div",{staticClass:"mb-2 list-switcher"},e._l(e.agreeListFilters,(function(t,i){return n("a",{key:"filters:"+t.name+":"+i,staticClass:"black--text lighten-1 font-weight-light mr-9",class:{selected:t.isSelected,"font-weight-bold":t.isSelected},attrs:{id:"filters:"+t.name+":"+i},on:{click:e.agreeListFilter}},[e._v("\n      "+e._s(t.name))])})),0):n("div",{staticClass:"emptybox"},[n("span",{staticClass:"emptybox-text black--text lighten-1"},[e._v(e._s(e.$gettext("Данные по согласованию отсутствуют")))])]),e._v(" "),n("v-row",{staticClass:"column",attrs:{"no-gutters":""}},e._l(e.treeData,(function(t,i){return n("v-row",{key:t.id+":name",staticClass:"agree-model font-weight-bold mr-3",attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"auto"}},[n("div",{staticClass:"agree-list__model-container"},[n("span",[e._v(" "+e._s(t.operTypeDisplayName)+" ("+e._s(e.generateAgreementProportion(t))+") ")])])]),e._v(" "),n("v-col",[n("div",{staticClass:"mb-2 column"},e._l(t.items,(function(i){return e.isItemShowed(i)?n("div",{key:t.id+":"+i.id,staticClass:"agree-list__item"},[n("div",[n("div",[2===i.stateIdx||3===i.stateIdx?n("v-icon",{staticClass:"success agree-item-icon",attrs:{small:"",dark:""}},[e._v("\n                  done\n                ")]):1===i.stateIdx?n("v-icon",{staticClass:"undefined agree-item-icon"},[e._v(" help_outline ")]):4===i.stateIdx?n("v-icon",{staticClass:"warning agree-item-icon",attrs:{dark:"",small:""}},[e._v(" close ")]):e._e(),e._v(" "),n("span",{staticClass:"ml-2 black--text lighten-1"},[e._v("\n                  "+e._s(i.visorName)+"\n                  "),i.signDate?n("span",{staticClass:"sm-text grey--text font-weight-regular"},[e._v("("+e._s(e.getSignDate(i))+")")]):e._e()])],1),e._v(" "),n("div",{staticClass:"sm-text grey--text font-weight-regular ml-4 pl-3"},[e._v(e._s(i.department))]),e._v(" "),n("div",{staticClass:"sm-text grey--text font-weight-regular ml-4 pl-3"},[e._v(e._s(i.position))])])]):e._e()})),0)])],1)})),1)],1)},o=[];(function(e){e[e["OnExecute"]=1]="OnExecute",e[e["Signed"]=2]="Signed",e[e["Note"]=3]="Note",e[e["Decline"]=4]="Decline"})(i||(i={}));var s=n(50103),r=n(77896),a=n(69332),l=n(1869),c=n(31025),d=n(28517),u=n(81086),p=n(12853),h=n(54486),m=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let f=class InstructionAgreeListComponent extends m.Vue{constructor(){super(...arguments),this.loading=!1,this.agreeData=[],this.selection=[],this.treeData=null,this.isActive=!1,this.agreeListFilters=[{key:"all",name:this.$gettext("Все"),isSelected:!0,Idx:[2,3],showedIdx:[0,1,2,3,4]},{key:"rejected",name:this.$gettext("Отказы"),isSelected:!1,Idx:[4],showedIdx:[4]},{key:"pending",name:this.$gettext("Ожидание"),isSelected:!1,Idx:[1],showedIdx:[1]}],this.selectedFilter=this.agreeListFilters[0],this.treeOptions={category:"items",unique:e=>e.id,css:{TreeView:"tree-view"},strategies:{click:["select","toggle-fold"],selection:["modifiers"],fold:["opener-control","no-child-selection"]},openerOpts:{position:"left"}}}onIdChanged(){this.id&&this.reload()}onListUpdateCounterChanged(){return __awaiter(this,void 0,void 0,(function*(){yield this.reload()}))}reload(){return __awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{this.isInstruction?this.agreeData=yield this.queryBus.exec(new a.VZ(String(this.id))):this.isDocument&&(this.agreeData=yield this.queryBus.exec(new r.LU(this.id))),this.toTree()}finally{this.loading=!1}}))}onSelect(e){}agreeListFilter(e){for(const e of this.agreeListFilters)e.isSelected=!1;const t=e.target.id.split(":")[2];this.agreeListFilters[Number(t)].isSelected=!0,this.selectedFilter=this.agreeListFilters[Number(t)]}getSignDate(e){if(e.signDate){const t=new Date(e.signDate);return c.C.dateToString(t)}return""}generateAgreementProportion(e){const t=e.items.filter((e=>this.selectedFilter.Idx.filter((t=>t===e.stateIdx)).length>0)).length,n=e.items.length;return`${t}/${n}`}isItemShowed(e){return this.selectedFilter.showedIdx.filter((t=>t===e.stateIdx)).length>0}changeColor(e){return Number(e.state)===i.OnExecute?"grey":Number(e.state)===i.Signed||Number(e.state)===i.Note?"green lighten-2":Number(e.state)===i.Decline?"red":void 0}toTree(){if(!this.agreeData)return;const e=[],t={};this.agreeData.forEach((e=>{e.icon=d.C.getListSheetIconInfo(Number(e.state)),e.color=this.changeColor(e);let n=t[e.operTypeID];n||(n=[],t[e.operTypeID]=n),n.push(e)})),Object.keys(t).forEach((n=>{const i=t[Number(n)];e.push(Object.assign(Object.assign({},i[0]),{items:i}))})),this.treeData=e}get isInstruction(){return this.contentType===s.zc.Instruction}get isDocument(){return this.contentType===s.zc.Document}};__decorate([(0,m.Prop)(),__metadata("design:type",Number)],f.prototype,"id",void 0),__decorate([(0,m.Prop)({default:!0}),__metadata("design:type",Boolean)],f.prototype,"visibility",void 0),__decorate([(0,m.Prop)(),__metadata("design:type",Number)],f.prototype,"contentType",void 0),__decorate([(0,m.Prop)(),__metadata("design:type",Number)],f.prototype,"updateListCounter",void 0),__decorate([(0,h.t)(l.M.IQueryBus),__metadata("design:type",Object)],f.prototype,"queryBus",void 0),__decorate([(0,m.Watch)("id",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],f.prototype,"onIdChanged",null),__decorate([(0,m.Watch)("updateListCounter"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],f.prototype,"onListUpdateCounterChanged",null),f=__decorate([(0,m.Component)({components:{"tree-view":p.L},filters:{dateFormat:u.v}})],f);const g=f,y=g;var v=n(51900),b=n(43453),C=n.n(b),w=n(17024),_=n(71100),x=n(57894),S=(0,v.Z)(y,render,o,!1,null,"1805a806",null);const I=S.exports;C()(S,{VCol:w.Z,VIcon:_.Z,VRow:x.Z})},8756:(e,t,n)=>{"use strict";n.d(t,{Z:()=>G});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"report",class:{"grid-container":e.modal&&!e.isCompact}},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.loading}}),e._v(" "),e.modal&&e.isCompact?[n("div",{staticClass:"grid-title mb-2"},[n("div",{staticClass:"modal-title__name px-1"},[n("v-icon",{staticClass:"mr-1",attrs:{color:"primary",size:"18"}},[e._v(" mail ")]),e._v(" "),n("span",{staticClass:"primary--text text-overflow body-1",on:{click:e.onInstructionOpen}},[e._v(" "+e._s(e.instructionTitle)+" ")])],1),e._v(" "),e.reportObj?n("div",{staticClass:"modal-title__btn pl-2"},[e.isReportTypePositive?n("v-btn",{staticClass:"toolbar-button small-button icon-button elevation-0",attrs:{id:"reportSendBtn",disabled:e.processing,color:"success"},on:{click:e.send}},[n("v-icon",[e._v("done")]),e._v(" "),e.isMobile?e._e():n("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\r\n        "+e._s(e.reportObj.operationMenuCaption||e.$gettext("Отчитаться"))+"\r\n      ")])],1):e._e(),e._v(" "),e.isReportTypeNegative?n("v-tooltip",{attrs:{bottom:"",disabled:!e.isReportTypeUndef},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"toolbar-button",class:{"ml-2 mr-0 square-sm-button elevation-0":e.isReportTypeUndef,"small-button icon-button elevation-0":!e.isReportTypeUndef},attrs:{id:"reportCancelBtn",disabled:e.processing,color:"warning"},on:{click:e.cancel}},i),[n("v-icon",[e._v("clear")]),e._v(" "),e.isMobile||e.isReportTypeUndef?e._e():n("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\r\n            "+e._s(e.$gettext("Отказать"))+"\r\n          ")])],1)]}}],null,!1,106315346)},[e._v(" "),n("translate",{staticClass:"body-1"},[e._v("Отказать")])],1):e._e(),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"ml-2 mr-0 white--text rounded-button square-sm-button elevation-0",attrs:{id:"reportSaveBtn",disabled:e.processing,color:"grey darken-1"},on:{click:e.save}},i),[n("v-icon",{attrs:{small:""}},[e._v("save")])],1)]}}],null,!1,1802702724)},[e._v(" "),n("translate",{staticClass:"body-1"},[e._v("Сохранить проект")])],1)],1):e._e()]),e._v(" "),n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"report-body mb-3"},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(" "+e._s(e.$gettext("Получатель отчета:"))+" ")]),e._v(" "),e.reportObj?n("div",{staticClass:"mt-2"},[n("v-chip",{attrs:{small:"",color:"primary_light","text-color":"white"}},[e._v(e._s(e.reportObj.receiver.name))])],1):e._e()])],1),e._v(" "),n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticStyle:{"margin-bottom":"10px"}},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Отчет"))+":")]),e._v(" "),e.reportObj?n("div",{staticClass:"report-text mt-1"},[n("v-textarea",{staticClass:"small-input body-1 font-weight-light mr-2",attrs:{id:"reportText",name:"input-10-1",placeholder:e.$gettext("Текст отчёта"),flat:"",solo:"","single-line":"",outlined:"","hide-details":"",height:170},model:{value:e.reportObj.text,callback:function(t){e.$set(e.reportObj,"text",t)},expression:"reportObj.text"}}),e._v(" "),n("div",[n("message-template-renderer",{staticStyle:{display:"none"},attrs:{instructionInfo:e.instructionInfo,report:e.reportObj,"template-type":e.templateType,context:e.context},on:{"set-standard-resolution-handler":e.onSetStandardResolutionHandler}}),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"square-sm-button rounded-button bordered-button grey--border lighten-2",attrs:{icon:""},on:{click:e.onStandardReportResolution}},i),[n("v-icon",{attrs:{color:"primary",size:"18"}},[e._v("assignment")])],1)]}}],null,!1,2424555945)},[e._v(" "),n("translate",{staticClass:"body-1"},[e._v("Шаблоны отчетов")])],1)],1)],1):e._e()])],1),e._v(" "),n("v-row",{staticClass:"picker-wrapper",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"d-flex align-center"},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(" "+e._s(e.$gettext("Дата выполнения:"))+" ")]),e._v(" "),e.reportObj?n("div",{staticClass:"ml-4"},[n("vdt-picker",{attrs:{readonly:!0,disabled:!0},model:{value:e.reportObj.executionDate,callback:function(t){e.$set(e.reportObj,"executionDate",t)},expression:"reportObj.executionDate"}})],1):e._e()])],1),e._v(" "),e.reportObj?n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("attach-doc",{attrs:{limitedMode:!e.isFullMode,document:e.document,files:e.reportObj.files,"action-context":e.context,"show-dropzone":!1,"show-download-btn":!1,"show-template-btn":!1,"allowed-file-extensions":e.allowedFileExtensions,"doc-changeable":!0,modal:!0,"is-report":!0},on:{"document-select":function(t){return e.updateBaseDocument(t)},"upload-files":e.uploadFiles,"updated-files":e.updatedFiles,"clear-base-document":e.clearBaseDocument}})],1)],1):e._e()]:e.modal&&!e.isCompact?[n("div",{staticClass:"grid-row"},[n("div",{staticClass:"modal-title__name px-1"},[n("v-icon",{staticClass:"mr-1",attrs:{color:"primary",size:"18"}},[e._v(" mail ")]),e._v(" "),n("span",{staticClass:"primary--text text-overflow body-1",on:{click:e.onInstructionOpen}},[e._v(" "+e._s(e.instructionTitle)+" ")])],1),e._v(" "),e.reportObj?n("div",{staticClass:"modal-title__btn px-2"},[e.isReportTypePositive?n("v-btn",{staticClass:"toolbar-button small-button icon-button elevation-0",attrs:{id:"reportSendBtn",disabled:e.disabling,color:"success"},on:{click:e.send}},[n("v-icon",[e._v("done")]),e._v(" "),e.isMobile?e._e():n("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\n        "+e._s(e.reportObj.operationMenuCaption||e.$gettext("Отчитаться"))+"\n      ")])],1):e._e(),e._v(" "),e.isReportTypeNegative?n("v-btn",{staticClass:"toolbar-button small-button icon-button elevation-0",class:{"ml-2 mr-0":e.isReportTypeUndef},attrs:{id:"reportCancelBtn",disabled:e.disabling,color:"warning"},on:{click:e.cancel}},[n("v-icon",[e._v("clear")]),e._v(" "),e.isMobile?e._e():n("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\n        "+e._s(e.$gettext("Отказать"))+"\n      ")])],1):e._e(),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"ml-2 mr-0 white--text rounded-button square-sm-button elevation-0",attrs:{id:"reportSaveBtn",disabled:e.disabling,color:"grey darken-1"},on:{click:e.save}},i),[n("v-icon",{attrs:{small:""}},[e._v("save")])],1)]}}],null,!1,2913805246)},[e._v(" "),n("translate",{staticClass:"body-1"},[e._v("Сохранить проект")])],1)],1):e._e()]),e._v(" "),n("v-container",{staticClass:"pa-0 mt-3"},[n("v-row",{staticClass:"grid-row",attrs:{"no-gutters":""}},[n("v-col",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"report-body mb-3"},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(" "+e._s(e.$gettext("Получатель отчета:"))+" ")]),e._v(" "),e.reportObj?n("div",{staticClass:"mt-2"},[n("v-chip",{attrs:{small:"",color:"primary_light","text-color":"white"}},[e._v(e._s(e.reportObj.receiver.name))])],1):e._e()])],1),e._v(" "),!e.isMobile&&e.reportObj?n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"mb-3"},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Тема:")))]),e._v(" "),n("v-text-field",{staticClass:"small-input body-1 font-weight-light rounded-border mt-2 black--text lighten-1",attrs:{id:"reportTheme",type:"text",rows:"1","auto-grow":"",placeholder:e.$gettext("Тема сообщения"),flat:"",solo:"","single-line":"",outlined:""},model:{value:e.reportObj.subject,callback:function(t){e.$set(e.reportObj,"subject",t)},expression:"reportObj.subject"}})],1)],1):e._e(),e._v(" "),n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{staticClass:"mb-3"},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Отчет"))+":")]),e._v(" "),e.reportObj?n("div",{staticClass:"report-text mt-2"},[n("v-textarea",{staticClass:"small-input body-1 font-weight-light mr-2",attrs:{id:"reportText",name:"input-10-1",placeholder:e.$gettext("Текст отчета"),height:124,flat:"",solo:"","single-line":"",outlined:""},model:{value:e.reportObj.text,callback:function(t){e.$set(e.reportObj,"text",t)},expression:"reportObj.text"}}),e._v(" "),n("div",[n("message-template-renderer",{staticStyle:{display:"none"},attrs:{instructionInfo:e.instructionInfo,report:e.reportObj,"template-type":e.templateType,context:e.context},on:{"set-standard-resolution-handler":e.onSetStandardResolutionHandler}}),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"square-sm-button rounded-button bordered-button grey--border lighten-2",attrs:{icon:""},on:{click:e.onStandardReportResolution}},i),[n("v-icon",{attrs:{color:"primary",size:"18"}},[e._v("assignment")])],1)]}}],null,!1,2424555945)},[e._v(" "),n("translate",{staticClass:"body-1"},[e._v("Шаблоны отчетов")])],1)],1)],1):e._e()])],1),e._v(" "),e.reportObj?n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("div",{staticClass:"block-title mb-3"},[n("translate",{staticClass:"body-2 font-weight-bold black--text lighten-1"},[e._v(" Ответный документ ")])],1),e._v(" "),n("attach-doc",{attrs:{limitedMode:!e.isFullMode,document:e.document,files:e.reportObj.files,"action-context":e.context,"show-download-btn":!1,"show-dropzone":e.canHandleUploadFiles,"show-template-btn":!1,"allowed-file-extensions":e.allowedFileExtensions,"doc-changeable":!0,modal:!0,"is-report":!0},on:{"document-select":function(t){return e.updateBaseDocument(t)},"upload-files":e.uploadFiles,"updated-files":e.updatedFiles,"clear-base-document":e.clearBaseDocument}})],1)],1):e._e()],1),e._v(" "),n("v-col",{staticClass:"pl-2"},[n("div",{staticClass:"params modal px-2 pt-2"},[n("div",{staticClass:"body-2 font-weight-bold mb-3 black--text lighten-1"},[n("span",[e._v("Параметры")])]),e._v(" "),e.reportObj?n("div",{staticClass:"mb-3"},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(" "+e._s(e.$gettext("Дата выполнения:"))+" ")]),e._v(" "),n("div",{staticClass:"mt-2",staticStyle:{"max-width":"206px"}},[n("vdt-picker",{attrs:{readonly:!0},model:{value:e.reportObj.executionDate,callback:function(t){e.$set(e.reportObj,"executionDate",t)},expression:"reportObj.executionDate"}})],1)]):e._e(),e._v(" "),e.reportObj?n("div",[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(" "+e._s(e.$gettext("Комментарий:"))+" ")]),e._v(" "),n("div",{staticClass:"mt-2"},[n("v-textarea",{staticClass:"small-input rounded-border body-1 font-weight-light black--text lighten-1",attrs:{name:"input-10-1",placeholder:e.$gettext("Комментарий"),flat:"",solo:"","single-line":"",outlined:"",height:"52","hide-details":""},model:{value:e.reportObj.comment,callback:function(t){e.$set(e.reportObj,"comment",t)},expression:"reportObj.comment"}})],1)]):e._e()])])],1)],1)]:[e.isFullMode?e._e():n("div",{staticClass:"report-header font-weight-bold"},[n("div",{staticClass:"report-header__title title mt-2"},[n("span",{staticClass:"ml-1 pl-2 title font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Создать отчёт")))])])]),e._v(" "),n("v-col",{staticClass:"mt-3 mx-1 px-2 pb-1 report-body"},[e.isFullMode?n("div",[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Получатель отчета:")))])]):e._e(),e._v(" "),e.reportObj&&e.isFullMode?n("div",{staticClass:"mb-3"},[n("v-chip",{attrs:{small:"",color:"primary_light","text-color":"white"}},[e._v(e._s(e.reportObj.receiver.name))])],1):e._e(),e._v(" "),!e.isMobile&&e.reportObj?n("div",[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Тема:")))]),e._v(" "),n("v-text-field",{staticClass:"small-input body-1 font-weight-light rounded-border pr-2 black--text lighten-1",attrs:{id:"reportTheme",type:"text",rows:"1","auto-grow":"",placeholder:e.$gettext("Тема сообщения"),flat:"",solo:"","single-line":"",outlined:""},model:{value:e.reportObj.subject,callback:function(t){e.$set(e.reportObj,"subject",t)},expression:"reportObj.subject"}})],1):e._e(),e._v(" "),n("div",{staticClass:"mt-2"},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Отчет"))+":")]),e._v(" "),e.reportObj?n("div",[n("v-textarea",{staticClass:"small-input body-1 font-weight-light mr-2",attrs:{id:"reportText",name:"input-10-1",placeholder:e.$gettext("Отчет:"),rows:"8",flat:"",solo:"","single-line":"",outlined:""},model:{value:e.reportObj.text,callback:function(t){e.$set(e.reportObj,"text",t)},expression:"reportObj.text"}})],1):e._e()]),e._v(" "),e.isMobile?e._e():n("v-row",{staticClass:"mt-2 mb-2 mr-2 no-gutters"},[n("v-col",[n("message-template-renderer",{attrs:{instructionInfo:e.instructionInfo,report:e.reportObj,"template-type":e.templateType,context:e.context},on:{"show-standard-resolution":e.onShowStandardResolution,"set-standard-resolution-handler":e.onSetStandardResolutionHandler}})],1),e._v(" "),e.isShowStandardResolution?n("v-btn",{staticClass:"rounded-button font-weight-regular small-button mx-0 elevation-0 my-0",attrs:{color:"primary"},on:{click:e.onStandardReportResolution}},[e._v("\n          "+e._s(e.$gettext("Шаблоны отчетов"))+"\n        ")]):e._e()],1),e._v(" "),n("div",{staticClass:"subheading font-weight-bold pt-3 grey--border lighten-2",attrs:{id:"response-doc-section"}},[n("span",{staticClass:"black--text lighten-1"},[e._v(e._s(e.$gettext("Ответный документ")))])]),e._v(" "),e.reportObj?n("v-row",[n("v-col",{attrs:{lg:"12",md:"12",sm:"12",cols:"12"}},[n("attach-doc",{attrs:{limitedMode:!e.isFullMode,document:e.document,files:e.reportObj.files,"action-context":e.context,"show-dropzone":e.canHandleUploadFiles,"show-template-btn":!1,"allowed-file-extensions":e.allowedFileExtensions,"doc-changeable":!0},on:{"document-select":function(t){return e.updateBaseDocument(t)},"upload-files":e.uploadFiles,"updated-files":e.updatedFiles,"clear-base-document":e.clearBaseDocument}})],1)],1):e._e(),e._v(" "),e.isMobile?e._e():[e.isFullMode?n("div",[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Дата выполнения:")))])]):e._e(),e._v(" "),e.reportObj&&e.isFullMode?n("div",{staticClass:"mb-3",staticStyle:{width:"150px"}},[n("vdt-picker",{attrs:{readonly:!0},model:{value:e.reportObj.executionDate,callback:function(t){e.$set(e.reportObj,"executionDate",t)},expression:"reportObj.executionDate"}})],1):e._e()],e._v(" "),n("div",{staticClass:"pt-2"},[n("span",{staticClass:"body-1 font-weight-bold black--text lighten-1"},[e._v(e._s(e.$gettext("Комментарий:")))])]),e._v(" "),e.reportObj?n("div",{staticClass:"pt-1"},[n("v-textarea",{staticClass:"small-input rounded-border body-1 font-weight-light pr-2 black--text lighten-1",attrs:{name:"input-10-1",placeholder:e.$gettext("Комментарий"),rows:"3",flat:"",solo:"","single-line":"",outlined:""},model:{value:e.reportObj.comment,callback:function(t){e.$set(e.reportObj,"comment",t)},expression:"reportObj.comment"}})],1):e._e()],2),e._v(" "),e.reportObj&&e.forceIsMobile?n("div",{staticClass:"report-footer secondary",attrs:{"align-center":""}},[n("v-btn",{staticClass:"body-1 text-capitalize font-weight-regular small-button rounded-button elevation-0 ml-2 mr-2",attrs:{id:"reportSendBtn",disabled:e.processing,color:"success"},on:{click:e.send}},[n("v-icon",[e._v("done")])],1),e._v(" "),n("v-btn",{staticClass:"body-1 text-capitalize font-weight-regular small-button rounded-button elevation-0 mr-2",attrs:{id:"reportCancelBtn",disabled:e.processing,color:"warning"},on:{click:e.cancel}},[n("v-icon",[e._v("clear")])],1),e._v(" "),n("v-btn",{staticClass:"white--text body-1 text-capitalize font-weight-regular small-button rounded-button elevation-0",attrs:{id:"reportSaveBtn",disabled:e.processing,icon:"",color:"grey lighten-1"},on:{click:e.save}},[n("v-icon",[e._v("save")])],1)],1):e.reportObj&&!e.forceIsMobile?n("div",{staticClass:"report-footer secondary",attrs:{"align-center":""}},[n("v-btn",{staticClass:"body-1 small-button font-weight-regular rounded-button elevation-0 ml-2 mr-2",attrs:{id:"reportSendBtn",disabled:e.processing,color:"success"},on:{click:e.send}},[n("v-icon",[e._v("done")]),e._v(" "),e.isMobile?e._e():n("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis"}},[e._v("\n          "+e._s(e.reportObj.operationMenuCaption||e.$gettext("Отчитаться"))+"\n        ")])],1),e._v(" "),n("v-btn",{staticClass:"body-1 small-button font-weight-regular rounded-button elevation-0 mr-2",attrs:{id:"reportCancelBtn",disabled:e.processing,color:"warning"},on:{click:e.cancel}},[n("v-icon",[e._v("clear")]),e._v(" "),e.isMobile?e._e():n("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis"}},[e._v(e._s(e.$gettext("Отказать")))])],1),e._v(" "),n("v-btn",{staticClass:"white--text body-1 small-button font-weight-regular rounded-button elevation-0",attrs:{id:"reportSaveBtn",disabled:e.processing,color:"grey lighten-1"},on:{click:e.save}},[n("v-icon",[e._v("save")]),e._v(" "),e.isMobile?e._e():n("translate",[e._v(" Сохранить проект ")])],1)],1):e._e()]],2)},i=[],o=n(2557),s=n(97625),r=n(60917),a=n(64447),l=n(22402),c=n(29256),d=n(40471),u=n(65779),p=n(37272),h=n(43857),m=n(22337),f=n(69332),g=n(43867),y=n(20386),v=n(13560),b=n(1869),C=n(31025),w=n(16273),_=n(18220),x=n(17773),S=n(69585),I=n(71148),D=n(95478),R=n(82464),T=n(38484),P=n(73718),O=n(54486),k=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};const F="update-report-id",A="set-report-obj";let $=Promise.resolve(),j=class InstructionReportComponent extends R.Z{constructor(){super(...arguments),this.reportObj=null,this.document=null,this.initialReportObj=null,this.title=this.$gettext("отчет"),this.loading=!1,this.processing=!1,this.disabling=!1,this.valid=!0,this.startDate="",this.allowedFileExtensions=[],this.filesToUpload=[],this.fileUpdated=!1,this.templateType=d.$.Create,this.isSending=!1,this.isSentEmitted=!1,this.standardResolutionHandler=null,this.isShowStandardResolution=!0}created(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchFileTypes(new m.uL);this.allowedFileExtensions=e.filter((e=>e.Extension)).map((e=>e.Extension.toLowerCase())),I.X.$emit("app-view-set-save",(e=>this.close(null,!e,!0)))}))}beforeDestroy(){this.isSending&&!this.isSentEmitted&&this.sent()}onInstructionInfoChanged(){var e,t,n,i,s,r;return __awaiter(this,void 0,void 0,(function*(){if(this.instructionInfo){if(this.actionType!==p.xK.ForwardReport&&!(null===(t=null===(e=this.instructionInfo)||void 0===e?void 0:e.permissions)||void 0===t?void 0:t.canSendReport))return this.context&&(this.context.breadcrumbs=null===(i=null===(n=this.context)||void 0===n?void 0:n.breadcrumbs)||void 0===i?void 0:i.itemsBefore(this.$route.path)),this.$app.goto(o.k.ViewMessage,this.context);try{this.loading=!0;try{yield $}catch(e){this.$log.debug("Ошибка сохранения отчета",e)}let e=this.getActionTypeString();this.actionType===p.xK.CreateReport&&this.reportId&&(e="Edit"),this.reportId&&this.reportId>0&&(this.templateType=d.$.Edit);let t=this.instructionInfo.instruction.id;this.instructionInfo.instruction.isReport&&(t=this.instructionInfo.instruction.parentID);let n=0;this.actionType===p.xK.ForwardReport&&(n=this.reportId,t=this.targetInstructionId?String(this.targetInstructionId):this.instructionInfo.parentInstruction?this.instructionInfo.parentInstruction.id:String(this.reportId));const i=new f.et(t,e,n);this.reportObj=yield this.fetchReport(i),((null===(s=this.reportObj)||void 0===s?void 0:s.reportId)||this.reportId)&&(this.document=null===(r=this.reportObj)||void 0===r?void 0:r.document),this.document&&this.reportObj.srcReportId&&(this.reportObj.files=yield this.fetchFiles(new f.I1(this.reportObj.srcReportId,!0))),this.reportObj.executionDate||(this.reportObj.executionDate=new Date),this.initialReportObj=Object.assign({},this.reportObj),this.$emit(A,this.reportObj),this.fileUpdated=!1,D.J.canCloseReport=!1}catch(e){this.$emit("instruction-report-closed"),this.showError(e)}finally{this.processing=!1,this.loading=!1}}}))}onDoCloseChanged(){this.close(null,!0,!0)}onShowStandardResolution(e){this.isShowStandardResolution=e}onSetStandardResolutionHandler(e){this.standardResolutionHandler=e}onStandardReportResolution(){return __awaiter(this,void 0,void 0,(function*(){if(this.standardResolutionHandler)return this.standardResolutionHandler();const e=new v.F({title:"Выбор шаблона отчета",componentName:"wrapper-catalogue",componentProps:{selectedItems:[],disabledItems:[],name:[this.$config.standardResolutionSource],gridColumns:["Name","Text"],constrains:this.VOCABULARY_CONSTRATIN,fullInfo:!0,enableCheckRights:!1,context:Object.assign(Object.assign({},this.context),{instructionInfo:[this.instructionInfo]})},selectAsOk:!0,height:"100%"}),t=yield this.queryBus.exec(e);if(t&&0!==t.length){const e=t[0].attributes.Text;e&&this.reportObj.text?this.$set(this.reportObj,"text",`${this.reportObj.text} ${e}`):e&&this.$set(this.reportObj,"text",e)}}))}uploadFiles(e){this.filesToUpload=null!==e&&void 0!==e?e:[],this.fileUpdated=!0}updatedFiles(e){var t;this.reportObj.files=null!==(t=[...e])&&void 0!==t?t:[],this.fileUpdated=!0}close(e,t=!1,n=!1){return __awaiter(this,void 0,void 0,(function*(){if(this.processing)return;const e=this.fileUpdated||!(0,P.Z)(this.reportObj,this.initialReportObj),i=e&&!t&&(yield this.queryBus.exec(new y.l(this.$gettext("Внимание!"),this.$gettext("Отчет содержит несохраненные данные. Сохранить проект отчета перед закрытием?"))));(i||e&&t)&&this.save(null,!0),n||this.$emit("instruction-report-closed")}))}sent(e){var t,n,i,o,r,a;if(D.J.canCloseReport=!0,this.$emit("instruction-report-sent"),this.isSentEmitted=!0,e){let l="";switch(e){case u.g.Success:l=this.$gettext("подтверждением");break;case u.g.Reject:l=this.$gettext("отказом");break;default:break}const c=s.X.getInstructionTitle({createDateTime:null===(n=null===(t=this.instructionInfo)||void 0===t?void 0:t.instruction)||void 0===n?void 0:n.createDateTime,creatorName:null===(o=null===(i=this.instructionInfo)||void 0===i?void 0:i.instruction)||void 0===o?void 0:o.creatorName,documentRegistrationNumber:null===(a=null===(r=this.instructionInfo)||void 0===r?void 0:r.instruction)||void 0===a?void 0:a.baseDocumentRegistrationNumber});this.$toasted.success(this.$gettextInterpolate(this.$gettext("Отчет для %{title} с %{msg} успешно отправлен"),{title:c,msg:l}))}}send(){return __awaiter(this,void 0,void 0,(function*(){try{this.disabling=!0,yield this.sendReport(u.g.Success)}catch(e){this.stopProcessingAfterError(),this.showError(e)}finally{this.disabling=!1}}))}cancel(){return __awaiter(this,void 0,void 0,(function*(){try{this.disabling=!0,yield this.sendReport(u.g.Reject)}catch(e){this.stopProcessingAfterError(),this.showError(e)}finally{this.disabling=!1}}))}save(e,t=!1){var n;return __awaiter(this,void 0,void 0,(function*(){try{this.disabling=!0,$=new Promise(((e,t)=>{this.resolveSave=e,this.rejectSave=t})),this.reportObj.reportId?yield this.editProject():yield this.createProject(t),(null===(n=this.instructionInfo)||void 0===n?void 0:n.instruction)&&this.pubSubService.domainEmit(`refresh-message:${this.instructionInfo.instruction.id}`)}finally{this.disabling=!1}}))}updateBaseDocument(e){this.document=e,this.reportObj.document=e,this.reportObj.files=[...e.files],this.fileUpdated=!0}clearBaseDocument(){this.reportObj.files=[],this.fileUpdated=!0,this.document=null,this.reportObj.document=null}createProject(e=!1){return __awaiter(this,void 0,void 0,(function*(){if(!this.processing){if(!e){const e=yield this.queryBus.exec(new y.l(this.$gettext("Внимание!"),this.$gettext("Вы действительно хотите сохранить проект отчета?")));if(!e)return}return this.process((()=>__awaiter(this,void 0,void 0,(function*(){yield this.validate(),yield this.loadFilesToServer(),this.instructionInfo.instruction.taskID&&(this.reportObj.taskID=this.instructionInfo.instruction.taskID);const e=new c._S(this.instructionInfo.instruction.id,this.reportObj,this.instructionInfo.instruction.folder),t=yield this.commandBus.exec(e);this.reportObj.reportId=t.value.reportId,this.initialReportObj=Object.assign({},this.reportObj),this.$emit(A,this.reportObj),this.fileUpdated=!1,D.J.canCloseReport=!0,this.resolveSave(),this.$emit(F,this.reportObj.reportId)}))))}}))}editProject(){if(!this.processing)return this.process((()=>__awaiter(this,void 0,void 0,(function*(){yield this.validate(),yield this.loadFilesToServer();const e=new c.Vr(this.reportObj,this.instructionInfo.instruction.folder);yield this.commandBus.exec(e),this.initialReportObj=Object.assign({},this.reportObj),this.$emit(A,this.reportObj),this.fileUpdated=!1,D.J.canCloseReport=!0,this.resolveSave()}))),!0)}onInstructionOpen(){this.$app.viewMessage(this.instructionInfo.instruction.id,this.context)}process(e,t=!0){return __awaiter(this,void 0,void 0,(function*(){if(!this.processing)try{this.loading=t,this.processing=!0;try{return yield e()}catch(e){throw this.rejectSave&&this.rejectSave(e),this.showError(e),this.stopProcessingAfterError(),this.$log.error(e),e}finally{this.processing=!1,this.loading=!1}}catch(e){this.$log.error(e)}}))}setProcessingStatus(e){this.modal&&this.$emit("dialog:processing",e)}stopProcessingAfterError(){this.modal&&this.$emit("dialog:activate")}sendReport(e){var t,n,i,o,r;return __awaiter(this,void 0,void 0,(function*(){if(this.processing)return;this.isSending=!0;let a=h.A.NoCheck;this.instructionInfo.instructionType&&(a=e===u.g.Success?this.instructionInfo.instructionType.checkReportTypePositive:this.instructionInfo.instructionType.checkReportTypeNegative),this.reportObj.document=this.document;const l=s.X.validateReportRequiredFields(this.reportObj,a);if(l)return void this.$toasted.error(l);let d,p=null;e===u.g.Success&&(null===(n=null===(t=this.instructionInfo)||void 0===t?void 0:t.instruction)||void 0===n?void 0:n.operationID)&&(d=yield this.queryBus.exec(new f.I1(null===(o=null===(i=this.instructionInfo)||void 0===i?void 0:i.instruction)||void 0===o?void 0:o.id,!0)),p=this.instructionService.checkFilesVersions(d));const m=Array.isArray(p)&&p.length;let g=!1;if(m&&(g=yield this.instructionService.newFileVersionAlert(null===(r=this.reportObj)||void 0===r?void 0:r.operationMenuCaption)),m&&!g)return;this.setProcessingStatus(this.$gettext("Отправка отчета..."));const y=!this.reportObj.reportId||0===Number(this.reportObj.reportId),v=yield this.process((()=>__awaiter(this,void 0,void 0,(function*(){yield this.validate(),yield this.loadFilesToServer();const t=this.targetInstructionId?String(this.targetInstructionId):this.instructionInfo.instruction.id,n=this.context.folderId?{id:Number(this.context.folderId),name:this.context.folderName}:this.instructionInfo.instruction.folder,i=new c.Gm(t,this.reportObj,n,e,g);return this.commandBus.exec(i)}))));v&&(v.isFailure?y&&v.error&&v.error.data&&v.error.data.reportId&&(this.reportObj.reportId=v.error.data.reportId,this.$emit(F,this.reportObj.reportId)):(y&&(this.reportObj.reportId=v.value.reportId,this.$emit(F,this.reportObj.reportId)),this.initialReportObj=Object.assign({},this.reportObj),this.$emit(A,this.reportObj),this.sent(e)))}))}showError(e){let t=this.$gettext("Не удалось выполнить операцию. Попробуйте позже.");if(e){let n;if(e instanceof a.$Q?n=e.error:e instanceof a.yr&&(n=e),n){if(n.message)t=n.message;else if(n.messages.length){let e="";for(const t of n.messages)"string"===typeof t?e=t:""===(null===t||void 0===t?void 0:t.name)&&""===(null===t||void 0===t?void 0:t.text)||(e+=`${t.name} <br> ${t.text}`);""!==e&&(t=e)}}else t=e.message}return this.$log.error(t),this.queryBus.exec(new g.m(this.$gettext("Ошибка"),t))}validate(){return __awaiter(this,void 0,void 0,(function*(){let e=[];const t=(0,w.ZV)([...this.reportObj.files,...this.filesToUpload],this.allowedFileExtensions);if(t||e.push(this.$gettext("Среди приложенных файлов есть файлы с недопустимыми типами.")),this.reportObj.document||!Array.isArray(this.filesToUpload)||!this.filesToUpload.length||this.userSettings.documentDefaultSettings&&this.userSettings.documentDefaultSettings.documentTypeId&&this.userSettings.documentDefaultSettings.journalId||e.push(this.$gettext("Чтобы сохранить приложенные файлы требуется настроить журнал и тип документа по умолчанию.")),e.length>1){let t=0;e=e.map((e=>`${++t}. ${e}`))}return e.length?Promise.reject(new a.$Q({value:!1,error:new a.yr(e)})):Promise.resolve(new a.$Q({value:!0}))}))}loadFilesToServer(){var e,t;return __awaiter(this,void 0,void 0,(function*(){if((null===(t=null===(e=this.reportObj)||void 0===e?void 0:e.document)||void 0===t?void 0:t.id)||!this.filesToUpload||!this.filesToUpload.length)return;const n=new c.R3(this.userSettings.documentDefaultSettings.documentTypeId,this.userSettings.documentDefaultSettings.journalId,this.reportObj.text),i=yield this.commandBus.exec(n);try{const e=i.value,t=yield this.commandBus.exec(new c.eY(e,this.getFormData())),n=t.value?t.value.files:[];return this.reportObj.files=[...this.reportObj.files,...n],this.filesToUpload=[],this.reportObj.document={id:e},new a.$Q({value:t.value?t.value.files:null})}catch(e){let t=null;e.data&&e.data.files&&(t=e.data.files);const n=new a.yr(e.message,e);return this.reportObj.files=[...this.reportObj.files,...t],new a.$Q({value:t,error:n})}}))}getFormData(){const e=new FormData;return this.filesToUpload.forEach((t=>{e.append("file",t.file)})),e}getActionTypeString(){switch(this.actionType){case p.xK.CreateReport:return"Create";case p.xK.Edit:return"Edit";case p.xK.ForwardReport:return"ForwardReport"}}get actionTypeText(){let e="",t=this.actionType;switch(this.actionType===p.xK.Create&&this.reportId&&(t=p.xK.Edit),t){case p.xK.Create:e=this.$gettext("Создать");break;case p.xK.Edit:e=this.$gettext("Изменить");break;case p.xK.ForwardReport:e=this.$gettext("Перенаправить");break;default:break}return e}get instructionTitle(){const e=s.X.userNameShorting(this.instructionInfo.instruction.creatorName),t=C.C.dateToString(new Date(this.instructionInfo.instruction.createDateTime),"date");return`${e} ${this.$gettext("от")} ${t}`}get isFullMode(){return!this.quickReport}get isCompact(){return this.elementWidth<=600}get canHandleUploadFiles(){var e,t,n,i;return Boolean((null===(t=null===(e=this.userSettings)||void 0===e?void 0:e.documentDefaultSettings)||void 0===t?void 0:t.documentTypeId)&&(null===(i=null===(n=this.userSettings)||void 0===n?void 0:n.documentDefaultSettings)||void 0===i?void 0:i.journalId))}get VOCABULARY_CONSTRATIN(){return[`Convert.ToInt32(Attributes["CreatorID"]) == ${this.currentUser.effectiveId}`,'Convert.ToInt32(Attributes["KindID"]) == 2']}get isReportTypePositive(){return!this.context.data||this.context.data===u.g.Success}get isReportTypeNegative(){return!this.context.data||this.context.data===u.g.Reject}get isReportTypeUndef(){return!this.context.data}};__decorate([(0,k.Prop)(),__metadata("design:type",Object)],j.prototype,"instructionInfo",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Number)],j.prototype,"reportId",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Object)],j.prototype,"targetInstructionId",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Number)],j.prototype,"actionType",void 0),__decorate([(0,k.Prop)({default:!1}),__metadata("design:type",Boolean)],j.prototype,"quickReport",void 0),__decorate([(0,k.Prop)({type:Object,default:null}),__metadata("design:type",Object)],j.prototype,"context",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Number)],j.prototype,"doClose",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Boolean)],j.prototype,"forceIsMobile",void 0),__decorate([(0,k.Prop)(),__metadata("design:type",Boolean)],j.prototype,"modal",void 0),__decorate([(0,_.p$)("fetchFileTypes"),__metadata("design:type",Object)],j.prototype,"fetchFileTypes",void 0),__decorate([(0,_.Rm)("fetchReport"),__metadata("design:type",Object)],j.prototype,"fetchReport",void 0),__decorate([(0,_.Rm)("fetchFiles"),__metadata("design:type",Object)],j.prototype,"fetchFiles",void 0),__decorate([(0,O.t)(b.M.IQueryBus),__metadata("design:type",Object)],j.prototype,"queryBus",void 0),__decorate([(0,O.t)(l.O.ICommandBus),__metadata("design:type",Object)],j.prototype,"commandBus",void 0),__decorate([(0,O.t)(),__metadata("design:type",s.X)],j.prototype,"instructionService",void 0),__decorate([(0,O.t)(r.h),__metadata("design:type",r.h)],j.prototype,"pubSubService",void 0),__decorate([(0,S.x)("userSettings"),__metadata("design:type",Object)],j.prototype,"userSettings",void 0),__decorate([(0,x.O)("currentUser"),__metadata("design:type",Object)],j.prototype,"currentUser",void 0),__decorate([(0,k.Watch)("instructionInfo",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],j.prototype,"onInstructionInfoChanged",null),__decorate([(0,k.Watch)("doClose"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],j.prototype,"onDoCloseChanged",null),j=__decorate([(0,k.Component)({components:{"attach-doc":T.Z}})],j);const E=j,M=E;var N=n(51900),V=n(43453),B=n.n(V),L=n(82127),U=n(93462),H=n(17024),Q=n(71100),z=n(57894),Z=n(22528),W=n(80172),q=(0,N.Z)(M,render,i,!1,null,"3c355c97",null);const G=q.exports;B()(q,{VBtn:L.Z,VChip:U.Z,VCol:H.Z,VIcon:Q.Z,VRow:z.Z,VTextField:Z.Z,VTextarea:W.Z})},59976:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ce});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"instruction-view-wrapper"},[e.instruction?n("div",{class:{"m-one-column":e.showMobileInstructionArea}},[n("div",{staticClass:"instruction-common-info"},[n("icommon-info",{attrs:{actionContext:e.actionPanelContext,isPreview:e.isPreview,creatorInfo:e.creatorInfo,instruction:e.instruction,instructionInfo:e.instructionInfo,files:e.files,entityViewMode:e.actionContext.entityViewMode,actionType:e.actionType,limitedMode:e.limitedMode,forceIsMobile:e.forceIsMobile,forceIsTablet:e.forceIsTablet}})],1)]):n("div",{staticClass:"emptybox"},[n("translate",{staticClass:"emptybox-text"},[e._v("Данные сообщения отсутствуют")])],1)])},i=[],o=n(29256),s=n(37272),r=n(50103),a=n(69332),l=n(31716),c=n(18220),d=n(76764),u=n(69585),instructionBasicInfovue_type_template_id_d40365ce_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Дата создания:")])],1),e._v(" "),n("v-col",[e._v(" "+e._s(e.instructionCreateDateString)+" ")])],1),e._v(" "),e.isInitialMessage?e._e():n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Тип сообщения:")])],1),e._v(" "),n("v-col",[e._v(" "+e._s(e.instruction.instructionTypeName)+" ")])],1),e._v(" "),e.instruction.isReport?n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Отправитель:")])],1),e._v(" "),n("v-col",[e._v(" "+e._s(e.instruction.creatorName)+" ")])],1):e._e(),e._v(" "),n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Тип рассылки:")])],1),e._v(" "),n("v-col",[e._v(" "+e._s(e.printSendType(e.instruction.sendTypeIdx))+" ")])],1),e._v(" "),e.instruction.isReport?e._e():n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Срок исполнения:")])],1),e._v(" "),n("v-col",{staticClass:"d-flex align-center",class:{"error--text":e.isOverdue,"black--text lighten-1":!e.isOverdue}},[e.execDateString?n("svg-icon",{staticClass:"svg-icon darken-3",class:{"error--text":e.isOverdue,"grey--text":!e.isOverdue},attrs:{icon:"event"}}):e._e(),e._v("\n      "+e._s(e.execDateString?e.execDateString:e.$gettext("Не задан"))+"\n    ")],1)],1),e._v(" "),e.isPreview?e._e():n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Статус:")])],1),e._v(" "),n("v-col",[n("v-chip",{staticClass:"item__value status",attrs:{small:"",color:"info",label:"",outlined:""}},[e._v(" "+e._s(e.instruction.stateName)+" ")])],1)],1),e._v(" "),e.isInitialMessage||!e.instructionInfo.instruction.respReceiverHintName||e.isPreview?e._e():n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Метки:")])],1),e._v(" "),n("v-col",[e.instruction.respReceiverHintName?n("v-chip",{staticClass:"caption item__value black--text lighten-1",attrs:{small:"",color:"grey-lighten-3",label:"",outlined:""}},[e._v("\n        "+e._s(e.respReceiverHintName)+"\n      ")]):e._e()],1)],1),e._v(" "),n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Получатель:")])],1),e._v(" "),n("v-col",[e._v(" "+e._s(e.instruction.receiverName)+" ")])],1),e._v(" "),e.instruction.useControl?n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Получатель отчёта:")])],1),e._v(" "),n("v-col",[e.instruction.reportReceiverName?[e._v(" "+e._s(e.instruction.reportReceiverName)+" ")]:n("translate",[e._v("Не задан")])],2)],1):e._e(),e._v(" "),e.instruction.useControl?n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Контролёр:")])],1),e._v(" "),n("v-col",[e.instruction.execAuditorName?[e._v(" "+e._s(e.instruction.execAuditorName)+" ")]:n("translate",[e._v("Не задан")])],2)],1):e._e(),e._v(" "),n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Задание выдал:")])],1),e._v(" "),n("v-col",[e.instruction.initiatorName?[e._v(" "+e._s(e.instruction.initiatorName)+" ")]:n("translate",[e._v("Не задан")])],2)],1),e._v(" "),e.instruction.isReport?n("v-row",[n("v-col",{staticClass:"body-1 font-weight-bold pl-0"},[n("translate",[e._v("Комментарий:")])],1),e._v(" "),n("v-col",[e.instruction.comment?[e._v(" "+e._s(e.instruction.comment)+" ")]:n("translate",[e._v("Не задан")])],2)],1):e._e(),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("div",{staticClass:"ml-1 column"},[n("message-template-renderer",{attrs:{instructionInfo:e.instructionInfo,"template-type":e.templateType,context:e.actionContext}})],1)])],1)],1)},p=[],h=n(97625),m=n(40471),f=n(31025),g=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let y=class InstructionBasicInfoComponent extends g.Vue{constructor(){super(...arguments),this.instructionCreateDate=null,this.execDate=null,this.templateType=m.$.ViewParams}onInstructionChanged(){var e,t,n;this.instructionCreateDate=new Date(null===(e=this.instruction)||void 0===e?void 0:e.createDateTime),(null===(t=this.instruction)||void 0===t?void 0:t.executionEndDate)?this.execDate=new Date(null===(n=this.instruction)||void 0===n?void 0:n.executionEndDate):this.execDate=null}printSendType(e){return h.X.getSentType(e).split(" ",2).join(" ")}get execDateString(){return this.execDate?f.C.dateToString(this.execDate):null}get instructionCreateDateString(){return f.C.dateToString(this.instructionCreateDate)}get isOverdue(){if(!this.execDate)return!1;const e=new Date;return e>this.execDate}get respReceiverHintName(){return"CoExecutor"===this.instruction.respReceiverResName?this.$gettext("Я соисполнитель"):"ResponsibleExecutor"===this.instruction.respReceiverResName?this.$gettext("Я ответственный исполнитель"):""}};__decorate([(0,g.Prop)(),__metadata("design:type",Object)],y.prototype,"instruction",void 0),__decorate([(0,g.Prop)(),__metadata("design:type",Object)],y.prototype,"instructionInfo",void 0),__decorate([(0,g.Prop)(),__metadata("design:type",String)],y.prototype,"creatorInfo",void 0),__decorate([(0,g.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],y.prototype,"isPreview",void 0),__decorate([(0,g.Prop)({type:Boolean,default:!1}),__metadata("design:type",Boolean)],y.prototype,"isInitialMessage",void 0),__decorate([(0,g.Prop)(),__metadata("design:type",Boolean)],y.prototype,"limitedMode",void 0),__decorate([(0,g.Prop)(),__metadata("design:type",Object)],y.prototype,"actionContext",void 0),__decorate([(0,g.Watch)("instruction",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],y.prototype,"onInstructionChanged",null),y=__decorate([(0,g.Component)({})],y);const v=y,b=v;var C=n(51900),w=n(43453),_=n.n(w),x=n(93462),S=n(17024),I=n(66530),D=n(57894),R=(0,C.Z)(b,instructionBasicInfovue_type_template_id_d40365ce_scoped_true_render,p,!1,null,"d40365ce",null);const T=R.exports;_()(R,{VChip:x.Z,VCol:S.Z,VContainer:I.Z,VRow:D.Z});var P,O,instructionCommonInfovue_type_template_id_dc504126_scoped_true_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{staticClass:"no-gutters",class:{"instruction-wrapper":e.isPreview||e.limitedMode}},[n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.loading}}),e._v(" "),n("div",{staticStyle:{display:"none"}},[n("message-template-renderer",{attrs:{"instruction-info":e.instructionInfo,"template-type":e.templateType,context:e.actionContext},on:{"set-card-actions":e.onSetCardActions}})],1),e._v(" "),e.isPreview||e.limitedMode?[n("v-card",{staticClass:"instruction-main mb-0 pt-2 elevation-0"},[n("v-col",{staticClass:"px-2 ml-1",class:{"pb-0":e.isPreview,"pb-3":!e.isPreview},attrs:{cols:"12"}},[n("v-col",{key:e.instruction.id,attrs:{cols:"12"}},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.instruction.isReport&&!e.isProject?n("div",e._g({staticClass:"triangle-topleft",class:"triangle-topleft--"+e.reportStatusColor},i)):e._e()]}}])},[e._v(" "),n("span",[e._v(e._s(e.instruction.stateName))])]),e._v(" "),n("span",{staticClass:"subheading font-weight-bold mr-4 black--text lighten-1"},[e._v(e._s(e.creatorName))]),e._v(" "),n("span",{staticClass:"grey--text"},[e._v(" "+e._s(e.instructionCreateDateString)+" ")]),e._v(" "),n("span",{staticClass:"grey--text mx-2"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text"},[e._v(e._s(e.instruction.instructionTypeName))]),e._v(" "),e.instruction.executionEndDate?n("span",{staticClass:"grey--text mx-2"},[e._v("|")]):e._e(),e._v(" "),e.instruction.executionEndDate?n("svg-icon",{staticClass:"svg-icon darken-3",class:{"error--text":e.isOverdue,"grey--text":!e.isOverdue},staticStyle:{transform:"translate3d(0px, 5px, 0)"},attrs:{icon:"event"}}):e._e(),e._v(" "),e.instruction.executionEndDate?n("span",{class:{"error--text":e.isOverdue,"grey--text":!e.isOverdue}},[e._v(e._s(e.execDateString))]):e._e(),e._v(" "),e.instruction.isReport?e._e():[n("span",{staticClass:"grey--text mx-2"},[e._v("|")]),e._v(" "),e.isMobile?e._e():n("span",{staticClass:"ml-2 sm-text info--text status",attrs:{id:"liStatus","data-test-id":"liStatus"}},[e._v("\n              "+e._s(e.instruction.stateName)+"\n            ")])]],2),e._v(" "),e.instructionInfo&&e.instructionInfo.instruction.respReceiverHintName?n("v-chip",{staticClass:"ml-0 mb-0 mt-0 status font-weight-1 black--text lighten-1",attrs:{small:"",color:"grey-lighten-3",label:"",outlined:"","data-testid":"respReceiverBtn"}},[e._v("\n          "+e._s(e.respReceiverHintName)+"\n        ")]):e._e(),e._v(" "),e.hasText?n("v-col",{staticClass:"mb-2"},[n("span",{staticClass:"body-1 instruction-text black--text lighten-1"},[e._v(e._s(e.instruction.text))])]):e._e()],1),e._v(" "),e.isPreview?n("v-card-actions",{staticClass:"pa-0",attrs:{flat:""}},[n("v-col",{staticClass:"pl-1 pb-1"},[n("action-panel",{attrs:{visible:!0,context:e.actionContext,loading:e.loading,forceIsMobile:e.forceIsMobile,"custom-actions":e.customActions},on:{"action-result":e.onActionResult,"action-processing":e.onActionProcessing}})],1)],1):e._e()],1),e._v(" "),n("div",{staticClass:"grey--border lighten-2",attrs:{id:"expansion-wrapper"}},[n("v-expansion-panels",{staticClass:"pb-3 elevation-0",attrs:{accordion:"",multiple:"",flat:""},on:{input:e.changeListVisibility},model:{value:e.expansionPanelItemOpened,callback:function(t){e.expansionPanelItemOpened=t},expression:"expansionPanelItemOpened"}},[n("v-expansion-panel",{staticClass:"pl-1",attrs:{id:"iciCustom",expand:""}},[n("v-expansion-panel-content",[n("message-template-renderer",{attrs:{instructionInfo:e.instructionInfo,"template-type":e.templateType,context:e.actionContext}})],1)],1),e._v(" "),n("v-expansion-panel",{staticClass:"pl-1",attrs:{id:"iciFiles",disabled:!e.files||!e.files.length}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("div",{class:{"black--text":e.files&&e.files.length,"grey--text panel-header":!e.files||!e.files.length}},[n("translate",{staticClass:"body-2 font-weight-bold"},[e._v("Приложенные файлы")])],1)]),e._v(" "),e.files&&e.files.length?n("v-expansion-panel-content",[n("v-card",{staticClass:"elevation-0 ml-2"},[n("attach-doc",{attrs:{limitedMode:e.limitedMode,instruction:e.instruction,files:e.files,"show-dropzone":!1}})],1)],1):e._e()],1),e._v(" "),e.instruction.isReport?n("v-expansion-panel",{staticClass:"pl-1",attrs:{id:"iciAnswerDoc",disabled:!e.instruction.documentID}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0",class:{"black--text lighten-1":e.instruction.documentID,"grey--text panel-header":!e.instruction.documentID}},[e._v("\n              "+e._s(e.$gettext("Ответный документ"))+"\n            ")])]),e._v(" "),e.instruction.documentID?n("v-expansion-panel-content",[n("v-card",{staticClass:"elevation-0 ml-2"},[e.showExpand?n("v-row",{staticClass:"external-link grey lighten-5 mb-2 ml-3 pl-3 py-1 no-gutters",staticStyle:{border:"1px solid"},attrs:{align:"center",justify:"space-between"}},[e.reportDocumentInfo?n("v-col",{attrs:{xl:"10",lg:"10",md:"10",sm:"10",cols:"10"},on:{dblclick:function(t){return e.goToDoc(e.reportDocument)}}},[n("span",{staticClass:"primary--text font-weight-regular body-2 header",staticStyle:{"text-decoration":"underline"},attrs:{id:"liDocName","data-test-id":"liDocName"}},[e._v("\n                    №"+e._s(e.reportDocumentInfo.RegistrationNumber)+"\n                  ")]),e._v(" "),n("span",{staticClass:"grey--text lighten-1 pipe"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text lighten-1 pipe body-1 font-weight-light"},[e._v(e._s(e._f("date")(e.reportDocumentInfo.RegistrationDate,"DD.MM.YYYY")))]),e._v(" "),n("span",{staticClass:"grey--text lighten-1 pipe"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text lighten-1 pipe body-1 font-weight-light"},[e._v(e._s(e.reportDocumentInfo.DocumentType))]),e._v(" "),e.reportDocumentInfo.Annotation?n("span",{staticClass:"font-weight-regular body-1 nowrap-text grey--text darken-3"},[e._v("\n                    "+e._s(e.reportDocumentInfo.Annotation)+"\n                  ")]):e._e()]):e._e(),e._v(" "),n("v-col",[n("v-row",{staticClass:"mr-3",attrs:{align:"center",justify:"end"}},[e.reportDocumentInfo&&e.reportDocumentInfo.HasSheafs?n("v-icon",{staticClass:"mr-1",attrs:{color:"grey lighten-3y"}},[e._v("link")]):e._e(),e._v(" "),e.reportDocumentInfo&&e.reportDocumentInfo.HasFiles?n("v-icon",{staticClass:"mr-1",attrs:{color:"grey lighten-3y"}},[e._v("attach_file")]):e._e(),e._v(" "),e.actionContext.isDialog?e._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.isMobile||e.limitedMode?e._e():n("v-btn",e._g({staticClass:"square-sm-button rounded-button grey lighten-3",attrs:{id:"iciOpenDocBtn",outlined:""},on:{click:function(t){return e.onOpenDoc(!1,"resp-doc")}}},i),[n("svg-icon",{staticClass:"svg-icon",class:e.changeIconColor("base-doc"),attrs:{id:"base-doc-preview-icon",icon:"chrome_reader_mode"}})],1)]}}],null,!1,370300760)},[e._v(" "),n("translate",[e._v("Открыть документ в доп. области")])],1),e._v(" "),e.isMobile&&!e.limitedMode?n("v-icon",{staticClass:"mr-1",attrs:{id:"iciOpenDocIcon",color:"primary",size:"30"},on:{click:function(t){return e.goToDoc(e.reportDocument)}}},[e._v("chevron_right")]):e._e()],1)],1)],1):e._e()],1)],1):e._e()],1):e._e(),e._v(" "),n("v-expansion-panel",{key:"iciDoc",staticClass:"pl-1",attrs:{id:"iciDoc",disabled:!e.instruction.baseDocumentID}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("div",{staticClass:"body-2 font-weight-bold py-0",class:{"black--text lighten-1":e.instruction.baseDocumentID,"grey--text panel-header":!e.instruction.baseDocumentID}},[n("translate",[e._v("Документ-основание")])],1)]),e._v(" "),e.instruction.baseDocumentID?n("v-expansion-panel-content",[e.showExpand?n("v-row",{staticClass:"external-link grey lighten-5 mb-2 pl-3 py-1 ml-2 no-gutters sm-text",staticStyle:{border:"1px solid"},attrs:{align:"end",justify:"space-between"}},[n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.docLoading}}),e._v(" "),e.baseDocumentInfo?n("v-col",{attrs:{cols:"12"},on:{dblclick:function(t){return e.goToDoc(e.baseDocument)}}},[n("span",{staticClass:"primary--text font-weight-regular header",staticStyle:{"text-decoration":"underline"},attrs:{id:"liDocName","data-test-id":"liDocName"}},[e._v("\n                  №"+e._s(e.baseDocumentInfo.RegistrationNumber)+"\n                ")]),e._v(" "),n("span",{staticClass:"grey--text pipe"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text pipe"},[e._v(e._s(e._f("date")(e.baseDocumentInfo.RegistrationDate,"DD.MM.YYYY")))]),e._v(" "),n("span",{staticClass:"grey--text pipe"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text pipe"},[e._v(e._s(e.baseDocumentInfo.DocumentType))])]):e._e(),e._v(" "),n("v-col",{attrs:{cols:"12","no-gutters":""}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"8"}},[e.baseDocumentInfo&&e.baseDocumentInfo.Annotation?n("span",{staticClass:"font-weight-regular nowrap-text mt-1 black--text lighten-1"},[e._v("\n                      "+e._s(e.baseDocumentInfo.Annotation)+"\n                    ")]):e._e()]),e._v(" "),n("v-col",{staticClass:"pr-2 ml-auto",attrs:{cols:"auto"}},[e.baseDocumentInfo&&e.baseDocumentInfo.HasSheafs?n("v-icon",{staticClass:"medium-icon grey--text darken-3"},[e._v("link")]):e._e(),e._v(" "),e.baseDocumentInfo&&e.baseDocumentInfo.HasFiles?n("v-icon",{staticClass:"medium-icon grey--text darken-3"},[e._v("attach_file")]):e._e(),e._v(" "),e.actionContext.isDialog?e._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.isMobile||e.limitedMode?e._e():n("v-btn",e._g({staticClass:"elevation-0 mx-0 square-sm-button",class:"base-doc"===e.activeIconName?"grey-lighten-3":"transparent",attrs:{id:"iciOpenDocBtn"},on:{click:function(t){return e.onOpenDoc(!0,"base-doc")}}},i),[n("svg-icon",{staticClass:"svg-icon",class:"base-doc"===e.activeIconName?"primary--text":"grey--text darken-3",attrs:{id:"base-doc-preview-icon",icon:"chrome_reader_mode"}})],1)]}}],null,!1,2027778740)},[e._v(" "),n("translate",[e._v("Открыть документ в доп. области")])],1),e._v(" "),e.isMobile&&!e.limitedMode?n("v-icon",{staticClass:"mr-1",attrs:{id:"iciOpenDocIcon",color:"primary",size:"30"},on:{click:function(t){return e.goToDoc(e.baseDocument)}}},[e._v("chevron_right")]):e._e()],1)],1)],1)],1):e._e()],1):e._e()],1),e._v(" "),n("v-expansion-panel",{staticClass:"pl-1",attrs:{id:"iciInfo"}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0 black--text lighten-1"},[e._v("\n              "+e._s(e.$gettext("Информация о сообщении"))+"\n            ")])]),e._v(" "),n("v-expansion-panel-content",[n("v-card",{staticClass:"elevation-0 ml-2"},[n("v-col",{attrs:{id:"insrtuction-basic-info"}},[n("ibasic-info",{attrs:{creatorInfo:e.creatorInfo,instruction:e.instruction,instructionInfo:e.instructionInfo,isPreview:e.isPreview,"limited-mode":e.limitedMode,"action-context":e.actionContext}})],1)],1)],1)],1),e._v(" "),n("v-expansion-panel",{key:"iciTree",staticClass:"pl-1",class:{"d-none":e.limitedMode&&!e.instruction.baseDocumentID},attrs:{id:"iciTree",disabled:!e.instruction.baseDocumentID}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("div",{class:{"black--text lighten-1":e.instruction.baseDocumentID,"grey--text panel-header":!e.instruction.baseDocumentID}},[n("translate",{staticClass:"body-2 font-weight-bold"},[e._v("Дерево сообщений")])],1)]),e._v(" "),e.instruction.baseDocumentID?n("v-expansion-panel-content",[e.instruction.baseDocumentID?n("v-card",{staticClass:"elevation-0 ml-2"},[e.instruction?n("ld-instruction-tree",{attrs:{id:e.instruction.id,instructionListVisibility:!0,instructionParent:e.instruction,"action-context":e.actionContext},on:{"update-counter":function(t){e.counter=t}}}):e._e()],1):e._e()],1):e._e()],1),e._v(" "),n("v-expansion-panel",{staticClass:"pl-1",class:{"d-none":e.limitedMode&&!e.instruction.baseDocumentID},attrs:{id:"iciAgree",disabled:!e.instruction.baseDocumentID}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0",class:{"black--text lighten-1":e.instruction.baseDocumentID,"grey--text panel-header":!e.instruction.baseDocumentID}},[e._v("\n              "+e._s(e.$gettext("Лист согласования"))+"\n            ")])]),e._v(" "),e.instruction.baseDocumentID?n("v-expansion-panel-content",[n("v-card",{staticClass:"ml-2 elevation-0"},[n("ld-agree-list",{attrs:{id:e.instruction.id,visibility:e.agreeListVisibility,contentType:e.actionContext.contentType}})],1)],1):e._e()],1),e._v(" "),e.instruction.isReport?n("v-expansion-panel",{staticClass:"pl-1",attrs:{id:"iciSrcMsg"}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0 black--text lighten-1"},[e._v("\n              "+e._s(e.$gettext("Исходное сообщение"))+"\n            ")])]),e._v(" "),n("v-expansion-panel-content",[e.initialMessage?n("v-card",{staticClass:"ml-2 elevation-0"},[n("div",{staticClass:"d-flex"},[n("div",{staticClass:"flex-basis-100",attrs:{id:"insrtuction-basic-info"}},[n("ibasic-info",{attrs:{instruction:e.initialMessage.instruction,instructionInfo:e.initialMessage.instructionInfo,"action-context":e.actionContext,isInitialMessage:!0}})],1),e._v(" "),e.isMobile||e.limitedMode?e._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"square-sm-button rounded-button grey lighten-3",attrs:{outlined:""},on:{click:function(t){return e.onOpenInstruction(e.initialMessage.instruction.id,"instruction")}}},i),[n("svg-icon",{staticClass:"svg-icon",class:e.changeIconColor("instruction"),attrs:{id:"resp-doc-preview-icon",icon:"chrome_reader_mode"}})],1)]}}],null,!1,3463422587)},[e._v(" "),n("translate",{staticClass:"nowrap"},[e._v("Открыть сообщение в доп. области")])],1),e._v(" "),e.isMobile&&!e.limitedMode?n("v-icon",{staticClass:"mr-1",attrs:{color:"primary",size:"30"},on:{click:function(t){return e.goToInstruction(e.initialMessage.instruction.id)}}},[e._v("\n                  chevron_right\n                ")]):e._e()],1)]):e._e()],1)],1):e._e(),e._v(" "),e.instruction.reportID&&!e.instruction.isReport?n("v-expansion-panel",{staticClass:"pl-1",attrs:{id:"iciReport"}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0 black--text lighten-1"},[e._v(e._s(e.$gettext("Отчёт по сообщению")))])]),e._v(" "),e.report?n("v-expansion-panel-content",[n("v-card",{staticClass:"elevation-0 ml-2"},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{id:"insrtuction-basic-info"}},[n("ibasic-info",{attrs:{instruction:e.report.instruction,instructionInfo:e.report.instructionInfo,isInitialMessage:!0,"action-context":e.actionContext}})],1),e._v(" "),e.isMobile||e.limitedMode?e._e():n("v-btn",{staticClass:"square-sm-button rounded-button grey lighten-3",attrs:{outlined:""},on:{click:function(t){return e.onOpenInstruction(e.report.instruction.id,"instruction")}}},[n("svg-icon",{staticClass:"svg-icon",class:e.changeIconColor("instruction"),attrs:{id:"resp-doc-preview-icon",icon:"chrome_reader_mode"}})],1),e._v(" "),e.isMobile&&!e.limitedMode?n("v-icon",{staticClass:"mr-1",attrs:{color:"primary",size:"30"},on:{click:function(t){return e.goToInstruction(e.report.instruction.id)}}},[e._v("chevron_right")]):e._e()],1)],1)],1):e._e()],1):e._e(),e._v(" "),e.limitedMode?e._e():n("v-expansion-panel",{staticClass:"pl-1",attrs:{id:"iciEsign",disabled:!e.hasElectronicSign}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0",class:{"black--text lighten-1":e.hasElectronicSign,"grey--text panel-header":!e.hasElectronicSign}},[e._v("\n              "+e._s(e.$gettext("Данные об электронной подписи"))+"\n            ")])]),e._v(" "),e.hasElectronicSign?n("v-expansion-panel-content",[n("v-card",{staticClass:"ml-2 elevation-0"},[n("v-col",{staticClass:"px-2"},[n("esign-viewer",{attrs:{contentType:e.instructionContentType,id:e.instruction.id}})],1)],1)],1):e._e()],1)],1)],1)]:[n("div",{staticClass:"instruction-area"},[n("div",[n("v-col",{staticClass:"pt-2 pb-2"},[n("span",{staticClass:"subheading font-weight-bold mr-4 black--text lighten-1"},[e._v(e._s(e.creatorName))])]),e._v(" "),n("v-col",{staticClass:"pb-2"},[n("span",{staticClass:"grey--text"},[e._v(" "+e._s(e.instructionCreateDateString))]),e._v(" "),n("span",{staticClass:"grey--text mx-2"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text"},[e._v(e._s(e.instruction.instructionTypeName))]),e._v(" "),e.instruction.executionEndDate?n("span",{staticClass:"grey--text mx-2"},[e._v("|")]):e._e(),e._v(" "),e.instruction.executionEndDate?n("svg-icon",{staticClass:"svg-icon darken-3",class:{"error--text":e.isOverdue,"grey--text":!e.isOverdue},staticStyle:{transform:"translate3d(0px, 5px, 0)"},attrs:{icon:"event"}}):e._e(),e._v(" "),e.instruction.executionEndDate?n("span",{class:{"error--text":e.isOverdue,"grey--text":!e.isOverdue}},[e._v(e._s(e.execDateString))]):e._e()],1),e._v(" "),n("v-col",{staticClass:"pb-2"},[e.isMobile?e._e():n("v-chip",{staticClass:"ml-0 mb-0 mt-0 mr-1 status font-weight-1",attrs:{small:"",outlined:"",label:"",color:"info",id:"liStatus","data-test-id":"liStatus"}},[e._v("\n            "+e._s(e.instruction.stateName)+"\n          ")]),e._v(" "),e.instructionInfo&&e.instructionInfo.instruction.respReceiverHintName?n("v-chip",{staticClass:"ml-0 mb-0 mt-0 status font-weight-1 black--text lighten-1",attrs:{small:"",color:"grey-lighten-3",label:"",outlined:"","data-testid":"respReceiverBtn"}},[e._v(e._s(e.respReceiverHintName)+"\n          ")]):e._e()],1),e._v(" "),e.hasText?n("v-col",{staticClass:"pb-2"},[n("span",{staticClass:"body-1 instruction-text"},[e._v(e._s(e.instruction.text))])]):e._e(),e._v(" "),n("v-expansion-panels",{staticClass:"elevation-0",attrs:{multiple:"",accordion:"",flat:""},on:{input:e.changeListVisibility},model:{value:e.expandPanelLeft,callback:function(t){e.expandPanelLeft=t},expression:"expandPanelLeft"}},[n("v-expansion-panel",{attrs:{expand:""}},[n("v-expansion-panel-content",{attrs:{id:"iciCustom"}},[n("message-template-renderer",{attrs:{instructionInfo:e.instructionInfo,"template-type":e.templateType,context:e.actionContext}})],1)],1),e._v(" "),n("v-expansion-panel",{attrs:{id:"iciFiles",disabled:!e.files||!e.files.length}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("div",{class:{"black--text":e.files&&e.files.length,"grey--text panel-header":!e.files||!e.files.length}},[n("translate",{staticClass:"body-2 font-weight-bold"},[e._v("Приложенные файлы")])],1)]),e._v(" "),e.files&&e.files.length?n("v-expansion-panel-content",[n("v-card",{staticClass:"ml-2 elevation-0"},[n("attach-doc",{attrs:{limitedMode:e.limitedMode,instruction:e.instruction,files:e.files,"show-dropzone":!1}})],1)],1):e._e()],1),e._v(" "),n("v-expansion-panel",{attrs:{id:"iciInfo"}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0 black--text lighten-1"},[e._v(e._s(e.$gettext("Информация о сообщении")))])]),e._v(" "),n("v-expansion-panel-content",[n("v-card",{staticClass:"ml-2 elevation-0"},[n("v-col",{attrs:{id:"insrtuction-basic-info"}},[n("ibasic-info",{attrs:{creatorInfo:e.creatorInfo,instruction:e.instruction,instructionInfo:e.instructionInfo,isPreview:e.isPreview,"limited-mode":e.limitedMode,"action-context":e.actionContext}})],1)],1)],1)],1),e._v(" "),n("v-expansion-panel",{class:{"d-none":e.limitedMode},attrs:{id:"iciAgree",disabled:!e.instruction.baseDocumentID}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold",class:{"black--text lighten-1 py-0":e.instruction.baseDocumentID,"grey--text panel-header":!e.instruction.baseDocumentID}},[e._v("\n                "+e._s(e.$gettext("Лист согласования"))+"\n              ")])]),e._v(" "),e.instruction.baseDocumentID?n("v-expansion-panel-content",[n("v-card",{staticClass:"pl-1 ml-2 elevation-0"},[n("ld-agree-list",{attrs:{id:e.instruction.id,visibility:e.agreeListVisibility,contentType:e.actionContext.contentType}})],1)],1):e._e()],1),e._v(" "),e.instruction.isReport?n("v-expansion-panel",{attrs:{id:"iciSrcMsg"}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0 black--text lighten-1"},[e._v(e._s(e.$gettext("Исходное сообщение")))])]),e._v(" "),n("v-expansion-panel-content",[e.initialMessage?n("v-card",{staticClass:"elevation-0"},[n("div",{staticClass:"d-flex"},[n("div",{staticClass:"flex-basis-100",attrs:{id:"insrtuction-basic-info"}},[n("ibasic-info",{attrs:{instruction:e.initialMessage.instruction,instructionInfo:e.initialMessage.instructionInfo,"action-context":e.actionContext,isInitialMessage:!0}})],1),e._v(" "),e.isMobile||e.limitedMode?e._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"square-sm-button rounded-button grey lighten-3",attrs:{outlined:""},on:{click:function(t){return e.onOpenInstruction(e.initialMessage.instruction.id,"instruction")}}},i),[n("svg-icon",{staticClass:"svg-icon",class:e.changeIconColor("instruction"),attrs:{id:"resp-doc-preview-icon",icon:"chrome_reader_mode"}})],1)]}}],null,!1,3463422587)},[e._v(" "),n("translate",[e._v("Открыть сообщение в доп. области")])],1),e._v(" "),e.isMobile&&!e.limitedMode?n("v-icon",{staticClass:"mr-1",attrs:{color:"primary",size:"30"},on:{click:function(t){return e.goToInstruction(e.initialMessage.instruction.id)}}},[e._v("\n                    chevron_right\n                  ")]):e._e()],1)]):e._e()],1)],1):e._e(),e._v(" "),e.instruction.reportID&&!e.instruction.isReport?n("v-expansion-panel",{attrs:{id:"iciReport"}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0 black--text lighten-1"},[e._v(e._s(e.$gettext("Отчёт по сообщению")))])]),e._v(" "),n("v-expansion-panel-content",[n("v-card",{staticClass:"elevation-0"},[n("div",{staticClass:"d-flex"},[n("div",{staticClass:"flex-basis-100",attrs:{id:"insrtuction-basic-info"}},[e.report?n("ibasic-info",{attrs:{instruction:e.report.instruction,instructionInfo:e.report.instructionInfo,isInitialMessage:!0,"action-context":e.actionContext}}):e._e()],1),e._v(" "),e.isMobile||e.limitedMode?e._e():n("v-btn",{staticClass:"square-sm-button rounded-button grey lighten-3",attrs:{outlined:""},on:{click:function(t){return e.onOpenInstruction(e.report.instruction.id,"instruction")}}},[n("svg-icon",{staticClass:"svg-icon",class:e.changeIconColor("instruction"),attrs:{id:"resp-doc-preview-icon",icon:"chrome_reader_mode"}})],1),e._v(" "),e.isMobile&&!e.limitedMode?n("v-icon",{staticClass:"mr-1",attrs:{color:"primary",size:"30"},on:{click:function(t){return e.goToInstruction(e.report.instruction.id)}}},[e._v("\n                    chevron_right\n                  ")]):e._e()],1)])],1)],1):e._e(),e._v(" "),e.hasElectronicSign?n("v-expansion-panel",{class:{"d-none":e.limitedMode},attrs:{id:"iciEsign"}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0 black--text lighten-1"},[e._v(e._s(e.$gettext("Данные об электронной подписи")))])]),e._v(" "),n("v-expansion-panel-content",[n("v-card",{staticClass:"elevation-0",staticStyle:{"min-width":"300px"}},[n("v-col",[n("esign-viewer",{attrs:{contentType:e.instructionContentType,id:e.instruction.id}})],1)],1)],1)],1):e._e()],1)],1),e._v(" "),n("div",[n("v-expansion-panels",{staticClass:"elevation-0",attrs:{multiple:"",accordion:"",flat:""},on:{input:e.changeListVisibility},model:{value:e.expandPanelRight,callback:function(t){e.expandPanelRight=t},expression:"expandPanelRight"}},[!e.limitedMode&&e.instruction.isReport?n("v-expansion-panel",{attrs:{id:"iciAnswerDoc",disabled:!e.instruction.documentID}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0",class:{"black--text lighten-1":e.instruction.documentID,"grey--text panel-header":!e.instruction.documentID}},[e._v("\n                "+e._s(e.$gettext("Ответный документ"))+"\n              ")])]),e._v(" "),e.instruction.documentID?n("v-expansion-panel-content",[n("v-card",{staticClass:"elevation-0"},[e.showExpand?n("v-row",{staticClass:"external-link grey lighten-5 mb-2 ml-3 pl-3 py-1 no-gutters",staticStyle:{border:"1px solid"},attrs:{align:"center",justify:"space-between"}},[e.reportDocumentInfo?n("v-col",{attrs:{xl:"10",lg:"10",md:"10",sm:"10",cols:"10"},on:{dblclick:function(t){return e.goToDoc(e.reportDocument)}}},[n("span",{staticClass:"primary--text font-weight-regular body-2 header",staticStyle:{"text-decoration":"underline"},attrs:{id:"liDocName","data-test-id":"liDocName"}},[e._v("\n                      №"+e._s(e.reportDocumentInfo.RegistrationNumber)+"\n                    ")]),e._v(" "),n("span",{staticClass:"grey--text lighten-1 pipe"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text lighten-1 pipe body-1 font-weight-light"},[e._v(e._s(e._f("date")(e.reportDocumentInfo.RegistrationDate,"DD.MM.YYYY")))]),e._v(" "),n("span",{staticClass:"grey--text lighten-1 pipe"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text lighten-1 pipe body-1 font-weight-light"},[e._v(e._s(e.reportDocumentInfo.DocumentType))]),e._v(" "),e.reportDocumentInfo.Annotation?n("span",{staticClass:"font-weight-regular body-1 nowrap-text grey--text darken-3"},[e._v("\n                      "+e._s(e.reportDocumentInfo.Annotation)+"\n                    ")]):e._e()]):e._e(),e._v(" "),n("v-col",[n("v-row",{staticClass:"mr-3",attrs:{align:"center",justify:"end"}},[e.reportDocumentInfo&&e.reportDocumentInfo.HasSheafs?n("v-icon",{staticClass:"mr-1",attrs:{color:"grey lighten-3y"}},[e._v("link")]):e._e(),e._v(" "),e.reportDocumentInfo&&e.reportDocumentInfo.HasFiles?n("v-icon",{staticClass:"mr-1",attrs:{color:"grey lighten-3y"}},[e._v("attach_file")]):e._e(),e._v(" "),e.actionContext.isDialog?e._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.isMobile||e.limitedMode?e._e():n("v-btn",e._g({staticClass:"square-sm-button rounded-button grey lighten-3",attrs:{id:"iciOpenDocBtn",outlined:""},on:{click:function(t){return e.onOpenDoc(!1,"resp-doc")}}},i),[n("svg-icon",{staticClass:"svg-icon",class:e.changeIconColor("base-doc"),attrs:{id:"base-doc-preview-icon",icon:"chrome_reader_mode"}})],1)]}}],null,!1,370300760)},[e._v(" "),n("translate",[e._v("Открыть документ в доп. области")])],1),e._v(" "),e.isMobile&&!e.limitedMode?n("v-icon",{staticClass:"mr-1",attrs:{id:"iciOpenDocIcon",color:"primary",size:"30"},on:{click:function(t){return e.goToDoc(e.reportDocument)}}},[e._v("chevron_right")]):e._e()],1)],1)],1):e._e()],1)],1):e._e()],1):e._e(),e._v(" "),n("v-expansion-panel",{key:"iciDoc",attrs:{id:"iciDoc",disabled:!e.instruction.baseDocumentID}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("div",{staticClass:"body-2 font-weight-bold",class:{"black--text lighten-1":e.instruction.baseDocumentID,"grey--text panel-header":!e.instruction.baseDocumentID}},[n("translate",[e._v("Документ-основание")])],1)]),e._v(" "),e.instruction.baseDocumentID?n("v-expansion-panel-content",{staticClass:"special"},[e.showExpand?n("v-row",{staticClass:"external-link grey lighten-5 mb-2 ml-2 pl-3 py-1 no-gutters sm-text",staticStyle:{border:"1px solid"},attrs:{align:"end",justify:"space-between"}},[n("loader",{attrs:{options:{transparent:!0,global:!1},visible:e.docLoading}}),e._v(" "),e.baseDocumentInfo?n("v-col",{attrs:{cols:"12"},on:{dblclick:function(t){return e.goToDoc(e.baseDocument)}}},[n("span",{staticClass:"primary--text font-weight-regular header",staticStyle:{"text-decoration":"underline"},attrs:{id:"liDocName","data-test-id":"liDocName"}},[e._v("\n                    №"+e._s(e.baseDocumentInfo.RegistrationNumber)+"\n                  ")]),e._v(" "),n("span",{staticClass:"grey--text pipe"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text pipe"},[e._v(e._s(e._f("date")(e.baseDocumentInfo.RegistrationDate,"DD.MM.YYYY")))]),e._v(" "),n("span",{staticClass:"grey--text pipe"},[e._v("|")]),e._v(" "),n("span",{staticClass:"grey--text pipe"},[e._v(e._s(e.baseDocumentInfo.DocumentType))])]):e._e(),e._v(" "),n("v-col",{attrs:{cols:"12","no-gutters":""}},[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",{attrs:{cols:"10"}},[e.baseDocumentInfo&&e.baseDocumentInfo.Annotation?n("span",{staticClass:"font-weight-regular nowrap-text mt-1"},[e._v("\n                        "+e._s(e.baseDocumentInfo.Annotation)+"\n                      ")]):e._e()]),e._v(" "),n("v-col",{staticClass:"pr-2 ml-auto",attrs:{cols:"auto"}},[e.baseDocumentInfo&&e.baseDocumentInfo.HasSheafs?n("v-icon",{staticClass:"medium-icon grey--text darken-3"},[e._v("link")]):e._e(),e._v(" "),e.baseDocumentInfo&&e.baseDocumentInfo.HasFiles?n("v-icon",{staticClass:"medium-icon grey--text darken-3"},[e._v("attach_file")]):e._e(),e._v(" "),e.actionContext.isDialog?e._e():n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[e.isMobile||e.limitedMode?e._e():n("v-btn",e._g({staticClass:"elevation-0 mx-0 square-sm-button",class:"base-doc"===e.activeIconName?"grey-lighten-3":"transparent",attrs:{id:"iciOpenDocBtn",icon:""},on:{click:function(t){return e.onOpenDoc(!0,"base-doc")}}},i),[n("svg-icon",{staticClass:"svg-icon",class:"base-doc"===e.activeIconName?"primary--text":"grey--text darken-3",attrs:{id:"base-doc-preview-icon",icon:"chrome_reader_mode"}})],1)]}}],null,!1,224976265)},[e._v(" "),n("translate",[e._v("Открыть документ в доп. области")])],1),e._v(" "),e.isMobile&&!e.limitedMode?n("v-icon",{staticClass:"mr-1",attrs:{id:"iciOpenDocIcon",color:"primary",size:"30"},on:{click:function(t){return e.goToDoc(e.baseDocument)}}},[e._v("chevron_right")]):e._e()],1)],1)],1)],1):e._e()],1):e._e()],1),e._v(" "),e.instruction.baseDocumentID?n("v-expansion-panel",{key:"iciTree",class:{"d-none":e.limitedMode},attrs:{id:"iciTree"}},[n("v-expansion-panel-header",{attrs:{"expand-icon":"chevron_right"}},[n("span",{staticClass:"body-2 font-weight-bold py-0 black--text lighten-1"},[e._v(e._s(e.$gettext("Дерево сообщений")))])]),e._v(" "),n("v-expansion-panel-content",[e.instruction.baseDocumentID?n("v-card",{staticClass:"elevation-0 ml-3"},[e.instruction?n("ld-instruction-tree",{attrs:{id:e.instruction.id,instructionListVisibility:!0,instructionParent:e.instruction,"action-context":e.actionContext},on:{"update-counter":function(t){e.counter=t}}}):e._e()],1):e._e()],1)],1):n("v-expansion-panel",{key:"iciTree",attrs:{id:"iciTree",disabled:""}},[n("v-expansion-panel-header",[n("span",{staticClass:"body-2 font-weight-bold grey--text panel-header"},[e._v(" "+e._s(e.$gettext("Дерево сообщений"))+" ")])])],1)],1)],1)])]],2)},k=[],F=n(95289),A=n(60917),$=n(76748),j=n(24578),E=n(26825),M=n(77896),N=n(54519),V=n(43206),B=n(24377),L=n(38484),U=n(70832),H=n(45904),Q=n(54486),instructionCommonInfovue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},instructionCommonInfovue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};(function(e){e[e["Custom"]=0]="Custom",e[e["Files"]=1]="Files",e[e["BaseDocument"]=2]="BaseDocument",e[e["InstructionTree"]=3]="InstructionTree",e[e["AgreeList"]=4]="AgreeList"})(P||(P={})),function(e){e[e["Custom"]=0]="Custom",e[e["BasicInformation"]=1]="BasicInformation",e[e["Files"]=2]="Files",e[e["BaseDocument"]=3]="BaseDocument",e[e["InstructionTree"]=4]="InstructionTree",e[e["AgreeList"]=5]="AgreeList"}(O||(O={}));let z=class InstructionCommonInfoComponent extends((0,H.mixins)(V.r)){constructor(){super(...arguments),this.loading=!1,this.docLoading=!1,this.instructionCreateDate=null,this.execDate=null,this.instructionListVisibility=!1,this.agreeListVisibility=!1,this.selected=!1,this.initialMessage=null,this.report=null,this.instructionContentType=r.zc.Instruction,this.counter=null,this.activeIconName="",this.expansionPanelItemOpened=[1],this.expandPanelLeft=[1],this.expandPanelRight=[0],this.updateDownloadFilesCounter=0}onInstructionChanged(e,t){t&&this.pubSubService.off(`refresh-message:${t.id}`),e&&(this.pubSubService.on(`refresh-message:${e.id}`,this.refresh,null,$.Q.Client),this.instructionCreateDate=new Date(e.createDateTime),this.execDate=new Date(e.executionEndDate)),this.fetchInitialMessage()}onBaseDocumentChanged(){this.instruction.baseDocumentID&&!this.baseDocument&&this.readDocument(this.instruction.baseDocumentID)}beforeDestroy(){this.instruction&&this.pubSubService.off(`refresh-message:${this.instruction.id}`)}getDocumentLink(){window.location.href=`landocs://document/${this.instruction.documentUid}`}changeListVisibility(e){this.isPreview||this.isMobile?(this.instructionListVisibility=e[O.InstructionTree],this.agreeListVisibility=e[O.AgreeList]):(this.instructionListVisibility=e[P.InstructionTree],this.agreeListVisibility=e[P.AgreeList])}onActionResult(e){if(e)switch(e.status){case F.Ao.RemoveFromFolder:break;case F.Ao.NeedUpdate:setTimeout((()=>this.refresh()),500);break;default:break}}onActionProcessing(e){this.loading=e}onOpenDoc(e,t){var n,i;const o=t;this.activeIconName=e?"base-doc":"resp-doc";const callbackOnPanelClose=()=>{this.activeIconName===o&&(this.activeIconName="")};this.$app.view(this.actionContext,r.zc.Document,null,e?null===(n=this.baseDocument)||void 0===n?void 0:n.id:null===(i=this.reportDocument)||void 0===i?void 0:i.id,callbackOnPanelClose)}onOpenInstruction(e,t){this.activeIconName=t;const callbackOnPanelClose=()=>{this.activeIconName===t&&(this.activeIconName="")};this.$app.view(this.actionContext,r.zc.Instruction,null,e,callbackOnPanelClose)}onDownLoadFilesCounter(){this.updateDownloadFilesCounter++}changeIconColor(e){return this.activeIconName===e?"primary--text":"grey--text darken-3"}goToDoc(e){e.data&&delete e.data;const t=Object.assign({},this.actionContext);t.contentType=r.zc.Document,t.folderId=e.journalID,t.folderName=e.attributes.ContainerName,t.entityViewMode=r.dS.View,t.document=[e],this.$app.view(t,r.zc.Document,null,String(e.id))}goToInstruction(e){this.$app.viewMessage(e,Object.assign({},this.actionContext))}readDocument(e){return __awaiter(this,void 0,void 0,(function*(){this.docLoading=!0;try{yield this.fetchDocument(new M.U_(e,r.dS.View))}finally{this.docLoading=!1}}))}refresh(){return __awaiter(this,void 0,void 0,(function*(){this.loading=!0;try{const e=this.instruction.folder?this.instruction.folder.id:null;yield this.fetchInstruction(new a.oE(this.instruction.id,e,!0))}finally{this.loading=!1}}))}fetchInitialMessage(){return __awaiter(this,void 0,void 0,(function*(){const e=this.instruction.folder?this.instruction.folder.id:null;this.instruction.isReport?(this.initialMessage=yield this.fetchInstruction(new a.oE(this.instruction.parentID,e,!1)),this.instruction.documentID&&!this.reportDocument&&this.readDocument(this.instruction.documentID)):this.instruction.reportID&&(this.report=yield this.fetchInstruction(new a.oE(this.instruction.reportID,e,!1)))}))}showExpand(){return!0}get baseDocument(){return this.instruction.baseDocumentID?this.getDocument(this.instruction.baseDocumentID,r.dS.View):null}get reportStatusColor(){return this.instruction.stateNameResName.includes("DONE_ERROR")?"red":"green"}get reportDocument(){return this.instruction.documentID?this.getDocument(this.instruction.documentID,r.dS.View):null}get reportDocumentInfo(){return this.reportDocument?this.reportDocument.attributes:null}get creatorName(){const e=this.instruction.creatorName;return e}get hasElectronicSign(){return this.eSignMode!==j.Ky.Disabled}get execDateString(){return!this.execDate||this.instruction.isReport?"":f.C.dateToString(this.execDate)}get instructionCreateDateString(){return f.C.shortDateFromISO(this.instructionCreateDate)}get hasText(){var e;return Boolean(null===(e=this.instruction.text)||void 0===e?void 0:e.trim())}get isOverdue(){if(!this.execDate)return!1;const e=new Date;return e>this.execDate}get isProject(){return this.instruction.stateNameResName===E.nJ.NotActive}get isActionCreateReport(){return this.actionType===s.xK.CreateReport}get respReceiverHintName(){return"CoExecutor"===this.instruction.respReceiverResName?this.$gettext("Я соисполнитель"):"ResponsibleExecutor"===this.instruction.respReceiverResName?this.$gettext("Я ответственный исполнитель"):""}get docActionContext(){return Object.assign(Object.assign({},this.actionContext),{entityViewMode:r.dS.List})}get baseDocumentInfo(){return this.baseDocument?this.baseDocument.attributes:null}get filesSectionOpened(){return this.isPreview||this.limitedMode?!!this.expansionPanelItemOpened.length&&this.expansionPanelItemOpened.some((e=>1===e)):!!this.expandPanelLeft.length&&this.expandPanelLeft.some((e=>1===e))}};instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Object)],z.prototype,"actionContext",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Object)],z.prototype,"instruction",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Object)],z.prototype,"instructionInfo",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",String)],z.prototype,"creatorInfo",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Boolean)],z.prototype,"isPreview",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Array)],z.prototype,"files",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Number)],z.prototype,"entityViewMode",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Number)],z.prototype,"actionType",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Boolean)],z.prototype,"limitedMode",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Boolean)],z.prototype,"forceIsMobile",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Prop)(),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Boolean)],z.prototype,"forceIsTablet",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,Q.t)(A.h),instructionCommonInfovue_type_script_lang_js_metadata("design:type",A.h)],z.prototype,"pubSubService",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,c.Rm)("fetchInstruction"),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Object)],z.prototype,"fetchInstruction",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,c.jI)("fetchDocument"),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Object)],z.prototype,"fetchDocument",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,u.x)("eSignMode"),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Object)],z.prototype,"eSignMode",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,N.k)("getDocument"),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Object)],z.prototype,"getDocument",void 0),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Watch)("instruction",{immediate:!0}),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Function),instructionCommonInfovue_type_script_lang_js_metadata("design:paramtypes",[Object,Object]),instructionCommonInfovue_type_script_lang_js_metadata("design:returntype",void 0)],z.prototype,"onInstructionChanged",null),instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Watch)("instruction.baseDocumentID",{immediate:!0}),instructionCommonInfovue_type_script_lang_js_metadata("design:type",Function),instructionCommonInfovue_type_script_lang_js_metadata("design:paramtypes",[]),instructionCommonInfovue_type_script_lang_js_metadata("design:returntype",void 0)],z.prototype,"onBaseDocumentChanged",null),z=instructionCommonInfovue_type_script_lang_js_decorate([(0,g.Component)({components:{"ibasic-info":T,"attach-doc":L.Z,"action-panel":B.default,"esign-viewer":U.Z}})],z);const Z=z,W=Z;var q=n(82127),G=n(85893),K=n(5255),Y=n(44557),J=n(94694),X=n(86131),ee=n(29442),te=n(71100),ne=n(7442),ie=(0,C.Z)(W,instructionCommonInfovue_type_template_id_dc504126_scoped_true_render,k,!1,null,"dc504126",null);const oe=ie.exports;_()(ie,{VBtn:q.Z,VCard:G.Z,VCardActions:K.h7,VChip:x.Z,VCol:S.Z,VExpansionPanel:Y.Z,VExpansionPanelContent:J.Z,VExpansionPanelHeader:X.Z,VExpansionPanels:ee.Z,VIcon:te.Z,VRow:D.Z,VTooltip:ne.Z});var instructionViewvue_type_script_lang_js_decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},instructionViewvue_type_script_lang_js_metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},instructionViewvue_type_script_lang_js_awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let se=class InstructionViewComponent extends g.Vue{constructor(){super(...arguments),this.creatorInfo="",this.loading=!1,this.files=null,this.myInstructionInfo=null}onIdChanged(e){if(!this.context&&e)try{this.onContextChanged({instruction:null,permissions:null,parentControlInstruction:null,fullyRead:!1,instructionType:null})}catch(e){this.$log.error(e)}}onContextChanged(e,t){var n,i,o;return instructionViewvue_type_script_lang_js_awaiter(this,void 0,void 0,(function*(){if(e){this.$log.debug("instructionView context.id = ",e.instruction.id);try{this.myInstructionInfo=e;let t,s=null===(i=null===(n=this.instruction)||void 0===n?void 0:n.folder)||void 0===i?void 0:i.id;if(!s&&(null===(o=this.actionContext)||void 0===o?void 0:o.folderId)&&(s=Number(this.actionContext.folderId)),!this.myInstructionInfo.fullyRead){this.loading=!0,this.$emit("instr-view-loading",!0);const e=this.myInstructionInfo.instruction,t=e?e.id:this.id;return yield this.fetchInstruction(new a.oE(t,s,!0)),void this.$emit("update-message",this.instructionInfo)}if(!this.instruction)return;!this.instruction.files&&this.hasFiles?this.files=yield this.fetchFiles(new a.I1(this.instruction.id,!0)):this.files=this.instruction.files,this.instruction.files=this.files;const c=this.instruction.viewFlag;if(this.limitedMode||c||this.actionContext.entityViewMode!==r.dS.View&&this.actionContext.entityViewMode!==r.dS.Preview||(t=this.userSettings.markAsReadSecondsInterval,this.setTimerReaded(this.instruction.id,t)),this.creatorInfo=this.instruction.creatorInfo,this.instructionInfo&&!this.creatorInfo){const e=yield this.getUserInfo(this.instructionInfo.instruction.creatorID);this.instruction.creatorInfo=(0,l.F)(e),this.creatorInfo=this.instruction.creatorInfo}}finally{this.loading=!1,this.$emit("instr-view-loading",!1)}}}))}beforeDestroy(){clearTimeout(this.setReadedTimer)}setTimerReaded(e,t){clearTimeout(this.setReadedTimer),this.setReadedTimer=setTimeout((()=>{this.instruction&&this.setInstructionReadedCommand(new o.Ub(this.instruction.id,this.instruction.folder))}),1e3*t)}get instructionInfo(){var e;return this.myInstructionInfo?this.getInstruction(this.myInstructionInfo.instruction.id,(null===(e=this.myInstructionInfo.instruction.folder)||void 0===e?void 0:e.id)?this.myInstructionInfo.instruction.folder.id:null):null}get instruction(){var e;return null===(e=this.instructionInfo)||void 0===e?void 0:e.instruction}get hasFiles(){var e;return null===(e=this.instruction)||void 0===e?void 0:e.hasFiles}get actionPanelContext(){return!this.actionContext.folderId&&this.instructionInfo.instruction.folder&&(this.actionContext.folderId=this.instructionInfo.instruction.folder.id,this.actionContext.folderName=this.instructionInfo.instruction.folder.name),Object.assign(Object.assign({},this.actionContext),{instructionInfo:[this.instructionInfo],entity:[this.instructionInfo],limitedMode:this.limitedMode})}get isPreview(){return this.actionContext.entityViewMode===r.dS.Preview}get showMobileInstructionArea(){return this.limitedMode||this.isMobile||this.isPreview}};instructionViewvue_type_script_lang_js_decorate([(0,g.Prop)(),instructionViewvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"context",void 0),instructionViewvue_type_script_lang_js_decorate([(0,g.Prop)(),instructionViewvue_type_script_lang_js_metadata("design:type",Number)],se.prototype,"id",void 0),instructionViewvue_type_script_lang_js_decorate([(0,g.Prop)(),instructionViewvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"actionContext",void 0),instructionViewvue_type_script_lang_js_decorate([(0,g.Prop)(),instructionViewvue_type_script_lang_js_metadata("design:type",Number)],se.prototype,"actionType",void 0),instructionViewvue_type_script_lang_js_decorate([(0,g.Prop)(),instructionViewvue_type_script_lang_js_metadata("design:type",Boolean)],se.prototype,"limitedMode",void 0),instructionViewvue_type_script_lang_js_decorate([(0,g.Prop)(),instructionViewvue_type_script_lang_js_metadata("design:type",Boolean)],se.prototype,"forceIsMobile",void 0),instructionViewvue_type_script_lang_js_decorate([(0,g.Prop)(),instructionViewvue_type_script_lang_js_metadata("design:type",Boolean)],se.prototype,"forceIsTablet",void 0),instructionViewvue_type_script_lang_js_decorate([(0,c.Rm)("fetchInstruction"),instructionViewvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"fetchInstruction",void 0),instructionViewvue_type_script_lang_js_decorate([(0,c.Rm)("fetchFiles"),instructionViewvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"fetchFiles",void 0),instructionViewvue_type_script_lang_js_decorate([(0,c.Rm)("setInstructionReadedCommand"),instructionViewvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"setInstructionReadedCommand",void 0),instructionViewvue_type_script_lang_js_decorate([(0,c.Vw)("getUserInfo"),instructionViewvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"getUserInfo",void 0),instructionViewvue_type_script_lang_js_decorate([(0,u.x)("userSettings"),instructionViewvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"userSettings",void 0),instructionViewvue_type_script_lang_js_decorate([(0,d.Y)("getInstruction"),instructionViewvue_type_script_lang_js_metadata("design:type",Object)],se.prototype,"getInstruction",void 0),instructionViewvue_type_script_lang_js_decorate([(0,g.Watch)("id",{immediate:!0}),instructionViewvue_type_script_lang_js_metadata("design:type",Function),instructionViewvue_type_script_lang_js_metadata("design:paramtypes",[Number]),instructionViewvue_type_script_lang_js_metadata("design:returntype",void 0)],se.prototype,"onIdChanged",null),instructionViewvue_type_script_lang_js_decorate([(0,g.Watch)("context",{immediate:!0}),instructionViewvue_type_script_lang_js_metadata("design:type",Function),instructionViewvue_type_script_lang_js_metadata("design:paramtypes",[Object,Object]),instructionViewvue_type_script_lang_js_metadata("design:returntype",Promise)],se.prototype,"onContextChanged",null),se=instructionViewvue_type_script_lang_js_decorate([(0,g.Component)({components:{"ibasic-info":T,"icommon-info":oe}})],se);const re=se,ae=re;var le=(0,C.Z)(ae,render,i,!1,null,"3c021555",null);const ce=le.exports},56556:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.items.length?n("div",[e.isManyItems?[n("div",{staticClass:"d-flex flex-row-reverse"},e._l(e.items,(function(t){return n("v-btn",{key:t.id,staticClass:"small-button ml-4 minimize-btn",attrs:{color:"secondary",dark:""},on:{click:function(n){return e.onMaximize(t)}}},[n("div",{staticClass:"minimize-btn__inner"},[n("span",{staticClass:"body-1 minimize-btn__title"},[e._v(e._s(t.processingDescription||t.description))]),e._v(" "),n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""}},i),[n("v-icon",{staticClass:"lighten-8",attrs:{size:"18",color:"grey"}},[e._v(" open_in_full ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Развернуть")])],1),e._v(" "),n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[n("v-btn",e._g({staticClass:"small-round-button",attrs:{icon:""},on:{click:function(n){return n.stopPropagation(),e.onClose(t)}}},o),[n("v-icon",{staticClass:"lighten-8",attrs:{size:"18",color:"grey"}},[e._v(" close ")])],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Закрыть")])],1)],1)])})),1)]:[n("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,o=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"small-button ml-4 minimize-btn minimize-btn-all",attrs:{color:"secondary",dark:""}},"v-btn",o,!1),i),[n("span",{staticClass:"body-1"},[n("translate",[e._v("Свёрнутые окна")]),e._v(" ("+e._s(e.items.length)+") ")],1)])]}}],null,!1,195757036)},[e._v(" "),n("div",{staticClass:"minimized-menu"},[n("v-list",e._l(e.items,(function(t){return n("v-list-item",{key:t.id,on:{click:function(n){return e.onMaximize(t)}}},[n("v-list-item-content",{class:{changed:e.itemIsChanged(t)}},[n("div",{staticClass:"minimized-item__title"},[e._v(e._s(t.description))]),e._v(" "),n("div",{staticClass:"minimized-item__subtitle"},[e._v(e._s(t.title))])]),e._v(" "),n("v-list-item-action",{staticClass:"ma-0"},[n("v-btn",{staticClass:"small-round-button",attrs:{icon:""},on:{click:function(n){return n.stopPropagation(),e.onMaximize(t)}}},[n("v-icon",{staticClass:"lighten-6",attrs:{size:"18",color:"grey"}},[e._v("open_in_full")])],1)],1),e._v(" "),n("v-list-item-action",{staticClass:"ma-0"},[n("v-btn",{staticClass:"small-round-button",attrs:{icon:""},on:{click:function(n){return n.stopPropagation(),e.onClose(t)}}},[n("v-icon",{staticClass:"lighten-6",attrs:{size:"18",color:"grey"}},[e._v("close")])],1)],1)],1)})),1),e._v(" "),n("div",{staticClass:"minimized-menu__close_all"},[n("v-btn",{staticClass:"small-button",attrs:{color:"grey"},on:{click:function(t){return e.$emit("close-all")}}},[n("div",{staticClass:"d-flex align-center body-1 white--text"},[n("v-icon",{attrs:{size:"18"}},[e._v("close")]),e._v(" "),n("translate",[e._v("Закрыть все")])],1)])],1)],1)])]],2):e._e()},i=[],o=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let s=class MinimizedDialogsComponent extends o.Vue{onMaximize(e){const t=this.dialogs.find((t=>t.id===e.id));t&&this.$emit("maximize",t)}onClose(e){const t=this.dialogs.find((t=>t.id===e.id));t&&this.$emit("close",t)}itemIsChanged(e){return!(!e.isChanged||"function"!==typeof e.isChanged)&&e.isChanged()}get label(){return this.$gettext("Свёрнутые окна")}get items(){var e;return null!==(e=this.dialogs)&&void 0!==e?e:[]}get isManyItems(){return this.items.length&&this.items.length<5}};__decorate([(0,o.Prop)(),__metadata("design:type",Array)],s.prototype,"dialogs",void 0),s=__decorate([o.Component],s);const r=s,a=r;var l=n(51900),c=n(43453),d=n.n(c),u=n(82127),p=n(71100),h=n(54983),m=n(53760),f=n(73444),g=n(45903),y=n(51333),v=n(7442),b=(0,l.Z)(a,render,i,!1,null,"6aee3773",null);const C=b.exports;d()(b,{VBtn:u.Z,VIcon:p.Z,VList:h.Z,VListItem:m.Z,VListItemAction:f.Z,VListItemContent:g.km,VMenu:y.Z,VTooltip:v.Z})},53606:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>j});var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{staticClass:"pa-0",staticStyle:{height:"100%"}},[e.isMobile?[n("v-row",{staticClass:"documents-select m-mobile"},[n("div",{staticClass:"documents-select__header mb-2 m-mobile"},[n("v-row",{staticClass:"fit-width"},[n("v-col",{attrs:{cols:"4"}},[n("card-combobox",{attrs:{"data-testid":"journalsSelect",placeholder:e.$gettext("Журнал регистрации"),mobile:e.isMobile,multiselect:!1,items:e.selectableJournals,"persistent-hint":""},model:{value:e.selectedFolder,callback:function(t){e.selectedFolder=t},expression:"selectedFolder"}})],1),e._v(" "),n("v-col",{attrs:{cols:"2"}},[n("v-row",{staticClass:"ml-1 mb-1",staticStyle:{height:"32px"}},[n("v-checkbox",{staticClass:"my-0 display-1",staticStyle:{"max-width":"28px"},attrs:{color:"primary","data-testid":"archiveCheckbox"},model:{value:e.onlyArchivedDocs,callback:function(t){e.onlyArchivedDocs=t},expression:"onlyArchivedDocs"}}),e._v(" "),n("v-col",{staticClass:"pt-1"},[e._v("Только документы из архива")])],1)],1),e._v(" "),n("v-col",[n("v-text-field",{staticClass:"small-input body-1 font-weight-light documents-select__reg-number",attrs:{flat:"","hide-details":"","single-line":"",outlined:"","data-testid":"regNumber",placeholder:e.$gettext("Регистрационный номер")},model:{value:e.regNumber,callback:function(t){e.regNumber=t},expression:"regNumber"}})],1),e._v(" "),n("v-row",{staticClass:"date-filter-input ml-1 mt-2",staticStyle:{height:"32px"}},[n("v-checkbox",{staticClass:"my-0 display-1",staticStyle:{"max-width":"35px"},attrs:{color:"primary","data-testid":"dateCheckbox"},model:{value:e.dateFilterControl,callback:function(t){e.dateFilterControl=t},expression:"dateFilterControl"}}),e._v(" "),n("v-col",{staticClass:"documents-select__document-date",attrs:{cols:"12",sm:"6",md:"6"}},[n("vdt-picker",{attrs:{dateonly:!0,disabled:!e.dateFilterControl,"data-testid":"dateInput"},model:{value:e.regDate,callback:function(t){e.regDate=t},expression:"regDate"}})],1),e._v(" "),n("v-col",[n("v-btn",{staticClass:"small-button rounded-button my-0 mx-0 ml-1 mr-0 pl-2 font-weight-regular documents-select__search-button",attrs:{outlined:"",color:"primary","data-testid":"searchBtn",disabled:!e.selectedFolder},on:{click:e.searchDocuments}},[n("v-icon",[e._v("search")]),e._v(" "),n("translate",[e._v("Найти")])],1)],1)],1)],1)],1),e._v(" "),n("v-row",{staticClass:"datatable-wrapper"},[n("v-col",{staticClass:"m-mobile",class:[{"md8 lg8 xl8":e.multiselect}]},[n("datatable",{ref:"table",staticClass:"m-mobile material ngx-flex elevation-1",attrs:{"data-testid":"table",rows:e.filteredDocuments,columns:e.columns,sortType:"multi",columnMode:"force",headerHeight:50,footerHeight:e.calculateFooterHeight,rowHeight:40,scrollbarV:!0,loadingIndicator:e.docsLoading,selected:e.previuoslySelectedDocuments,selectionType:e.tableSelectType,messages:{emptyMessage:e.$gettext("Нет документов для отображения"),selectedMessage:e.$gettext("Выбрано"),totalMessage:e.$gettext("Всего")}},on:{select:function(t){return e.onSelectDocument(t)}}})],1),e._v(" "),e.multiselect?n("v-col",{attrs:{md:"4",lg:"4",xl:"4"}},[n("v-row",{staticClass:"ml-2",staticStyle:{"max-width":"250px","min-width":"250px"}},[e.selectedDocuments?n("span",{staticClass:"subheading font-weight-bold"},[n("translate",[e._v("Выбрано ")]),e._v("("+e._s(e.selectedDocuments.length)+"):\n        ")],1):e._e(),e._v(" "),n("v-col",[n("draggable",{model:{value:e.selectedDocuments,callback:function(t){e.selectedDocuments=t},expression:"selectedDocuments"}},e._l(e.selectedDocuments,(function(t,i){return n("v-chip",{key:t.id,staticClass:"white--text caption",attrs:{close:"",small:"",color:"primary_light"},on:{input:function(t){return e.documentDelete(i)}}},[e._v(e._s(t.attributes.RegistrationNumber))])})),1)],1)],1)],1):e._e()],1)],1)]:n("v-row",{staticClass:"documents-select",attrs:{"no-gutters":""}},[n("div",{staticClass:"documents-select__header"},[n("div",{staticClass:"grid-row"},[n("div",{staticClass:"d-flex pr-5"},[n("span",{staticClass:"text-body-2 error--text pr-1"},[e._v("*")]),e._v(" "),n("card-combobox",{attrs:{"data-testid":"journalsSelect",placeholder:e.$gettext("Журнал регистрации"),mobile:e.isMobile,multiselect:!1,items:e.selectableJournals,"persistent-hint":"","hide-details":""},model:{value:e.selectedFolder,callback:function(t){e.selectedFolder=t},expression:"selectedFolder"}})],1),e._v(" "),n("div",{staticClass:"grid-controls"},[n("v-switch",{staticClass:"ml-0 pa-0 my-0 exec-checkbox body-1",attrs:{"data-testid":"archiveCheckbox",ripple:!1,label:e.$gettext("Архивные"),color:"primary","hide-details":""},model:{value:e.onlyArchivedDocs,callback:function(t){e.onlyArchivedDocs=t},expression:"onlyArchivedDocs"}}),e._v(" "),n("v-text-field",{staticClass:"pl-0 small-input sm-text search-field",attrs:{"data-testid":"regNumber",text:"","hide-details":"","single-line":"",outlined:"",clearable:"",autocomplete:"off","prepend-inner-icon":"search",label:e.$gettext("Поиск")},model:{value:e.searchTerms,callback:function(t){e.searchTerms=t},expression:"searchTerms"}}),e._v(" "),n("v-menu",{attrs:{"offset-y":"","close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on;return[n("v-btn",e._g({staticClass:"my-0 square-sm-button rounded-button bordered-button grey--border lighten-3",attrs:{outlined:""}},Object.assign({},i,o)),[n("svg-icon",{staticClass:"svg-icon",class:{"grey--text darken-3":!e.currentDateRange,"primary--text":e.currentDateRange},staticStyle:{transform:"translate3d(2px, 2px, 0)"},attrs:{icon:"event"}})],1)]}}],null,!0)},[e._v(" "),n("translate",[e._v("Выбрать диапазон")])],1)]}}]),model:{value:e.isDateRangeOpened,callback:function(t){e.isDateRangeOpened=t},expression:"isDateRangeOpened"}},[e._v(" "),n("workspace-date-range",{attrs:{value:e.currentDateRange},on:{input:e.onDateRangeApply}})],1),e._v(" "),n("v-btn",{staticClass:"small-button rounded-button my-0 mr-0 elevation-0",staticStyle:{width:"100%"},attrs:{color:"primary","data-testid":"searchBtn",disabled:!e.selectedFolder},on:{click:e.searchDocuments}},[n("translate",[e._v("Найти")])],1)],1)])]),e._v(" "),n("div",{staticClass:"datatable-wrapper"},[n("div",{staticClass:"mb-2"},[e.currentDateRange?n("v-chip",{staticClass:"elevation-0 ml-0 mr-1",attrs:{"text-color":"white",color:"primary_light",small:"",close:""},on:{"click:close":function(t){e.currentDateRange=null}}},[n("span",[e._v(" "+e._s(e.dateRangeApplied)+" ")])]):e._e()],1),e._v(" "),n("div",[n("span",{staticClass:"caption"},[e._v(" "+e._s(e.documentsCount)+" ")])]),e._v(" "),n("div",{staticClass:"datatable-inner"},[e.documentsSearchResult.length?n("div",{staticClass:"datatable-toolbar pr-2 elevation-2"},[n("v-icon",{staticClass:"grey--text darken-3",staticStyle:{transform:"rotate(30deg)",cursor:"pointer"},attrs:{size:"24"},on:{click:function(t){e.isFileViewerOpened=!0}}},[e._v("\n            attach_file\n          ")])],1):e._e(),e._v(" "),n("document-list",{attrs:{"temp-list":"",context:e.actionContext,"fetch-options":e.fetchOptions,"selected-id":e.selectedId,"show-grid-columns":!1,"collection-view-mode":e.viewMode,preview:!1,"show-active-item":!1,"empty-message":e.emptyMessage,"select-message":e.selectMessage,"disable-table-toolbar":"","disable-double-click":""},on:{"update-selected":e.onSelectDocument,"update-state":e.onListStateUpdate,"update-cancel-date-range":e.onCancelDateRange}}),e._v(" "),e.isFileViewerOpened?n("div",{staticClass:"datatable-file-viewer"},[n("div",{staticClass:"datatable-file-viewer__inner"},[n("loader",{attrs:{options:{transparent:!0,global:!1},indicator:"circle",visible:e.filesLoading}}),e._v(" "),n("v-container",{staticClass:"py-0"},[n("v-row",{staticClass:"my-0"},[n("v-col",{staticClass:"py-0 d-flex align-center",attrs:{cols:"6"}},[n("translate",{staticClass:"body-2 font-weight-bold"},[e._v("Файлы документа")])],1),e._v(" "),n("v-col",{staticClass:"py-0 d-flex justify-end align-center",attrs:{cols:"6"}},[n("v-icon",{staticClass:"grey--text darken-3",staticStyle:{cursor:"pointer"},attrs:{icon:"",size:"20"},on:{click:function(t){e.isFileViewerOpened=!1}}},[e._v("\n                    close\n                  ")])],1)],1),e._v(" "),n("v-row",{staticClass:"my-0"},[n("v-col",{staticClass:"py-0",staticStyle:{"margin-left":"-10px","max-height":"100%"},attrs:{cols:"12"}},[n("ld-files-viewer",{attrs:{card:e.selectedDocuments[0],context:e.actionContext,"doc-changable":!1}})],1)],1)],1)],1)]):e._e()],1)])])],2)},i=[],o=n(72835),s=n(42256),r=n(50103),a=n(77896),l=n(31025),c=n(18220),d=n(85236),u=n(72878),p=n(53600),h=n(41162),m=n(86142),f=n(29339),g=n(9980),y=n.n(g),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let v=class SelectDocumentsComponent extends f.Vue{constructor(){super(...arguments),this.regDate=new Date,this.journalId=null,this.searchTerms="",this.documentsSearchResult=[],this.documentFolders=null,this.selectedFolder=null,this.loading=!1,this.docsLoading=!1,this.selectedDocuments=[],this.dateFilterControl=!1,this.selectedDocIds=[],this.onlyArchivedDocs=!1,this.defaultColumnWidth=170,this.columns=[],this.isDefaultColumns=!1,this.fetchOptions=null,this.selectMessage=this.$gettext('Выберите параметры поиска и нажмите "Найти"'),this.emptyMessage="",this.isDateRangeOpened=!1,this.currentDateRange=null,this.isFileViewerOpened=!1,this.filesLoading=!1,this.documentFiles=[],this.wasSearch=!1,this.queriesCounter=0,this.desktopColumns=[{name:this.$gettext("Рег. номер"),prop:"attributes.RegistrationNumber",flex:1},{name:this.$gettext("Рег. дата"),prop:"attributes.RegistrationDate",isDateValue:!0,flex:1},{name:this.$gettext("Краткое содержание"),prop:"attributes.Annotation",flex:5}],this.mobileColumns=[{name:this.$gettext("Рег.Номер / рег.Дата"),prop:"attributes.Name"}]}onSelectedFolderChanged(){this.journalId=this.selectedFolder,this.wasSearch&&this.searchDocuments()}onSelectedChanged(){Array.isArray(this.selected)&&this.selected.length&&(this.selectedDocuments=[...this.selected],this.selectedDocIds=this.selected.map((e=>e.id)))}created(){this.emptyMessage=this.selectMessage,this.getJournals(),this.fetchOptions={folderInfo:null,filter:null,page:1,pageSize:0,section:s.S.Documents,refreshCounter:0,searchTerm:null,sortField:null,unreadOnlyFilter:null,entities:null}}formatDate(e){if(!e)return null;const[t,n,i]=e.split("-");return`${i}.${n}.${t}`}arraysEquality(e,t){let n;for(let i=0;i<0;i++)n=e[i]===t[i];return n}onSelectDocument(e){e&&(this.selectedDocuments.splice(0,this.selectedDocuments.length),this.selectedDocuments.push(e.entity),this.emitSetResult())}documentDelete(e){this.selectedDocuments.splice(e,1),this.emitSetResult()}getJournals(){return __awaiter(this,void 0,void 0,(function*(){this.loading=!0,this.documentFolders=yield this.fetchJournalsList({journalType:"all"})}))}searchDocuments(){var e;return __awaiter(this,void 0,void 0,(function*(){let t;this.docsLoading=!0;const n=this.selectableJournals.find((e=>e.id===this.selectedFolder));let i=[null,null];this.currentDateRange&&(i=["dateStart","dateFinish"].map((e=>this.currentDateRange[e]?l.C.toServerString(this.currentDateRange[e]):null)));try{this.queriesCounter++,t=yield this.fetchDocuments(new a.m$(Number(this.journalId),this.onlyArchivedDocs,this.createListInfo(this.searchTerms,null),n.cardId,!0,this.queriesCounter>1,i[0],i[1],!0,!0))}catch(e){this.$toasted.error(this.$gettext("Произошла ошибка при загрузке журнала."))}finally{this.documentsSearchResult=null===t||void 0===t?void 0:t.items,this.sourceDocumentId&&Array.isArray(this.documentsSearchResult)&&(this.documentsSearchResult=this.documentsSearchResult.filter((e=>e.id!==this.sourceDocumentId))),this.fetchOptions.entities=null!==(e=this.documentsSearchResult)&&void 0!==e?e:[],this.fetchOptions.entities.length?this.emptyMessage=this.selectMessage:this.emptyMessage=this.$gettext("Документов не найдено"),this.fetchOptions.folderInfo={id:this.journalId,compositeId:"",contentType:r.zc.Document,name:"",parentId:0,nodeType:o.J.Journal},this.docsLoading=!1,this.wasSearch=!0}}))}onListStateUpdate(e){e.page&&this.fetchOptions.page!==e.page&&(this.fetchOptions.page=e.page),e.pageSize&&(this.fetchOptions.pageSize=e.pageSize)}onCancelDateRange(){this.currentDateRange=null}get filteredDocuments(){if(!this.documentsSearchResult)return[];let e=this.documentsSearchResult;return this.sourceDocumentId&&(e=this.documentsSearchResult.filter((e=>e.id!==this.sourceDocumentId))),e}onDateRangeApply(e){this.isDateRangeOpened=!1,this.currentDateRange=e,this.selectedFolder&&this.searchDocuments()}get selectableJournals(){let e;return Array.isArray(this.documentFolders)&&(e=this.documentFolders.map((e=>({id:e.id,value:e.name,cardId:e.cardID})))),Array.isArray(this.allowedJournals)&&this.allowedJournals.length&&this.documentFolders&&(e=this.documentFolders.filter((e=>this.allowedJournals.includes(e.id))).map((e=>({id:e.id,value:e.name,cardId:e.cardID})))),e}get calculateFooterHeight(){return this.isMobile?95:50}get actionContext(){return{section:s.S.Documents,instructionInfo:null,document:this.selectedDocuments.length?[...this.selectedDocuments]:null,entity:[...this.selectedDocuments],contentType:r.zc.Document,collectionViewMode:r.Ml.Grid,entityViewMode:r.dS.List,folderId:this.journalId,folderName:"",breadcrumbs:null,rights:null}}get viewMode(){return r.Ml.Grid}get selectedId(){var e;return(null===(e=this.selectedDocIds)||void 0===e?void 0:e.length)?String(this.selectedDocIds[0]):""}get dateRangeApplied(){return this.currentDateRange?[l.C.dateToLocal(this.currentDateRange.dateStart),l.C.dateToLocal(this.currentDateRange.dateFinish)].join(" - "):""}get documentsCount(){if(!this.documentsSearchResult.length)return"";let e="";return this.documentsSearchResult.length>1?e+=this.$gettext("По запросу найдено"):e+=this.$gettext("По запросу найден"),e+=" ",e+=(0,m.o)(this.documentsSearchResult.length,"документ","документа","документов"),e}emitSetResult(){this.$emit("set-result",this.selectedDocuments?this.selectedDocuments[0]:null)}createListInfo(e,t){const n=1,i=100,o=(n-1)*i;return{page:n,take:i,maxTake:100,skip:o,searchText:e,filter:(0,d.Z)(t)}}};__decorate([(0,f.Prop)({default:null}),__metadata("design:type",Number)],v.prototype,"sourceDocumentId",void 0),__decorate([(0,f.Prop)(),__metadata("design:type",Array)],v.prototype,"selected",void 0),__decorate([(0,f.Prop)(),__metadata("design:type",Array)],v.prototype,"allowedJournals",void 0),__decorate([(0,c.jI)("fetchJournalsList"),__metadata("design:type",Object)],v.prototype,"fetchJournalsList",void 0),__decorate([(0,c.jI)("fetchDocuments"),__metadata("design:type",Object)],v.prototype,"fetchDocuments",void 0),__decorate([(0,c.jI)("fetchDocumentFiles"),__metadata("design:type",Object)],v.prototype,"fetchDocumentFiles",void 0),__decorate([(0,c.r5)("fetchUserGridSettings"),__metadata("design:type",Object)],v.prototype,"fetchUserGridSettings",void 0),__decorate([(0,c.r5)("fetchTableSettings"),__metadata("design:type",Object)],v.prototype,"fetchTableSettings",void 0),__decorate([(0,f.Watch)("selectedFolder",{immediate:!1}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],v.prototype,"onSelectedFolderChanged",null),__decorate([(0,f.Watch)("selected",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],v.prototype,"onSelectedChanged",null),v=__decorate([(0,f.Component)({mixins:[u.Z],components:{draggable:y(),"document-list":p.default,"workspace-date-range":h.Z}})],v);const b=v,C=b;var w=n(51900),_=n(43453),x=n.n(_),S=n(82127),I=n(93462),D=n(17024),R=n(66530),T=n(71100),P=n(51333),O=n(57894),k=n(56721),F=n(22528),A=n(7442),$=(0,w.Z)(C,render,i,!1,null,"a9fa78ba",null);const j=$.exports;x()($,{VBtn:S.Z,VChip:I.Z,VCol:D.Z,VContainer:R.Z,VIcon:T.Z,VMenu:P.Z,VRow:O.Z,VSwitch:k.Z,VTextField:F.Z,VTooltip:A.Z})},41162:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var i,render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"pa-1"},[n("v-row",{staticClass:"px-2 pb-1",attrs:{"no-gutters":""}},[n("v-col",[n("v-chip-group",{staticClass:"data-range__period-group",attrs:{"active-class":"primary"},model:{value:e.activePeriod,callback:function(t){e.activePeriod=t},expression:"activePeriod"}},e._l(e.periodList,(function(t){return n("v-chip",{key:t,staticClass:"mr-1",attrs:{small:"",value:t},on:{click:e.onDateChipClickHandler}},[e._v("\n          "+e._s(t)+"\n        ")])})),1)],1)],1),e._v(" "),n("v-row",{staticClass:"pb-1",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"px-2 sx12",attrs:{sm:"6"}},[n("vdt-picker",{attrs:{"allowed-dates":e.allowedStartDates,"no-title":""},model:{value:e.dateStart,callback:function(t){e.dateStart=t},expression:"dateStart"}})],1),e._v(" "),n("v-col",{staticClass:"px-2 sx12",attrs:{sm:"6"}},[n("vdt-picker",{attrs:{"allowed-dates":e.allowedFinishDates,"no-title":""},model:{value:e.dateFinish,callback:function(t){e.dateFinish=t},expression:"dateFinish"}})],1)],1),e._v(" "),n("v-card-actions",{staticClass:"filter-footer"},[n("v-btn",{staticClass:"rounded-button small-button primary elevation-0 font-weight-regular",attrs:{disabled:!e.canBeApplied},on:{click:e.apply}},[n("translate",[e._v("Применить")])],1),e._v(" "),n("v-btn",{staticClass:"bordered-button rounded-button small-button grey--border lighten-2 white elevation-0",on:{click:e.clear}},[n("translate",[e._v("Сбросить")])],1)],1)],1)},o=[],s=n(11135),r=n(81086),a=n(29339),__decorate=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},__metadata=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};let l=i=class WorkspaceDateRangeComponent extends a.Vue{constructor(){super(...arguments),this.dateRange={dateStart:null,dateFinish:null},this.dateStart=null,this.dateFinish=null,this.periodStart=null,this.periodFinish=null,this.periodList=s.Fw,this.activePeriod=null,this.currentDate=null}static isLessThenOrEqualDates(e,t){return(null===e||void 0===e?void 0:e.getTime())<=(null===t||void 0===t?void 0:t.getTime())}created(){this.currentDate=new Date}onDateStartChanged(e){e&&this.dateStart.setHours(0,0,0,0),this.onDateChanged("Start")}onDateFinishChanged(e){e&&this.dateFinish.setHours(23,59,59,999),this.onDateChanged("Finish")}onValueChanged(e){var t,n;this.dateRange=Object.assign({},e),this.dateStart=null===(t=this.dateRange)||void 0===t?void 0:t.dateStart,this.dateFinish=null===(n=this.dateRange)||void 0===n?void 0:n.dateFinish}onDateChipClickHandler(){return __awaiter(this,void 0,void 0,(function*(){if(yield this.$nextTick(),!this.activePeriod)return this.dateStart=null,void(this.dateFinish=null);const e=(0,r.G)(this.currentDate,this.activePeriod);e&&(this.dateStart=this.periodStart=e.dateStart,this.dateFinish=this.periodFinish=e.dateFinish)}))}apply(){this.dateStart&&this.dateFinish?this.$emit("input",this.dateRange):this.$emit("input",null)}clear(){this.dateRange={dateStart:null,dateFinish:null},this.dateStart=null,this.dateFinish=null,this.apply()}allowedStartDates(e){return!this.dateFinish||i.isLessThenOrEqualDates(new Date(e),this.dateFinish)}allowedFinishDates(e){return!this.dateStart||i.isLessThenOrEqualDates(this.dateStart,new Date(e))}get canBeApplied(){return Boolean(this.dateStart&&this.dateFinish)}onDateChanged(e){const t=`date${e}`,n=`period${e}`;this[t]!==this[n]&&(this.activePeriod=null),this[t]&&(this.dateRange[t]=this[t])}};__decorate([(0,a.Model)("input",{type:Object,default:null}),__metadata("design:type",Object)],l.prototype,"value",void 0),__decorate([(0,a.Watch)("dateStart",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Date]),__metadata("design:returntype",void 0)],l.prototype,"onDateStartChanged",null),__decorate([(0,a.Watch)("dateFinish",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Date]),__metadata("design:returntype",void 0)],l.prototype,"onDateFinishChanged",null),__decorate([(0,a.Watch)("value",{immediate:!0}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],l.prototype,"onValueChanged",null),l=i=__decorate([a.Component],l);const c=l,d=c;var u=n(51900),p=n(43453),h=n.n(p),m=n(82127),f=n(85893),g=n(5255),y=n(93462),v=n(86791),b=n(17024),C=n(57894),w=(0,u.Z)(d,render,o,!1,null,"e6c7c24e",null);const _=w.exports;h()(w,{VBtn:m.Z,VCard:f.Z,VCardActions:g.h7,VChip:y.Z,VChipGroup:v.Z,VCol:b.Z,VRow:C.Z})},12853:(e,t,n)=>{"use strict";n.d(t,{L:()=>N});var i=function array(e){return{last:function last(){return e.length>0?e[e.length-1]:null},in:function _in(t,n){return e.filter((function(e){return t.indexOf(e)>=0&&(!n||n(e))}))},notIn:function notIn(t,n){return e.filter((function(e){return t.indexOf(e)<0&&(!n||n(e))}))},is:function is(t,n){var i=t.isIn,o=void 0===i?[]:i,s=t.notIn,r=void 0===s?[]:s;return e.filter((function(e){return o.reduce((function(t,n){return n.indexOf(e)>=0&&t}),!0)&&r.reduce((function(t,n){return n.indexOf(e)<0&&t}),!0)&&(!n||n(e))}))},contains:function contains(t){return e.indexOf(t)>=0},allIn:function allIn(t){return e.every((function(e){return t.indexOf(e)>=0}))}}},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var s=function tree(e,t){return{flatten:function flatten(){var n=[],o=[e];while(o.length>0){var s=o.pop();s instanceof Array&&(n=[].concat(_toConsumableArray(i(n).notIn(s)),_toConsumableArray(s)),o=[].concat(_toConsumableArray(o),_toConsumableArray(s.filter((function(e){return e[t]})).map((function(e){return e[t]})))))}return n},filter:function filter(n){var i=e.filter(n),o=function recurse(e){e.forEach((function(e){e[t]&&e[t]instanceof Array&&(e[t]=e[t].filter(n),recurse(e[t]))}))};return o(i),i},filterMap:function filterMap(n){var i=new Map,o=function recurse(e,i){e.forEach((function(e){if(e[t]&&e[t]instanceof Array){var o=new Map;recurse(e[t],o),o.size>0?i.set(e,o):n(e)&&i.set(e,new Map)}else n(e)&&i.set(e,null)}))};return o(e,i),i},perform:function perform(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return o||(o=tree(e,t).path(n)),o instanceof Array?(o.reverse().forEach((function(e,n){0===n?i(e):e[t]=[].concat(_toConsumableArray(e[t]))})),[].concat(_toConsumableArray(e))):e},add:function add(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return tree(e,t).perform(n,(function(e){return e[t]=[].concat(_toConsumableArray(e[t]),[i])}),o)},remove:function remove(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return tree(e,t).perform(n,(function(e){e[t]=e[t].filter((function(e){return"function"===typeof i?!i(e):e!==i}))}),o)},path:function path(n){for(var i=function recurse(e){if(e===n||"function"===typeof n&&n(e))return[e];if(!e[t])return!1;for(var i=0;i<e[t].length;i++){var o=recurse(e[t][i]);if(o)return[e].concat(_toConsumableArray(o))}return!1},o=0;o<e.length;o++){var s=i(e[o]);if(s)return s}return!1},visit:function visit(n){var i=[e];while(i.length>0){var o=i.pop();n(o),o.forEach((function(e){return e[t]&&e[t]instanceof Array?i.push(e[t]):null}))}},unwrapTree:function unwrapTree(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return!0};return Promise.all(e.map((function(e){return e.children&&n(e)?("function"===typeof e.children?e.children().then((function(e){return tree(e,t).unwrapTree(n)})):tree(e.children,t).unwrapTree(n)).then((function(t){return o({},e,{children:t})})):Promise.resolve(e)})))}}};Object.assign,"function"===typeof Symbol&&Symbol.iterator;var r={classes:function classes(e){var t=[];for(var n in e)e[n]&&t.push(n);return t.join(" ")},addClass:function addClass(e,t){e instanceof HTMLElement&&(e.className=e.className.split(" ").filter((function(e){return e!==t})).join(" ")+" "+t)},removeClass:function removeClass(e,t){e instanceof HTMLElement&&(e.className=e.className.split(" ").filter((function(e){return e!==t})).join(" "))},hasClass:function hasClass(e,t){return e instanceof HTMLElement&&e.className.indexOf(t)>=0}},a=function(){function sliceIterator(e,t){var n=[],i=!0,o=!1,s=void 0;try{for(var r,a=e[Symbol.iterator]();!(i=(r=a.next()).done);i=!0)if(n.push(r.value),t&&n.length===t)break}catch(e){o=!0,s=e}finally{try{!i&&a["return"]&&a["return"]()}finally{if(o)throw s}}return n}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function object(e){if(!e||!(e instanceof Object))throw new Error("Bad object format");return{shallowCompare:function shallowCompare(t,n){var i=!0;for(var o in e)if(e.hasOwnProperty(o)&&!(n&&n.indexOf(o)>=0)&&t[o]!==e[o])return void(i=!1);return i},filter:function filter(t){var n={};for(var i in e)e.hasOwnProperty(i)&&t(e[i])&&(n[i]=e[i]);return n},map:function map(t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i]));return n},fullMap:function fullMap(t){var n={};for(var i in e)if(e.hasOwnProperty(i)){var o=t(i,e[i]),s=a(o,2),r=s[0],l=s[1];n[r]=l}return n},nestPrefix:function nestPrefix(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},i=_defineProperty({},t,{});for(var o in e)e.hasOwnProperty(o)&&o.startsWith(t)?i[t][n(o.substring(t.length))]=e[o]:i[o]=e[o];return i}}},c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};var d={itemRef:void 0,guardCheck:!1},u={onDragStart:function onDragStart(e){return function(t){t.stopPropagation(),this.inputs.get().dragndrop.onDrag(e,t,this.inputs.get())}},onDragOver:function onDragOver(e){return function(t){t.preventDefault(),t.stopPropagation();var n=d.itemRef===e?d.guardCheck:this.inputs.get().dragndrop.guard&&this.inputs.get().dragndrop.guard(e,t,this.inputs.get());n?(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),r.addClass(t.currentTarget,this.mixCss("nodrop"))):(t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),r.addClass(t.currentTarget,this.mixCss("dragover"))),d.itemRef=e,d.guardCheck=n,this.inputs.get().dragndrop.onOver(e,t,this.inputs.get())}},onDragEnter:function onDragEnter(e){return function(t){if(t.preventDefault(),t.stopPropagation(),e&&(this.hasChildren(e)||this.isAsync(e))&&r.hasClass(t.target,this.mixCss("opener"))){var n=this.state.get().unfolded.filter((function(t){return t!==e}));n.push(e),this.state.set({unfolded:n})}this.inputs.get().dragndrop.onEnter(e,t,this.inputs.get())}},onDragLeave:function onDragLeave(e){return function(t){t.stopPropagation(),r.removeClass(t.currentTarget,this.mixCss("dragover")),r.removeClass(t.currentTarget,this.mixCss("nodrop")),this.inputs.get().dragndrop.onLeave(e,t,this.inputs.get())}},onDrop:function onDrop(e){return function(t){t.stopPropagation(),r.removeClass(t.currentTarget,this.mixCss("dragover")),r.removeClass(t.currentTarget,this.mixCss("nodrop")),this.inputs.get().dragndrop.guard&&this.inputs.get().dragndrop.guard(e,t,this.inputs.get())||this.inputs.get().dragndrop.onDrop(e,t,this.inputs.get())}},onDragEnd:function onDragEnd(e){return function(t){t.stopPropagation(),t.dataTransfer&&"none"===t.dataTransfer.dropEffect&&this.inputs.get().dragndrop.onCancel(e,t,this.inputs.get())}}},p=function wrapEvents(){var e=this;return c({},this.inputs.get().dragndrop,{onDrag:function onDrag(t,n,o){i(e.inputs.get().selection).contains(t)||e.onSelect(t,o.ancestors,o.neighbours),e.outputs.onDrag&&e.outputs.onDrag(t,n,o)},onOver:function onOver(t,n,i){e.outputs.onOver&&e.outputs.onOver(t,n,i)},onEnter:function onEnter(t,n,i){e.outputs.onEnter&&e.outputs.onEnter(t,n,i)},onLeave:function onLeave(t,n,i){e.outputs.onLeave&&e.outputs.onLeave(t,n,i)},onDrop:function onDrop(t,n,i){n.preventDefault(),e.outputs.onDrop&&e.outputs.onDrop(t,n,i)},onCancel:function onCancel(t,n,i){n.preventDefault(),n.dataTransfer&&"none"===n.dataTransfer.dropEffect&&e.outputs.onCancel&&e.outputs.onCancel(t,n,i)}})},h=function(){function sliceIterator(e,t){var n=[],i=!0,o=!1,s=void 0;try{for(var r,a=e[Symbol.iterator]();!(i=(r=a.next()).done);i=!0)if(n.push(r.value),t&&n.length===t)break}catch(e){o=!0,s=e}finally{try{!i&&a["return"]&&a["return"]()}finally{if(o)throw s}}return n}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function strategies_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var m=function singleSelect(e,t,n,o){return i(t).contains(e)?[]:[e]},f=function multiSelect(e,t,n,o){var r=!1,a=t.filter((function(t){return r||(r=t===e),t!==e&&o.indexOf(t)<0}));return!r&&e[this.inputs.get().category]&&e[this.inputs.get().category]instanceof Array&&s(e[this.inputs.get().category],this.inputs.get().category).visit((function(e){a=i(a).notIn(e)})),r||a.push(e),a},g={single:m,multiple:f,modifiers:function modifiers(e,t,n,o){var s=this;if(this.modifiers.control||this.modifiers.meta)return this.lastSelection=e,delete this.lastIndex,delete this.lastPivot,f.bind(this)(e,t,n,o);if(this.modifiers.shift){if(!this.lastSelection)return t;var r=n.indexOf(this.lastSelection);if(r<0)return t;var a=t.slice(),l=n.indexOf(e);if(r>=0){var c;if(this.lastPivot){var d=n.indexOf(this.lastPivot),u=r>d?[d,r]:[r,d],p=h(u,2),g=p[0],y=p[1],v=n.slice(g,y+1);a=i(a).notIn(v)}this.lastPivot=e;var b=r>l?[l,r]:[r,l],C=h(b,2),w=C[0],_=C[1],x=this.inputs.get().disabled?n.slice(w,_+1).filter((function(e){return!s.inputs.get().disabled(e)})):n.slice(w,_+1);a=i(a).notIn(x),(c=a).push.apply(c,strategies_toConsumableArray(x))}return a}return this.lastSelection=e,delete this.lastIndex,delete this.lastPivot,m.bind(this)(e,t.length>1?[]:t,n,o)},ancestors:function(e){function ancestors(t,n,i,o){return e.apply(this,arguments)}return ancestors.toString=function(){return e.toString()},ancestors}((function(e,t,n,o){return 0===t.length?[e]:i(t).contains(e)?[].concat(strategies_toConsumableArray(o)):[].concat(strategies_toConsumableArray(o),[e])}))},y={select:function select(e){this.inputs.get().onSelect(e,this.inputs.get().ancestors,this.inputs.get().model)},"unfold-on-selection":function unfoldOnSelection(e){if(!this.isSelected(e)){var t=this.state.get().unfolded.filter((function(t){return t!==e}));t.push(e),this.state.set({unfolded:t})}},"toggle-fold":function toggleFold(e){var t=this.state.get().unfolded.filter((function(t){return t!==e}));t.length===this.state.get().unfolded.length&&t.push(e),this.state.set({unfolded:t})}},v={"opener-control":function openerControl(e){return!i(this.state.get().unfolded).contains(e)},"not-selected":function notSelected(e){return!this.isSelected(e)},"no-child-selection":function noChildSelection(e){var t=this,n=function recurseCheck(n){return n!==e&&t.isSelected(n)||n[t.inputs.get().category]&&n[t.inputs.get().category]instanceof Array&&n[t.inputs.get().category].some(recurseCheck)},i=!n(e);return i},"max-depth":function maxDepth(){return!(!this.inputs.get().maxDepth||isNaN(parseInt(this.inputs.get().maxDepth,10)))&&this.inputs.get().depth>=parseInt(this.inputs.get().maxDepth,10)}},b={labels:{"search.placeholder":"Search ..."},css:{TreeView:"TreeView",opener:"opener",depth:"depth",selected:"selected",category:"category",folded:"folded",disabled:"disabled",async:"async",loading:"loading",nodrop:"nodrop",dragover:"dragover",search:"search",item:"item"},strategies:{selection:["single"],click:["select"],fold:["not-selected","no-child-selection"]},display:function display(e){return e.toString()},async:function async(e){return e()},openerOpts:{position:"right"},dragndrop:{draggable:!1,droppable:!1}},C=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function logic_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var w=function Core(e,t,n,i){_classCallCheck(this,Core),this.inputs=e,this.outputs=t,this.state=n,this.refresh=i},_=function(e){function TreeNode(){var e,t,n,o;_classCallCheck(this,TreeNode);for(var s=arguments.length,a=Array(s),l=0;l<s;l++)a[l]=arguments[l];return n=_possibleConstructorReturn(this,(e=TreeNode.__proto__||Object.getPrototypeOf(TreeNode)).call.apply(e,[this].concat(a))),t=n,n.isSelected=function(e){return i(n.inputs.get().selection).contains(e)},n.isFolded=function(e){let t=!0;e&&"boolean"===typeof e.expanded&&(t=!e.expanded);var i=n.inputs.get().strategies;return(!n.inputs.get().searched||n.isAsync(e))&&(i&&i.fold||[]).map((function(e){return(v[e]||e).bind(n)})).reduce((function(t,n){return t&&n(e,t)}),t)},n.hasChildren=function(e){return e[n.inputs.get().category]&&e[n.inputs.get().category]instanceof Array},n.isAsync=function(e){return!!e&&[n.inputs.get().category]&&"function"===typeof e[n.inputs.get().category]},n.isDisabled=function(e){var t=n.inputs.get().disabled;return!!t&&t(e)},n.isDraggable=function(e){return e&&n.inputs.get().dragndrop.draggable&&("function"!==typeof n.inputs.get().dragndrop.draggable||n.inputs.get().dragndrop.draggable(e))},n.isDroppable=function(e){return n.inputs.get().dragndrop.droppable&&("function"!==typeof n.inputs.get().dragndrop.droppable||n.inputs.get().dragndrop.droppable(e))},n.mixCss=function(e){return n.inputs.get().css[e]||b.css[e]},n.ulCss=function(){return r.classes(logic_defineProperty({},n.mixCss("depth")+"-"+(n.inputs.get().depth||0),!0))},n.liCss=function(e){var t;return r.classes((t={},logic_defineProperty(t,n.mixCss("selected"),n.isSelected(e)),logic_defineProperty(t,n.mixCss("category"),n.hasChildren(e)||n.isAsync(e)),logic_defineProperty(t,n.mixCss("folded"),n.hasChildren(e)||n.isAsync(e)?n.isFolded(e):null),logic_defineProperty(t,n.mixCss("disabled"),n.isDisabled(e)),logic_defineProperty(t,n.mixCss("async"),n.isAsync(e)&&n.isFolded(e)),logic_defineProperty(t,n.mixCss("loading"),n.isAsync(e)&&!n.isFolded(e)),t))},n.pending=[],n.unwrapPromise=function(e){n.pending.push(e);var t=n.inputs.get().async;return t?t(e[n.inputs.get().category]).then((function(t){e[n.inputs.get().category]=t,n.refresh()})).catch((function(e){throw e})).then((function(){return n.pending=n.pending.filter((function(t){return t!==e}))})):Promise.reject(new Error("Missing async function."))},n.onClick=function(e){return function(t){if(!n.isDisabled(e)){var i=n.inputs.get().strategies;(i&&i.click||[]).map((function(e){return(y[e]||e).bind(n)})).forEach((function(i){return i(e,t,n.inputs.get().ancestors,n.inputs.get().model)}))}}},n.getDragEvents=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t)return{};var i={draggable:n.isDraggable(e),onDragStart:n.isDraggable(e)&&u.onDragStart(e).bind(n),onDragOver:n.isDroppable(e)&&u.onDragOver(e).bind(n),onDragEnter:n.isDroppable(e)&&u.onDragEnter(e).bind(n),onDragLeave:n.isDroppable(e)&&u.onDragLeave(e).bind(n),onDrop:n.isDroppable(e)&&u.onDrop(e).bind(n),onDragEnd:n.isDraggable(e)&&u.onDragEnd(e).bind(n)};for(var o in i)i[o]||delete i[o];return i},o=t,_possibleConstructorReturn(n,o)}return _inherits(TreeNode,e),C(TreeNode,[{key:"onOpener",value:function onOpener(e,t){var n=this;return function(i){var o=n.state.get().unfolded.filter((function(t){return t!==e})),s=!0;o.length===n.state.get().unfolded.length&&(o.push(e),s=!1),e&&"boolean"===typeof e.expanded&&(e.expanded=!s),n.state.set({unfolded:o}),t&&t(e,s),i&&i.stopPropagation()}}},{key:"onExpand",value:function onExpand(e){var t=this;return function(n){var i=[...t.state.get().unfolded],o=i.find((function(t){return t===e}));if(o){if(n){var s=i.indexOf(e);s>=0&&(i.splice(s,1),e.expanded=!1),t.state.set({unfolded:i})}}else i.push(e),e.expanded=!0,t.state.set({unfolded:i})}}}]),TreeNode}(w),x=function(e){function RootNode(){var e,t,n,i;_classCallCheck(this,RootNode);for(var o=arguments.length,r=Array(o),a=0;a<o;a++)r[a]=arguments[a];return n=_possibleConstructorReturn(this,(e=RootNode.__proto__||Object.getPrototypeOf(RootNode)).call.apply(e,[this].concat(r))),t=n,n.modifiers={},n.onKey=function(e){n.modifiers={control:e.getModifierState("Control"),meta:e.getModifierState("Meta"),shift:e.getModifierState("Shift")}},n.onSelect=function(e,t,i){var o=n.inputs.get().strategies.selection||[],s=o.map((function(e){return(g[e]||e).bind(n)})).reduce((function(n,o){return o(e,n,i,t)}),n.inputs.get().selection);return n.outputs.onSelect(s,e,t,i),s},n.wrapDragNDrop=p.bind(n),n.mixCss=function(e){return n.inputs.get().css[e]||b.css[e]},n.filterTree=function(e){var t=n.inputs.get().search;return t&&e.trim()?s(n.inputs.get().model,n.inputs.get().category).filterMap(t(e.trim())):null},i=t,_possibleConstructorReturn(n,i)}return _inherits(RootNode,e),RootNode}(w),S=n(3933),I=n.n(S),D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function labels_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var R=function withLabels(e){return function(t){return{name:"withLabels-"+t.name,props:t.props?[].concat(labels_toConsumableArray(t.props)):[],render:function render(){var n=arguments[0],i={props:D({},this.$props,{labels:D({},e,this.$props.labels)})};return n(t,i)}}}},T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function transitions_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var P=function withTransition(e){var t=e.key;return function(e){return{name:"withTransition-"+e.name,props:e.props?[].concat(transitions_toConsumableArray(e.props)):[],render:function render(){var n=arguments[0],i={props:T({},this.$props)},o=T({},this.transition);return this.transition?n("transition",o,[n(e,I()([i,{key:t(this.$props)}]))]):n(e,i)}}}},O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function listener_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function listener_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var k=function withListener(e){var t=e.eventType,n=void 0===t?"click":t,i=e.prop,o=void 0===i?"listener":i,s=e.mountOn,r=void 0===s?null:s,a=e.autoMount,l=void 0!==a&&a,c=e.regulate,d=void 0!==c&&c;return function(e){return{name:"withListener-"+e.name,props:e.props?[].concat(listener_toConsumableArray(e.props)):[],created:function created(){l&&this.mount(this)},beforeDestroy:function beforeDestroy(){this.unmount()},beforeUpdate:function beforeUpdate(){r&&(r(this.$props)?this.mount(this):this.unmount())},data:function data(){return{listening:!1,ticking:!1,callback:null}},methods:{subscribe:function subscribe(e){this.callback=e},onEvent:function onEvent(e){var t=this;if(this.callback)if(d){if(!this.ticking){var n=this.callback;window.requestAnimationFrame((function(){return n(e,(function(){t.ticking=!1}))}))}this.ticking=!0}else this.callback(e)},mount:function mount(){this.listening||(document.addEventListener(n,this.onEvent),this.listening=!0)},unmount:function unmount(){this.listening&&(document.removeEventListener(n,this.onEvent),this.listening=!1)}},render:function render(){var t=arguments[0],n=listener_defineProperty({},o,{subscribe:this.subscribe,mount:this.mount,unmount:this.unmount}),i={props:O({},this.$props,n)};return this.$scopedSlots.default&&(i.props.scopedSlots=this.$scopedSlots),t(e,i)}}}},F=function combine(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function TreeViewNode_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var $={name:"TreeViewNode",created:function created(){var e=this,t={get:function get(){return e.$props}},n={get:function get(){return e.$data},set:function set(t){for(var n in t)n in e.$data&&(e.$data[n]=t[n])}};this.node=new _(t,{},n,(function(){e._unmounted||e.$forceUpdate()}))},beforeDestroy:function beforeDestroy(){this._unmounted=!0},props:["model","category","selection","onSelect","display","strategies","dragndrop","labels","sort","disabled","openerOpts","async","css","folded","transition","unique","loading","depth","ancestors","searched","onSelect","filteredModel","scopedSlots"],data:function data(){return{unfolded:[]}},computed:{childrenModel:function childrenModel(){var e=this,t=new Map;return this.$props.model.forEach((function(n){e.node.hasChildren(n)&&!e.node.isAsync(n)&&t.set(n,e.$props.sort?n[e.$props.category].sort(e.$props.sort):n[e.$props.category])})),t},rootDragData:function rootDragData(){var e=this.node.getDragEvents(null,!this.$props.depth);return A({attrs:{draggable:e.draggable}},l(e).nestPrefix("on",(function(e){return e.toLowerCase()})))}},render:function render(){var e=this,t=arguments[0],n=function renderSubtree(n){if(!e.node.hasChildren(n)&&!e.node.isAsync(n))return null;var o=null;!e.node.isAsync(n)||e.node.isFolded(n)||i(e.node.pending).contains(n)||e.node.unwrapPromise(n),e.$props.filteredModel&&(o=e.$props.filteredModel.get(n));var s={props:A({},e.$props,{model:e.childrenModel.get(n),filteredModel:o,ancestors:[].concat(TreeViewNode_toConsumableArray(e.$props.ancestors),[n]),depth:(e.$props.depth||0)+1,folded:e.node.isFolded(n),loading:e.node.isAsync(n)&&!e.node.isFolded(n)})};return t(j,s)},o=function renderOpener(n,i){return function(o){return(e.node.hasChildren(n)&&n[e.$props.category].length>0||e.node.isAsync(n))&&e.$props.openerOpts.position===o?t(i,{class:e.node.mixCss("opener"),on:{click:e.node.onOpener(n,e.$props.openerOpts.callback)}}):null}},s=this.$props,r=s.model,a=s.folded,c=s.display,d=s.loading,u=s.scopedSlots;if(a)return null;if(d)return t("span");var p=this.$props.opener||"span",h=r.filter((function(t){return!e.$props.searched||e.$props.filteredModel&&e.$props.filteredModel.has(t)})).map((function(i,s){var r=A({},e.node.getDragEvents(i),{class:e.node.liCss(i)}),a=A({attrs:{draggable:r.draggable}},l(r).nestPrefix("on",(function(e){return e.toLowerCase()})));e.$props.unique&&(a.key=e.$props.unique(i,s)),i.__onExpandNode__||(i.__onExpandNode__=e.node.onExpand(i));var d=null;return d=u&&u.default?u.default({item:i}):c&&c(i,e.$props),t("li",a,[t("span",{class:e.node.mixCss("item"),on:{click:e.node.onClick(i)}},[o(i,p)("left"),d,o(i,p)("right")]),n(i)])}));return t("ul",I()([{class:this.node.ulCss()},this.rootDragData]),[h])}},j=P({key:function key(e){return e.folded||e.loading}})($),E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function _objectWithoutProperties(e,t){var n={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}var M={name:"TreeView",props:["model","category","selection","onSelect","display","search","transition","strategies","labels","css","dragndrop","sort","disabled","openerOpts","async","keyUpListener","keyDownListener","unique","scopedSlots"],data:function data(){return{searchInput:"",filtered:null}},methods:{onSearch:function onSearch(e){var t=e.currentTarget.value;this.$data.searchInput=t,this.$data.filtered=this.rootNode.filterTree(t)}},computed:{computedModel:function computedModel(){return this.$props.sort?this.$props.model.sort(this.$props.sort):this.$props.model},wrapDragNDrop:function wrapDragNDrop(){return this.rootNode.wrapDragNDrop()}},created:function created(){var e=this,t={get:function get(){return E({},b,l(e.$props).filter((function(e){return!!e})))}},n={onSelect:this.$props.onSelect,onDrag:this.$props.dragndrop&&this.$props.dragndrop.drag,onOver:this.$props.dragndrop&&this.$props.dragndrop.over,onEnter:this.$props.dragndrop&&this.$props.dragndrop.enter,onLeave:this.$props.dragndrop&&this.$props.dragndrop.leave,onDrop:this.$props.dragndrop&&this.$props.dragndrop.drop,onCancel:this.$props.dragndrop&&this.$props.dragndrop.cancel},i={get:function get(){return E({},e.$data)},set:function set(t){for(var n in t)n in e.$data&&(e.$data[n]=t[n])}};this.rootNode=new x(t,n,i,this.$forceUpdate)},mounted:function mounted(){this.keyUpListener.subscribe(this.rootNode.onKey),this.keyDownListener.subscribe(this.rootNode.onKey)},render:function render(){var e=arguments[0],t=l(this.$props).filter((function(e){return!!e})),n=(t.onSelect,t.sort),i=(t.model,_objectWithoutProperties(t,["onSelect","sort","model"])),o={props:E({},b,i,{model:this.computedModel,filteredModel:this.$data.filtered,onSelect:this.rootNode.onSelect,dragndrop:this.wrapDragNDrop,ancestors:[],sort:n,folded:!1,searched:!!this.$data.searchInput.trim()})},s=this.$props.search?e("input",{attrs:{type:"search",placeholder:this.$props.labels&&this.$props.labels["search.placeholder"]},class:this.rootNode.mixCss("search"),domProps:{value:this.$data.searchInput},on:{input:this.onSearch}}):null;return e("div",{class:this.rootNode.mixCss("TreeView")},[s,e(j,o)])}},N=F(R(b.labels),k({eventType:"keyup",prop:"keyUpListener",autoMount:!0}),k({eventType:"keydown",prop:"keyDownListener",autoMount:!0}))(M)},59859:function(e){(function webpackUniversalModuleDefinition(t,n){e.exports=n()})(0,(function(){return function(e){var t={};function __nested_webpack_require_584__(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,__nested_webpack_require_584__),i.l=!0,i.exports}return __nested_webpack_require_584__.m=e,__nested_webpack_require_584__.c=t,__nested_webpack_require_584__.i=function(e){return e},__nested_webpack_require_584__.d=function(e,t,n){__nested_webpack_require_584__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__nested_webpack_require_584__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __nested_webpack_require_584__.d(t,"a",t),t},__nested_webpack_require_584__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__nested_webpack_require_584__.p="",__nested_webpack_require_584__(__nested_webpack_require_584__.s=1)}([function(e,t,n){"use strict";function camelize(e){if(0===e.length)return e;var t,n,i=e.split(/[_-]/);if(1===i.length&&i[0][0].toLowerCase()===i[0][0])return e;for(n=i[0].toLowerCase(),t=1;t<i.length;t++)n=n+i[t].charAt(0).toUpperCase()+i[t].substring(1).toLowerCase();return n}camelize.prepended=function(e,t){return t=camelize(t),e+t[0].toUpperCase()+t.substring(1)},e.exports=camelize},function(e,t,n){"use strict";var i=n(0);e.exports=function(e){e=e||{};var t=i(e.name||e.past||"history"),n=i(e.future||"future"),o=i.prepended("clear",t),s=i.prepended(t,"back"),r=i.prepended(t,"forward"),a=i.prepended("can",s),l=i.prepended("can",r),c=e.max,d={configure:function(e){e.addTransitionLifecycleNames(s),e.addTransitionLifecycleNames(r)},init:function(e){e[t]=[],e[n]=[]},lifecycle:function(e,i){"onEnterState"===i.event&&(e[t].push(i.to),c&&e[t].length>c&&e[t].shift(),i.transition!==s&&i.transition!==r&&(e[n].length=0))},methods:{},properties:{}};return d.methods[o]=function(){this[t].length=0,this[n].length=0},d.properties[a]={get:function(){return this[t].length>1}},d.properties[l]={get:function(){return this[n].length>0}},d.methods[s]=function(){if(!this[a])throw Error("no history");var e=this[t].pop(),i=this[t].pop();this[n].push(e),this._fsm.transit(s,e,i,[])},d.methods[r]=function(){if(!this[l])throw Error("no history");var e=this.state,t=this[n].pop();this._fsm.transit(r,e,t,[])},d}}])}))},66671:function(e){(function webpackUniversalModuleDefinition(t,n){e.exports=n()})(0,(function(){return function(e){var t={};function __nested_webpack_require_563__(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,__nested_webpack_require_563__),i.l=!0,i.exports}return __nested_webpack_require_563__.m=e,__nested_webpack_require_563__.c=t,__nested_webpack_require_563__.i=function(e){return e},__nested_webpack_require_563__.d=function(e,t,n){__nested_webpack_require_563__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__nested_webpack_require_563__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __nested_webpack_require_563__.d(t,"a",t),t},__nested_webpack_require_563__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__nested_webpack_require_563__.p="",__nested_webpack_require_563__(__nested_webpack_require_563__.s=5)}([function(e,t,n){"use strict";e.exports=function(e,t){var n,i,o;for(n=1;n<arguments.length;n++)for(o in i=arguments[n],i)i.hasOwnProperty(o)&&(e[o]=i[o]);return e}},function(e,t,n){"use strict";var i=n(0);e.exports={build:function(e,t){var n,o,s,r=t.plugins;for(n=0,o=r.length;n<o;n++)s=r[n],s.methods&&i(e,s.methods),s.properties&&Object.defineProperties(e,s.properties)},hook:function(e,t,n){var i,o,s,r,a=e.config.plugins,l=[e.context];for(n&&(l=l.concat(n)),i=0,o=a.length;i<o;i++)r=a[i],s=a[i][t],s&&s.apply(r,l)}}},function(e,t,n){"use strict";function camelize(e){if(0===e.length)return e;var t,n,i=e.split(/[_-]/);if(1===i.length&&i[0][0].toLowerCase()===i[0][0])return e;for(n=i[0].toLowerCase(),t=1;t<i.length;t++)n=n+i[t].charAt(0).toUpperCase()+i[t].substring(1).toLowerCase();return n}camelize.prepended=function(e,t){return t=camelize(t),e+t[0].toUpperCase()+t.substring(1)},e.exports=camelize},function(e,t,n){"use strict";var i=n(0),o=n(2);function Config(e,t){e=e||{},this.options=e,this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}i(Config.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=o.prepended("onEnter",e),this.lifecycle.onLeave[e]=o.prepended("onLeave",e),this.lifecycle.on[e]=o.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=o.prepended("onBefore",e),this.lifecycle.onAfter[e]=o.prepended("onAfter",e),this.lifecycle.on[e]=o.prepended("on",e)},mapTransition:function(e){var t=e.name,n=e.from,i=e.to;return this.addState(n),"function"!==typeof i&&this.addState(i),this.addTransition(t),this.map[n][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"===typeof e?this.mapTransition(i({},this.defaults.init,{to:e,active:!0})):"object"===typeof e?this.mapTransition(i({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"===typeof e?e:"object"===typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var n,i,o;for(e=e||[],n=0,i=e.length;n<i;n++)o=e[n],"function"===typeof o&&(e[n]=o=o()),o.configure&&o.configure(this);return e},configureTransitions:function(e){var t,n,i,o,s,r=this.defaults.wildcard;for(n=0;n<e.length;n++)for(i=e[n],o=Array.isArray(i.from)?i.from:[i.from||r],s=i.to||r,t=0;t<o.length;t++)this.mapTransition({name:i.name,from:o[t],to:s})},transitionFor:function(e,t){var n=this.defaults.wildcard;return this.map[e][t]||this.map[n][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=Config},function(e,t,n){var i=n(0),o=n(6),s=n(1),r=[null,[]];function JSM(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}i(JSM.prototype,{init:function(e){if(i(this.context,this.config.data.apply(this.context,e)),s.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var n=this.config.defaults.wildcard,i=this.config.transitionFor(this.state,e),o=i&&i.to;return"function"===typeof o?o.apply(this.context,[{transition:e,from:this.state},...t]):o===n?this.state:o},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,n,i){var o=this.config.lifecycle,s=this.config.options.observeUnchangedState||t!==n;return n?this.isPending()?this.context.onPendingTransition(e,t,n):(this.config.addState(n),this.beginTransit(),i.unshift({transition:e,from:t,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(o.onBefore.transition),this.observersForEvent(o.onBefore[e]),this.observersForEvent(o.on.transition),s?this.observersForEvent(o.onLeave.state):r,s?this.observersForEvent(o.onLeave[t]):r,s?["doTransit",[this]]:r,s?this.observersForEvent(o.onEnter.state):r,s?this.observersForEvent(o.onEnter[n]):r,s?this.observersForEvent(o.on[n]):r,this.observersForEvent(o.onAfter.transition),this.observersForEvent(o.onAfter[e]),this.observersForEvent(o.on[e])],i)):this.context.onInvalidTransition(e,t,n)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,n=0,i=this.observers.length,o=[];n<i;n++)t=this.observers[n],t[e]&&o.push(t);return[e,o,!0]},observeEvents:function(e,t,n,i){if(0===e.length)return this.endTransit(void 0===i||i);var o=e[0][0],r=e[0][1],a=e[0][2];if(t[0].event=o,void 0!==i&&(t[0].prevResult=i),0===r.length)return e.shift(),this.observeEvents(e,t,o,i);var l=r.shift();o&&a&&o!==n&&s.hook(this,"lifecycle",t);var c=l[o].apply(l,t);if(c&&"function"===typeof c.then){var d=this.observeEvents.bind(this);return c.then((n=>!1===n?this.endTransit(!1):d(e,t,o,n))).catch(this.failTransit.bind(this))}return!1===c?this.endTransit(!1):this.observeEvents(e,t,o,c)},onInvalidTransition:function(e,t,n){throw new o("transition is invalid in current state",e,t,n,this.state)},onPendingTransition:function(e,t,n){throw new o("transition is invalid while previous transition is still in progress",e,t,n,this.state)}}),e.exports=JSM},function(e,t,n){"use strict";var i=n(0),o=n(2),s=n(1),r=n(3),a=n(4),l={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},seek:function(e,t){return this._fsm.seek(e,t)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,n){return this._fsm.onInvalidTransition(e,t,n)},onPendingTransition:function(e,t,n){return this._fsm.onPendingTransition(e,t,n)}},c={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function StateMachine(e){return apply(this||{},e)}function factory(){var e,t;"function"===typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var n=new r(t,StateMachine);return build(e.prototype,n),e.prototype._fsm.config=n,e}function apply(e,t){var n=new r(t,StateMachine);return build(e,n),e._fsm(),e}function build(e,t){if("object"!==typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");s.build(e,t),Object.defineProperties(e,c),i(e,l),i(e,t.methods),t.allTransitions().forEach((function(t){e[o(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}})),e._fsm=function(){this._fsm=new a(this,t),this._fsm.init(arguments)}}StateMachine.version="3.0.1",StateMachine.factory=factory,StateMachine.apply=apply,StateMachine.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=StateMachine},function(e,t,n){"use strict";e.exports=function(e,t,n,i,o){this.message=e,this.transition=t,this.from=n,this.to=i,this.current=o}}])}))},91739:(e,t,n)=>{(function webpackUniversalModuleDefinition(t,i){e.exports=i(n(29339))})(window,(function(e){return function(e){var t={};function __nested_webpack_require_868__(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,__nested_webpack_require_868__),i.l=!0,i.exports}return __nested_webpack_require_868__.m=e,__nested_webpack_require_868__.c=t,__nested_webpack_require_868__.d=function(e,t,n){__nested_webpack_require_868__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__nested_webpack_require_868__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__nested_webpack_require_868__.t=function(e,t){if(1&t&&(e=__nested_webpack_require_868__(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__nested_webpack_require_868__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)__nested_webpack_require_868__.d(n,i,function(t){return e[t]}.bind(null,i));return n},__nested_webpack_require_868__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __nested_webpack_require_868__.d(t,"a",t),t},__nested_webpack_require_868__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__nested_webpack_require_868__.p="",__nested_webpack_require_868__(__nested_webpack_require_868__.s="./src/components/datatable.component.vue")}({"./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/sass-loader/lib/loader.js?!./src/components/datatable.component.scss?vue&type=style&index=0&lang=scss&":function(e,t,n){t=e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1),t.push([e.i,".ngx-datatable {\n  display: block;\n  overflow: hidden;\n  justify-content: center;\n  position: relative;\n  -webkit-transform: translate3d(0, 0, 0);\n  transform: translate3d(0, 0, 0);\n  /**\r\n   * Vertical Scrolling Adjustments\r\n   */\n  /**\r\n   * Horizontal Scrolling Adjustments\r\n   */\n  /**\r\n   * Fixed Header Height Adjustments\r\n   */\n  /**\r\n   * Fixed row height adjustments\r\n   */\n  /**\r\n   * Shared Styles\r\n   */\n  /**\r\n   * Header Styles\r\n   */\n  /**\r\n   * Body Styles\r\n   */\n  /**\r\n   * Footer Styles\r\n   */\n}\n.ngx-datatable.ngx-flex {\n    display: flex;\n    flex-flow: column;\n    justify-content: flex-start;\n    height: 100%;\n}\n.ngx-datatable.ngx-flex .datatable-body {\n      overflow-y: auto;\n      flex: 1 1 auto;\n}\n.ngx-datatable.ngx-flex .datatable-header,\n    .ngx-datatable.ngx-flex .datatable-footer {\n      flex: none;\n}\n.ngx-datatable.ngx-nowrap-text .datatable-body .datatable-body-row .datatable-body-cell .datatable-body-cell-label {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n.ngx-datatable [hidden] {\n    display: none !important;\n}\n.ngx-datatable .hidden-columns {\n    visibility: hidden;\n    position: absolute;\n    z-index: -1;\n}\n.ngx-datatable *,\n  .ngx-datatable *:before,\n  .ngx-datatable *:after {\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n}\n.ngx-datatable.scroll-vertical .datatable-body {\n    overflow-y: auto;\n}\n.ngx-datatable.scroll-vertical.virtualized .datatable-body .datatable-row-wrapper {\n    position: absolute;\n}\n.ngx-datatable.scroll-horz .datatable-body {\n    overflow-x: auto;\n    -webkit-overflow-scrolling: touch;\n}\n.ngx-datatable.fixed-header .datatable-header .datatable-header-inner {\n    white-space: nowrap;\n}\n.ngx-datatable.fixed-header .datatable-header .datatable-header-inner .datatable-header-cell {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n}\n.ngx-datatable.fixed-row .datatable-scroll {\n    white-space: nowrap;\n}\n.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row {\n      white-space: nowrap;\n}\n.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row .datatable-body-cell {\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n}\n.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row .datatable-body-group-cell {\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n}\n.ngx-datatable .datatable-body-row,\n  .ngx-datatable .datatable-row-center,\n  .ngx-datatable .datatable-header-inner {\n    display: -webkit-box;\n    display: -moz-box;\n    display: -ms-flexbox;\n    display: -webkit-flex;\n    display: flex;\n    flex-direction: row;\n    -webkit-flex-flow: row;\n    -moz-flex-flow: row;\n    -ms-flex-flow: row;\n    -o-flex-flow: row;\n    flex-flow: row;\n}\n.ngx-datatable .datatable-body-cell,\n  .ngx-datatable .datatable-header-cell {\n    overflow-x: hidden;\n    vertical-align: top;\n    display: inline-flex;\n    line-height: 1.625;\n}\n.ngx-datatable .datatable-body-cell:focus,\n    .ngx-datatable .datatable-header-cell:focus {\n      outline: none;\n}\n.ngx-datatable .datatable-body-cell .datatable-body-cell-label,\n    .ngx-datatable .datatable-header-cell .datatable-body-cell-label {\n      width: 100%;\n}\n.ngx-datatable .datatable-body-cell-bold,\n    .ngx-datatable .datatable-header-cell-bold {\n      font-weight: bold;\n}\n.ngx-datatable .datatable-row-left,\n  .ngx-datatable .datatable-row-right {\n    z-index: 9;\n}\n.ngx-datatable .datatable-row-left,\n  .ngx-datatable .datatable-row-center,\n  .ngx-datatable .datatable-row-group,\n  .ngx-datatable .datatable-row-right {\n    position: relative;\n}\n.ngx-datatable .datatable-header {\n    overflow: hidden;\n}\n.ngx-datatable .datatable-header .datatable-header-inner {\n      align-items: stretch;\n      -webkit-align-items: stretch;\n}\n.ngx-datatable .datatable-header .datatable-header-cell {\n      position: relative;\n      display: inline-flex;\n      user-select: none;\n}\n.ngx-datatable .datatable-header .datatable-header-cell.sortable .datatable-header-cell-wrapper {\n        cursor: pointer;\n}\n.ngx-datatable .datatable-header .datatable-header-cell.longpress .datatable-header-cell-wrapper {\n        cursor: move;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .sort-btn {\n        margin-left: auto;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .sort-btn::before {\n        line-height: 100%;\n        vertical-align: middle;\n        display: inline-block;\n        cursor: pointer;\n        font-size: 1.25rem;\n        margin-right: -7px;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .resize-handle,\n      .ngx-datatable .datatable-header .datatable-header-cell .resize-handle--not-resizable {\n        display: inline-block;\n        position: absolute;\n        right: 0;\n        top: 0;\n        bottom: 0;\n        width: 5px;\n        padding: 0 4px;\n        visibility: hidden;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .resize-handle {\n        cursor: ew-resize;\n}\n.ngx-datatable .datatable-header .datatable-header-cell.resizeable:hover .resize-handle {\n        visibility: visible;\n}\n.ngx-datatable .datatable-header .datatable-header-cell:hover .resize-handle--not-resizable {\n        visibility: visible;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .targetMarker {\n        position: absolute;\n        top: 0;\n        bottom: 0;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .targetMarker.dragFromLeft {\n          right: -13px;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .targetMarker.dragFromRight {\n          left: 0;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .targetMarker .icon {\n          position: absolute;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .targetMarker .datatable-icon-down {\n          top: 0px;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .targetMarker .datatable-icon-up {\n          top: 35px;\n}\n.ngx-datatable .datatable-header .datatable-header-cell .datatable-header-cell-template-wrap {\n        height: inherit;\n}\n.ngx-datatable .datatable-body {\n    position: relative;\n    z-index: 10;\n    display: block;\n}\n.ngx-datatable .datatable-body .datatable-scroll {\n      display: inline-block;\n}\n.ngx-datatable .datatable-body .datatable-row-detail {\n      overflow-y: hidden;\n}\n.ngx-datatable .datatable-body .datatable-row-wrapper {\n      display: -webkit-box;\n      display: -moz-box;\n      display: -ms-flexbox;\n      display: -webkit-flex;\n      display: flex;\n      -webkit-box-orient: vertical;\n      -webkit-box-direction: normal;\n      -webkit-flex-direction: column;\n      -moz-box-orient: vertical;\n      -moz-box-direction: normal;\n      -ms-flex-direction: column;\n      flex-direction: column;\n}\n.ngx-datatable .datatable-body .datatable-body-row {\n      outline: none;\n}\n.ngx-datatable .datatable-body .datatable-body-row > div {\n        display: -webkit-box;\n        display: -moz-box;\n        display: -ms-flexbox;\n        display: -webkit-flex;\n        display: flex;\n}\n.ngx-datatable .datatable-footer {\n    display: block;\n    width: 100%;\n    margin-top: auto;\n}\n.ngx-datatable .datatable-footer .datatable-footer-inner {\n      display: flex;\n      align-items: center;\n      width: 100%;\n}\n.ngx-datatable .datatable-footer .selected-count .page-count {\n      flex: 1 1 40%;\n}\n.ngx-datatable .datatable-footer .selected-count .datatable-pager {\n      flex: 1 1 60%;\n}\n.ngx-datatable .datatable-footer .page-count {\n      flex: 1 1 20%;\n}\n.ngx-datatable .datatable-footer .datatable-pager {\n      flex: 1 1 80%;\n      text-align: right;\n}\n.ngx-datatable .datatable-footer .datatable-pager .pager,\n      .ngx-datatable .datatable-footer .datatable-pager .pager li {\n        padding: 0;\n        margin: 0;\n        display: inline-block;\n        list-style: none;\n}\n.ngx-datatable .datatable-footer .datatable-pager .pager li,\n      .ngx-datatable .datatable-footer .datatable-pager .pager li a {\n        outline: none;\n}\n.ngx-datatable .datatable-footer .datatable-pager .pager li a {\n        cursor: pointer;\n        display: inline-block;\n}\n.ngx-datatable .datatable-footer .datatable-pager .pager li.disabled a {\n        cursor: not-allowed;\n}\n",""])},"./node_modules/css-loader/dist/runtime/api.js":function(e,t,n){"use strict";function cssWithMappingToString(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"===typeof btoa){var o=toComment(i),s=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[n].concat(s).concat([o]).join("\n")}return[n].join("\n")}function toComment(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,"+t;return"/*# "+n+" */"}e.exports=function(e){var t=[];return t.toString=function toString(){return this.map((function(t){var n=cssWithMappingToString(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"===typeof e&&(e=[[null,e,""]]);for(var i={},o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(o=0;o<e.length;o++){var r=e[o];null!=r[0]&&i[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="("+r[2]+") and ("+n+")"),t.push(r))}},t}},"./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/body/body-cell.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=n("./src/utils/index.ts"),l=function(e){function DataTableBodyCellComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.sanitizedValue=null,t.value=null,t.isFocused=!1,t}return i(DataTableBodyCellComponent,e),DataTableBodyCellComponent.prototype.onRowChanged=function(){this.checkValueUpdates()},DataTableBodyCellComponent.prototype.created=function(){var e,t;this.cellSlot&&(this.$slots.default=this.cellSlot({row:null!==(t=null===(e=this.rowContext)||void 0===e?void 0:e.row)&&void 0!==t?t:{},column:this.column,rowIndex:this.rowContext.rowIndex,expanded:this.rowContext.expanded,group:this.rowContext.group,value:this.value,updateCell:this.$forceUpdate.bind(this)})),this.renderTracking&&this.$emit("cell-created",this.column)},DataTableBodyCellComponent.prototype.beforeUpdate=function(){var e,t;this.cellSlot&&(this.$slots.default=this.cellSlot({row:null!==(t=null===(e=this.rowContext)||void 0===e?void 0:e.row)&&void 0!==t?t:{},column:this.column,rowIndex:this.rowContext.rowIndex,expanded:this.rowContext.expanded,group:this.rowContext.group,value:this.value,updateCell:this.$forceUpdate.bind(this)})),this.renderTracking&&this.$emit("cell-updated",this.column)},DataTableBodyCellComponent.prototype.checkValueUpdates=function(){var e="";e=this.rowContext&&this.column?this.column.$$valueGetter(this.rowContext.row,this.column.prop):"",this.value!==e&&(this.value=e,this.sanitizedValue=null!==e&&void 0!==e?this.stripHtml(e):e)},DataTableBodyCellComponent.prototype.stripHtml=function(e){return e.replace?e.replace(/<\/?[^>]+(>|$)/g,""):e},DataTableBodyCellComponent.prototype.onFocus=function(){this.isFocused=!0},DataTableBodyCellComponent.prototype.onBlur=function(){this.isFocused=!1},DataTableBodyCellComponent.prototype.onClick=function(e){this.$emit("activate",{type:"click",event:e,row:this.rowContext.row,rowHeight:this.rowContext.rowHeight,column:this.column,cellElement:this.$el,value:this.value,group:this.rowContext.group})},DataTableBodyCellComponent.prototype.onDblClick=function(e){this.$emit("activate",{type:"dblclick",event:e,row:this.rowContext.row,rowHeight:this.rowContext.rowHeight,column:this.column,cellElement:this.$el,value:this.value,group:this.rowContext.group})},DataTableBodyCellComponent.prototype.onKeyDown=function(e){var t=e.keyCode,n=e.target===this.$el,i=t===a.Keys.return||t===a.Keys.down||t===a.Keys.up||t===a.Keys.left||t===a.Keys.right||t===a.Keys.pageUp||t===a.Keys.pageDown;i&&n&&(e.preventDefault(),e.stopPropagation(),this.$emit("activate",{type:"keydown",event:e,row:this.rowContext.row,rowIndex:this.rowContext.rowIndex,rowHeight:this.rowContext.rowHeight,column:this.column,cellElement:this.$el,value:this.value,group:this.rowContext.group}))},DataTableBodyCellComponent.prototype.onCheckboxChange=function(e){this.$emit("activate",{type:"checkbox",event:e,row:this.rowContext.row,rowHeight:this.rowContext.rowHeight,column:this.column,cellElement:this.$el,treeStatus:this.rowContext.treeStatus,value:this.value,group:this.rowContext.group})},DataTableBodyCellComponent.prototype.onTreeAction=function(e){this.$emit("tree-action",{event:e,row:this.rowContext.row})},DataTableBodyCellComponent.prototype.onMouseEnter=function(e){this.$emit("mouseenter",{event:e,row:this.rowContext.row})},Object.defineProperty(DataTableBodyCellComponent.prototype,"cssClasses",{get:function(){var e=this;if(!this.rowContext)return null;var t,n={};if(this.column.cellClass){var i=this.column.cellClass;Array.isArray(i)||(i=[i]),i.forEach((function(i){var o,s,r;if(t=null,"string"===typeof i?n[i]=!0:Array.isArray(i)?i.forEach((function(e){n[e]=!0})):"function"===typeof i&&(t=i),t){var a=t({row:null===(o=e.rowContext)||void 0===o?void 0:o.row,group:null===(s=e.rowContext)||void 0===s?void 0:s.group,column:e.column,value:e.value,rowHeight:null===(r=e.rowContext)||void 0===r?void 0:r.rowHeight});if("string"===typeof a)n[a]=!0;else if("object"===typeof a)for(var l=Object.keys(a),c=0,d=l;c<d.length;c++){var u=d[c];!0===a[u]&&(n[" "+u]=!0)}}}))}return n["active"]=this.isFocused,n},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyCellComponent.prototype,"styles",{get:function(){return this.rowContext?{width:this.column.width+"px",minWidth:this.column.minWidth?this.column.minWidth+"px":void 0,maxWidth:this.column.maxWidth?this.column.maxWidth+"px":void 0,height:this.rowContext.rowHeight+"px"}:{}},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyCellComponent.prototype,"marginCellStyle",{get:function(){return this.rowContext?{"margin-left":this.calcLeftMargin(this.column,this.rowContext.row)+"px"}:{}},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyCellComponent.prototype,"isCheckboxable",{get:function(){return this.column.checkboxable&&(!this.displayCheck||this.displayCheck(this.rowContext.row,this.column,this.value))},enumerable:!1,configurable:!0}),DataTableBodyCellComponent.prototype.cellHeight=function(e){var t=e;return isNaN(t)?t:t+"px"},DataTableBodyCellComponent.prototype.calcLeftMargin=function(e,t){var n=null!==e.treeLevelIndent?e.treeLevelIndent:50;return e.isTreeColumn?t.level*n:0},o([r.Prop(),s("design:type",Object)],DataTableBodyCellComponent.prototype,"column",void 0),o([r.Prop(),s("design:type",Object)],DataTableBodyCellComponent.prototype,"rowContext",void 0),o([r.Prop(),s("design:type",String)],DataTableBodyCellComponent.prototype,"tabIndex",void 0),o([r.Prop(),s("design:type",Function)],DataTableBodyCellComponent.prototype,"cellSlot",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableBodyCellComponent.prototype,"renderTracking",void 0),o([r.Prop(),s("design:type",Function)],DataTableBodyCellComponent.prototype,"displayCheck",void 0),o([r.Watch("rowContext.row",{deep:!0,immediate:!0}),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTableBodyCellComponent.prototype,"onRowChanged",null),DataTableBodyCellComponent=o([r.Component],DataTableBodyCellComponent),DataTableBodyCellComponent}(r.Vue);t.default=l},"./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/body/body-row-wrapper.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=n("./src/components/body/body-group-header.component.ts"),l=n("./src/components/body/body-row-detail.component.ts"),c=n("./src/components/body/body-row.component.vue"),d=function(e){function DataTableRowWrapperComponent(){return null!==e&&e.apply(this,arguments)||this}return i(DataTableRowWrapperComponent,e),DataTableRowWrapperComponent.prototype.mounted=function(){this.$emit("set-row-element",this.$el)},DataTableRowWrapperComponent.prototype.updated=function(){this.$emit("set-row-element",this.$el)},DataTableRowWrapperComponent.prototype.onContextmenu=function(e){this.$emit("rowContextmenu",{event:e,row:this.row})},Object.defineProperty(DataTableRowWrapperComponent.prototype,"groupHeaderStyles",{get:function(){var e={};return e["transform"]="translate3d("+this.offsetX+"px, 0px, 0px)'",e["backface-visibility"]="hidden",e["width"]=this.innerWidth||"100%",e["height"]=this.groupRowHeight?this.groupRowHeight+"px":"auto",e},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableRowWrapperComponent.prototype,"rowId",{get:function(){if(!this.row)return null;if(this.rowIdentity){var e=this.rowIdentity(this.row);return"object"===typeof e?null:e}return null},enumerable:!1,configurable:!0}),o([r.Prop(),s("design:type",Number)],DataTableRowWrapperComponent.prototype,"innerWidth",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableRowWrapperComponent.prototype,"rowDetail",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableRowWrapperComponent.prototype,"groupHeader",void 0),o([r.Prop(),s("design:type",Number)],DataTableRowWrapperComponent.prototype,"groupLevel",void 0),o([r.Prop(),s("design:type",Number)],DataTableRowWrapperComponent.prototype,"offsetX",void 0),o([r.Prop(),s("design:type",Number)],DataTableRowWrapperComponent.prototype,"rowDetailHeight",void 0),o([r.Prop(),s("design:type",Number)],DataTableRowWrapperComponent.prototype,"groupRowHeight",void 0),o([r.Prop(),s("design:type",Object)],DataTableRowWrapperComponent.prototype,"row",void 0),o([r.Prop(),s("design:type",Function)],DataTableRowWrapperComponent.prototype,"rowIdentity",void 0),o([r.Prop(),s("design:type",Array)],DataTableRowWrapperComponent.prototype,"groupRowsBy",void 0),o([r.Prop(),s("design:type",Number)],DataTableRowWrapperComponent.prototype,"rowIndex",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableRowWrapperComponent.prototype,"expanded",void 0),o([r.Prop(),s("design:type",Object)],DataTableRowWrapperComponent.prototype,"styleObject",void 0),o([r.Prop(),s("design:type",Function)],DataTableRowWrapperComponent.prototype,"groupHeaderSlot",void 0),o([r.Prop(),s("design:type",Function)],DataTableRowWrapperComponent.prototype,"rowDetailSlot",void 0),DataTableRowWrapperComponent=o([r.Component({name:"datatable-row-wrapper",components:{"datatable-group-header":a.default,"datatable-row-detail":l.default,"datatable-body-row":c.default}})],DataTableRowWrapperComponent),DataTableRowWrapperComponent}(r.Vue);t.default=d},"./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/body/body-row.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=n("./src/utils/keys.ts"),l=n("./src/components/body/body-cell.component.vue"),c=function(e){function DataTableBodyRowComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.counter=0,t.isFocused=!1,t}return i(DataTableBodyRowComponent,e),DataTableBodyRowComponent.prototype.created=function(){this.renderTracking&&this.$emit("row-created",this.row)},DataTableBodyRowComponent.prototype.updated=function(){this.renderTracking&&this.$emit("row-updated",this.row),this.isFocused&&this.$el.focus()},DataTableBodyRowComponent.prototype.onCellRendered=function(e){this.$emit("row-updated",this.row)},DataTableBodyRowComponent.prototype.onFocus=function(){this.isFocused=!0},DataTableBodyRowComponent.prototype.onBlur=function(){this.isFocused=!1},DataTableBodyRowComponent.prototype.onActivate=function(e,t){e.cellIndex=t,e.rowElement=this.$el,this.$emit("activate",e)},DataTableBodyRowComponent.prototype.onKeyDown=function(e){var t=e.keyCode,n=e.target===this.$el,i=t===a.Keys.return||t===a.Keys.down||t===a.Keys.up||t===a.Keys.pageUp||t===a.Keys.pageDown;i&&n&&(e.preventDefault(),e.stopPropagation(),this.$emit("activate",{type:"keydown",event:e,row:this.row,rowIndex:this.rowContext.rowIndex,rowElement:this.$el}))},DataTableBodyRowComponent.prototype.onMouseenter=function(e){this.$emit("activate",{type:"mouseenter",event:e,row:this.row,rowElement:this.$el})},DataTableBodyRowComponent.prototype.onTreeAction=function(e){this.$emit("tree-action",e)},Object.defineProperty(DataTableBodyRowComponent.prototype,"styles",{get:function(){return this.rowContext?{width:this.columnGroupWidths.total+"px",height:this.rowContext.rowHeight+"px"}:{width:this.columnGroupWidths.total+"px"}},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyRowComponent.prototype,"cssClasses",{get:function(){var e,t,n="";if((null===(e=this.rowContext)||void 0===e?void 0:e.isSelected)&&(n+=" active"),(null===(t=this.rowContext)||void 0===t?void 0:t.rowIndex)%2!==0?n+=" datatable-row-odd":n+=" datatable-row-even","function"===typeof this.rowClass){var i=this.rowClass(this.rowContext.row,this.rowContext.rowIndex);if("string"===typeof i)n+=" "+i;else if("object"===typeof i)for(var o=Object.keys(i),s=0,r=o;s<r.length;s++){var a=r[s];!0===i[a]&&(n+=" "+a)}}return n},enumerable:!1,configurable:!0}),o([r.Prop(),s("design:type",Object)],DataTableBodyRowComponent.prototype,"row",void 0),o([r.Prop(),s("design:type",Object)],DataTableBodyRowComponent.prototype,"rowContext",void 0),o([r.Prop(),s("design:type",Array)],DataTableBodyRowComponent.prototype,"columnsByPin",void 0),o([r.Prop(),s("design:type",Object)],DataTableBodyRowComponent.prototype,"columnGroupWidths",void 0),o([r.Prop(),s("design:type",Object)],DataTableBodyRowComponent.prototype,"groupStyles",void 0),o([r.Prop(),s("design:type",Function)],DataTableBodyRowComponent.prototype,"rowClass",void 0),o([r.Prop(),s("design:type",Function)],DataTableBodyRowComponent.prototype,"displayCheck",void 0),o([r.Prop(),s("design:type",Function)],DataTableBodyRowComponent.prototype,"slots",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableBodyRowComponent.prototype,"renderTracking",void 0),DataTableBodyRowComponent=o([r.Component({components:{"datatable-body-cell":l.default}})],DataTableBodyRowComponent),DataTableBodyRowComponent}(r.Vue);t.default=c},"./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/body/body.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},s=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},r=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},a=this&&this.__awaiter||function(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(o=2&s[0]?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],i=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0});var c=n("vue-property-decorator"),d=n("./src/services/scrollbar-helper.service.ts"),u=n("./src/types/index.ts"),p=n("./src/types/check.type.ts"),h=n("./src/utils/index.ts"),m=n("./src/components/body/body-group-header.component.ts"),f=n("./src/components/body/body-row-detail.component.ts"),g=n("./src/components/body/body-row-wrapper.component.vue"),y=n("./src/components/body/body-row.component.vue"),v=n("./src/components/body/progress-bar.component.ts"),b=n("./src/components/body/scroller.component.ts"),C=n("./src/components/body/selection.component.ts"),w=n("./src/components/body/summary/summary-row.component.ts"),_=function(e){function DataTableBodyComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.scroller=null,t.selector=null,t.rowHeightsCache=new h.RowHeightCache,t.offsetY=0,t.myOffset=0,t.myOffsetX=0,t.indexes={first:0,last:0},t.columnGroupWidths=null,t.columnGroupWidthsWithoutGroup=null,t.rowIndexes=new Map,t.rowExpansions=new Map,t.myBodyHeight=null,t.columnsByPin=null,t.groupStyles={left:{},center:{},right:{}},t.rowContexts=[],t.scrollbarHelper=new d.ScrollbarHelper,t.renderCounter=0,t.renderId=null,t.getDetailRowHeight=function(e,n){if(!t.rowDetail)return 0;var i=t.rowDetailHeight||t.getRowHeight(e)||50;return"function"===typeof i?i(e,n):Number(i)},t}return i(DataTableBodyComponent,e),DataTableBodyComponent.prototype.onPageSize=function(){this.recalcLayout()},DataTableBodyComponent.prototype.onRowsChanged=function(){return a(this,void 0,void 0,(function(){var e;return l(this,(function(t){switch(t.label){case 0:return this.rowsChanged=!0,this.rowExpansions.clear(),e=this.rows&&this.rows.length&&(this.offset&&!this.offsetY||!this.offset&&this.offsetY),e?(this.updateOffsetY(this.offset,!0),[4,this.$nextTick()]):[3,3];case 1:return t.sent(),!this.offset||this.offsetY?[3,3]:(this.updateOffsetY(this.offset,!0),[4,this.$nextTick()]);case 2:t.sent(),t.label=3;case 3:return this.recalcLayout(),[2]}}))}))},DataTableBodyComponent.prototype.onSelectedChanged=function(){return a(this,void 0,void 0,(function(){var e=this;return l(this,(function(t){switch(t.label){case 0:return[4,this.$nextTick()];case 1:return t.sent(),this.rowContexts.forEach((function(t){t.isSelected=e.isSelect(t.row),t.isChecked=e.isChecked(t.row)})),[2]}}))}))},DataTableBodyComponent.prototype.onCheckedChanged=function(){return a(this,void 0,void 0,(function(){var e=this;return l(this,(function(t){switch(t.label){case 0:return[4,this.$nextTick()];case 1:return t.sent(),this.rowContexts.forEach((function(t){t.isChecked=e.isChecked(t.row)})),[2]}}))}))},DataTableBodyComponent.prototype.onColumnsChanged=function(){this.recalculateColumns(),this.buildStylesByGroup()},DataTableBodyComponent.prototype.onOffsetChanged=function(){this.myOffset=this.offset},DataTableBodyComponent.prototype.onOffsetXChanged=function(){this.myOffsetX=this.offsetX},DataTableBodyComponent.prototype.onMyOffsetXChanged=function(){this.buildStylesByGroup()},DataTableBodyComponent.prototype.onInnerWidthChanged=function(){this.recalculateColumns(),this.buildStylesByGroup()},DataTableBodyComponent.prototype.onMyOffsetChanged=function(){this.limit&&this.recalcLayout()},DataTableBodyComponent.prototype.onRowCountChanged=function(){this.recalcLayout()},DataTableBodyComponent.prototype.onBodyHeightChanged=function(){this.myBodyHeight=this.bodyHeight.toString(),-1!==this.bodyHeight?(this.scrollbarV?this.myBodyHeight=this.myBodyHeight+"px":this.myBodyHeight="auto",this.recalcLayout()):this.myBodyHeight="0px"},DataTableBodyComponent.prototype.created=function(){var e=this;this.rowTrackingFn=function(t){var n=e.getRowIndex(t);return e.trackByProp?n+"-"+e.trackByProp:n}},DataTableBodyComponent.prototype.mounted=function(){this.selector=this.$refs.selector,this.scroller=this.$refs.scroller},Object.defineProperty(DataTableBodyComponent.prototype,"bodyWidth",{get:function(){return this.scrollbarH?this.innerWidth+"px":"100%"},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyComponent.prototype,"styleObject",{get:function(){return{width:this.bodyWidth?this.bodyWidth:"auto",height:this.myBodyHeight?this.myBodyHeight:"auto","overflow-anchor":"auto",contain:"content"}},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyComponent.prototype,"selectEnabled",{get:function(){return Boolean(this.selectionType)},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyComponent.prototype,"checkEnabled",{get:function(){return this.checkMode===p.CheckMode.checkNoSelect||this.selectionType===u.SelectionType.checkbox},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyComponent.prototype,"isUseRowHeightCache",{get:function(){return!("function"!==typeof this.rowHeight&&!this.rowDetailHeight&&!this.groupRowsBy)},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyComponent.prototype,"fixedRowHeight",{get:function(){return!(!this.rowHeight||"number"!==typeof this.rowHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyComponent.prototype,"scrollHeight",{get:function(){if(this.scrollbarV&&this.virtualization&&this.rowCount){if(!this.isUseRowHeightCache){var e=this.rowHeight;return e*this.rowCount}return this.rowHeightsCache.query(this.rowCount-1)}if(!this.rowCount)return 0},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyComponent.prototype,"scrollWidth",{get:function(){return this.columnGroupWidths?this.columnGroupWidths.total.toString():"auto"},enumerable:!1,configurable:!0}),DataTableBodyComponent.prototype.destroyed=function(){},DataTableBodyComponent.prototype.reset=function(){this.myOffsetX=0,this.offsetY=0},DataTableBodyComponent.prototype.onSelect=function(e){this.$emit("select",e)},DataTableBodyComponent.prototype.recalculateColumns=function(e){void 0===e&&(e=this.columns);var t=h.columnsByPin(this.columns);this.columnsByPin=h.columnsByPinArr(this.columns);var n=this.innerWidth;this.scrollbarV&&(n-=this.scrollbarHelper.width),this.columnGroupWidths=h.columnGroupWidths(t,this.columns,n)},DataTableBodyComponent.prototype.updateOffsetY=function(e,t){if(void 0===t&&(t=!1),this.scroller){var n=0;if(this.scrollbarV&&this.virtualization&&e){var i=this.pageSize*e;n=this.isUseRowHeightCache||"function"===typeof this.rowHeight?this.rowHeightsCache.query(i-1):i*this.rowHeight}else this.scrollbarV&&!this.virtualization&&(n=0);return e&&!n?0:(this.scroller.setOffset(n||0,t),n||0)}},DataTableBodyComponent.prototype.onScrollSetup=function(e){this.myOffsetX=e.scrollXPos,this.offsetY=e.scrollYPos},DataTableBodyComponent.prototype.onBodyScroll=function(e){var t=this,n=e.scrollYPos,i=e.scrollXPos;if((this.offsetY!==n||this.myOffsetX!==i)&&(this.$emit("scroll",{offsetY:n,offsetX:i}),this.groupHeader&&this.myOffsetX!==i)){var o=this.$el.querySelectorAll(".datatable-group-header");o&&o.length&&o.forEach((function(e){e.style.width=t.$el.clientWidth+"px",e.style.transform="translateX("+i+"px)"}))}this.offsetY=n,this.myOffsetX=i,this.$nextTick((function(){t.updateIndexes(e.direction),t.updatePage(e.direction,e.fromPager),t.updateRows()}))},DataTableBodyComponent.prototype.updatePage=function(e,t){var n=this.indexes.first/this.pageSize;t||"up"===e?n=Math.ceil(n):"down"===e&&(n=Math.floor(n)),t||!["up","down"].includes(e)||isNaN(n)||this.$emit("page",{offset:n})},DataTableBodyComponent.prototype.updateRows=function(e){var t;void 0===e&&(e=!1);var n=this.indexes,i=n.first,o=n.last;if(e||this.rowsChanged||this.lastFirst!==i||this.lastLast!==o){this.rowsChanged=!1,(null===(t=this.rows)||void 0===t?void 0:t.length)&&(this.lastFirst=i,this.lastLast=o),this.lastRowCount=this.rowCount;var s=i,r=0;this.rowIndexes.clear();var a,l=[];while(s<o&&s<this.rowCount){var c=this.rows[s];c&&(c.__isGroup&&(a=c),this.rowIndexes.set(c,s),l[r]={row:c,rowIndex:s,rowHeight:this.getRowHeight(c),isSelected:this.isSelect(c),isChecked:this.isChecked(c),expanded:this.getRowExpanded(c),treeStatus:this.treeStatus(c),group:a},r++),s++}this.rowContexts=l}},DataTableBodyComponent.prototype.getRowHeight=function(e){return"function"===typeof this.rowHeight?this.rowHeight(e):this.rowHeight},DataTableBodyComponent.prototype.getGroupHeight=function(e){var t=0;if(Array.isArray(e.value))for(var n=0,i=e.value;n<i.length;n++){var o=i[n];t+=this.getRowAndDetailHeight(o)}return t},DataTableBodyComponent.prototype.getRowAndDetailHeight=function(e){var t=this.getRowHeight(e),n=this.rowExpansions.get(e);return n&&(t+=this.getDetailRowHeight(e)),t},DataTableBodyComponent.prototype.getRowWrapperStyles=function(e){if(!e)return null;var t={};if(this.groupRowsBy&&(t["width"]="100%"),this.scrollbarV&&this.virtualization){var n=0;n=e.rowIndex;var i=0,o=50;this.isUseRowHeightCache?i=this.rowHeightsCache.query(n-1):(o=this.rowHeight,i=n*o),h.translateXY(t,0,i)}return t},DataTableBodyComponent.prototype.getRowOffsetY=function(e){if(this.isUseRowHeightCache||"function"===typeof this.rowHeight){var t=this.rowHeightsCache.queryWithHeight(e);return t||(t={height:0,offsetY:0}),t}return{offsetY:this.rowHeight*e,height:this.rowHeight}},DataTableBodyComponent.prototype.getBottomSummaryRowStyles=function(){if(!this.scrollbarV||!this.rows||!this.rows.length)return null;var e={position:"absolute"},t=0;return t=this.isUseRowHeightCache||"function"===typeof this.rowHeight?this.rowHeightsCache.query(this.rows.length-1):this.rowHeight*(this.rowCount-1),h.translateXY(e,0,t),e},DataTableBodyComponent.prototype.updateIndexes=function(e){var t=0,n=0;if(this.scrollbarV&&!this.limit)if(this.virtualization){var i=this.bodyHeight;this.isUseRowHeightCache||"function"===typeof this.rowHeight?(t=this.rowHeightsCache.getRowIndex(this.offsetY),n=this.rowHeightsCache.getRowIndex(i+this.offsetY)+1):(t=Math.floor(this.offsetY/this.rowHeight),n=Math.ceil((i+this.offsetY+this.rowHeight)/this.rowHeight))}else t=0,n=this.rowCount;else this.externalPaging||(t=Math.max(this.myOffset*this.pageSize,0)),n=Math.min(t+this.pageSize,this.rowCount);this.indexes={first:t,last:n}},DataTableBodyComponent.prototype.refreshRowHeightCache=function(){this.isUseRowHeightCache&&(this.rowHeightsCache.clearCache(),this.rows&&this.rows.length&&this.rowHeightsCache.initCache({rows:this.rows,rowHeight:this.rowHeight,rowDetailHeight:this.getDetailRowHeight,groupRowHeight:this.groupRowHeight,externalVirtual:this.scrollbarV&&this.externalPaging,rowCount:this.rowCount,rowIndexes:this.rowIndexes,rowExpansions:this.rowExpansions}))},DataTableBodyComponent.prototype.getAdjustedViewPortIndex=function(){var e,t=this.indexes.first;return this.isUseRowHeightCache||"function"===typeof this.rowHeight?(e=this.rowHeightsCache.query(t),e<=this.offsetY?Math.max(0,t-1):t):(e=this.rowHeight*t,e<=this.offsetY?Math.max(0,t-1):t)},DataTableBodyComponent.prototype.toggleRowExpansion=function(e){var t=e.expanded;if(this.isUseRowHeightCache){var n=this.getDetailRowHeight(e.row)*(t?-1:1);this.rowHeightsCache.update(e.rowIndex,n)}return t=!t,this.rowExpansions.set(e.row,t),this.$emit("detail-toggle",{rows:[e.row],currentIndex:e.rowIndex}),Boolean(t)},DataTableBodyComponent.prototype.toggleAllRows=function(e){this.rowExpansions.clear();for(var t=Boolean(e),n=this.getAdjustedViewPortIndex(),i=0,o=this.rows;i<o.length;i++){var s=o[i];this.rowExpansions.set(s,t)}this.scrollbarV&&this.recalcLayout(),this.$emit("detail-toggle",{rows:this.rows,currentIndex:n})},DataTableBodyComponent.prototype.onGroupToggle=function(e){this.$emit("group-toggle",e)},DataTableBodyComponent.prototype.recalcLayout=function(){this.refreshRowHeightCache(),this.updateIndexes(),this.updateRows()},DataTableBodyComponent.prototype.columnTrackingFn=function(e,t){return t.$$id},DataTableBodyComponent.prototype.initExpansions=function(e){if(this.rowExpansions.set(e,!0),e.groups)for(var t=0,n=e.groups;t<n.length;t++){var i=n[t];this.initExpansions(i)}},DataTableBodyComponent.prototype.getRowExpanded=function(e){if(!this.rowDetail)return!1;var t=Boolean(this.rowExpansions.get(e));return t},DataTableBodyComponent.prototype.getRowIndex=function(e){return e&&this.rowIndexes.get(e)||0},DataTableBodyComponent.prototype.onTreeAction=function(e){this.$emit("tree-action",e)},DataTableBodyComponent.prototype.isSelect=function(e){return!!this.selectEnabled&&(!!this.selector&&this.selector.getRowSelected(e))},DataTableBodyComponent.prototype.isChecked=function(e){return!!this.checkEnabled&&(!!this.selector&&this.selector.getRowChecked(e))},DataTableBodyComponent.prototype.onActivate=function(e,t){this.selector&&this.selector.onActivate(e,this.indexes.first+t)},DataTableBodyComponent.prototype.onRowRendered=function(e){var t=this;0===this.renderCounter&&console.time("render"),this.renderCounter++;var n=this.renderCounter;clearTimeout(this.renderId),this.renderId=setTimeout((function(){return t.checkRenderFinish(n)}),100)},DataTableBodyComponent.prototype.checkRenderFinish=function(e){var t=this;e===this.renderCounter?(console.timeEnd("render"),this.renderCounter=0,this.$emit("rendered")):(e=this.renderCounter,clearTimeout(this.renderId),this.renderId=setTimeout((function(){return t.checkRenderFinish(e)}),100))},DataTableBodyComponent.prototype.buildStylesByGroup=function(){this.groupStyles["left"]=this.calcStylesByGroup("left"),this.groupStyles["center"]=this.calcStylesByGroup("center"),this.groupStyles["right"]=this.calcStylesByGroup("right")},DataTableBodyComponent.prototype.calcStylesByGroup=function(e){var t=this.columnGroupWidths,n=this.myOffsetX,i={width:t[e]+"px"};if("left"===e)h.translateXY(i,n,0);else if("right"===e){var o=parseInt(this.innerWidth.toString(),10),s=t.total-o,r=s-n,a=-1*(r+this.scrollbarHelper.width);h.translateXY(i,a,0)}return i},DataTableBodyComponent.prototype.getGroupStyles=function(e){return e&&e.type?o({width:this.columnGroupWidths.total+"px"},this.groupStyles[e.type]):{width:this.columnGroupWidths.total+"px"}},DataTableBodyComponent.prototype.treeStatus=function(e){return e?e.treeStatus:null},DataTableBodyComponent.prototype.isRowVisible=function(e){var t,n=this.rowContexts.find((function(t){return t.row===e}));return!!n&&(t=this.isUseRowHeightCache||"function"===typeof this.rowHeight?this.rowHeightsCache.query(n.rowIndex):this.rowHeight*n.rowIndex,t>=this.offsetY&&t<=this.offsetY+this.bodyHeight)},Object.defineProperty(DataTableBodyComponent.prototype,"cellSlots",{get:function(){var e={};return this.columns&&this.columns.forEach((function(t){t.cellTemplate&&(e[t.prop]=t.cellTemplate)})),function(){return e}},enumerable:!1,configurable:!0}),DataTableBodyComponent.prototype.onCellFocus=function(e){console.log("onCellFocus($event)")},DataTableBodyComponent.prototype.toggleExpandDetail=function(e){var t=this.rowContexts.find((function(t){return t.row===e}));if(!t)throw new Error("row context is not found");t.expanded=this.toggleRowExpansion(t),this.updateIndexes(),this.updateRows(!0),this.$emit("detail-toggle",{type:"row",value:e})},DataTableBodyComponent.prototype.expandAllDetails=function(){this.toggleAllRows(!0),this.$emit("detail-toggle",{type:"all",value:!0})},DataTableBodyComponent.prototype.collapseAllDetails=function(){this.toggleAllRows(!1),this.$emit("detail-toggle",{type:"all",value:!1})},s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"scrollbarV",void 0),s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"scrollbarH",void 0),s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"loadingIndicator",void 0),s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"externalPaging",void 0),s([c.Prop(),r("design:type",Object)],DataTableBodyComponent.prototype,"rowHeight",void 0),s([c.Prop(),r("design:type",Object)],DataTableBodyComponent.prototype,"groupRowHeight",void 0),s([c.Prop(),r("design:type",Number)],DataTableBodyComponent.prototype,"offsetX",void 0),s([c.Prop(),r("design:type",String)],DataTableBodyComponent.prototype,"emptyMessage",void 0),s([c.Prop(),r("design:type",String)],DataTableBodyComponent.prototype,"selectionType",void 0),s([c.Prop(),r("design:type",String)],DataTableBodyComponent.prototype,"checkMode",void 0),s([c.Prop({type:Array,default:function(){return[]}}),r("design:type",Array)],DataTableBodyComponent.prototype,"selected",void 0),s([c.Prop({type:Array,default:function(){return[]}}),r("design:type",Array)],DataTableBodyComponent.prototype,"checked",void 0),s([c.Prop(),r("design:type",Function)],DataTableBodyComponent.prototype,"rowIdentity",void 0),s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"rowDetail",void 0),s([c.Prop(),r("design:type",Object)],DataTableBodyComponent.prototype,"rowDetailHeight",void 0),s([c.Prop(),r("design:type",Object)],DataTableBodyComponent.prototype,"groupHeader",void 0),s([c.Prop(),r("design:type",Object)],DataTableBodyComponent.prototype,"selectCheck",void 0),s([c.Prop(),r("design:type",Object)],DataTableBodyComponent.prototype,"displayCheck",void 0),s([c.Prop(),r("design:type",String)],DataTableBodyComponent.prototype,"trackByProp",void 0),s([c.Prop(),r("design:type",Function)],DataTableBodyComponent.prototype,"rowClass",void 0),s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"groupExpansionDefault",void 0),s([c.Prop(),r("design:type",Number)],DataTableBodyComponent.prototype,"innerWidth",void 0),s([c.Prop(),r("design:type",Array)],DataTableBodyComponent.prototype,"groupRowsBy",void 0),s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"virtualization",void 0),s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"summaryRow",void 0),s([c.Prop(),r("design:type",String)],DataTableBodyComponent.prototype,"summaryPosition",void 0),s([c.Prop(),r("design:type",Object)],DataTableBodyComponent.prototype,"summaryHeight",void 0),s([c.Prop(),r("design:type",Number)],DataTableBodyComponent.prototype,"pageSize",void 0),s([c.Prop(),r("design:type",Number)],DataTableBodyComponent.prototype,"limit",void 0),s([c.Prop(),r("design:type",Array)],DataTableBodyComponent.prototype,"rows",void 0),s([c.Prop(),r("design:type",Array)],DataTableBodyComponent.prototype,"columns",void 0),s([c.Prop(),r("design:type",Number)],DataTableBodyComponent.prototype,"offset",void 0),s([c.Prop({default:0}),r("design:type",Number)],DataTableBodyComponent.prototype,"rowCount",void 0),s([c.Prop({default:0}),r("design:type",Number)],DataTableBodyComponent.prototype,"bodyHeight",void 0),s([c.Prop({type:[Number,String],default:null}),r("design:type",Object)],DataTableBodyComponent.prototype,"minItemHeight",void 0),s([c.Prop({type:[String],default:"height"}),r("design:type",String)],DataTableBodyComponent.prototype,"heightField",void 0),s([c.Prop(),r("design:type",Function)],DataTableBodyComponent.prototype,"groupHeaderSlot",void 0),s([c.Prop(),r("design:type",Function)],DataTableBodyComponent.prototype,"rowDetailSlot",void 0),s([c.Prop(),r("design:type",Boolean)],DataTableBodyComponent.prototype,"renderTracking",void 0),s([c.Watch("pageSize"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onPageSize",null),s([c.Watch("rows",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",Promise)],DataTableBodyComponent.prototype,"onRowsChanged",null),s([c.Watch("selected",{deep:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",Promise)],DataTableBodyComponent.prototype,"onSelectedChanged",null),s([c.Watch("checked",{deep:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",Promise)],DataTableBodyComponent.prototype,"onCheckedChanged",null),s([c.Watch("columns",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onColumnsChanged",null),s([c.Watch("offset",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onOffsetChanged",null),s([c.Watch("offsetX",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onOffsetXChanged",null),s([c.Watch("myOffsetX"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onMyOffsetXChanged",null),s([c.Watch("innerWidth"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onInnerWidthChanged",null),s([c.Watch("myOffset"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onMyOffsetChanged",null),s([c.Watch("rowCount"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onRowCountChanged",null),s([c.Watch("bodyHeight",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableBodyComponent.prototype,"onBodyHeightChanged",null),DataTableBodyComponent=s([c.Component({components:{"datatable-selection":C.default,"datatable-progress":v.default,"datatable-scroller":b.default,"datatable-summary-row":w.default,"datatable-row-wrapper":g.default,"datatable-body-row":y.default,"datatable-group-header":m.default,"datatable-row-detail":f.default}})],DataTableBodyComponent),DataTableBodyComponent}(c.Vue);t.default=_},"./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/datatable.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},s=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},r=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var s=arguments[t],r=0,a=s.length;r<a;r++,o++)i[o]=s[r];return i};Object.defineProperty(t,"__esModule",{value:!0});var l=n("vue-property-decorator"),c=n("./src/directives/visibility.directive.ts"),d=n("./src/services/dimensions-helper.service.ts"),u=n("./src/services/scrollbar-helper.service.ts"),p=n("./src/types/index.ts"),h=n("./src/types/check.type.ts"),m=n("./src/utils/index.ts"),f=n("./src/utils/equal.array.ts"),g=n("./src/components/body/body-cell.component.vue"),y=n("./src/components/body/body.component.vue"),v=n("./src/components/columns/column.component.ts"),b=n("./src/components/footer/footer.component.ts"),C=n("./src/components/header/header.component.ts");l.Vue.component("datatable-column",v.default),l.Vue.component("datatable-body-cell",g.default);var w=function(e){function DatatableComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.groupedRows=null,t.innerWidth=0,t.pageSize=0,t.bodyHeight=0,t.rowCount=0,t.offsetX=0,t.internalRows=null,t.initialRows=null,t.internalColumns=null,t.myColumnMode=p.ColumnMode.standard,t.mySortType=p.SortType.single,t.innerOffset=0,t.mySelected=[],t.myChecked=[],t.renderTracking=!1,t.isVisible=!1,t.rowDetail=!1,t.groupHeader=!1,t.groupHeaderSlot=null,t.rowDetailSlot=null,t.footerSlot=null,t.isColumnsInited=!1,t.scrollbarHelper=new u.ScrollbarHelper,t.dimensionsHelper=new d.DimensionsHelper,t.needToCalculateDims=!0,t}return i(DatatableComponent,e),DatatableComponent.prototype.onRowsChanged=function(e){e&&(this.internalRows=a(e));var t=m.optionalGetterForProp(this.treeFromRelation),n=m.optionalGetterForProp(this.treeToRelation);t&&n&&(this.initialRows=this.internalRows),this.externalSorting||this.sortInternalRows(),this.internalRows=m.groupRowsByParents(this.internalRows,t,n,this.lazyTree),this.groupedRows=null,this.rows&&this.groupRowsBy&&(this.groupedRows=this.groupArrayBy(this.rows,this.groupRowsBy,0),this.internalRows=this.processGroupedRows(this.groupedRows)),this.$el&&this.recalculate()},DatatableComponent.prototype.onGroupRowsByChanged=function(e,t){f.isArrayEqual(e,t)||(this.groupHeader=Boolean(this.groupRowsBy),this.groupedRows=null,this.groupRowsBy?(this.groupedRows=this.groupArrayBy(this.rows,this.groupRowsBy,0),this.internalRows=this.processGroupedRows(this.groupedRows)):this.internalRows=this.rows,this.externalSorting||this.sortInternalRows(),this.recalculate())},DatatableComponent.prototype.onColumnsChanged=function(e){var t=this;e&&(m.setColumnsDefaults(e,this),this.internalColumns=a(e),this.$nextTick((function(){return t.recalculateColumns()})))},DatatableComponent.prototype.onLimitChanged=function(){this.recalculate()},DatatableComponent.prototype.onCountChanged=function(){this.recalculate()},DatatableComponent.prototype.onColumnModeChanged=function(){this.myColumnMode=p.ColumnMode[this.columnMode]},DatatableComponent.prototype.onSortTypeChanged=function(){p.SortType[this.sortType]&&(this.mySortType=p.SortType[this.sortType])},DatatableComponent.prototype.onOffsetChanged=function(){this.innerOffset!==this.offset&&(this.innerOffset=this.offset,this.pageSize&&this.innerOffset>=0&&this.onFooterPage({page:this.innerOffset+1}))},DatatableComponent.prototype.onPageSizeChanged=function(){var e=this;this.pageSize&&this.innerOffset>=0&&this.$nextTick((function(){return e.onFooterPage({page:e.innerOffset+1})}))},DatatableComponent.prototype.onSelectedChanged=function(){this.mySelected=this.selected},DatatableComponent.prototype.onCheckedChanged=function(){this.myChecked=this.checked},DatatableComponent.prototype.onSortsChanged=function(){this.innerSortRows()},DatatableComponent.prototype.onWindowResize=function(){this.recalculate()},DatatableComponent.prototype.created=function(){this.groupHeader=Boolean(this.groupRowsBy),this.$listeners.rendered&&(this.renderTracking=!0)},DatatableComponent.prototype.beforeDestroy=function(){this.resizeHandler&&window.removeEventListener("resize",this.resizeHandler),this.resizeObserver&&this.resizeObserver.unobserve(this.$el)},DatatableComponent.prototype.mounted=function(){var e=this;this.bodyComponent=this.$refs.datatableBody,this.headerComponent=this.$refs.datatableHeader,this.groupHeaderSlot=this.$scopedSlots.groupHeader,this.rowDetailSlot=this.$scopedSlots.rowDetail,this.footerSlot=this.$scopedSlots.footer,this.rowDetail=Boolean(this.rowDetailSlot),this.externalSorting||this.sortInternalRows(),window.ResizeObserver?(this.needToCalculateDims=!1,this.resizeObserver=new window.ResizeObserver((function(t){var n=0;t.length&&t[0].contentRect?(e.innerWidth=Math.floor(t[0].contentRect.width),n=t[0].contentRect.height):(n=e.$el.clientHeight,e.innerWidth=e.$el.clientWidth),e.scrollbarV&&(e.headerHeight&&(n-=e.headerHeight),e.footerHeight&&(n-=e.footerHeight),e.bodyHeight=n),"undefined"===typeof requestAnimationFrame?e.recalculate():requestAnimationFrame((function(){e.recalculate()}))})),this.resizeObserver.observe(this.$el)):(this.resizeHandler=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeHandler));var init=function(){e.recalculate(),e.externalPaging&&e.scrollbarV&&e.$emit("page",{count:e.count,pageSize:e.pageSize,limit:e.limit,offset:e.innerOffset})};"undefined"===typeof requestAnimationFrame?init():requestAnimationFrame((function(){init()}))},Object.defineProperty(DatatableComponent.prototype,"myRowHeight",{get:function(){return"string"===typeof this.rowHeight?"auto"===this.rowHeight?50:Number(this.rowHeight):this.rowHeight},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"myOffset",{get:function(){return this.rowCount?Math.max(Math.min(this.innerOffset,Math.ceil(this.rowCount/this.pageSize)-1),0):this.innerOffset},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isFixedHeader",{get:function(){var e=this.headerHeight;return"string"!==typeof e||"auto"!==e},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isFixedRow",{get:function(){return"function"!==typeof this.rowHeight},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isVertScroll",{get:function(){return this.scrollbarV},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isVirtualized",{get:function(){return this.virtualization},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isHorScroll",{get:function(){return this.scrollbarH},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isSelectable",{get:function(){return void 0!==this.selectionType},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isCheckboxSelection",{get:function(){return this.selectionType===p.SelectionType.checkbox},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isCellSelection",{get:function(){return this.selectionType===p.SelectionType.cell},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isSingleSelection",{get:function(){return this.selectionType===p.SelectionType.single},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isSingleFocusSelection",{get:function(){return this.selectionType===p.SelectionType.singleFocus},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isMultiSelection",{get:function(){return this.selectionType===p.SelectionType.multi},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"isMultiClickSelection",{get:function(){return this.selectionType===p.SelectionType.multiClick},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"classObject",{get:function(){return{"fixed-header":this.isFixedHeader,"fixed-row":this.isFixedRow,"scroll-vertical":this.isVertScroll,virtualized:this.isVirtualized,"scroll-horz":this.isHorScroll,selectable:this.isSelectable,"checkbox-selection":this.isCheckboxSelection,"cell-selection":this.isCellSelection,"single-selection":this.isSingleSelection,"multi-selection":this.isMultiSelection,"multi-click-selection":this.isMultiClickSelection}},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"allRowsSelected",{get:function(){var e=this.mySelected;this.checkMode===h.CheckMode.checkNoSelect&&(e=this.myChecked);var t=this.rows&&e&&e.length===this.rows.length;if(this.selectAllRowsOnPage&&this.bodyComponent){var n=this.bodyComponent.indexes,i=this.rows.length;!this.limit||this.scrollbarV||this.virtualization||(i=n.last-n.first),t=e.length===i}return e&&this.rows&&0!==this.rows.length&&t},enumerable:!1,configurable:!0}),Object.defineProperty(DatatableComponent.prototype,"scrollbarWidth",{get:function(){return this.scrollbarHelper.width},enumerable:!1,configurable:!0}),DatatableComponent.prototype.reset=function(){this.bodyComponent.reset()},DatatableComponent.prototype.adjust=function(){var e=this;this.bodyHeight=-1,setTimeout((function(){e.recalculateDims()}))},DatatableComponent.prototype.recalculate=function(){this.needToCalculateDims?this.recalculateDims():this.recalculatePages(),this.recalculateColumns()},DatatableComponent.prototype.recalculateColumns=function(e,t,n){if(void 0===e&&(e=this.internalColumns),void 0===t&&(t=-1),void 0===n&&(n=this.scrollbarH),!e)return null;var i=this.innerWidth;this.scrollbarV&&(i-=this.scrollbarHelper.width),this.myColumnMode===p.ColumnMode.force?m.forceFillColumnWidths(e,i,t,n):this.myColumnMode===p.ColumnMode.flex&&m.adjustColumnWidths(e,i);var o=e.filter((function(e){return e.hidden}));return o.length&&this.bodyComponent&&this.bodyComponent.onInnerWidthChanged(),e},DatatableComponent.prototype.recalculateDims=function(){var e=this.dimensionsHelper.getDimensions(this.$el);if(this.innerWidth=Math.floor(e.width),this.scrollbarV){var t=e.height;this.headerHeight&&(t-=this.headerHeight),this.footerHeight&&(t-=this.footerHeight),this.bodyHeight=t}this.recalculatePages()},DatatableComponent.prototype.recalculatePages=function(){this.pageSize=this.calcPageSize(),this.rowCount=this.calcRowCount(),this.$emit("row-count",this.rowCount)},DatatableComponent.prototype.onBodyPage=function(e){var t=e.offset;this.externalPaging&&!this.virtualization||this.innerOffset!==t&&(this.innerOffset=t,this.$emit("page",{count:this.count,pageSize:this.pageSize,limit:this.limit,offset:this.innerOffset}))},DatatableComponent.prototype.onBodyScroll=function(e){this.offsetX=e.offsetX,this.$emit("scroll",e)},DatatableComponent.prototype.onFooterPage=function(e){this.innerOffset=e.page-1,this.bodyComponent&&this.bodyComponent.updateOffsetY(this.innerOffset,!0),this.$emit("page",{count:this.count,pageSize:this.pageSize,limit:this.limit,offset:this.innerOffset}),this.selectAllRowsOnPage&&!this.scrollbarV&&this.limit&&(this.mySelected=[],this.$emit("select",{selected:this.mySelected}))},DatatableComponent.prototype.onVisible=function(e){this.isVisible!==e&&(this.isVisible=e,this.isVisible&&this.recalculate())},DatatableComponent.prototype.calcPageSize=function(e){if(void 0===e&&(e=this.rows),this.scrollbarV&&this.virtualization){var t=50;"number"===typeof this.rowHeight&&(t=this.rowHeight);var n=Math.ceil(this.bodyHeight/t);return Math.max(n,0)}return void 0!==this.limit&&null!==this.limit?Number(this.limit):e?e.length:0},DatatableComponent.prototype.calcRowCount=function(e){return void 0===e&&(e=this.rows),this.externalPaging?this.count:e?this.groupRowsBy||null!==this.treeFromRelation&&null!==this.treeToRelation?this.internalRows.length:e.length:0},DatatableComponent.prototype.onColumnContextmenu=function(e){var t=e.event,n=e.column;this.$emit("tableContextmenu",{event:t,type:p.ContextmenuType.header,content:n})},DatatableComponent.prototype.onRowContextmenu=function(e){var t=e.event,n=e.row;this.$emit("tableContextmenu",{event:t,type:p.ContextmenuType.body,content:n})},DatatableComponent.prototype.onColumnResize=function(e){var t,n=e.column,i=e.newValue;void 0!==n&&(this.internalColumns.map((function(e,o){return e.$$id===n.$$id&&(t=o,e.width=i,e.canAutoResize=!1,e.$$oldWidth=i),e})),this.recalculateColumns(this.internalColumns,t),this.$emit("resize",{column:n,newValue:i}))},DatatableComponent.prototype.onColumnReorder=function(e){var t=e.column,n=e.newValue,i=e.prevValue,o=a(this.internalColumns);if(this.swapColumns){var s=o[n];if(t.$$id===s.$$id)return;o[n]=t,o[i]=s}else if(n>i){for(var r=o[i],l=i;l<n;l++)o[l]=o[l+1];o[n]=r}else{for(r=o[i],l=i;l>n;l--)o[l]=o[l-1];o[n]=r}this.internalColumns=o,this.$emit("reorder",{column:t,newValue:n,prevValue:i})},DatatableComponent.prototype.onColumnSort=function(e){var t,n=this;this.selectAllRowsOnPage&&(this.myChecked=[],this.$emit("check",{checked:this.myChecked})),Array.isArray(this.sorts)&&Array.isArray(e.sorts)&&(this.sorts.length=0,e.sorts.forEach((function(e){return n.sorts.push(e)})),0===this.sorts.length&&this.sorts.push({dir:null,prop:null})),this.innerSortRows(),this.goToFirstAfterSort&&(this.innerOffset=0),this.bodyComponent.updateOffsetY(this.myOffset,!0),this.$emit("sort",o(o({},e),{sorts:null===(t=null===e||void 0===e?void 0:e.sorts)||void 0===t?void 0:t.filter((function(e){return e.prop}))}))},DatatableComponent.prototype.onHeaderSelect=function(e){var t,n,i,o,s,r="select";if(this.selectAllRowsOnPage){var a=this.bodyComponent.indexes.first,l=this.bodyComponent.indexes.last;if(this.checkMode===h.CheckMode.checkIsSelect){var c=this.mySelected.length===l-a;this.mySelected=[],c||(t=this.mySelected).push.apply(t,this.internalRows.slice(a,l))}else{r="check";var d=this.myChecked.length===l-a;this.scrollbarV&&this.virtualization&&!this.limit&&(d=this.myChecked.length===this.internalRows.length),this.myChecked=[],e&&!d&&(this.scrollbarV&&this.virtualization?(n=this.myChecked).push.apply(n,this.internalRows):(i=this.myChecked).push.apply(i,this.internalRows.slice(a,l)))}}else if(this.checkMode===h.CheckMode.checkIsSelect){c=this.mySelected.length===this.rows.length;this.mySelected=[],c||(o=this.mySelected).push.apply(o,this.rows)}else{d=this.myChecked.length===this.rows.length;this.myChecked=[],d||(s=this.myChecked).push.apply(s,this.rows)}this.$emit(r,{selected:this.mySelected,checked:this.myChecked})},DatatableComponent.prototype.onBodySelect=function(e){this.$emit("select",e)},DatatableComponent.prototype.onBodyCheck=function(e){this.$emit("check",e)},DatatableComponent.prototype.onGroupToggle=function(e){e.value.__expanded=!e.value.__expanded,this.internalRows=this.processGroupedRows(this.groupedRows),this.recalculate()},DatatableComponent.prototype.onTreeAction=function(e){var t=this,n=e.row,i=this.rows.findIndex((function(n){return n[t.treeToRelation]===e.row[t.treeToRelation]}));this.$emit("tree-action",{row:n,rowIndex:i})},DatatableComponent.prototype.onColumnInsert=function(e){var t=this;m.setColumnDefaults(e,this),this.internalColumns?this.internalColumns=a(this.internalColumns,[e]):this.internalColumns=[e],this.isVisible&&this.recalculateColumns(),clearTimeout(this.isColumnsInitedTimeoutId),this.isColumnsInitedTimeoutId=setTimeout((function(){return t.isColumnsInited=!0}),50)},DatatableComponent.prototype.onColumnRemoved=function(e){var t=this.internalColumns.findIndex((function(t){return t.name===e.name})),n=a(this.internalColumns);n.splice(t,1),this.internalColumns=a(n),this.recalculateColumns()},DatatableComponent.prototype.onColumnChangeVisible=function(e){var t=this;setTimeout((function(){return t.recalculateColumns()}),100)},DatatableComponent.prototype.toggleExpandDetail=function(e){this.bodyComponent.toggleExpandDetail(e),this.$emit("detail-toggle",{type:"row",value:e})},DatatableComponent.prototype.expandAllDetails=function(){this.bodyComponent.expandAllDetails(),this.$emit("detail-toggle",{type:"all",value:!0})},DatatableComponent.prototype.collapseAllDetails=function(){this.bodyComponent.collapseAllDetails(),this.$emit("detail-toggle",{type:"all",value:!1})},DatatableComponent.prototype.isRowVisible=function(e){var t;return null===(t=this.bodyComponent)||void 0===t?void 0:t.isRowVisible(e)},DatatableComponent.prototype.innerSortRows=function(){var e=m.optionalGetterForProp(this.treeFromRelation),t=m.optionalGetterForProp(this.treeToRelation);e&&t&&(this.internalRows=this.initialRows),!1===this.externalSorting&&this.sortInternalRows(),this.internalRows=m.groupRowsByParents(this.internalRows,e,t,this.lazyTree)},DatatableComponent.prototype.groupArrayBy=function(e,t,n){var i=this;void 0===n&&(n=0);var o=t;Array.isArray(t)&&(o=t[n]);var s=new Map,getValue=function(e,t){return"string"===typeof t?e[t]:"prop"in t?t.valueGetter?t.valueGetter(e[t.prop]):e[t.prop]:void 0},getKey=function(e,t){return Array.isArray(t)?t.reduce((function(t,n){var i=null;return Array.isArray(n)?getKey(e,n):(i=getValue(e,n),i?t?t+"^^"+i:""+i:i)}),""):getValue(e,t)},r=[];e.forEach((function(e){var t=getKey(e,o);void 0===t&&null===t||(r.push(e),s.has(t)?s.get(t).push(e):s.set(t,[e]))})),n>0&&r.length&&r.forEach((function(t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}));var a=[];if(Array.isArray(o))o.forEach((function(e){var t=i.getGroupTitle(e);a.push({title:t,prop:e})}));else{var l=this.getGroupTitle(o);a.push({title:l,prop:o})}var c=Array.from(s,(function(e){return i.addGroup(e[0],e[1],n,a)}));return Array.isArray(t)&&n<t.length-1&&c.forEach((function(e){e.groups=i.groupArrayBy(e.rows,t,n+1)})),c},DatatableComponent.prototype.addGroup=function(e,t,n,i){var o=e?e.toString().split("^^"):null,s=[];return i.forEach((function(e,t){s.push({title:e.title,prop:e.prop,value:o&&o.length>t?o[t]:""})})),{key:e,rows:t,level:n,keys:s,__expanded:!0,__isGroup:!0}},DatatableComponent.prototype.getGroupTitle=function(e){var t=e;if("string"===typeof e){var n=this.columns&&this.columns.find((function(t){return t.prop===e}));t=n?n.name:e}else"title"in e&&(t=e.title);return t},DatatableComponent.prototype.sortInternalRows=function(){this.groupedRows?(this.groupedRows=this.sortGroupedRows(this.groupedRows),this.internalRows=this.processGroupedRows(this.groupedRows)):this.internalRows=m.sortRows(this.internalRows,this.internalColumns,this.sorts)},DatatableComponent.prototype.sortGroupedRows=function(e){var t=this,n=[];e.forEach((function(e){var i={__group:e};e.keys.forEach((function(e){i[e.prop]=e.value})),n.push(i),e.groups&&e.groups.length&&(e.groups=t.sortGroupedRows(e.groups)),e.rows&&e.rows&&(e.rows=m.sortRows(e.rows,t.internalColumns,t.sorts))}));var i=m.sortRows(n,this.internalColumns,this.sorts),o=i.map((function(e){return e.__group}));return o},DatatableComponent.prototype.addRow=function(e,t){var n=this;t.push(e),e.rows&&e.__expanded&&e.rows.forEach((function(e){t.push(e)})),e.groups&&e.__expanded&&e.groups.forEach((function(e){n.addRow(e,t)}))},DatatableComponent.prototype.processGroupedRows=function(e){var t=this,n=[];return e&&e.length&&e.forEach((function(e){t.addRow(e,n)})),n},s([l.Prop({default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"visibilityCheck",void 0),s([l.Prop({default:1e3}),r("design:type",Number)],DatatableComponent.prototype,"visibilityCheckTimeout",void 0),s([l.Prop(),r("design:type",Array)],DatatableComponent.prototype,"rows",void 0),s([l.Prop(),r("design:type",Array)],DatatableComponent.prototype,"groupRowsBy",void 0),s([l.Prop(),r("design:type",Array)],DatatableComponent.prototype,"columns",void 0),s([l.Prop({type:Array,default:function(){return[]}}),r("design:type",Array)],DatatableComponent.prototype,"selected",void 0),s([l.Prop({type:Array,default:function(){return[]}}),r("design:type",Array)],DatatableComponent.prototype,"checked",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"scrollbarV",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"scrollbarH",void 0),s([l.Prop({default:"auto"}),r("design:type",Object)],DatatableComponent.prototype,"rowHeight",void 0),s([l.Prop(),r("design:type",Object)],DatatableComponent.prototype,"groupRowHeight",void 0),s([l.Prop(),r("design:type",Object)],DatatableComponent.prototype,"rowDetailHeight",void 0),s([l.Prop({type:String,validator:function(e){return-1!==["standard","flex","force"].indexOf(e)}}),r("design:type",String)],DatatableComponent.prototype,"columnMode",void 0),s([l.Prop({type:Number,default:30}),r("design:type",Number)],DatatableComponent.prototype,"headerHeight",void 0),s([l.Prop({type:Number,default:0}),r("design:type",Number)],DatatableComponent.prototype,"footerHeight",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"externalPaging",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"externalPager",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"externalSorting",void 0),s([l.Prop(),r("design:type",Number)],DatatableComponent.prototype,"limit",void 0),s([l.Prop({type:Number,default:0}),r("design:type",Number)],DatatableComponent.prototype,"count",void 0),s([l.Prop({type:Number,default:0}),r("design:type",Number)],DatatableComponent.prototype,"offset",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"loadingIndicator",void 0),s([l.Prop(),r("design:type",String)],DatatableComponent.prototype,"selectionType",void 0),s([l.Prop({default:h.CheckMode.checkIsSelect}),r("design:type",String)],DatatableComponent.prototype,"checkMode",void 0),s([l.Prop({type:Boolean,default:!0}),r("design:type",Boolean)],DatatableComponent.prototype,"reorderable",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"swapColumns",void 0),s([l.Prop({type:String,validator:function(e){return-1!==["single","multi"].indexOf(e)}}),r("design:type",String)],DatatableComponent.prototype,"sortType",void 0),s([l.Prop({type:Array,default:function(){return[]}}),r("design:type",Array)],DatatableComponent.prototype,"sorts",void 0),s([l.Prop({default:!0}),r("design:type",Boolean)],DatatableComponent.prototype,"goToFirstAfterSort",void 0),s([l.Prop({type:Object,default:function(){return{sortAscending:"datatable-icon-up",sortDescending:"datatable-icon-down",pagerLeftArrow:"datatable-icon-left",pagerRightArrow:"datatable-icon-right",pagerPrevious:"datatable-icon-prev",pagerNext:"datatable-icon-skip"}}}),r("design:type",Object)],DatatableComponent.prototype,"cssClasses",void 0),s([l.Prop({type:Object,default:function(){return{emptyMessage:"No data to display",totalMessage:"total",selectedMessage:"selected"}}}),r("design:type",Object)],DatatableComponent.prototype,"messages",void 0),s([l.Prop({type:Function,default:function(e){return e}}),r("design:type",Function)],DatatableComponent.prototype,"rowIdentity",void 0),s([l.Prop(),r("design:type",Function)],DatatableComponent.prototype,"rowClass",void 0),s([l.Prop(),r("design:type",Object)],DatatableComponent.prototype,"selectCheck",void 0),s([l.Prop({type:Function,default:null}),r("design:type",Function)],DatatableComponent.prototype,"displayCheck",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"groupExpansionDefault",void 0),s([l.Prop(),r("design:type",String)],DatatableComponent.prototype,"trackByProp",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"selectAllRowsOnPage",void 0),s([l.Prop({type:Boolean,default:!0}),r("design:type",Boolean)],DatatableComponent.prototype,"virtualization",void 0),s([l.Prop(),r("design:type",String)],DatatableComponent.prototype,"treeFromRelation",void 0),s([l.Prop(),r("design:type",String)],DatatableComponent.prototype,"treeToRelation",void 0),s([l.Prop({default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"lazyTree",void 0),s([l.Prop({type:Boolean,default:!1}),r("design:type",Boolean)],DatatableComponent.prototype,"summaryRow",void 0),s([l.Prop({default:30}),r("design:type",Object)],DatatableComponent.prototype,"summaryHeight",void 0),s([l.Prop({type:String,default:"top"}),r("design:type",String)],DatatableComponent.prototype,"summaryPosition",void 0),s([l.Watch("rows",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[Array]),r("design:returntype",void 0)],DatatableComponent.prototype,"onRowsChanged",null),s([l.Watch("groupRowsBy"),r("design:type",Function),r("design:paramtypes",[Array,Array]),r("design:returntype",void 0)],DatatableComponent.prototype,"onGroupRowsByChanged",null),s([l.Watch("columns",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[Array]),r("design:returntype",void 0)],DatatableComponent.prototype,"onColumnsChanged",null),s([l.Watch("limit"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onLimitChanged",null),s([l.Watch("count"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onCountChanged",null),s([l.Watch("columnMode",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onColumnModeChanged",null),s([l.Watch("sortType",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onSortTypeChanged",null),s([l.Watch("offset",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onOffsetChanged",null),s([l.Watch("pageSize"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onPageSizeChanged",null),s([l.Watch("selected",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onSelectedChanged",null),s([l.Watch("checked",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onCheckedChanged",null),s([l.Watch("sorts"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onSortsChanged",null),s([m.throttleable(5),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DatatableComponent.prototype,"onWindowResize",null),DatatableComponent=s([l.Component({directives:{"v-visibility-observer":c.default},components:{"datatable-header":C.default,"datatable-body":y.default,"datatable-footer":b.default}})],DatatableComponent),DatatableComponent}(l.Vue);t.default=w},"./node_modules/vue-loader/lib/runtime/componentNormalizer.js":function(e,t,n){"use strict";function normalizeComponent(e,t,n,i,o,s,r,a){var l,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),s&&(c._scopeId="data-v-"+s),r?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},c._ssrRegister=l):o&&(l=a?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function renderWithStyleInjection(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}n.r(t),n.d(t,"default",(function(){return normalizeComponent}))},"./node_modules/vue-style-loader/index.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/sass-loader/lib/loader.js?!./src/components/datatable.component.scss?vue&type=style&index=0&lang=scss&":function(e,t,n){var i=n("./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/sass-loader/lib/loader.js?!./src/components/datatable.component.scss?vue&type=style&index=0&lang=scss&");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=n("./node_modules/vue-style-loader/lib/addStylesClient.js").default;o("24f3cf14",i,!1,{})},"./node_modules/vue-style-loader/lib/addStylesClient.js":function(e,t,n){"use strict";function listToStyles(e,t){for(var n=[],i={},o=0;o<t.length;o++){var s=t[o],r=s[0],a=s[1],l=s[2],c=s[3],d={id:e+":"+o,css:a,media:l,sourceMap:c};i[r]?i[r].parts.push(d):n.push(i[r]={id:r,parts:[d]})}return n}n.r(t),n.d(t,"default",(function(){return addStylesClient}));var i="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!i)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},s=i&&(document.head||document.getElementsByTagName("head")[0]),r=null,a=0,l=!1,noop=function(){},c=null,d="data-vue-ssr-id",u="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function addStylesClient(e,t,n,i){l=n,c=i||{};var s=listToStyles(e,t);return addStylesToDom(s),function update(t){for(var n=[],i=0;i<s.length;i++){var r=s[i],a=o[r.id];a.refs--,n.push(a)}t?(s=listToStyles(e,t),addStylesToDom(s)):s=[];for(i=0;i<n.length;i++){a=n[i];if(0===a.refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete o[a.id]}}}}function addStylesToDom(e){for(var t=0;t<e.length;t++){var n=e[t],i=o[n.id];if(i){i.refs++;for(var s=0;s<i.parts.length;s++)i.parts[s](n.parts[s]);for(;s<n.parts.length;s++)i.parts.push(addStyle(n.parts[s]));i.parts.length>n.parts.length&&(i.parts.length=n.parts.length)}else{var r=[];for(s=0;s<n.parts.length;s++)r.push(addStyle(n.parts[s]));o[n.id]={id:n.id,refs:1,parts:r}}}}function createStyleElement(){var e=document.createElement("style");return e.type="text/css",s.appendChild(e),e}function addStyle(e){var t,n,i=document.querySelector("style["+d+'~="'+e.id+'"]');if(i){if(l)return noop;i.parentNode.removeChild(i)}if(u){var o=a++;i=r||(r=createStyleElement()),t=applyToSingletonTag.bind(null,i,o,!1),n=applyToSingletonTag.bind(null,i,o,!0)}else i=createStyleElement(),t=applyToTag.bind(null,i),n=function(){i.parentNode.removeChild(i)};return t(e),function updateStyle(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap)return;t(e=i)}else n()}}var p=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function applyToSingletonTag(e,t,n,i){var o=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=p(t,o);else{var s=document.createTextNode(o),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}function applyToTag(e,t){var n=t.css,i=t.media,o=t.sourceMap;if(i&&e.setAttribute("media",i),c.ssrId&&e.setAttribute(d,t.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{while(e.firstChild)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},"./src/components/body/body-cell.component.html?vue&type=template&id=48c40f9f&":function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return render})),n.d(t,"staticRenderFns",(function(){return i}));var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.column.visible,expression:"column.visible"}],staticClass:"datatable-body-cell",class:e.cssClasses,style:e.styles,attrs:{id:e.column.prop+"-"+e.column.$$id,tabindex:e.tabIndex},on:{dblclick:e.onDblClick,click:e.onClick,keydown:e.onKeyDown,mouseenter:e.onMouseEnter,focus:e.onFocus,blur:e.onBlur}},[n("div",{staticClass:"datatable-body-cell-label",style:e.column.isTreeColumn?e.marginCellStyle:null},[e.isCheckboxable?n("label",{staticClass:"datatable-checkbox"},[n("input",{attrs:{type:"checkbox"},domProps:{checked:e.rowContext.isChecked},on:{click:e.onCheckboxChange}})]):e._e(),e._v(" "),e.column.isTreeColumn?[e.column.treeToggleTemplate?e._e():n("button",{staticClass:"datatable-tree-button",attrs:{disabled:"disabled"===e.rowContext.treeStatus},on:{click:e.onTreeAction}},[n("span",["loading"===e.rowContext.row.treeStatus?n("i",{staticClass:"icon datatable-icon-collapse"}):"collapsed"===e.rowContext.treeStatus?n("i",{staticClass:"icon datatable-icon-right"}):"expanded"===e.rowContext.treeStatus?n("i",{staticClass:"icon datatable-icon-down"}):n("i",{staticClass:"icon icon-disabled datatable-icon-down"})])]),e._v(" "),e._t("tree-toggle")]:e._e(),e._v(" "),e._t("default",[n("span",{attrs:{title:e.sanitizedValue},domProps:{innerHTML:e._s(e.value)}})],null,{row:e.rowContext.row?e.rowContext.row:{},column:e.column,rowIndex:e.rowContext.rowIndex,group:e.rowContext.group,expanded:e.rowContext.expanded,value:e.value})],2)])},i=[];render._withStripped=!0},"./src/components/body/body-cell.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";n.r(t);var i=n("./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/body/body-cell.component.ts?vue&type=script&lang=js&"),o=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},"./src/components/body/body-cell.component.vue":function(e,t,n){"use strict";n.r(t);var i=n("./src/components/body/body-cell.component.html?vue&type=template&id=48c40f9f&"),o=n("./src/components/body/body-cell.component.ts?vue&type=script&lang=js&");for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);var r=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=Object(r["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,null,null);a.options.__file="src/components/body/body-cell.component.vue",t["default"]=a.exports},"./src/components/body/body-group-header.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=function(e){function DataTableBodyGroupHeaderComponent(){return null!==e&&e.apply(this,arguments)||this}return i(DataTableBodyGroupHeaderComponent,e),DataTableBodyGroupHeaderComponent.prototype.created=function(){this.groupHeaderSlot&&(this.$slots.groupHeader=this.groupHeaderSlot({group:this.group,expanded:this.expanded,level:this.groupLevel,groupBy:this.groupBy}))},DataTableBodyGroupHeaderComponent.prototype.beforeUpdate=function(){this.groupHeaderSlot&&(this.$slots.groupHeader=this.groupHeaderSlot({group:this.group,expanded:this.expanded,level:this.groupLevel,groupBy:this.groupBy}))},DataTableBodyGroupHeaderComponent.prototype.toggleExpandGroup=function(){this.$emit("group-toggle",{type:"group",value:this.group})},DataTableBodyGroupHeaderComponent.prototype.expandAllGroups=function(){this.$emit("group-toggle",{type:"all",value:!0})},DataTableBodyGroupHeaderComponent.prototype.collapseAllGroups=function(){this.$emit("group-toggle",{type:"all",value:!1})},Object.defineProperty(DataTableBodyGroupHeaderComponent.prototype,"groupTitle",{get:function(){var e="";return this.group&&this.group.keys&&this.group.keys.forEach((function(t){e+=e?"; "+t.title+" - "+t.value:t.title+" - "+t.value})),e},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyGroupHeaderComponent.prototype,"styles",{get:function(){return{"padding-left":this.groupLevel?10*this.groupLevel+"px":"5px"}},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableBodyGroupHeaderComponent.prototype,"groupBy",{get:function(){return this.groupLevel&&Array.isArray(this.groupRowsBy)&&this.groupRowsBy.length-1>=this.groupLevel?this.groupRowsBy[this.groupLevel]:null},enumerable:!1,configurable:!0}),o([r.Prop({default:0}),s("design:type",Object)],DataTableBodyGroupHeaderComponent.prototype,"rowHeight",void 0),o([r.Prop(),s("design:type",Object)],DataTableBodyGroupHeaderComponent.prototype,"group",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableBodyGroupHeaderComponent.prototype,"expanded",void 0),o([r.Prop(),s("design:type",Function)],DataTableBodyGroupHeaderComponent.prototype,"groupHeaderSlot",void 0),o([r.Prop(),s("design:type",Number)],DataTableBodyGroupHeaderComponent.prototype,"groupLevel",void 0),o([r.Prop(),s("design:type",Array)],DataTableBodyGroupHeaderComponent.prototype,"groupRowsBy",void 0),DataTableBodyGroupHeaderComponent=o([r.Component({template:'\n    <div\n      :class="{ \'datatable-icon-right\': !expanded, \'datatable-icon-down\': expanded }"\n      :style="styles"\n      title="Expand/Collapse Group"\n      @click="toggleExpandGroup"\n    >\n      <slot name="groupHeader" v-bind="{ group: group, expanded: expanded, level: groupLevel, groupBy: groupBy }">\n        <span\n          ><b>{{ groupTitle }}</b></span\n        >\n      </slot>\n    </div>\n  '})],DataTableBodyGroupHeaderComponent),DataTableBodyGroupHeaderComponent}(r.Vue);t.default=a},"./src/components/body/body-row-detail.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=function(e){function DataTableBodyRowDetailComponent(){return null!==e&&e.apply(this,arguments)||this}return i(DataTableBodyRowDetailComponent,e),DataTableBodyRowDetailComponent.prototype.created=function(){this.rowDetailSlot&&(this.$slots.rowDetail=this.rowDetailSlot({row:this.row,expanded:this.expanded}))},DataTableBodyRowDetailComponent.prototype.beforeUpdate=function(){this.rowDetailSlot&&(this.$slots.rowDetail=this.rowDetailSlot({row:this.row,expanded:this.expanded}))},DataTableBodyRowDetailComponent.prototype.toggleExpandGroup=function(){},o([r.Prop({default:0}),s("design:type",Object)],DataTableBodyRowDetailComponent.prototype,"rowHeight",void 0),o([r.Prop(),s("design:type",Object)],DataTableBodyRowDetailComponent.prototype,"row",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableBodyRowDetailComponent.prototype,"expanded",void 0),o([r.Prop(),s("design:type",Function)],DataTableBodyRowDetailComponent.prototype,"rowDetailSlot",void 0),DataTableBodyRowDetailComponent=o([r.Component({template:'\n    <div style="padding-left:5px;">\n      <slot name="rowDetail" v-bind="{ row: row, expanded: expanded }">\n        <h3>detail row info</h3>\n      </slot>\n    </div>\n  '})],DataTableBodyRowDetailComponent),DataTableBodyRowDetailComponent}(r.Vue);t.default=a},"./src/components/body/body-row-wrapper.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";n.r(t);var i=n("./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/body/body-row-wrapper.component.ts?vue&type=script&lang=js&"),o=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},"./src/components/body/body-row-wrapper.component.vue":function(e,t,n){"use strict";n.r(t);var i=n("./src/components/body/body-row-wrapper.component.vue?vue&type=template&id=11b0d871&scoped=true&"),o=n("./src/components/body/body-row-wrapper.component.ts?vue&type=script&lang=js&");for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);var r=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=Object(r["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,"11b0d871",null);a.options.__file="src/components/body/body-row-wrapper.component.vue",t["default"]=a.exports},"./src/components/body/body-row-wrapper.component.vue?vue&type=template&id=11b0d871&scoped=true&":function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return render})),n.d(t,"staticRenderFns",(function(){return i}));var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"datatable-row-wrapper",style:e.styleObject,attrs:{tabindex:"-1","data-test-id":e.rowId}},[e.row&&e.row.__isGroup?n("datatable-group-header",{staticClass:"datatable-group-header",style:e.groupHeaderStyles,attrs:{group:e.row,groupLevel:e.row.level,groupRowsBy:e.groupRowsBy,expanded:e.row.__expanded,groupHeaderSlot:e.groupHeaderSlot},on:{"group-toggle":function(t){return e.$emit("group-toggle",t)},contextmenu:function(t){return e.$emit("row-contextmenu",t,e.row)}}}):e._t("default"),e._v(" "),e.rowDetail&&e.expanded?n("datatable-row-detail",{staticClass:"datatable-row-detail",style:{height:e.rowDetailHeight+"px"},attrs:{row:e.row,expanded:e.expanded,rowDetailSlot:e.rowDetailSlot},on:{"detail-toggle":function(t){return e.$emit("detail-toggle",t)},contextmenu:function(t){return e.$emit("row-contextmenu",t,e.row)}}}):e._e()],2)},i=[];render._withStripped=!0},"./src/components/body/body-row.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";n.r(t);var i=n("./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/body/body-row.component.ts?vue&type=script&lang=js&"),o=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},"./src/components/body/body-row.component.vue":function(e,t,n){"use strict";n.r(t);var i=n("./src/components/body/body-row.component.vue?vue&type=template&id=0d0f71aa&"),o=n("./src/components/body/body-row.component.ts?vue&type=script&lang=js&");for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);var r=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=Object(r["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,null,null);a.options.__file="src/components/body/body-row.component.vue",t["default"]=a.exports},"./src/components/body/body-row.component.vue?vue&type=template&id=0d0f71aa&":function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return render})),n.d(t,"staticRenderFns",(function(){return i}));var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"datatable-body-row",class:e.cssClasses,style:e.styles,attrs:{id:"row-group",tabIndex:-1},on:{focus:e.onFocus,blur:e.onBlur,keydown:e.onKeyDown}},e._l(e.columnsByPin,(function(t){return n("div",{key:t.type,staticClass:"datatable-row-group",class:"datatable-row-"+t.type,style:e.groupStyles(t),on:{mouseenter:function(t){return e.$emit("activate",e.row)}}},e._l(t.columns,(function(t,i){return n("datatable-body-cell",{key:t.$$id+"-"+e.counter,attrs:{tabIndex:"-1",rowContext:e.rowContext,column:t,cellSlot:e.slots()[t.prop],renderTracking:e.renderTracking,displayCheck:e.displayCheck},on:{activate:function(t){return e.onActivate(t,i)},"tree-action":e.onTreeAction,mouseenter:e.onMouseenter,"cell-created":e.onCellRendered,"cell-updated":e.onCellRendered}})})),1)})),0)},i=[];render._withStripped=!0},"./src/components/body/body.component.html?vue&type=template&id=0878f244&":function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return render})),n.d(t,"staticRenderFns",(function(){return i}));var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"datatable-body",style:e.styleObject},[n("datatable-selection",{ref:"selector",attrs:{selected:e.selected,checked:e.checked,rows:e.rows,pageSize:e.pageSize,selectCheck:e.selectCheck,selectEnabled:e.selectEnabled,selectionType:e.selectionType,checkMode:e.checkMode,rowIdentity:e.rowIdentity,scroller:e.scroller,bodyHeight:e.bodyHeight},on:{select:e.onSelect,check:function(t){return e.$emit("check",t)},activate:function(t){return e.$emit("activate",t)}}},[e.loadingIndicator?n("datatable-progress"):e._e(),e._v(" "),n("datatable-scroller",{ref:"scroller",attrs:{scrollbarV:e.scrollbarV,scrollbarH:e.scrollbarH,scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth},on:{setup:e.onScrollSetup,scroll:e.onBodyScroll}},[e.summaryRow&&"top"===e.summaryPosition?n("datatable-summary-row",{staticClass:"datatable-summary-row",attrs:{rowHeight:e.summaryHeight,offsetX:e.offsetX,innerWidth:e.innerWidth,rows:e.rows,columns:e.columns,columnsByPin:e.columnsByPin,columnGroupWidths:e.columnGroupWidths,groupStyles:e.getGroupStyles,slots:e.cellSlots}}):e._e(),e._v(" "),e._l(e.rowContexts,(function(t,i){return n("datatable-row-wrapper",{key:i,attrs:{styleObject:e.getRowWrapperStyles(t),groupRowsBy:e.groupRowsBy,groupLevel:0,row:t.row,rowIdentity:e.rowIdentity,innerWidth:e.innerWidth,rowDetail:e.rowDetail,groupHeader:e.groupHeader,offsetX:e.offsetX,groupRowHeight:e.groupRowHeight,rowDetailHeight:e.getDetailRowHeight(t.row),expanded:t.expanded,rowIndex:t.rowIndex,groupHeaderSlot:e.groupHeaderSlot,rowDetailSlot:e.rowDetailSlot},on:{"group-toggle":e.onGroupToggle,"row-contextmenu":function(t){return e.$emit("rowContextmenu")}}},[n("datatable-body-row",{attrs:{tabindex:"-1",columnsByPin:e.columnsByPin,columnGroupWidths:e.columnGroupWidths,groupStyles:e.getGroupStyles,rowClass:e.rowClass,row:t.row,rowContext:t,displayCheck:e.displayCheck,slots:e.cellSlots,renderTracking:e.renderTracking},on:{"tree-action":function(t){return e.onTreeAction(t)},activate:function(t){return e.onActivate(t,i)},"row-created":e.onRowRendered,"row-updated":e.onRowRendered}})],1)})),e._v(" "),e.summaryRow&&"bottom"===e.summaryPosition?n("datatable-summary-row",{staticClass:"datatable-summary-row",style:e.getBottomSummaryRowStyles,attrs:{rowHeight:e.summaryHeight,offsetX:e.offsetX,innerWidth:e.innerWidth,rows:e.rows,columns:e.columns,columnsByPin:e.columnsByPin,columnGroupWidths:e.columnGroupWidths,groupStyles:e.getGroupStyles,slots:e.cellSlots}}):e._e()],2),e._v(" "),e.rows&&e.rows.length||e.loadingIndicator?e._e():n("div",{staticClass:"empty-row",domProps:{innerHTML:e._s(e.emptyMessage)}})],1)],1)},i=[];render._withStripped=!0},"./src/components/body/body.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";n.r(t);var i=n("./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/body/body.component.ts?vue&type=script&lang=js&"),o=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},"./src/components/body/body.component.vue":function(e,t,n){"use strict";n.r(t);var i=n("./src/components/body/body.component.html?vue&type=template&id=0878f244&"),o=n("./src/components/body/body.component.ts?vue&type=script&lang=js&");for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);var r=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=Object(r["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,null,null);a.options.__file="src/components/body/body.component.vue",t["default"]=a.exports},"./src/components/body/progress-bar.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(t,"__esModule",{value:!0});var s=n("vue-property-decorator"),r=function(e){function ProgressBarComponent(){return null!==e&&e.apply(this,arguments)||this}return i(ProgressBarComponent,e),ProgressBarComponent=o([s.Component({template:'\n    <div class="progress-linear" role="progressbar">\n      <div class="ngx-container">\n        <div class="ngx-bar"></div>\n      </div>\n    </div>\n  '})],ProgressBarComponent),ProgressBarComponent}(s.Vue);t.default=r},"./src/components/body/scroller.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=function(e){function ScrollerComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.fromPager=!0,t.scrollYPos=0,t.scrollXPos=0,t.prevScrollYPos=0,t.prevScrollXPos=0,t}return i(ScrollerComponent,e),Object.defineProperty(ScrollerComponent.prototype,"styleObject",{get:function(){return{height:this.scrollHeight?this.scrollHeight+"px":null,width:this.scrollWidth+"px",position:"relative",transform:"translateZ(0)"}},enumerable:!1,configurable:!0}),ScrollerComponent.prototype.created=function(){this.$emit("setup",{scrollYPos:this.scrollYPos,scrollXPos:this.scrollXPos})},ScrollerComponent.prototype.mounted=function(){var e=this;(this.scrollbarV||this.scrollbarH)&&(this.parentElement=this.$el.closest(".datatable-body"),this.onInitScrollHandler=this.onInitScroll.bind(this),"mousedown DOMMouseScroll mousewheel wheel touchstart keyup".split(" ").forEach((function(t){e.parentElement.addEventListener(t,e.onInitScrollHandler,{passive:!0})})),this.tick())},ScrollerComponent.prototype.beforeDestroy=function(){var e=this;(this.scrollbarV||this.scrollbarH)&&"mousedown DOMMouseScroll mousewheel wheel touchstart keyup".split(" ").forEach((function(t){e.parentElement.removeEventListener(t,e.onInitScrollHandler)}))},ScrollerComponent.prototype.setOffset=function(e,t){void 0===t&&(t=!1),this.parentElement&&(this.fromPager=t,this.parentElement.scrollTop=e)},ScrollerComponent.prototype.incOffset=function(e){this.parentElement&&(this.parentElement.scrollTop+=e)},ScrollerComponent.prototype.onInitScroll=function(){this.fromPager=!1},ScrollerComponent.prototype.tick=function(){var e=this;if(requestAnimationFrame((function(){return e.tick()})),this.scrollbarV||this.scrollbarH){var t=this.parentElement;if(!t)return;var n=t.scrollTop,i=t.scrollLeft;if(this.scrollYPos===n&&this.scrollXPos===i)return;this.scrollYPos=n,this.scrollXPos=i,this.updateOffset()}},ScrollerComponent.prototype.updateOffset=function(){var e;this.scrollYPos<this.prevScrollYPos?e="down":this.scrollYPos>this.prevScrollYPos?e="up":this.scrollXPos<this.prevScrollXPos?e="right":this.scrollXPos>this.prevScrollXPos&&(e="left"),e&&this.$emit("scroll",{direction:e,scrollYPos:this.scrollYPos,scrollXPos:this.scrollXPos,fromPager:this.fromPager}),this.prevScrollYPos=this.scrollYPos,this.prevScrollXPos=this.scrollXPos},o([r.Prop({type:Boolean,default:!1}),s("design:type",Boolean)],ScrollerComponent.prototype,"scrollbarV",void 0),o([r.Prop({type:Boolean,default:!1}),s("design:type",Boolean)],ScrollerComponent.prototype,"scrollbarH",void 0),o([r.Prop(),s("design:type",Number)],ScrollerComponent.prototype,"scrollHeight",void 0),o([r.Prop(),s("design:type",String)],ScrollerComponent.prototype,"scrollWidth",void 0),ScrollerComponent=o([r.Component({template:'\n    <div class="datatable-scroll" :style="styleObject">\n      <slot></slot>\n    </div>\n  '})],ScrollerComponent),ScrollerComponent}(r.Vue);t.default=a},"./src/components/body/selection.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var s=arguments[t],r=0,a=s.length;r<a;r++,o++)i[o]=s[r];return i};Object.defineProperty(t,"__esModule",{value:!0});var a=n("./src/components/body/scroller.component.ts"),l=n("vue-property-decorator"),c=n("./src/types/index.ts"),d=n("./src/types/check.type.ts"),u=n("./src/utils/index.ts"),p=function(e){function DataTableSelectionComponent(){return null!==e&&e.apply(this,arguments)||this}return i(DataTableSelectionComponent,e),DataTableSelectionComponent.prototype.selectRow=function(e,t,n){var i;if(this.selectEnabled){var o=this.selectionType===c.SelectionType.checkbox&&this.checkMode===d.CheckMode.checkIsSelect,s=this.selectionType===c.SelectionType.multi,a=this.selectionType===c.SelectionType.multiClick,l=[];l=s||o||a?e.shiftKey?u.selectRowsBetween([],this.rows,t,this.prevIndex,this.getRowSelectedIdx.bind(this)):e.ctrlKey||e.metaKey||a||o?u.selectRows(r(this.selected),n,this.getRowSelectedIdx.bind(this)):u.selectRows([],n,this.getRowSelectedIdx.bind(this)):u.selectRows([],n,this.getRowSelectedIdx.bind(this)),this.prevIndex=t,"function"===typeof this.selectCheck&&(l=l.filter(this.selectCheck.bind(this))),this.selected.splice(0,this.selected.length),(i=this.selected).push.apply(i,l),this.$emit("select",{selected:l,index:t})}},DataTableSelectionComponent.prototype.checkRow=function(e,t,n){var i;if(this.selectEnabled){var o=[];o=e.shiftKey?u.selectRowsBetween([],this.rows,t,this.prevIndex,this.getRowSelectedIdx.bind(this)):u.selectRows(r(this.checked),n,this.getRowSelectedIdx.bind(this)),this.prevIndex=t,"function"===typeof this.selectCheck&&(o=o.filter(this.selectCheck.bind(this))),this.checked.splice(0,this.checked.length),(i=this.checked).push.apply(i,o),this.$emit("check",{checked:o})}},DataTableSelectionComponent.prototype.onActivate=function(e,t){var n=e.type,i=e.event,o=e.row,s=e.column,r=this.selectionType===c.SelectionType.checkbox&&this.checkMode===d.CheckMode.checkIsSelect,a=!r&&("click"===n||"dblclick"===n)||r&&"checkbox"===n;this.checkMode===d.CheckMode.checkNoSelect&&(null===s||void 0===s?void 0:s.checkboxable)&&(a=!1),a?this.selectRow(i,t,o):"checkbox"===n&&this.checkMode===d.CheckMode.checkNoSelect?this.checkRow(i,t,o):"keydown"===n&&(i.keyCode===u.Keys.return?this.selectRow(i,t,o):this.onKeyboardFocus(e)),this.$emit("activate",e)},DataTableSelectionComponent.prototype.onKeyboardFocus=function(e){var t=e.event.keyCode,n=t===u.Keys.up||t===u.Keys.down||t===u.Keys.right||t===u.Keys.left||t===u.Keys.pageUp||t===u.Keys.pageDown;if(n){var i=this.selectionType===c.SelectionType.cell;e.cellElement&&i?i&&this.focusCell(e.cellElement,e.rowElement,t,e.cellIndex):this.focusRow(e,t)}},DataTableSelectionComponent.prototype.focusRow=function(e,t){var n=this.getPrevNextRow(e.rowElement,t),i=0;if(t===u.Keys.up){if(e.rowIndex-1<0)return;i=e.rowIndex-1}else if(t===u.Keys.down){if(e.rowIndex+1>=this.rows.length)return;i=e.rowIndex+1}else t===u.Keys.pageUp?(i=e.rowIndex-this.pageSize,i=i<0?0:i):t===u.Keys.pageDown&&(i=e.rowIndex+this.pageSize,i=i>=this.rows.length?this.rows.length-1:i);var o=this.$parent.getRowOffsetY(i+1),s=o.offsetY,r=o.height;if(r){var a=!1,l=0;[u.Keys.down,u.Keys.pageDown].includes(t)?l=s+r-(this.$parent.$el.scrollTop+this.bodyHeight):[u.Keys.up,u.Keys.pageUp].includes(t)&&(l=s-r-this.$parent.$el.scrollTop),l>0&&[u.Keys.down,u.Keys.pageDown].includes(t)?this.scroller.incOffset(l):l<0&&[u.Keys.up,u.Keys.pageUp].includes(t)?(this.scroller.incOffset(l),a=1!==e.rowIndex):0===l&&[u.Keys.up,u.Keys.pageUp].includes(t)&&[0,1,2].includes(e.rowIndex)&&this.scroller.setOffset(l),a||[u.Keys.left,u.Keys.right].includes(t)?e.rowElement.focus():n&&n.focus()}else n&&n.focus()},DataTableSelectionComponent.prototype.focusRow1=function(e){var t=this,n=0;if(e===u.Keys.up){if(this.prevIndex-1<0)return;n=this.prevIndex-1}else if(e===u.Keys.down){if(this.prevIndex+1>=this.rows.length)return;n=this.prevIndex+1}else e===u.Keys.pageUp?(n=this.prevIndex-this.pageSize,n=n<0?0:n):e===u.Keys.pageDown&&(n=this.prevIndex+this.pageSize,n=n>=this.rows.length?this.rows.length-1:n);var i=this.rows[n];if(i){setTimeout((function(){return t.selectRow({shiftKey:!1,ctrlKey:!1},n,i)}));var o=this.$parent.getRowOffsetY(n),s=o.offsetY,r=o.height,a=0;[u.Keys.down,u.Keys.pageDown].includes(e)?a=s-this.bodyHeight:[u.Keys.up,u.Keys.pageUp].includes(e)&&(a=s-r-this.scroller.scrollYPos),a>0&&[u.Keys.down,u.Keys.pageDown].includes(e)?this.scroller.setOffset(a):a<0&&[u.Keys.up,u.Keys.pageUp].includes(e)&&this.scroller.incOffset(a)}},DataTableSelectionComponent.prototype.getPrevNextRowElement=function(e,t){if(e){var n=void 0;return t===u.Keys.up?n=e.previousElementSibling:t===u.Keys.down&&(n=e.nextElementSibling),n}},DataTableSelectionComponent.prototype.getPrevNextRow=function(e,t){var n=e.parentElement;if(n){var i=void 0;if(t===u.Keys.up?i=n.previousElementSibling:t===u.Keys.down&&(i=n.nextElementSibling),i&&i.children.length)return i.children[0]}},DataTableSelectionComponent.prototype.getPrevNextRow1=function(e,t){var n=e.parentElement;if(n){var i=void 0;if(t===u.Keys.up?i=n.previousElementSibling:t===u.Keys.down&&(i=n.nextElementSibling),i&&i.children.length)return i.children[0]}},DataTableSelectionComponent.prototype.focusCell=function(e,t,n,i){var o;if(n===u.Keys.left)o=e.previousElementSibling;else if(n===u.Keys.right)o=e.nextElementSibling;else if(n===u.Keys.up||n===u.Keys.down){var s=this.getPrevNextRow(t,n);if(s){var r=s.getElementsByClassName("datatable-body-cell");r.length&&(o=r[i])}}o&&o.focus()},DataTableSelectionComponent.prototype.getRowSelected=function(e){return this.getRowSelectedIdx(e,this.selected)>-1},DataTableSelectionComponent.prototype.getRowChecked=function(e){var t=this.checkMode===d.CheckMode.checkIsSelect?this.selected:this.checked;return this.getRowSelectedIdx(e,t)>-1},DataTableSelectionComponent.prototype.getRowSelectedIdx=function(e,t){var n=this;if(!t||!t.length)return-1;var i=this.rowIdentity(e);return t.findIndex((function(e){var t=n.rowIdentity(e);return t===i}))},o([l.Prop(),s("design:type",Array)],DataTableSelectionComponent.prototype,"rows",void 0),o([l.Prop(),s("design:type",Array)],DataTableSelectionComponent.prototype,"selected",void 0),o([l.Prop(),s("design:type",Array)],DataTableSelectionComponent.prototype,"checked",void 0),o([l.Prop(),s("design:type",Boolean)],DataTableSelectionComponent.prototype,"selectEnabled",void 0),o([l.Prop(),s("design:type",String)],DataTableSelectionComponent.prototype,"selectionType",void 0),o([l.Prop(),s("design:type",String)],DataTableSelectionComponent.prototype,"checkMode",void 0),o([l.Prop(),s("design:type",Function)],DataTableSelectionComponent.prototype,"rowIdentity",void 0),o([l.Prop(),s("design:type",Function)],DataTableSelectionComponent.prototype,"selectCheck",void 0),o([l.Prop(),s("design:type",a.default)],DataTableSelectionComponent.prototype,"scroller",void 0),o([l.Prop(),s("design:type",Number)],DataTableSelectionComponent.prototype,"pageSize",void 0),o([l.Prop(),s("design:type",Number)],DataTableSelectionComponent.prototype,"bodyHeight",void 0),DataTableSelectionComponent=o([l.Component({template:'\n    <div id="selector">\n      <slot> selection </slot>\n    </div>\n  '})],DataTableSelectionComponent),DataTableSelectionComponent}(l.Vue);t.default=p},"./src/components/body/summary/summary-row.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=n("./src/components/body/body-row.component.vue");function defaultSumFunc(e){var t=e.filter((function(e){return Boolean(e)}));return t.length?t.some((function(e){return"number"!==typeof e}))?null:t.reduce((function(e,t){return e+t})):null}function noopSumFunc(e){return null}var l=function(e){function DataTableSummaryRowComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.internalColumns=[],t.summaryRow={},t.mySlotsFunc=null,t.myRowContext=null,t}return i(DataTableSummaryRowComponent,e),DataTableSummaryRowComponent.prototype.onRowsChanged=function(){this.onChanges()},DataTableSummaryRowComponent.prototype.onColumnsChanged=function(){this.onChanges()},DataTableSummaryRowComponent.prototype.onChanges=function(){this.columns&&this.rows&&(this.updateInternalColumns(),this.updateValues())},DataTableSummaryRowComponent.prototype.onActivate=function(e){this.$emit("summary-activate",e,this.summaryRow)},DataTableSummaryRowComponent.prototype.updateInternalColumns=function(){this.mySlotsFunc=this.slots;var e={};if(this.internalColumns=this.columns.map((function(t){return t.summaryTemplate&&(e[t.prop]=t.summaryTemplate),t})),Object.keys(e).length){var t=Object.assign({},this.slots());Object.keys(e).forEach((function(n){t[n]=e[n]})),this.mySlotsFunc=function(){return t}}},DataTableSummaryRowComponent.prototype.updateValues=function(){var e=this;this.summaryRow={},this.columns.filter((function(e){return!e.summaryTemplate})).forEach((function(t){var n=e.rows.map((function(e){return e[t.prop]})),i=e.getSummaryFunction(t);e.summaryRow[t.prop]=t.filter?t.filter(i(n)):i(n)})),this.myRowContext={row:this.summaryRow,rowIndex:-1,expanded:!1,isChecked:!1,isSelected:!1,rowHeight:this.rowHeight,treeStatus:null}},DataTableSummaryRowComponent.prototype.getSummaryFunction=function(e){return e.summaryFunc?null===e.summaryFunc?noopSumFunc:e.summaryFunc:defaultSumFunc},o([r.Prop(),s("design:type",Array)],DataTableSummaryRowComponent.prototype,"rows",void 0),o([r.Prop(),s("design:type",Array)],DataTableSummaryRowComponent.prototype,"columns",void 0),o([r.Prop(),s("design:type",Number)],DataTableSummaryRowComponent.prototype,"rowHeight",void 0),o([r.Prop(),s("design:type",Number)],DataTableSummaryRowComponent.prototype,"offsetX",void 0),o([r.Prop(),s("design:type",Number)],DataTableSummaryRowComponent.prototype,"innerWidth",void 0),o([r.Prop(),s("design:type",Array)],DataTableSummaryRowComponent.prototype,"columnsByPin",void 0),o([r.Prop(),s("design:type",Object)],DataTableSummaryRowComponent.prototype,"columnGroupWidths",void 0),o([r.Prop(),s("design:type",Object)],DataTableSummaryRowComponent.prototype,"groupStyles",void 0),o([r.Prop(),s("design:type",String)],DataTableSummaryRowComponent.prototype,"groupClass",void 0),o([r.Prop(),s("design:type",Function)],DataTableSummaryRowComponent.prototype,"slots",void 0),o([r.Watch("rows",{immediate:!0}),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTableSummaryRowComponent.prototype,"onRowsChanged",null),o([r.Watch("columns"),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTableSummaryRowComponent.prototype,"onColumnsChanged",null),DataTableSummaryRowComponent=o([r.Component({components:{"datatable-body-row":a.default},template:'\n    <datatable-body-row\n      v-if="summaryRow && internalColumns"\n      tabindex="-1"\n      :columnsByPin="columnsByPin"\n      :columnGroupWidths="columnGroupWidths"\n      :groupStyles="groupStyles"\n      :rowContext="myRowContext"\n      :row="summaryRow"\n      :slots="mySlotsFunc"\n      @activate="onActivate"\n    >\n    </datatable-body-row>\n  '})],DataTableSummaryRowComponent),DataTableSummaryRowComponent}(r.Vue);t.default=l},"./src/components/columns/column.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var s=arguments[t],r=0,a=s.length;r<a;r++,o++)i[o]=s[r];return i};Object.defineProperty(t,"__esModule",{value:!0});var a=n("vue-property-decorator"),l=function(e){function DataTableColumnComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.column={},t}return i(DataTableColumnComponent,e),DataTableColumnComponent.prototype.onVisibleChanged=function(e){this.column.visible=e,this.$parent.onColumnChangeVisible(this.column)},DataTableColumnComponent.prototype.mounted=function(){this.$set(this.column,"name",this.name),this.$set(this.column,"prop",this.prop),this.$set(this.column,"frozenLeft",this.frozenLeft),this.$set(this.column,"frozenRight",this.frozenRight),this.$set(this.column,"flexGrow",this.flexGrow),this.$set(this.column,"resizeable",this.resizeable),this.$set(this.column,"comparator",this.comparator),this.$set(this.column,"sortable",this.sortable),this.$set(this.column,"draggable",this.draggable),this.$set(this.column,"canAutoResize",this.canAutoResize),this.$set(this.column,"minWidth",this.minWidth),this.$set(this.column,"width",this.width),this.$set(this.column,"maxWidth",this.maxWidth),this.$set(this.column,"checkboxable",this.checkboxable),this.$set(this.column,"headerCheckboxable",this.headerCheckboxable);var e=[];if(Array.isArray(this.headerClass))e=r(this.headerClass);else if("string"===typeof this.headerClass)e.push(this.headerClass);else if("function"===typeof this.headerClass){var t=this.headerClass({column:this.column});if("string"===typeof t)e.push(t);else if("object"===typeof t)for(var n=Object.keys(t),i=0,o=n;i<o.length;i++){var s=o[i];!0===t[s]&&e.push(s)}}for(var a=0;a<this.$el.classList.length;a++){var l=this.$el.classList[0];e.push(l)}this.$set(this.column,"headerClass",e);var c=[];Array.isArray(this.cellClass)?c=r(this.cellClass):("string"===typeof this.cellClass||"function"===typeof this.cellClass)&&c.push(this.cellClass);for(a=0;a<this.$el.classList.length;a++){l=this.$el.classList[0];c.push(l)}this.$set(this.column,"cellClass",c),this.$set(this.column,"isTreeColumn",this.isTreeColumn),this.$set(this.column,"treeLevelIndent",this.treeLevelIndent),this.$set(this.column,"summaryFunc",this.summaryFunc),this.$set(this.column,"headerTemplate",this.$scopedSlots.header),this.$set(this.column,"headerAppendTemplate",this.$scopedSlots.headerAppend),this.$set(this.column,"cellTemplate",this.$scopedSlots.default),this.$set(this.column,"summaryTemplate",this.$scopedSlots.summary),this.$set(this.column,"visible",this.visible),this.$parent.onColumnInsert(this.column)},o([a.Prop(),s("design:type",String)],DataTableColumnComponent.prototype,"name",void 0),o([a.Prop(),s("design:type",Object)],DataTableColumnComponent.prototype,"prop",void 0),o([a.Prop(),s("design:type",Object)],DataTableColumnComponent.prototype,"frozenLeft",void 0),o([a.Prop(),s("design:type",Object)],DataTableColumnComponent.prototype,"frozenRight",void 0),o([a.Prop(),s("design:type",Number)],DataTableColumnComponent.prototype,"flexGrow",void 0),o([a.Prop(),s("design:type",Boolean)],DataTableColumnComponent.prototype,"resizeable",void 0),o([a.Prop(),s("design:type",Object)],DataTableColumnComponent.prototype,"comparator",void 0),o([a.Prop(),s("design:type",Object)],DataTableColumnComponent.prototype,"pipe",void 0),o([a.Prop(),s("design:type",Boolean)],DataTableColumnComponent.prototype,"sortable",void 0),o([a.Prop(),s("design:type",Boolean)],DataTableColumnComponent.prototype,"draggable",void 0),o([a.Prop({default:!0}),s("design:type",Boolean)],DataTableColumnComponent.prototype,"canAutoResize",void 0),o([a.Prop(),s("design:type",Number)],DataTableColumnComponent.prototype,"minWidth",void 0),o([a.Prop(),s("design:type",Number)],DataTableColumnComponent.prototype,"width",void 0),o([a.Prop(),s("design:type",Number)],DataTableColumnComponent.prototype,"maxWidth",void 0),o([a.Prop(),s("design:type",Boolean)],DataTableColumnComponent.prototype,"checkboxable",void 0),o([a.Prop(),s("design:type",Boolean)],DataTableColumnComponent.prototype,"headerCheckboxable",void 0),o([a.Prop(),s("design:type",Object)],DataTableColumnComponent.prototype,"headerClass",void 0),o([a.Prop(),s("design:type",Object)],DataTableColumnComponent.prototype,"cellClass",void 0),o([a.Prop(),s("design:type",Boolean)],DataTableColumnComponent.prototype,"isTreeColumn",void 0),o([a.Prop(),s("design:type",Number)],DataTableColumnComponent.prototype,"treeLevelIndent",void 0),o([a.Prop(),s("design:type",Function)],DataTableColumnComponent.prototype,"summaryFunc",void 0),o([a.Prop({default:!0}),s("design:type",Boolean)],DataTableColumnComponent.prototype,"visible",void 0),o([a.Watch("visible"),s("design:type",Function),s("design:paramtypes",[Boolean]),s("design:returntype",void 0)],DataTableColumnComponent.prototype,"onVisibleChanged",null),DataTableColumnComponent=o([a.Component({template:'\n    <div>\n      <slot name="header" v-bind="{column: column}">\n        \x3c!-- default content --\x3e\n        {{ name }}\n      </slot>\n      \x3c!-- default slot for cell --\x3e\n      <slot> </slot>\n    </div>\n  '})],DataTableColumnComponent),DataTableColumnComponent}(a.Vue);t.default=l},"./src/components/datatable.component.html?vue&type=template&id=3f42d2da&":function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return render})),n.d(t,"staticRenderFns",(function(){return i}));var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"visibility-observer",rawName:"v-visibility-observer",value:{on:e.visibilityCheck,timeout:e.visibilityCheckTimeout},expression:"{ on: visibilityCheck, timeout: visibilityCheckTimeout }"}],staticClass:"ngx-datatable",class:e.classObject,on:{visible:e.onVisible,"insert-column":e.onColumnInsert}},[e.isColumnsInited?e._e():n("div",{ref:"hiddenColumns",staticClass:"hidden-columns"},[e._t("default")],2),e._v(" "),e.headerHeight?n("datatable-header",{ref:"datatableHeader",staticClass:"datatable-header",attrs:{sorts:e.sorts,sortType:e.mySortType,scrollbarWidth:e.scrollbarWidth,scrollbarH:e.scrollbarH,innerWidth:e.innerWidth,offsetX:e.offsetX,dealsWithGroup:Array.isArray(e.groupRowsBy)&&Boolean(e.groupRowsBy.length),columns:e.internalColumns,headerHeight:e.headerHeight,reorderable:e.reorderable,sortAscendingIcon:e.cssClasses.sortAscending,sortDescendingIcon:e.cssClasses.sortDescending,allRowsSelected:e.allRowsSelected,selectionType:e.selectionType},on:{sort:function(t){return e.onColumnSort(t)},resize:function(t){return e.onColumnResize(t)},reorder:function(t){return e.onColumnReorder(t)},select:function(t){return e.onHeaderSelect(t)},columnContextmenu:function(t){return e.onColumnContextmenu(t)}}}):e._e(),e._v(" "),n("datatable-body",{ref:"datatableBody",attrs:{groupRowsBy:e.groupRowsBy,rows:e.internalRows,groupExpansionDefault:e.groupExpansionDefault,scrollbarV:e.scrollbarV,scrollbarH:e.scrollbarH,virtualization:e.virtualization,loadingIndicator:e.loadingIndicator,externalPaging:e.externalPaging,rowHeight:e.myRowHeight,rowCount:e.rowCount,offset:e.myOffset,trackByProp:e.trackByProp,columns:e.internalColumns,pageSize:e.pageSize,limit:e.limit,offsetX:e.offsetX,rowDetail:e.rowDetail,rowDetailHeight:e.rowDetailHeight,groupHeader:e.groupHeader,selected:e.mySelected,checked:e.myChecked,innerWidth:e.innerWidth,bodyHeight:e.bodyHeight,selectionType:e.selectionType,checkMode:e.checkMode,emptyMessage:e.messages.emptyMessage,rowIdentity:e.rowIdentity,rowClass:e.rowClass,selectCheck:e.selectCheck,displayCheck:e.displayCheck,summaryRow:e.summaryRow,summaryHeight:e.summaryHeight,summaryPosition:e.summaryPosition,groupRowHeight:e.groupRowHeight,groupHeaderSlot:e.groupHeaderSlot,rowDetailSlot:e.rowDetailSlot,renderTracking:e.renderTracking},on:{page:e.onBodyPage,activate:function(t){return e.$emit("activate",t)},rowContextmenu:e.onRowContextmenu,select:e.onBodySelect,check:e.onBodyCheck,scroll:e.onBodyScroll,"group-toggle":e.onGroupToggle,"tree-action":e.onTreeAction,rendered:function(t){return e.$emit("rendered",t)}}}),e._v(" "),n("div",{staticClass:"datatable-footer",class:{"datatable-footer-border":Boolean(e.footerHeight)}},[e.footerHeight?n("datatable-footer",{ref:"datatableFooter",attrs:{rowCount:e.rowCount,pageSize:e.pageSize,offset:e.myOffset,footerHeight:e.footerHeight,totalMessage:e.messages.totalMessage,pagerLeftArrowIcon:e.cssClasses.pagerLeftArrow,pagerRightArrowIcon:e.cssClasses.pagerRightArrow,pagerPreviousIcon:e.cssClasses.pagerPrevious,selectedCount:e.mySelected.length,selectedMessage:!!e.selectionType&&e.messages.selectedMessage,pagerNextIcon:e.cssClasses.pagerNext,footerSlot:e.footerSlot},on:{page:e.onFooterPage}}):e._e()],1)],1)},i=[];render._withStripped=!0},"./src/components/datatable.component.scss?vue&type=style&index=0&lang=scss&":function(e,t,n){"use strict";n.r(t);var i=n("./node_modules/vue-style-loader/index.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/sass-loader/lib/loader.js?!./src/components/datatable.component.scss?vue&type=style&index=0&lang=scss&"),o=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},"./src/components/datatable.component.ts?vue&type=script&lang=js&":function(e,t,n){"use strict";n.r(t);var i=n("./node_modules/ts-loader/index.js?!./node_modules/eslint-loader/dist/cjs.js!./src/components/datatable.component.ts?vue&type=script&lang=js&"),o=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},"./src/components/datatable.component.vue":function(e,t,n){"use strict";n.r(t);var i=n("./src/components/datatable.component.html?vue&type=template&id=3f42d2da&"),o=n("./src/components/datatable.component.ts?vue&type=script&lang=js&");for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);n("./src/components/datatable.component.scss?vue&type=style&index=0&lang=scss&");var r=n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js"),a=Object(r["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,null,null);a.options.__file="src/components/datatable.component.vue",t["default"]=a.exports},"./src/components/footer/footer.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=n("./src/components/footer/pager.component.ts"),l=function(e){function DataTableFooterComponent(){return null!==e&&e.apply(this,arguments)||this}return i(DataTableFooterComponent,e),DataTableFooterComponent.prototype.created=function(){this.footerSlot&&(this.$slots.default=this.footerSlot({rowCount:this.rowCount,pageSize:this.pageSize,selectedCount:this.selectedCount,curPage:this.curPage,offset:this.offset}))},DataTableFooterComponent.prototype.beforeUpdate=function(){this.footerSlot&&(this.$slots.default=this.footerSlot({rowCount:this.rowCount,pageSize:this.pageSize,selectedCount:this.selectedCount,curPage:this.curPage,offset:this.offset}))},Object.defineProperty(DataTableFooterComponent.prototype,"isVisible",{get:function(){return this.rowCount/this.pageSize>1},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableFooterComponent.prototype,"curPage",{get:function(){return this.offset+1},enumerable:!1,configurable:!0}),o([r.Prop(),s("design:type",Number)],DataTableFooterComponent.prototype,"footerHeight",void 0),o([r.Prop(),s("design:type",Number)],DataTableFooterComponent.prototype,"rowCount",void 0),o([r.Prop(),s("design:type",Number)],DataTableFooterComponent.prototype,"pageSize",void 0),o([r.Prop(),s("design:type",Number)],DataTableFooterComponent.prototype,"offset",void 0),o([r.Prop(),s("design:type",String)],DataTableFooterComponent.prototype,"pagerLeftArrowIcon",void 0),o([r.Prop(),s("design:type",String)],DataTableFooterComponent.prototype,"pagerRightArrowIcon",void 0),o([r.Prop(),s("design:type",String)],DataTableFooterComponent.prototype,"pagerPreviousIcon",void 0),o([r.Prop(),s("design:type",String)],DataTableFooterComponent.prototype,"pagerNextIcon",void 0),o([r.Prop(),s("design:type",String)],DataTableFooterComponent.prototype,"totalMessage",void 0),o([r.Prop(),s("design:type",Function)],DataTableFooterComponent.prototype,"footerSlot",void 0),o([r.Prop({type:Number,default:0}),s("design:type",Number)],DataTableFooterComponent.prototype,"selectedCount",void 0),o([r.Prop(),s("design:type",Object)],DataTableFooterComponent.prototype,"selectedMessage",void 0),DataTableFooterComponent=o([r.Component({components:{"datatable-pager":a.default},template:'\n    <div\n      class="datatable-footer-inner"\n      :class="{\'selected-count\': selectedMessage }"\n      :style="{ \'height\': footerHeight + \'px\' }"\n    >\n      <slot\n        v-bind:row="{ rowCount: rowCount, pageSize: pageSize,\n                          selectedCount: selectedCount, curPage: curPage, offset: offset }"\n      >\n        <div class="page-count">\n          <span v-if="selectedMessage"> {{ selectedCount.toLocaleString() }} {{ selectedMessage }} / </span>\n          {{ rowCount.toLocaleString() }} {{ totalMessage }}\n        </div>\n      </slot>\n      <div class="datatable-pager">\n        <datatable-pager\n          :pagerLeftArrowIcon="pagerLeftArrowIcon"\n          :pagerRightArrowIcon="pagerRightArrowIcon"\n          :pagerPreviousIcon="pagerPreviousIcon"\n          :pagerNextIcon="pagerNextIcon"\n          :page="curPage"\n          :size="pageSize"\n          :count="rowCount"\n          :hidden="!isVisible"\n          @change-page="$emit(\'page\', $event)"\n        >\n        </datatable-pager>\n      </div>\n    </div>\n  '})],DataTableFooterComponent),DataTableFooterComponent}(r.Vue);t.default=l},"./src/components/footer/pager.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=function(e){function DataTablePagerComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.pages=[],t.myPage=0,t}return i(DataTablePagerComponent,e),DataTablePagerComponent.prototype.onCountChanged=function(){this.pages=this.calcPages()},DataTablePagerComponent.prototype.onSizeChanged=function(){this.pages=this.calcPages()},DataTablePagerComponent.prototype.onPageChanged=function(){this.myPage=this.page,this.pages=this.calcPages()},DataTablePagerComponent.prototype.created=function(){this.myPage=this.page,this.pages=this.calcPages()},Object.defineProperty(DataTablePagerComponent.prototype,"totalPages",{get:function(){if(this.size<1)return 1;var e=Math.ceil(this.count/this.size),t=Math.floor(this.count/this.size)*this.size;return this.count-t===1&&e--,Math.max(e||0,1)},enumerable:!1,configurable:!0}),Object.defineProperty(DataTablePagerComponent.prototype,"canPrevious",{get:function(){return this.myPage>1},enumerable:!1,configurable:!0}),Object.defineProperty(DataTablePagerComponent.prototype,"canNext",{get:function(){return this.myPage<this.totalPages},enumerable:!1,configurable:!0}),DataTablePagerComponent.prototype.prevPage=function(){this.selectPage(this.myPage-1)},DataTablePagerComponent.prototype.nextPage=function(){this.selectPage(this.myPage+1)},DataTablePagerComponent.prototype.selectPage=function(e){e>0&&e<=this.totalPages&&e!==this.myPage&&(this.myPage=e,this.$emit("change-page",{page:e}))},DataTablePagerComponent.prototype.calcPages=function(e){var t=[],n=1,i=this.totalPages,o=5,s=o<this.totalPages;e=e||this.myPage,s&&(n=e-Math.floor(o/2),i=e+Math.floor(o/2),n<1?(n=1,i=Math.min(n+o-1,this.totalPages)):i>this.totalPages&&(n=Math.max(this.totalPages-o+1,1),i=this.totalPages));for(var r=n;r<=i;r++)t.push({number:r,text:String(r)});return t},o([r.Prop(),s("design:type",String)],DataTablePagerComponent.prototype,"pagerLeftArrowIcon",void 0),o([r.Prop(),s("design:type",String)],DataTablePagerComponent.prototype,"pagerRightArrowIcon",void 0),o([r.Prop(),s("design:type",String)],DataTablePagerComponent.prototype,"pagerPreviousIcon",void 0),o([r.Prop(),s("design:type",String)],DataTablePagerComponent.prototype,"pagerNextIcon",void 0),o([r.Prop({type:Number,default:0}),s("design:type",Number)],DataTablePagerComponent.prototype,"size",void 0),o([r.Prop({type:Number,default:0}),s("design:type",Number)],DataTablePagerComponent.prototype,"count",void 0),o([r.Prop({type:Number,default:1}),s("design:type",Number)],DataTablePagerComponent.prototype,"page",void 0),o([r.Watch("count"),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTablePagerComponent.prototype,"onCountChanged",null),o([r.Watch("size"),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTablePagerComponent.prototype,"onSizeChanged",null),o([r.Watch("page"),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTablePagerComponent.prototype,"onPageChanged",null),DataTablePagerComponent=o([r.Component({template:'\n    <ul class="pager">\n      <li :class="{ disabled: !canPrevious }">\n        <a role="button" aria-label="go to first page" href="javascript:void(0)" @click="selectPage(1)">\n          <i :class="pagerPreviousIcon"></i>\n        </a>\n      </li>\n      <li :class="{ disabled: !canPrevious }">\n        <a role="button" aria-label="go to previous page" href="javascript:void(0)" @click="prevPage">\n          <i :class="pagerLeftArrowIcon"></i>\n        </a>\n      </li>\n      <li\n        role="button"\n        aria-label="\'page \' + pg.number"\n        class="pages"\n        v-for="pg of pages"\n        :class="{ active: pg.number === myPage }"\n      >\n        <a href="javascript:void(0)" @click="selectPage(pg.number)">\n          {{ pg.text }}\n        </a>\n      </li>\n      <li :class="{ disabled: !canNext }">\n        <a role="button" aria-label="go to next page" href="javascript:void(0)" @click="nextPage">\n          <i :class="pagerRightArrowIcon"></i>\n        </a>\n      </li>\n      <li :class="{ disabled: !canNext }">\n        <a role="button" aria-label="go to last page" href="javascript:void(0)" @click="selectPage(totalPages)">\n          <i :class="pagerNextIcon"></i>\n        </a>\n      </li>\n    </ul>\n  '})],DataTablePagerComponent),DataTablePagerComponent}(r.Vue);t.default=a},"./src/components/header/header-cell.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("vue-property-decorator"),a=n("./src/types/index.ts"),l=n("./src/utils/index.ts"),c=function(e){function DataTableHeaderCellComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.sortFn=t.onSort.bind(t),t.sortDir=null,t.myAllRowsSelected=!1,t.sortOrder="",t.cellContext={column:null,sortDir:t.sortDir,sortFn:t.sortFn,allRowsSelected:!1},t}return i(DataTableHeaderCellComponent,e),DataTableHeaderCellComponent.prototype.onAllRowsSelectedChanged=function(){this.isCheckboxable&&(this.myAllRowsSelected=this.allRowsSelected,this.cellContext.allRowsSelected=this.allRowsSelected)},DataTableHeaderCellComponent.prototype.onColumnChahged=function(){this.cellContext.column=this.column},DataTableHeaderCellComponent.prototype.onSortsChanged=function(){this.sortDir=this.calcSortDir(this.sorts),this.cellContext.sortDir=this.sortDir},DataTableHeaderCellComponent.prototype.created=function(){this.cellContext.column=this.column,this.cellContext.allRowsSelected=this.allRowsSelected,this.$emit("header-cell-created",this.$el),this.column.headerTemplate&&(this.$slots.default=this.column.headerTemplate({column:this.column})),this.column.headerAppendTemplate&&(this.$slots.append=this.column.headerAppendTemplate({column:this.column}))},DataTableHeaderCellComponent.prototype.mounted=function(){this.column.element=this.$el,this.$emit("header-cell-mounted",this.$el),this.setResizeObserver()},DataTableHeaderCellComponent.prototype.beforeUpdate=function(){this.column.headerTemplate&&!this.$slots.default&&(this.$slots.default=this.column.headerTemplate({column:this.column})),this.column.headerAppendTemplate&&!this.$slots.append&&(this.$slots.append=this.column.headerAppendTemplate({column:this.column}))},DataTableHeaderCellComponent.prototype.updated=function(){this.resizeObserver&&this.column.element!==this.$el&&this.resizeObserver.unobserve(this.column.element),this.column.element=this.$el,this.setResizeObserver()},DataTableHeaderCellComponent.prototype.beforeDestroy=function(){this.column&&(this.column.element=null),this.resizeObserver&&this.resizeObserver.unobserve(this.$el)},DataTableHeaderCellComponent.prototype.onCheckboxChange=function(){this.$emit("select",this.myAllRowsSelected)},Object.defineProperty(DataTableHeaderCellComponent.prototype,"columnCssClasses",{get:function(){var e="datatable-header-cell";if(this.column&&(this.column.sortable&&(e+=" sortable"),this.column.resizeable&&(e+=" resizeable"),this.column.draggable&&(e+=" draggable"),this.column.headerClass))if("string"===typeof this.column.headerClass)e+=" "+this.column.headerClass;else if(Array.isArray(this.column.headerClass))e+=" "+this.column.headerClass.join(" ");else if("function"===typeof this.column.headerClass){var t=this.column.headerClass({column:this.column});if("string"===typeof t)e+=t;else if("object"===typeof t)for(var n=Object.keys(t),i=0,o=n;i<o.length;i++){var s=o[i];!0===t[s]&&(e+=" "+s)}}var r=this.sortDir;return r&&(e+=" sort-active sort-"+r),e},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableHeaderCellComponent.prototype,"name",{get:function(){return this.column.headerTemplate?null:this.column.name},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableHeaderCellComponent.prototype,"styles",{get:function(){return{height:this.headerHeight+"px",width:this.column.width+"px","min-width":this.column.minWidth+"px","max-width":this.column.maxWidth+"px"}},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableHeaderCellComponent.prototype,"sortCssClass",{get:function(){return this.calcSortCssClass(this.sortDir)},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableHeaderCellComponent.prototype,"cssClass",{get:function(){return this.calcCssClass(this.sortDir)},enumerable:!1,configurable:!0}),Object.defineProperty(DataTableHeaderCellComponent.prototype,"isCheckboxable",{get:function(){return this.column.checkboxable&&this.column.headerCheckboxable},enumerable:!1,configurable:!0}),DataTableHeaderCellComponent.prototype.onContextmenu=function(e){this.$emit("columnContextmenu",{event:e,column:this.column})},DataTableHeaderCellComponent.prototype.calcSortDir=function(e){var t=this;if(this.sortOrder="",e&&this.column){var n="",i=e.filter((function(e){return e.prop})).find((function(e,i){if(e.prop===t.column.prop)return n=(i+1).toString(),!0}));if(i)return this.sortType===a.SortType.multi&&(this.sortOrder=n),i.dir}},DataTableHeaderCellComponent.prototype.onSort=function(){if(this.column.sortable){var e=l.nextSortDir(this.sortType,this.sortDir);this.$emit("sort",{column:this.column,prevValue:this.sortDir,newValue:e})}},DataTableHeaderCellComponent.prototype.calcSortCssClass=function(e){return e===a.SortDirection.asc?"sort-btn sort-asc "+this.sortAscendingIcon:e===a.SortDirection.desc?"sort-btn sort-desc "+this.sortDescendingIcon:"sort-btn"},DataTableHeaderCellComponent.prototype.calcCssClass=function(e){return e===a.SortDirection.asc||e===a.SortDirection.desc?"datatable-header-cell-bold":""},DataTableHeaderCellComponent.prototype.setResizeObserver=function(){var e=this;window.ResizeObserver?(this.resizeObserver=new window.ResizeObserver((function(t){e.column&&(t.length&&t[0].contentRect?e.column.realWidth=Math.max(e.$el.clientWidth,t[0].contentRect.width):e.column.realWidth=e.$el.clientWidth)})),this.resizeObserver.observe(this.$el)):this.column.realWidth=null},o([r.Prop(),s("design:type",String)],DataTableHeaderCellComponent.prototype,"sortType",void 0),o([r.Prop(),s("design:type",String)],DataTableHeaderCellComponent.prototype,"sortAscendingIcon",void 0),o([r.Prop(),s("design:type",String)],DataTableHeaderCellComponent.prototype,"sortDescendingIcon",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableHeaderCellComponent.prototype,"isTarget",void 0),o([r.Prop(),s("design:type",Boolean)],DataTableHeaderCellComponent.prototype,"allRowsSelected",void 0),o([r.Prop(),s("design:type",String)],DataTableHeaderCellComponent.prototype,"selectionType",void 0),o([r.Prop(),s("design:type",Object)],DataTableHeaderCellComponent.prototype,"column",void 0),o([r.Prop(),s("design:type",Array)],DataTableHeaderCellComponent.prototype,"sorts",void 0),o([r.Prop(),s("design:type",Number)],DataTableHeaderCellComponent.prototype,"headerHeight",void 0),o([r.Watch("allRowsSelected",{immediate:!0}),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTableHeaderCellComponent.prototype,"onAllRowsSelectedChanged",null),o([r.Watch("column",{immediate:!0}),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTableHeaderCellComponent.prototype,"onColumnChahged",null),o([r.Watch("sorts",{immediate:!0}),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],DataTableHeaderCellComponent.prototype,"onSortsChanged",null),DataTableHeaderCellComponent=o([r.Component({template:'\n    <div\n      class="datatable-header-cell-template-wrap"\n      :class="[columnCssClasses]"\n      :style="styles"\n      :title="name"\n      v-show="column.visible"\n      @contextmenu="onContextmenu($event)"\n    >\n      <slot name="target-marker">\n        \x3c!-- Default content --\x3e\n        <div class="targetMarker" v-if="isTarget">\n          <div class="icon datatable-icon-down"></div>\n          <div class="icon datatable-icon-up"></div>\n        </div>\n      </slot>\n      <label v-if="isCheckboxable" class="datatable-checkbox">\n        <input type="checkbox" v-model="myAllRowsSelected" @change="onCheckboxChange" />\n      </label>\n      <slot v-bind="{ column: column }">\n        \x3c!-- Default content --\x3e\n        <span class="datatable-header-cell-wrapper">\n          <span class="datatable-header-cell-label draggable" :class="cssClass" @click="onSort" v-html="name"> </span>\n        </span>\n      </slot>\n      <div :class="sortCssClass" @click="onSort">\n        {{ sortOrder }}\n      </div>\n      <slot name="append" v-bind="{ column: column }"></slot>\n    </div>\n  '})],DataTableHeaderCellComponent),DataTableHeaderCellComponent}(r.Vue);t.default=c},"./src/components/header/header.component.ts":function(e,t,n){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},extendStatics(e,t)};return function(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},s=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},r=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=n("vue-property-decorator"),l=n("./src/directives/draggable.directive.ts"),c=n("./src/directives/long-press.directive.ts"),d=n("./src/directives/resizeable.directive.ts"),u=n("./src/types/index.ts"),p=n("./src/utils/index.ts"),h=n("./src/components/header/header-cell.component.ts"),m=function(e){function DataTableHeaderComponent(){var t=null!==e&&e.apply(this,arguments)||this;return t.columnsByPin=null,t.columnGroupWidths=null,t.myHeaderHeight="auto",t.styleByGroup={left:{},center:{},right:{}},t.targetMarkerContext=null,t.dragEvent=null,t.dragging=!1,t.positions={},t}return i(DataTableHeaderComponent,e),DataTableHeaderComponent.prototype.onChangedInnerWidth=function(){if(this.columns){var e=p.columnsByPin(this.columns);this.columnGroupWidths=p.columnGroupWidths(e,this.columns,this.innerWidth),this.setStylesByGroup()}},DataTableHeaderComponent.prototype.onHeaderHeightChanged=function(){"auto"!==this.headerHeight?this.myHeaderHeight=this.headerHeight+"px":this.myHeaderHeight=this.headerHeight},DataTableHeaderComponent.prototype.onColumnsChanged=function(){var e=p.columnsByPin(this.columns);this.columnsByPin=p.columnsByPinArr(this.columns),this.columnGroupWidths=p.columnGroupWidths(e,this.columns,this.innerWidth),this.setStylesByGroup()},DataTableHeaderComponent.prototype.onOffsetXChanged=function(){this.setStylesByGroup()},DataTableHeaderComponent.prototype.onLongPressStart=function(e){var t=e.event,n=e.model;n.dragging=!0,this.dragEvent=t},DataTableHeaderComponent.prototype.onLongPressEnd=function(e){var t=this,n=e.event,i=e.model;this.dragEvent=n,setTimeout((function(){var e=t.columns.find((function(e){return e.$$id===i.$$id}));e&&(e.dragging=!1)}),5)},Object.defineProperty(DataTableHeaderComponent.prototype,"headerWidth",{get:function(){return this.scrollbarH?this.innerWidth+"px":"100%"},enumerable:!1,configurable:!0}),DataTableHeaderComponent.prototype.isEnableDragX=function(e){return this.reorderable&&e.draggable&&e.dragging},DataTableHeaderComponent.prototype.onColumnResized=function(e,t){e<=t.minWidth?e=t.minWidth:e>=t.maxWidth&&(e=t.maxWidth),this.$emit("resize",{column:t,prevValue:t.width,newValue:e})},DataTableHeaderComponent.prototype.onHiddenChanged=function(){this.$emit("hidden-changed"),this.onChangedInnerWidth()},DataTableHeaderComponent.prototype.getColumn=function(e){var t=this.columnsByPin[0].columns.length;if(e<t)return this.columnsByPin[0].columns[e];var n=this.columnsByPin[1].columns.length;return e<t+n?this.columnsByPin[1].columns[e-t]:this.columnsByPin[2].columns[e-t-n]},DataTableHeaderComponent.prototype.onSort=function(e){var t=e.column,n=e.prevValue,i=e.newValue;if(!t.dragging){var o=this.calcNewSorts(t,n,i),s={sorts:o,column:t,prevValue:n,newValue:i};this.$emit("sort",s)}},DataTableHeaderComponent.prototype.onSelect=function(e){this.$emit("select",e)},DataTableHeaderComponent.prototype.calcNewSorts=function(e,t,n){var i=0;this.sorts||(this.sorts=[]);var s=this.sorts.map((function(t,n){return t=o({},t),t.prop===e.prop&&(i=n),t}));return n?t?s[i].dir=n:(this.sortType===u.SortType.single&&s.splice(0,this.sorts.length),s.push({dir:n,prop:e.prop})):s.splice(i,1),s},DataTableHeaderComponent.prototype.setStylesByGroup=function(){if(this.columnsByPin&&this.columnsByPin.length){var e=this.columnsByPin[0].columns.length;e&&(this.styleByGroup["left"]=this.calcStylesByGroup("left"));var t=this.columnsByPin[1].columns.length;t&&(this.styleByGroup["center"]=this.calcStylesByGroup("center"));var n=this.columnsByPin[2].columns.length;n&&(this.styleByGroup["right"]=this.calcStylesByGroup("right"))}},DataTableHeaderComponent.prototype.calcStylesByGroup=function(e){var t=this.columnGroupWidths,n=this.offsetX,i={width:t[e]+"px"};if("center"===e)p.translateXY(i,-1*n,0);else if("right"===e){var o=t.total-this.innerWidth,s=-1*o;this.scrollbarWidth&&(s-=this.scrollbarWidth),p.translateXY(i,s,0)}return i},DataTableHeaderComponent.prototype.styleForGroup=function(e){return this.styleByGroup[e.type]},Object.defineProperty(DataTableHeaderComponent.prototype,"styleObject",{get:function(){return{width:this.headerWidth?this.headerWidth:this.columnGroupWidths.total+"px",height:this.myHeaderHeight}},enumerable:!1,configurable:!0}),DataTableHeaderComponent.prototype.onHeaderCellMounted=function(e,t){this.draggables||(this.draggables=[]),this.draggables.push({dragModel:e,element:t})},DataTableHeaderComponent.prototype.onDragStart=function(){if(!this.dragging){this.dragging=!0,this.positions={};var e=0;this.draggables.sort((function(e,t){var n=parseInt(e.element.offsetLeft.toString(),10),i=parseInt(t.element.offsetLeft.toString(),10);return n-i}));for(var t=0,n=this.draggables;t<n.length;t++){var i=n[t],o=i.element,s=parseInt(o.offsetLeft.toString(),10),r=o.offsetWidth;r&&(this.positions[i.dragModel.prop]={left:s,right:s+parseInt(r.toString(),10),index:e++,element:o})}}},DataTableHeaderComponent.prototype.onDragging=function(e){e.element;var t=e.model,n=e.event,i=this.positions[t.prop],o=this.isTarget(t,n);o?this.lastDraggingIndex!==o.i&&(this.onTargetChanged({prevIndex:this.lastDraggingIndex,newIndex:o.i,initialIndex:i.index}),this.lastDraggingIndex=o.i):this.lastDraggingIndex!==i.index&&(this.onTargetChanged({prevIndex:this.lastDraggingIndex,initialIndex:i.index}),this.lastDraggingIndex=i.index)},DataTableHeaderComponent.prototype.onDragEnd=function(e){var t=e.element,n=e.model,i=e.event;this.dragging=!1;var o=this.columns.findIndex((function(e){return e.prop===n.prop})),s=this.isTarget(n,i);this.positions={},s&&this.onColumnReordered({prevIndex:o,newIndex:this.columns.findIndex((function(e){return e.prop===s.prop})),model:n}),this.lastDraggingIndex=void 0,t.style.left="auto"},DataTableHeaderComponent.prototype.onColumnReordered=function(e){var t=e.prevIndex,n=e.newIndex,i=e.model,o=this.getColumn(n);o.isTarget=!1,o.targetMarkerContext=null,this.$emit("reorder",{column:i,prevValue:t,newValue:n})},DataTableHeaderComponent.prototype.onTargetChanged=function(e){var t=e.prevIndex,n=e.newIndex,i=e.initialIndex;if(t||0===t){var o=this.getColumn(t);o.isTarget=!1,o.targetMarkerContext=null}if(n||0===n){var s=this.getColumn(n);s.isTarget=!0,i!==n&&(s.targetMarkerContext={class:"targetMarker ".concat(i>n?"dragFromRight":"dragFromLeft")})}},DataTableHeaderComponent.prototype.isTarget=function(e,t){var n=0,i=t.x||t.clientX,o=t.y||t.clientY,s=document.elementsFromPoint(i,o),_loop_1=function(t){var i=r.positions[t];if(e.prop!==t&&s.find((function(e){return e===i.element})))return{value:{prop:t,pos:i,i:n}};n++},r=this;for(var a in this.positions){var l=_loop_1(a);if("object"===typeof l)return l.value}},s([a.Prop(),r("design:type",String)],DataTableHeaderComponent.prototype,"sortAscendingIcon",void 0),s([a.Prop(),r("design:type",String)],DataTableHeaderComponent.prototype,"sortDescendingIcon",void 0),s([a.Prop(),r("design:type",Number)],DataTableHeaderComponent.prototype,"scrollbarWidth",void 0),s([a.Prop(),r("design:type",Boolean)],DataTableHeaderComponent.prototype,"scrollbarH",void 0),s([a.Prop(),r("design:type",Boolean)],DataTableHeaderComponent.prototype,"dealsWithGroup",void 0),s([a.Prop(),r("design:type",Number)],DataTableHeaderComponent.prototype,"innerWidth",void 0),s([a.Prop(),r("design:type",Array)],DataTableHeaderComponent.prototype,"sorts",void 0),s([a.Prop(),r("design:type",String)],DataTableHeaderComponent.prototype,"sortType",void 0),s([a.Prop(),r("design:type",Boolean)],DataTableHeaderComponent.prototype,"allRowsSelected",void 0),s([a.Prop(),r("design:type",String)],DataTableHeaderComponent.prototype,"selectionType",void 0),s([a.Prop(),r("design:type",Boolean)],DataTableHeaderComponent.prototype,"reorderable",void 0),s([a.Prop(),r("design:type",Object)],DataTableHeaderComponent.prototype,"headerHeight",void 0),s([a.Prop(),r("design:type",Array)],DataTableHeaderComponent.prototype,"columns",void 0),s([a.Prop(),r("design:type",Number)],DataTableHeaderComponent.prototype,"offsetX",void 0),s([a.Watch("innerWidth",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableHeaderComponent.prototype,"onChangedInnerWidth",null),s([a.Watch("headerHeight",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableHeaderComponent.prototype,"onHeaderHeightChanged",null),s([a.Watch("columns",{immediate:!0}),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableHeaderComponent.prototype,"onColumnsChanged",null),s([a.Watch("offsetX"),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],DataTableHeaderComponent.prototype,"onOffsetXChanged",null),DataTableHeaderComponent=s([a.Component({components:{"datatable-header-cell":h.default},directives:{resizeable:d.default,"long-press":c.default,dragndrop:l.default},template:'\n    <div :style="styleObject" class="datatable-header-inner">\n      <div\n        v-for="colGroup of columnsByPin"\n        :key="colGroup.type"\n        :class="[\'datatable-row-\' + colGroup.type]"\n        :style="styleByGroup[colGroup.type]"\n      >\n        <datatable-header-cell\n          v-for="column of colGroup.columns"\n          :key="column.$$id"\n          v-resizeable="{ resizeEnabled: column.resizeable }"\n          v-long-press="{pressModel: column, pressEnabled: reorderable && column.draggable}"\n          v-dragndrop="{dragEvent:dragEvent,dragModel:column,dragX:isEnableDragX(column),dragY:false}"\n          @resize="onColumnResized($event, column)"\n          @longPressStart="onLongPressStart($event, column)"\n          @longPressEnd="onLongPressEnd($event, column)"\n          :headerHeight="headerHeight"\n          :isTarget="column.isTarget"\n          :targetMarkerContext="column.targetMarkerContext"\n          :column="column"\n          :sortType="sortType"\n          :sorts="sorts"\n          :selectionType="selectionType"\n          :sortAscendingIcon="sortAscendingIcon"\n          :sortDescendingIcon="sortDescendingIcon"\n          :allRowsSelected="allRowsSelected"\n          @sort="onSort($event)"\n          @select="onSelect"\n          @columnContextmenu="$emit(\'columnContextmenu\', $event)"\n          @header-cell-mounted="onHeaderCellMounted(column, $event)"\n          @dragStart="onDragStart"\n          @dragEnd="onDragEnd"\n          @dragging="onDragging"\n          @hidden-changed="onHiddenChanged($event)"\n        >\n        </datatable-header-cell>\n      </div>\n    </div>\n  '})],DataTableHeaderComponent),DataTableHeaderComponent}(a.Vue);t.default=m},"./src/directives/draggable.directive.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("vue-property-decorator"),o=0,s=function(){function DraggableController(e,t,n,i,o,s){this.id=0,this.vnode=null,this.element=null,this.handleUp=null,this.handleDown=null,this.handleMove=null,this.dragX=!0,this.dragY=!0,this._dragEvent=null,this.isDragging=!1,this.id=e,this.vnode=t,this.element=n,this.dragModel=i,this.dragX=o,this.dragY=s,this.handleUp=this.onMouseUp.bind(this),this.handleMove=this.onMouseMove.bind(this)}return DraggableController.prototype.unsubscribe=function(){document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)},Object.defineProperty(DraggableController.prototype,"dragEvent",{get:function(){return this._dragEvent},set:function(e){this._dragEvent=e,e&&this.onMouseDown(e)},enumerable:!1,configurable:!0}),DraggableController.prototype.onMouseDown=function(e){var t=e.target.classList.contains("draggable");t&&(this.dragX||this.dragY)&&(e.preventDefault(),this.isDragging=!0,this.mouseDownPos={x:e.clientX,y:e.clientY},document.addEventListener("mouseup",this.handleUp),document.addEventListener("mousemove",this.handleMove),this.emit("dragStart",{event:e,element:this.element,model:this.dragModel}))},DraggableController.prototype.onMouseUp=function(e){document.removeEventListener("mousemove",this.handleMove),this.isDragging&&(this.isDragging=!1,this.element.classList.remove("dragging"),this.unsubscribe(),this.emit("dragEnd",{event:e,element:this.element,model:this.dragModel}))},DraggableController.prototype.onMouseMove=function(e){if(this.isDragging){var t=e.clientX-this.mouseDownPos.x,n=e.clientY-this.mouseDownPos.y;this.dragX&&(this.element.style.left=t+"px"),this.dragY&&(this.element.style.top=n+"px"),this.element.classList.add("dragging"),this.emit("dragging",{event:e,element:this.element,model:this.dragModel})}},DraggableController.prototype.emit=function(e,t){var n=this.vnode.data&&this.vnode.data.on||this.vnode.componentOptions&&this.vnode.componentOptions.listeners;n&&n[e]&&n[e].fns(t)},DraggableController}();t.default=i.Vue.directive("draggable",{bind:function(e,t,n){var i=new s(o++,n,e,t.value.dragModel,t.value.dragX,t.value.dragY);e.__draggable__=i},update:function(e,t,n){var i=e.__draggable__;i&&(i.dragX=t.value.dragX,i.dragEvent=t.value.dragEvent)},unbind:function(e){var t=e.__draggable__;t.unsubscribe()}})},"./src/directives/long-press.directive.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("vue-property-decorator"),o=0,s=function(){function LongPressController(e,t,n){this.id=0,this.pressEnabled=!0,this.duration=200,this.mouseX=0,this.mouseY=0,this.vnode=null,this.element=null,this.handleUp=null,this.handleDown=null,this.handleMove=null,this.id=e,this.vnode=t,this.element=n,this.handleDown=this.onMouseDown.bind(this),this.handleUp=this.onMouseUp.bind(this),this.handleMove=this.onMouseMove.bind(this),n.addEventListener("mousedown",this.handleDown)}return LongPressController.prototype.unsubscribe=function(){document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)},Object.defineProperty(LongPressController.prototype,"pressing",{get:function(){return this._pressing},set:function(e){this._pressing=e,e?this.element.classList.add("press"):this.element.classList.remove("press")},enumerable:!1,configurable:!0}),Object.defineProperty(LongPressController.prototype,"isLongPressing",{get:function(){return this._isLongPressing},set:function(e){this._isLongPressing=e,e?this.element.classList.add("longpress"):this.element.classList.remove("longpress")},enumerable:!1,configurable:!0}),LongPressController.prototype.onMouseDown=function(e){var t=this;if(1===e.which&&this.pressEnabled){var n=e.target;n.classList.contains("resize-handle")||(this.mouseX=e.clientX,this.mouseY=e.clientY,this.pressing=!0,this.isLongPressing=!1,document.addEventListener("mouseup",this.handleUp),this.timeout=setTimeout((function(){t.isLongPressing=!0,t.emit("longPressStart",{event:e,model:t.pressModel}),document.addEventListener("mousemove",t.handleMove),t.loop(e)}),this.duration),this.loop(e))}},LongPressController.prototype.onMouseUp=function(){document.removeEventListener("mousemove",this.handleMove),this.endPress()},LongPressController.prototype.onMouseMove=function(e){if(this.pressing&&!this.isLongPressing){var t=Math.abs(e.clientX-this.mouseX)>10,n=Math.abs(e.clientY-this.mouseY)>10;(t||n)&&this.endPress()}},LongPressController.prototype.loop=function(e){var t=this;this.isLongPressing&&(this.timeout=setTimeout((function(){t.emit("longPressing",{event:e,model:t.pressModel}),t.loop(e)}),50))},LongPressController.prototype.endPress=function(){clearTimeout(this.timeout),this.isLongPressing&&(this.unsubscribe(),this.isLongPressing=!1,this.pressing=!1,this.emit("longPressEnd",{model:this.pressModel}))},LongPressController.prototype.emit=function(e,t){var n=this.vnode.data&&this.vnode.data.on||this.vnode.componentOptions&&this.vnode.componentOptions.listeners;n&&n[e]&&n[e].fns(t)},LongPressController}();t.default=i.Vue.directive("long-press",{bind:function(e,t,n){var i=new s(o++,n,e),r=t.value;void 0!==r.pressEnabled&&null!==r.pressEnabled&&(i.pressEnabled=r.pressEnabled),void 0!==r.duration&&null!==r.duration&&(i.duration=r.duration),i.pressModel=r.pressModel,e.__longpress__=i},unbind:function(e){var t=e.__longpress__;t.element.removeEventListener("mousedown",t.handleDown),t.unsubscribe()}})},"./src/directives/resizeable.directive.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("vue-property-decorator"),o=0,s=function(){function ResizeableDirectiveController(e,t,n){this.resizeEnabled=!0,this.minWidth=0,this.maxWidth=0,this.resizing=!1,this.element=null,this.handleUp=null,this.handleDown=null,this.handleMove=null,this.vnode=null,this.id=0,this.id=e,this.vnode=t,this.element=n,this.handleDown=this.onMouseDown.bind(this),this.handleUp=this.onMouseUp.bind(this)}return ResizeableDirectiveController.prototype.onMouseUp=function(){document.removeEventListener("mousemove",this.handleMove),this.resizing&&(this.resizing=!1,this.emit(this.vnode,"resize",this.element.clientWidth))},ResizeableDirectiveController.prototype.onMouseDown=function(e){var t=this,n=e.target.classList.contains("resize-handle"),i=this.element.clientWidth,o=e.screenX;n&&(e.stopPropagation(),this.resizing=!0,this.handleMove=function(e){return t.move(e,i,o)},document.addEventListener("mousemove",this.handleMove))},ResizeableDirectiveController.prototype.move=function(e,t,n){if(this.resizing){var i=e.screenX-n,o=t+i,s=!this.minWidth||o>=this.minWidth,r=!this.maxWidth||o<=this.maxWidth;s&&r&&(this.element.style.width=o+"px")}},ResizeableDirectiveController.prototype.emit=function(e,t,n){var i=e.data&&e.data.on||e.componentOptions&&e.componentOptions.listeners;i&&i[t]&&i[t].fns(n)},ResizeableDirectiveController}();t.default=i.Vue.directive("resizeable",{resizing:!1,bind:function(e,t,n){var i=new s(o++,n,e),r=t.value;void 0!==r.resizeEnabled&&null!==r.resizeEnabled&&(i.resizeEnabled=r.resizeEnabled),i.minWidth=r.minWidth,i.maxWidth=r.maxWidth,e.__resizeable__=i,document.addEventListener("mouseup",i.handleUp),e.addEventListener("mousedown",i.handleDown)},unbind:function(e){var t=e.__resizeable__;document.removeEventListener("mouseup",t.handleUp),e.removeEventListener("mousedown",t.handleDown)},inserted:function(e){var t=document.createElement("span"),n=e.__resizeable__;n.resizeEnabled?t.classList.add("resize-handle"):t.classList.add("resize-handle--not-resizable"),e.appendChild(t)}})},"./src/directives/visibility.directive.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("vue-property-decorator"),o=function(){function VisibilityController(e,t){this._isVisible=!1,this.vnode=null,this.element=null,this.vnode=e,this.element=t}return Object.defineProperty(VisibilityController.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){this._isVisible=e,e?this.element.classList.add("visible"):this.element.classList.remove("visible")},enumerable:!1,configurable:!0}),VisibilityController.prototype.stopCheck=function(){clearTimeout(this.timeout)},VisibilityController.prototype.onVisibilityChange=function(e){this.isVisible!==e&&(this.isVisible=e,this.emit("visible",e))},VisibilityController.prototype.runCheck=function(e){var t=this,check=function(){clearTimeout(t.timeout);var n=t.element,i=n.offsetHeight,o=n.offsetWidth;i&&o?t.onVisibilityChange(!0):t.onVisibilityChange(!1),t.timeout=setTimeout((function(){return check()}),e)};this.timeout=setTimeout((function(){return check()}))},VisibilityController.prototype.emit=function(e,t){var n=this.vnode.data&&this.vnode.data.on||this.vnode.componentOptions&&this.vnode.componentOptions.listeners;n&&n[e]&&n[e].fns(t)},VisibilityController}();t.default=i.Vue.directive("visibility-observer",{resizing:!1,bind:function(e,t,n){var i,s,r,a=new o(n,e);e.__visibility__=a,(null===(i=null===t||void 0===t?void 0:t.value)||void 0===i?void 0:i.on)&&a.runCheck(null!==(r=null===(s=null===t||void 0===t?void 0:t.value)||void 0===s?void 0:s.timeout)&&void 0!==r?r:1e3)},unbind:function(e){var t=e.__visibility__;t.stopCheck()}})},"./src/services/dimensions-helper.service.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DimensionsHelper=void 0;var i=function(){function DimensionsHelper(){}return DimensionsHelper.prototype.getDimensions=function(e){return e.getBoundingClientRect()},DimensionsHelper}();t.DimensionsHelper=i},"./src/services/scrollbar-helper.service.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollbarHelper=void 0;var i=function(){function ScrollbarHelper(){this.document=window.document,this.width=this.getWidth()}return ScrollbarHelper.prototype.getWidth=function(){var e=this.document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style["msOverflowStyle"]="scrollbar",this.document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var n=this.document.createElement("div");n.style.width="100%",e.appendChild(n);var i=n.offsetWidth;return e.parentNode.removeChild(e),t-i},ScrollbarHelper}();t.ScrollbarHelper=i},"./src/types/check.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckMode=void 0,function(e){e["checkIsSelect"]="checkIsSelect",e["checkNoSelect"]="checkNoSelect"}(t.CheckMode||(t.CheckMode={}))},"./src/types/click.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClickType=void 0,function(e){e["single"]="single",e["double"]="double"}(t.ClickType||(t.ClickType={}))},"./src/types/column-mode.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnMode=void 0,function(e){e["standard"]="standard",e["flex"]="flex",e["force"]="force"}(t.ColumnMode||(t.ColumnMode={}))},"./src/types/contextmenu.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextmenuType=void 0,function(e){e["header"]="header",e["body"]="body"}(t.ContextmenuType||(t.ContextmenuType={}))},"./src/types/index.ts":function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("./src/types/column-mode.type.ts"),t),o(n("./src/types/sort.type.ts"),t),o(n("./src/types/sort-direction.type.ts"),t),o(n("./src/types/selection.type.ts"),t),o(n("./src/types/click.type.ts"),t),o(n("./src/types/table-column.type.ts"),t),o(n("./src/types/sort-prop-dir.type.ts"),t),o(n("./src/types/contextmenu.type.ts"),t)},"./src/types/selection.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionType=void 0,function(e){e["single"]="single",e["singleFocus"]="singleFocus",e["multi"]="multi",e["multiClick"]="multiClick",e["cell"]="cell",e["checkbox"]="checkbox"}(t.SelectionType||(t.SelectionType={}))},"./src/types/sort-direction.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortDirection=void 0,function(e){e["asc"]="asc",e["desc"]="desc"}(t.SortDirection||(t.SortDirection={}))},"./src/types/sort-prop-dir.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./src/types/sort.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortType=void 0,function(e){e["single"]="single",e["multi"]="multi"}(t.SortType||(t.SortType={}))},"./src/types/table-column.type.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./src/utils/camel-case.ts":function(e,t,n){"use strict";function camelCase(e){return e=e.replace(/[^a-zA-Z0-9 ]/g," "),e=e.replace(/([a-z](?=[A-Z]))/g,"$1 "),e=e.replace(/([^a-zA-Z0-9 ])|^[0-9]+/g,"").trim().toLowerCase(),e=e.replace(/([\d ]+)([A-Za-z])/g,(function(e,t,n){return t.trim()+n.toUpperCase()})),e}function deCamelCase(e){return e.replace(/([A-Z])/g,(function(e){return" "+e})).replace(/^./,(function(e){return e.toUpperCase()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.deCamelCase=t.camelCase=void 0,t.camelCase=camelCase,t.deCamelCase=deCamelCase},"./src/utils/column-helper.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=t.setColumnDefaults=t.setColumnsDefaults=void 0;var i=n("./src/utils/camel-case.ts"),o=n("./src/utils/column-prop-getters.ts"),s=n("./src/utils/id.ts");function setColumnsDefaults(e,t){if(e)for(var n=!1,i=0,o=e;i<o.length;i++){var s=o[i];setColumnDefaults(s,t),"isTreeColumn"in s&&s.isTreeColumn&&!n?(t.$set(s,"isTreeColumn",!0),n=!0):t.$set(s,"isTreeColumn",!1)}}function setColumnDefaults(e,t){e&&(e.$$id||(e.$$id=s.id()),isNullOrUndefined(e.prop)&&e.name&&(e.prop=i.camelCase(e.name)),t.$set(e,"$$valueGetter",o.getterForProp(e.prop)),!isNullOrUndefined(e.prop)&&isNullOrUndefined(e.name)&&(e.name=i.deCamelCase(String(e.prop))),isNullOrUndefined(e.prop)&&isNullOrUndefined(e.name)&&(e.name=""),"resizeable"in e||t.$set(e,"resizeable",!0),"sortable"in e||t.$set(e,"sortable",!0),"draggable"in e||t.$set(e,"draggable",!0),"visible"in e||t.$set(e,"visible",!0),"canAutoResize"in e&&!isNullOrUndefined(e.canAutoResize)||(e.canAutoResize=!0),"width"in e&&e.width?t.$set(e,"width",e.width):t.$set(e,"width",150),t.$set(e,"isTreeColumn",e.isTreeColumn),t.$set(e,"isTarget",!isNullOrUndefined(e.isTarget)&&e.isTarget))}function isNullOrUndefined(e){return null===e||void 0===e}t.setColumnsDefaults=setColumnsDefaults,t.setColumnDefaults=setColumnDefaults,t.isNullOrUndefined=isNullOrUndefined},"./src/utils/column-prop-getters.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deepValueGetter=t.shallowValueGetter=t.numericIndexGetter=t.getterForProp=t.emptyStringGetter=void 0;var i=n("./src/utils/column-helper.ts");function emptyStringGetter(){return""}function getterForProp(e){return i.isNullOrUndefined(e)?emptyStringGetter:"number"===typeof e?numericIndexGetter:-1!==e.indexOf(".")?deepValueGetter:shallowValueGetter}function numericIndexGetter(e,t){if(null===e)return"";if(!e||null===t)return e;var n=e[t];return null===n?"":n}function shallowValueGetter(e,t){if(null===e)return"";if(!e||!t)return e;var n=e[t];return null===n?"":n}function deepValueGetter(e,t){if(null===e)return"";if(!e||!t)return e;var n=e[t];if(void 0!==n)return n;n=e;var i=t.split(".");if(i.length)for(var o=0;o<i.length;o++)if(n=n[i[o]],void 0===n||null===n)return"";return n}t.emptyStringGetter=emptyStringGetter,t.getterForProp=getterForProp,t.numericIndexGetter=numericIndexGetter,t.shallowValueGetter=shallowValueGetter,t.deepValueGetter=deepValueGetter},"./src/utils/column.ts":function(e,t,n){"use strict";function columnsByPin(e){var t={left:[],center:[],right:[]};if(e)for(var n=0,i=e;n<i.length;n++){var o=i[n];o.frozenLeft?t.left.push(o):o.frozenRight?t.right.push(o):t.center.push(o)}return t}function columnGroupWidths(e,t,n){var i={left:columnTotalWidth(e.left),center:columnTotalWidth(e.center),right:columnTotalWidth(e.right),total:Math.floor(columnTotalWidth(t))};return n>i.total&&(i.center+=n-i.total,i.total=n),i}function columnTotalWidth(e){var t=0;if(e)for(var n=0,i=e;n<i.length;n++){var o=i[n];if(!o.hidden){var s=o.hidden?0:o.width;"string"===typeof s&&(s=parseFloat(s)),t+=s}}return t}function columnsTotalWidth(e){for(var t=0,n=0,i=e;n<i.length;n++){var o=i[n];t+=o.width}return t}function columnsByPinArr(e){var t=[],n=columnsByPin(e);return t.push({type:"left",columns:n["left"]}),t.push({type:"center",columns:n["center"]}),t.push({type:"right",columns:n["right"]}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.columnsByPinArr=t.columnsTotalWidth=t.columnTotalWidth=t.columnGroupWidths=t.columnsByPin=void 0,t.columnsByPin=columnsByPin,t.columnGroupWidths=columnGroupWidths,t.columnTotalWidth=columnTotalWidth,t.columnsTotalWidth=columnsTotalWidth,t.columnsByPinArr=columnsByPinArr},"./src/utils/elm-from-point.ts":function(e,t,n){"use strict";function elementsFromPoint(e,t){var n,i,o,s=[],r=[];while((n=document.elementFromPoint(e,t))&&n&&-1===s.indexOf(n))s.push(n),r.push({value:n.style.getPropertyValue("pointer-events"),priority:n.style.getPropertyPriority("pointer-events")}),n.style.setProperty("pointer-events","none","important");for(i=r.length;o=r[--i];)s[i].style.setProperty("pointer-events",(null===o||void 0===o?void 0:o.value)?o.value:"",null===o||void 0===o?void 0:o.priority);return s}Object.defineProperty(t,"__esModule",{value:!0}),t.elementsFromPoint=void 0,"undefined"===typeof document||document.elementsFromPoint||(document.elementsFromPoint=elementsFromPoint),t.elementsFromPoint=elementsFromPoint},"./src/utils/equal.array.ts":function(e,t,n){"use strict";function isArrayEqual(e,t){if(!e||!t||!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!isArrayEqual(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayEqual=void 0,t.isArrayEqual=isArrayEqual},"./src/utils/id.ts":function(e,t,n){"use strict";function id(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}Object.defineProperty(t,"__esModule",{value:!0}),t.id=void 0,t.id=id},"./src/utils/index.ts":function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n("./src/utils/id.ts"),t),o(n("./src/utils/column.ts"),t),o(n("./src/utils/column-prop-getters.ts"),t),o(n("./src/utils/camel-case.ts"),t),o(n("./src/utils/keys.ts"),t),o(n("./src/utils/math.ts"),t),o(n("./src/utils/prefixes.ts"),t),o(n("./src/utils/selection.ts"),t),o(n("./src/utils/translate.ts"),t),o(n("./src/utils/throttle.ts"),t),o(n("./src/utils/sort.ts"),t),o(n("./src/utils/row-height-cache.ts"),t),o(n("./src/utils/column-helper.ts"),t),o(n("./src/utils/elm-from-point.ts"),t),o(n("./src/utils/tree.ts"),t)},"./src/utils/keys.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Keys=void 0,function(e){e[e["up"]=38]="up",e[e["down"]=40]="down",e[e["return"]=13]="return",e[e["escape"]=27]="escape",e[e["left"]=37]="left",e[e["right"]=39]="right",e[e["pageUp"]=33]="pageUp",e[e["pageDown"]=34]="pageDown"}(t.Keys||(t.Keys={}))},"./src/utils/math.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forceFillColumnWidths=t.adjustColumnWidths=void 0;var i=n("./src/utils/column.ts");function getTotalFlexGrow(e){for(var t=0,n=0,i=e;n<i.length;n++){var o=i[n];t+=o.flexGrow||0}return t}function adjustColumnWidths(e,t){void 0===e&&(e=[]);var n=[];e.forEach((function(e){e.hidden=!1;var t=calcRealWidth(e);null!==t&&t<10&&(n.push(e),e.hidden=!0,e.$$oldWidth||(e.$$oldWidth=e.width),e.width=0)})),e=e.filter((function(e){return e.visible&&!e.hidden}));var o=i.columnsTotalWidth(e),s=getTotalFlexGrow(e),r=i.columnsByPin(e);o!==t&&scaleColumns(r,t,s)}function scaleColumns(e,t,n){var i;for(var o in e)for(var s=0,r=e[o];s<r.length;s++)i=r[s],i.canAutoResize?i.width=0:(t-=i.width,n-=i.flexGrow?i.flexGrow:0);var a={},l=t;do{var c=l/n;for(var o in l=0,e)for(var d=0,u=e[o];d<u.length;d++)if(i=u[d],i.canAutoResize&&!a[i.prop]){var p=i.width+i.flexGrow*c;i.minWidth&&p<i.minWidth?(l+=p-i.minWidth,i.width=i.minWidth,a[i.prop]=!0):i.width=p}}while(0!==l)}function calcRealWidth(e){if(!e.element)return null;var t=e.element.offsetWidth;if(null!==e.realWidth||void 0!==e.realWidth)return Math.max(t,e.realWidth);if(!t||t<0)return t;t=0;for(var n=0;n<e.element.children.length;n++){var i=e.element.children[n];t=Math.max(t,i.offsetWidth)}return t}function forceFillColumnWidths(e,t,n,i,o){void 0===o&&(o=300);var s=[];e.forEach((function(e){e.hidden=!1;var t=calcRealWidth(e);null!==t&&t<10&&(s.push(e),e.hidden=!0,e.$$oldWidth||(e.$$oldWidth=e.width),e.width=0)})),e=e.filter((function(e){return e.visible&&!e.hidden}));for(var r=e.slice(n+1,e.length).filter((function(e){return!1!==e.canAutoResize})),a=t/r.length,l=0,c=r;l<c.length;l++){var d=c[l];d.$$oldWidth||(d.$$oldWidth=d.width),d.width=a}var u=0,p=!1,h=getContentWidth(e,o),m=t-h,f=[];do{u=m/r.length,p=h>=t;for(var g=0,y=r;g<y.length;g++){d=y[g];if(p&&i)d.width=d.$$oldWidth||d.width||o;else{var v=(d.width||o)+u;d.minWidth&&v<d.minWidth?(d.width=d.minWidth,f.push(d)):d.maxWidth&&v>d.maxWidth?(d.width=d.maxWidth,f.push(d)):d.width=v}d.width=Math.max(0,d.width)}h=getContentWidth(e),m=t-h,removeProcessedColumns(r,f)}while(m>0&&0!==r.length)}function removeProcessedColumns(e,t){for(var n=0,i=t;n<i.length;n++){var o=i[n],s=e.indexOf(o);e.splice(s,1)}}function getContentWidth(e,t){void 0===t&&(t=300);for(var n=0,i=0,o=e;i<o.length;i++){var s=o[i];n+=s.width||t}return n}t.adjustColumnWidths=adjustColumnWidths,t.forceFillColumnWidths=forceFillColumnWidths},"./src/utils/prefixes.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVendorPrefixedName=void 0;var i=n("./src/utils/camel-case.ts"),o={},s="undefined"!==typeof document?document.createElement("div").style:void 0,r=function(){var e="undefined"!==typeof window?window.getComputedStyle(document.documentElement,""):void 0,t=null;e&&(t=Object.keys(e).join("").match(/-(moz|webkit|ms)-/));var n=null!==t?t[1]:void 0,i="undefined"!==typeof n?new RegExp("("+n+")","i").exec("WebKit|Moz|MS|O")[1]:void 0;return i?{dom:i,lowercase:n,css:"-"+n+"-",js:n[0].toUpperCase()+n.substr(1)}:void 0}();function getVendorPrefixedName(e){var t=i.camelCase(e);return o[t]||(void 0!==r&&void 0!==s[r.css+e]?o[t]=r.css+e:void 0!==s[e]&&(o[t]=e)),o[t]}t.getVendorPrefixedName=getVendorPrefixedName},"./src/utils/row-height-cache.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowHeightCache=void 0;var i=function(){function RowHeightCache(){this.heights=[]}return RowHeightCache.prototype.clearCache=function(){this.heights=[]},RowHeightCache.prototype.initCache=function(e){var t=e.rows,n=e.rowHeight,i=e.rowDetailHeight,o=e.groupRowHeight,s=e.externalVirtual,r=e.rowCount,a=e.rowIndexes,l=e.rowExpansions;if("function"!==typeof n&&isNaN(n))throw new Error("Row Height cache initialization failed. Please ensure that 'rowHeight' is a\n        valid number or function value: ("+n+") when 'scrollbarV' is enabled.");if("function"!==typeof i&&isNaN(i))throw new Error("Row Height cache initialization failed. Please ensure that 'rowDetailHeight' is a\n        valid number or function value: ("+i+") when 'scrollbarV' is enabled.");var c=s?r:t.length;this.heights=new Array(c);for(var d=0;d<c;++d)this.heights[d]=null;var u=0;for(d=0;d<c;++d){var p=t[d],h=void 0;h=p&&p.__isGroup?"function"===typeof o?o(p):o:"function"===typeof n?n(p):n;var m=l.get(p);if(p&&m)if("function"===typeof i){var f=a.get(p);h+=i(p,f)}else h+=i;u+=h,this.heights[d]={accumulator:u,height:h}}},RowHeightCache.prototype.getRowIndex=function(e){if(0===e)return 0;var t=this.calcRowIndex(e);return t},RowHeightCache.prototype.update=function(e,t){if(this.heights&&this.heights.length){var n=this.heights.length;while(e<n)this.heights[e].accumulator+=t,e++}},RowHeightCache.prototype.query=function(e){var t;return e<0?0:null===(t=this.heights[e])||void 0===t?void 0:t.accumulator},RowHeightCache.prototype.queryWithHeight=function(e){if(e<0)return null;var t=this.heights[e];return t?{offsetY:t.accumulator,height:t.height}:null},RowHeightCache.prototype.queryBetween=function(e,t){return this.query(t)-this.query(e-1)},RowHeightCache.prototype.calcRowIndex=function(e){if(!this.heights.length)return 0;if(this.heights[this.heights.length-1].accumulator<e)return this.heights.length;for(var t=-1,n=this.heights.length,i=0;i<n;i++)if(this.heights[i].accumulator>=e){t=i;break}return t},RowHeightCache}();t.RowHeightCache=i},"./src/utils/selection.ts":function(e,t,n){"use strict";function selectRows(e,t,n){var i=n(t,e);return i>-1?e.splice(i,1):e.push(t),e}function selectRowsBetween(e,t,n,i,o){for(var s=n<i,r=0;r<t.length;r++){var a=t[r],l=r>=i&&r<=n,c=r<=i&&r>=n,d={start:0,end:0};d=s?{start:n,end:i}:{start:i,end:n+1},(s&&c||!s&&l)&&r>=d.start&&r<=d.end&&e.push(a)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.selectRowsBetween=t.selectRows=void 0,t.selectRows=selectRows,t.selectRowsBetween=selectRowsBetween},"./src/utils/sort.ts":function(e,t,n){"use strict";var i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var s=arguments[t],r=0,a=s.length;r<a;r++,o++)i[o]=s[r];return i};Object.defineProperty(t,"__esModule",{value:!0}),t.sortRows=t.orderByComparator=t.nextSortDir=void 0;var o=n("./src/types/index.ts"),s=n("./src/utils/column-prop-getters.ts");function nextSortDir(e,t){return e===o.SortType.single?t===o.SortDirection.asc?o.SortDirection.desc:o.SortDirection.asc:t?t===o.SortDirection.asc?o.SortDirection.desc:void o.SortDirection.desc:o.SortDirection.asc}function orderByComparator(e,t){if(null!==e&&"undefined"!==typeof e||(e=0),null!==t&&"undefined"!==typeof t||(t=0),e instanceof Date&&t instanceof Date){if(e<t)return-1;if(e>t)return 1}else if(isNaN(parseFloat(e))||!isFinite(e)||isNaN(parseFloat(t))||!isFinite(t)){if(e=String(e),t=String(t),e.toLowerCase()<t.toLowerCase())return-1;if(e.toLowerCase()>t.toLowerCase())return 1}else{if(parseFloat(e)<parseFloat(t))return-1;if(parseFloat(e)>parseFloat(t))return 1}return 0}function sortRows(e,t,n){if(!e)return[];if(!n||!n.length)return i(e);var r=new Map;e.forEach((function(e,t){return r.set(e,t)}));var a=i(e),l={};Array.isArray(t)&&t.forEach((function(e){e.comparator&&"function"===typeof e.comparator&&(l[e.prop]=e.comparator)}));var c=n.map((function(e){var t=e.prop;return{prop:t,dir:e.dir,valueGetter:s.getterForProp(t),compareFn:l[t]||orderByComparator}}));return a.sort((function(e,t){for(var n=0,i=c;n<i.length;n++){var s=i[n],a=s.prop,l=s.valueGetter,d=l(e,a),u=l(t,a),p=s.dir!==o.SortDirection.desc?s.compareFn(d,u,e,t,s.dir):-s.compareFn(d,u,e,t,s.dir);if(0!==p)return p}return r.has(e)&&r.has(t)?r.get(e)<r.get(t)?-1:1:0}))}t.nextSortDir=nextSortDir,t.orderByComparator=orderByComparator,t.sortRows=sortRows},"./src/utils/throttle.ts":function(e,t,n){"use strict";function throttle(e,t,n){var i,o,s;n=n||{};var r=null,a=0;function later(){a=!1===n.leading?0:Number(new Date),r=null,s=e.apply(i,o)}return function(){var l=Number(new Date);a||!1!==n.leading||(a=l);var c=t-(l-a);return i=this,o=arguments,c<=0?(clearTimeout(r),r=null,a=l,s=e.apply(i,o)):r||!1===n.trailing||(r=setTimeout(later,c)),s}}function throttleable(e,t){return function innerDecorator(n,i,o){return{configurable:!0,enumerable:o.enumerable,get:function getter(){return Object.defineProperty(this,i,{configurable:!0,enumerable:o.enumerable,value:throttle(o.value,e,t)}),this[i]}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.throttleable=t.throttle=void 0,t.throttle=throttle,t.throttleable=throttleable},"./src/utils/translate.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateXY=void 0;var i=n("./src/utils/camel-case.ts"),o=n("./src/utils/prefixes.ts"),s="undefined"!==typeof window?o.getVendorPrefixedName("transform"):void 0,r="undefined"!==typeof window?o.getVendorPrefixedName("backfaceVisibility"):void 0,a="undefined"!==typeof window?Boolean(o.getVendorPrefixedName("transform")):void 0,l="undefined"!==typeof window?Boolean(o.getVendorPrefixedName("perspective")):void 0,c="undefined"!==typeof window?window.navigator.userAgent:"Chrome",d=/Safari\//.test(c)&&!/Chrome\//.test(c);function translateXY(e,t,n){"undefined"!==typeof s&&a?!d&&l?(e[s]="translate3d("+t+"px, "+n+"px, 0)",e[r]="hidden"):e[i.camelCase(s)]="translate("+t+"px, "+n+"px)":(e.top=n+"px",e.left=t+"px")}t.translateXY=translateXY},"./src/utils/tree.ts":function(e,t,n){"use strict";var i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var s=arguments[t],r=0,a=s.length;r<a;r++,o++)i[o]=s[r];return i};Object.defineProperty(t,"__esModule",{value:!0}),t.groupRowsByParents=t.optionalGetterForProp=void 0;var o=n("./src/utils/column-prop-getters.ts");function optionalGetterForProp(e){return e&&function(t){return o.getterForProp(e)(t,e)}}function groupRowsByParents(e,t,n,o){if(void 0===o&&(o=!1),!e)return e;if(t&&n){var r={},a=e.length,l=null;r[0]=new s;for(var c=e.reduce((function(e,t){var i=n(t);return-1===e.indexOf(i)&&e.push(i),e}),[]),d=0;d<a;d++)r[n(e[d])]=new s(e[d]);var u=[];for(d=0;d<a;d++){l=r[n(e[d])];var p=0,h=t(l.row);Boolean(h)&&c.indexOf(h)>-1&&(p=h),l.parent=r[p],null===l.parent.row["level"]||void 0===l.parent.row["level"]?u.push(l):(l.row["level"]=l.parent.row["level"]+1,l.parent.children.push(l))}var m=[];do{m.length=0;while(u.length)l=u.pop(),null===l.parent.row["level"]||void 0===l.parent.row["level"]?m.push(l):(l.row["level"]=l.parent.row["level"]+1,l.parent.children.push(l));u=i(m)}while(u.length);var f=[];return r[0].flatten((function(){f=i(f,[this.row])}),!0,o),f}return e}t.optionalGetterForProp=optionalGetterForProp,t.groupRowsByParents=groupRowsByParents;var s=function(){function TreeNode(e){void 0===e&&(e=null),e||(e={level:-1,treeStatus:"expanded"}),this.row=e,this.parent=null,this.children=[]}return TreeNode.prototype.flatten=function(e,t,n){if(void 0===n&&(n=!1),"expanded"===this.row["treeStatus"])for(var i=0,o=this.children.length;i<o;i++){var s=this.children[i];n||s.children&&s.children.length?s.children&&s.children.length&&"disabled"===s.row["treeStatus"]&&(s.row["treeStatus"]="collapsed"):s.row["treeStatus"]="disabled",e.apply(s,Array.prototype.slice.call(arguments,2)),t&&s.flatten.apply(s,arguments,n)}},TreeNode}()},"vue-property-decorator":function(t,n){t.exports=e}})}))},42069:()=>{},36599:()=>{},35358:()=>{},61822:()=>{},31127:()=>{},33074:()=>{}},t={};function __webpack_require__(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,__webpack_require__),o.loaded=!0,o.exports}__webpack_require__.m=e,(()=>{__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")}})(),(()=>{__webpack_require__.amdO={}})(),(()=>{var e=[];__webpack_require__.O=(t,n,i,o)=>{if(!n){var s=1/0;for(l=0;l<e.length;l++){for(var[n,i,o]=e[l],r=!0,a=0;a<n.length;a++)(!1&o||s>=o)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](n[a])))?n.splice(a--,1):(r=!1,o<s&&(s=o));r&&(e.splice(l--,1),t=i())}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,i,o]}})(),(()=>{__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return __webpack_require__.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;__webpack_require__.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var o=Object.create(null);__webpack_require__.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var r=2&i&&n;"object"==typeof r&&!~e.indexOf(r);r=t(r))Object.getOwnPropertyNames(r).forEach((e=>s[e]=()=>n[e]));return s["default"]=()=>n,__webpack_require__.d(o,s),o}})(),(()=>{__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[]))})(),(()=>{__webpack_require__.u=e=>"js/"+e+"."+{68:"2e292e872d9a4d0aae7d",141:"087602df880f1a3f02eb",209:"f50bdc393ebd0f9850b5",291:"379f10779d1104aa7cfe",491:"4b9ebb489d543f1e9b3a",596:"4efcff5078a0bb03963d",650:"f7382c00ff73aa483805",840:"21fd029125cfbc916697",924:"66107b1b9eb677d280be",1016:"3f8e1eadf8e5e89348c9",1190:"a03457d77311235c49c5",1411:"7487d69f899c581a337e",1431:"4008d663543c9554b62a",1501:"2c0fcc4dd5085ac5db81",1552:"87edd8bc839a1c7117b1",1588:"04e62bf008a3882c2e96",1658:"4dfeab2b74c8aadfec2d",1722:"dbaec8bbd67cd89f2b4c",1749:"90044e12464e4f2fa8ab",1834:"8ba62e49262f2cf9c962",1994:"4884965d5287c5d1fa7f",2060:"05d994d0bd7c0df77918",2075:"cabea1f4bc7f3ee21790",2083:"e59c4cd757da637c3a2b",2112:"dc52b891d0e9d646603e",2194:"2d085e3bfa4a574dffbc",2344:"eee11e4d10ded1fdfb61",2441:"b4ca973b7dac1545460c",2457:"75b967ff42bfc5a2468c",2672:"759592d72c038f8947ed",2677:"99e7b079907cdc580b4a",2759:"c7dc1a3a1a06b05a8977",2765:"02e8937e301c320c2c59",2898:"d4a086db6ac354b133f4",3037:"318772cc57d58be2406d",3050:"af918cedd5b0af28113c",3065:"c089efdfd9f8a0abc904",3126:"57743d31af83dc05b061",4620:"6dd3840c7a006cfd999a",4642:"e05bbd838b77c7790c27",4990:"4e9e6fe2d2d4c1f9de74",5066:"15b6bfc620072eb7ca85",5131:"874fb58dc98704f54431",5292:"cddd28886751cc973da7",5509:"e2027069159d58dddab7",5764:"890d3b1ddf30fd808998",5935:"1c4377662dbf8d404b4a",6026:"715ec8f248844d06adf3",6071:"3076b7e8c74836e778b4",6127:"c261001c209b4b140b78",6177:"858a0def35223f93a5b0",6308:"7f0319f1c8a3339aa67f",6323:"a335048818e5b371b2f2",6500:"5b59fa1a782d2c5a7105",6559:"b1eb9efeeefd943e0902",6801:"7dbe56a01d9210c3c325",6944:"423b40ac6d047b5f8f02",6957:"82b023520cf676ae354a",6967:"dfad8863c45c7842afa1",7190:"9ebf038ce9eae7ff5182",7380:"e939480667bb2c4eb58e",7421:"a16983d8778b98cb8c62",7455:"5285ef94187d9b0e534b",7548:"4e9728bf7b868ab2ec26",7576:"07e377e466decd7fd18d",7733:"132a229919922feb854f",7793:"b6e5a8b1b14b4a2444cf",7794:"4f0c29c28bc4218d3099",7839:"1d35ce4b934685d6753c",8008:"6268e047fa7351e0078c",8131:"9383d2aa01c4777cc98a",8181:"efe161d50b9cc5953a95",8479:"3497a0214948b346bc35",8603:"ebc256ccc08977b7b92a",8717:"b0dfb79f8699d3538f8f",8821:"96aa906df065d29fe2cc",8885:"d64b8105f370f5b67ef0",9040:"5bda3cdc6e8b795786e1",9376:"ca4f37bf155bff85f354",9461:"7785bccff2fc9e29cdc8",9539:"6a8c4a321edf86d981c0",9553:"1ef616eb71e358247f09",9663:"9c0318c5576426ba6e22",9854:"7d6e07d66e9d40500c03"}[e]+".js"})(),(()=>{__webpack_require__.miniCssF=e=>1479===e?"css/1479.5f088836dd1c2536c15a.css":"css/"+e+"."+{68:"54550dd89f550aa8f078",141:"a4e4c569ae3fcbf901cf",209:"cb42981b812115aeca9e",491:"a89e120f158228df1ba2",650:"7db2f17ba44303f35abe",840:"7380605fdcc6e2f6029e",1016:"96d12c944c7825f60bb8",1190:"31d6cfe0d16ae931b73c",1431:"31d6cfe0d16ae931b73c",1501:"bdc488570b81fc17abd8",1552:"94f4248206930e0fa19c",1658:"1f7dc0701ce2f7273d61",1722:"939665c58cbd95c20391",1749:"9cf464685cb8cd65ebd0",1834:"4d03d00085e836842b78",1994:"3b2fec72777b8e3095f0",2075:"9e3b29665ce1adbe90ca",2083:"5957575defe04bc4d6a2",2112:"14c60821c8999f6e6738",2344:"99621f5d1498d145b4ae",2441:"99a68d95e644c61a3514",2457:"5bbc8cd9177bd6db08a1",2672:"31d6cfe0d16ae931b73c",2677:"5d95a3c0b30eb6261850",2759:"e35a78747d8652067a29",2765:"7e9e20b9bbf304f9ae86",2898:"6a6dfb705f679f0f52d8",3037:"f9b2c25ffcfc977d7877",3065:"814756d042eea02a3005",3126:"f8db831a26fe8f78c5c2",4642:"6db96fdbd49c132b1b84",4990:"78d567360569e2125d85",5292:"e7e85bb94b72ef2d8ae9",5509:"b1ea3ae24f0dfad024c9",5764:"7012de601490b22e753b",5935:"4a531a611aad03259464",6026:"6b00e4e7e034c0bb6b86",6071:"9f66405612b5fdfb79d0",6127:"7380605fdcc6e2f6029e",6177:"6886babe6d3ab433857b",6308:"43676d4fd7842632b0ec",6323:"666fe823a869ab1fdaaa",6500:"c4f800e9798c68005262",6801:"42dad088f489540a6d13",6944:"6ac455d2c57ebb83b6ff",6967:"2e88819fd820c4cfe731",7190:"31d6cfe0d16ae931b73c",7380:"54bb5343e07b5c121343",7455:"bce8d18bdc4db67433f1",7548:"31d6cfe0d16ae931b73c",7576:"96f70c7d762c76b1f394",7733:"97cec4c02dc2f5bc0028",7793:"31d6cfe0d16ae931b73c",7794:"ee07d36777440028d142",7839:"6fc7a5d02f099d4a9916",8131:"2d0d4da4956e9f609096",8181:"f3d66d8cec195193aab9",8603:"98b31553536ba43aabdc",8717:"5911e1f05ac5c2fbf46c",8821:"9ceceda308416cfa7f3a",8885:"54e6fa96ec06ca1352f4",9040:"d8b1fedd61ed95d21062",9461:"d7f4247a86bba7269ab1",9539:"9be525cbb1424dc5d215",9553:"5d0d14bf76ab2873cd8b",9663:"56d6f39433fb99cd8f1d",9854:"cfaf797f68903b75c735"}[e]+".css"})(),(()=>{__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="landocs_web_ui:";__webpack_require__.l=(n,i,o,s)=>{if(e[n])e[n].push(i);else{var r,a;if(void 0!==o)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+o){r=d;break}}r||(a=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,__webpack_require__.nc&&r.setAttribute("nonce",__webpack_require__.nc),r.setAttribute("data-webpack",t+o),r.src=n),e[n]=[i];var onScriptComplete=(t,i)=>{r.onerror=r.onload=null,clearTimeout(u);var o=e[n];if(delete e[n],r.parentNode&&r.parentNode.removeChild(r),o&&o.forEach((e=>e(i))),t)return t(i)},u=setTimeout(onScriptComplete.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=onScriptComplete.bind(null,r.onerror),r.onload=onScriptComplete.bind(null,r.onload),a&&document.head.appendChild(r)}}})(),(()=>{__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{__webpack_require__.p=""})(),(()=>{var createStylesheet=(e,t,n,i)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var onLinkComplete=s=>{if(o.onerror=o.onload=null,"load"===s.type)n();else{var r=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=r,l.request=a,o.parentNode.removeChild(o),i(l)}};return o.onerror=o.onload=onLinkComplete,o.href=t,document.head.appendChild(o),o},findStylesheet=(e,t)=>{for(var n=document.getElementsByTagName("link"),i=0;i<n.length;i++){var o=n[i],s=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(s===e||s===t))return o}var r=document.getElementsByTagName("style");for(i=0;i<r.length;i++){o=r[i],s=o.getAttribute("data-href");if(s===e||s===t)return o}},loadStylesheet=e=>new Promise(((t,n)=>{var i=__webpack_require__.miniCssF(e),o=__webpack_require__.p+i;if(findStylesheet(i,o))return t();createStylesheet(e,o,t,n)})),e={179:0};__webpack_require__.f.miniCss=(t,n)=>{var i={68:1,141:1,209:1,491:1,650:1,840:1,1016:1,1190:1,1431:1,1501:1,1552:1,1658:1,1722:1,1749:1,1834:1,1994:1,2075:1,2083:1,2112:1,2344:1,2441:1,2457:1,2672:1,2677:1,2759:1,2765:1,2898:1,3037:1,3065:1,3126:1,4642:1,4990:1,5292:1,5509:1,5764:1,5935:1,6026:1,6071:1,6127:1,6177:1,6308:1,6323:1,6500:1,6801:1,6944:1,6967:1,7190:1,7380:1,7455:1,7548:1,7576:1,7733:1,7793:1,7794:1,7839:1,8131:1,8181:1,8603:1,8717:1,8821:1,8885:1,9040:1,9461:1,9539:1,9553:1,9663:1,9854:1};e[t]?n.push(e[t]):0!==e[t]&&i[t]&&n.push(e[t]=loadStylesheet(t).then((()=>{e[t]=0}),(n=>{throw delete e[t],n})))}})(),(()=>{var e={179:0};__webpack_require__.f.j=(t,n)=>{var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise(((n,o)=>i=e[t]=[n,o]));n.push(i[2]=o);var s=__webpack_require__.p+__webpack_require__.u(t),r=new Error,loadingEnded=n=>{if(__webpack_require__.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",r.name="ChunkLoadError",r.type=o,r.request=s,i[1](r)}};__webpack_require__.l(s,loadingEnded,"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var webpackJsonpCallback=(t,n)=>{var i,o,[s,r,a]=n,l=0;for(i in r)__webpack_require__.o(r,i)&&(__webpack_require__.m[i]=r[i]);if(a)var c=a(__webpack_require__);for(t&&t(n);l<s.length;l++)o=s[l],__webpack_require__.o(e,o)&&e[o]&&e[o][0](),e[s[l]]=0;return __webpack_require__.O(c)},t=this["webpackChunklandocs_web_ui"]=this["webpackChunklandocs_web_ui"]||[];t.forEach(webpackJsonpCallback.bind(null,0)),t.push=webpackJsonpCallback.bind(null,t.push.bind(t))})();var n=__webpack_require__.O(void 0,[1479],(()=>__webpack_require__(98001)));n=__webpack_require__.O(n)})();