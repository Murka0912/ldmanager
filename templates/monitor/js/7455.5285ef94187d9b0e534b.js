/*! For license information please see 7455.5285ef94187d9b0e534b.js.LICENSE.txt */
(this["webpackChunklandocs_web_ui"]=this["webpackChunklandocs_web_ui"]||[]).push([[7455],{97455:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>$});var i,render=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login"},[s("v-container",{staticClass:"py-0",attrs:{fluid:""}},[s("v-row",{staticClass:"login__body"},[s("v-col",{staticClass:"pa-0 d-flex flex-column justify-center",attrs:{cols:"12"}},[s("div",{staticClass:"client-logo"},[s("svg-icon",{staticClass:"svg-icon client-logo-wrapper",staticStyle:{width:"240px",height:"240px"},attrs:{icon:"clients_logo"}}),t._v(" "),t.logoReceived?[t.logoSrc?s("img",{attrs:{src:t.logoSrc}}):s("svg-icon",{staticClass:"svg-icon brand-logo",staticStyle:{width:"102px",height:"102px"},attrs:{icon:"empty-brand-logo"}})]:t._e()],2),t._v(" "),s("div",{staticClass:"login__error"},[s("ul",t._l(t.errors,(function(e){return s("li",{key:e,staticClass:"text-center"},[s("span",[t._v(t._s(e))])])})),0)]),t._v(" "),s("v-form",{ref:"form",class:{"mb-4":!t.isSmDesktop},attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[s("div",{staticClass:"mb-4"},[s("v-text-field",{staticClass:"sm-text",attrs:{color:"black lighten-1",id:"login-field",label:t.$gettext("Логин"),"hide-details":""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit("sql")}},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),t._v(" "),s("div",{staticClass:"mb-4"},[s("v-text-field",{staticClass:"sm-text",attrs:{id:"psw-field",color:"black lighten-1",type:t.showPsw?"text":"password",name:"input-10-1",label:t.$gettext("Пароль"),"hide-details":""},on:{"click:append":function(e){t.showPsw=!t.showPsw},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit("sql")}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),t._v(" "),s("div",{staticClass:"mb-4 login__btn"},[s("v-btn",{staticClass:"small-button black--text lighten-1 grey--border",attrs:{loading:t.tryingToLogIn,id:"sql-auth-btn",disabled:t.tryingToLogIn||!t.valid,block:"",text:"",outlined:""},on:{click:function(e){return t.onSubmit("sql")}}},[s("translate",[t._v("Войти в систему")])],1)],1),t._v(" "),t.allowLoginByCert?s("div",{staticClass:"mb-4 login__btn"},[s("v-btn",{staticClass:"small-button black--text lighten-1 grey--border",attrs:{loading:t.tryingToLogByCert,id:"cert-auth-btn",disabled:t.tryingToLogIn||!t.valid,block:"",text:"",outlined:""},on:{click:function(e){return e.preventDefault(),t.onSubmit("cert")}}},[s("translate",[t._v("Войти по сертификату")])],1)],1):t._e(),t._v(" "),s("div",{staticClass:"mb-4 login__btn"},[s("v-btn",{staticClass:"small-button black--text lighten-1 grey--border",attrs:{loading:t.tryingToLogInWindows,id:"win-auth-btn",disabled:t.tryingToLogIn||!t.valid,block:"",text:"",outlined:""},on:{click:function(e){return e.preventDefault(),t.onSubmit("win")}}},[t.isMobile?t._e():s("span",[t._v(t._s(t.$gettext("Войти с учётной записью Windows")))]),t._v(" "),t.isMobile?s("span",[t._v(t._s(t.$gettext("Учётная запись Windows")))]):t._e()])],1)]),t._v(" "),s("div",{staticClass:"d-flex flex-column align-center"},[t.isSmDesktop?s("svg-icon",{staticClass:"svg-icon",staticStyle:{width:"107px",height:"17px"},attrs:{icon:"landocs-sm"}}):s("svg-icon",{staticClass:"svg-icon",staticStyle:{width:"330px",height:"52px"},attrs:{icon:"landocs"}}),t._v(" "),s("div",{staticClass:"version",class:{"mt-1":t.isSmDesktop,"mt-4":!t.isSmDesktop}},[t._v("\n            "+t._s(t.version)+"\n          ")])],1)],1)],1)],1)],1)},o=[],n=s(4842),r=s(18220),a=s(97529),l=s(29339),__decorate=function(t,e,s,i){var o,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(n<3?o(r):n>3?o(e,s,r):o(e,s))||r);return n>3&&r&&Object.defineProperty(e,s,r),r},__metadata=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)};(function(t){t[t["SandGlass"]=0]="SandGlass",t[t["Clock"]=1]="Clock",t[t["Circle"]=2]="Circle",t[t["Css"]=3]="Css"})(i||(i={}));let c=class Loader extends l.Vue{created(){if(this.options.size||(this.options.size="big"),this.indicator)switch(this.indicator){case"circle":this.options.type=i.Circle;break;case"sand":this.options.type=i.SandGlass;break;case"clock":this.options.type=i.Clock;break;case"css":this.options.type=i.Css;break;default:this.options.type=i.SandGlass;break}}get isSandGlass(){return"sand"===this.indicator||this.options.type===i.SandGlass}get isCircle(){return"circle"===this.indicator||this.options.type===i.Circle}get isCssClass(){return"css"===this.indicator||this.options.type===i.Css}get imgClass(){return this.css}get isTransparent(){return!!this.options&&this.options.transparent}get isGlobal(){return!!this.options&&this.options.global}get styles(){return{"z-index":(0,a.K)(this.$parent.$el)+2}}get size(){var t,e;return null!==(e=null===(t=this.options)||void 0===t?void 0:t.size)&&void 0!==e?e:"big"}get color(){var t,e;return null!==(e=null===(t=this.options)||void 0===t?void 0:t.color)&&void 0!==e?e:"primary"}get isRelative(){var t,e;return null!==(e=null===(t=this.options)||void 0===t?void 0:t.relative)&&void 0!==e&&e}get cssClasses(){const t=[];return this.isTransparent||t.push("loader__white-bg"),this.isGlobal&&t.push("loading-mask-global"),this.isRelative?t.push("loader__relative"):t.push("loading-mask"),t.push(`loader__color-${this.color}`),t}};__decorate([(0,l.Prop)({type:Object,default:{size:"big"}}),__metadata("design:type",Object)],c.prototype,"options",void 0),__decorate([(0,l.Prop)({type:Boolean,default:"false"}),__metadata("design:type",Boolean)],c.prototype,"visible",void 0),__decorate([(0,l.Prop)({type:String,default:"circle",validator:t=>["sand","circle","clock","css"].includes(t)}),__metadata("design:type",String)],c.prototype,"indicator",void 0),__decorate([(0,l.Prop)({type:String,default:""}),__metadata("design:type",String)],c.prototype,"css",void 0),c=__decorate([l.Component],c);var d=s(71148),u=s(54486),p=s(51414),loginvue_type_script_lang_js_decorate=function(t,e,s,i){var o,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(n<3?o(r):n>3?o(e,s,r):o(e,s))||r);return n>3&&r&&Object.defineProperty(e,s,r),r},loginvue_type_script_lang_js_metadata=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=function(t,e,s,i){function adopt(t){return t instanceof s?t:new s((function(e){e(t)}))}return new(s||(s=Promise))((function(s,o){function fulfilled(t){try{step(i.next(t))}catch(t){o(t)}}function rejected(t){try{step(i["throw"](t))}catch(t){o(t)}}function step(t){t.done?s(t.value):adopt(t.value).then(fulfilled,rejected)}step((i=i.apply(t,e||[])).next())}))};const h="auth";let g=class LoginComponent extends l.Vue{constructor(){super(...arguments),this.manifest=null,this.logoSrc=null,this.logoReceived=!1,this.version="3.7.2.93",this.username="",this.password="",this.showPsw=!1,this.errors=[],this.valid=!1,this.tryingToLogIn=!1,this.tryingToLogInWindows=!1,this.tryingToLogByCert=!1,this.rules={required:t=>Boolean(t)||this.$gettext("Это поле обязательно"),onlyLatin:t=>!this.hasCyrillic(t)||""},this.loaderOptions={type:i.SandGlass,transparent:!0,global:!0}}created(){d.X.$emit("dialog:close:all",!0);const t=this.templatesLocation+"brand.png",e=new Image;e.onload=()=>{this.logoReceived=!0,this.logoSrc=t},e.onerror=()=>{this.logoReceived=!0},e.src=t}onSubmit(t){return __awaiter(this,void 0,void 0,(function*(){this.$refs.form.validate()&&(this.errors=[],"sql"===t?this.tryingToLogIn=!0:"win"===t?this.tryingToLogInWindows=!0:"cert"===t&&(this.tryingToLogByCert=!0),this.errors=[],yield this.logIn(t))}))}logIn(t){return __awaiter(this,void 0,void 0,(function*(){try{let e;return"sql"===t?e=yield this.authService.basicLogin(this.username,this.password):"win"===t?e=yield this.authService.winLogin():"cert"===t&&(e=yield this.authService.certLogin()),void this.onSuccessLogin(e)}catch(t){return void this.onErrorLogIn(t)}finally{"sql"===t?this.tryingToLogIn=!1:"win"===t?this.tryingToLogInWindows=!1:"cert"===t&&(this.tryingToLogByCert=!1)}}))}onReset(t){t.preventDefault(),this.username="",this.password=""}hasCyrillic(t){const e=/[а-яё№]/i;return e.test(t)}onSuccessLogin(t){this.$app.startApp(),this.setHelpAutoStart(t.isFirstStart);const e=this.$route.params;return(e.retrieveRouteName||e.retrieveRoutePath)&&"/"!==e.retrieveRoutePath?this.$router.push(e.retrieveRoutePath?{path:e.retrieveRoutePath}:{name:e.retrieveRouteName}):t.lastVisitedUrl?this.$router.push(t.lastVisitedUrl):this.$app.goHome(),t}onErrorLogIn(t){this.$app.stopApp();const e=t.response;if(e){let t=e.data.message;401===e.status||403===e.status?("Auth header not found"===t&&(t=this.$gettext("Не удалось авторизоваться. Сертификат не найден")),this.errors.push(t||this.$gettext("Не удалось авторизоваться. Попробуйте еще раз!"))):408===e.status?this.errors.push(t||this.$gettext("Не удалось авторизоваться. Время ожидания истекло. Попробуйте еще раз.")):402===e.status?this.errors.push(t||this.$gettext("Лицензионный ключ не найден или недействителен.")):"status"in e?(this.errors.push(`${this.$gettext("Не удалось авторизоваться.")} [${e.status}] ${e.statusText}`),t&&this.errors.push(t)):(this.errors.push(this.$gettext("Произошла непредвиденная ошибка")),t&&this.errors.push(t))}else this.errors.push(this.$gettext("Не удалось авторизоваться. Попробуйте еще раз!"));return!1}get hasErrors(){return Boolean(this.errors.length)}get allowLoginByCert(){return this.$config.loginByCert}get templatesLocation(){return this.$config.templatesLocation}get isSmDesktop(){return window.innerWidth<1400}};loginvue_type_script_lang_js_decorate([(0,u.t)(),loginvue_type_script_lang_js_metadata("design:type",n.e)],g.prototype,"authService",void 0),loginvue_type_script_lang_js_decorate([(0,r.Hg)("fetchCommonManifest"),loginvue_type_script_lang_js_metadata("design:type",Object)],g.prototype,"fetchCommonManifest",void 0),loginvue_type_script_lang_js_decorate([(0,p.aD)("isAuthenticated",{namespace:h}),loginvue_type_script_lang_js_metadata("design:type",Boolean)],g.prototype,"isAuthenticated",void 0),loginvue_type_script_lang_js_decorate([(0,p.mm)("SET_HELP_AUTO_START"),loginvue_type_script_lang_js_metadata("design:type",Function)],g.prototype,"setHelpAutoStart",void 0),g=loginvue_type_script_lang_js_decorate([(0,l.Component)({metaInfo(){return{title:this.$gettext("Вход")}}})],g);const v=g,f=v;var y=s(51900),b=s(43453),m=s.n(b),C=s(82127),_=s(17024),w=s(66530),x=s(83240),k=s(57894),S=s(22528),L=(0,y.Z)(f,render,o,!1,null,"f1907e04",null);const $=L.exports;m()(L,{VBtn:C.Z,VCol:_.Z,VContainer:w.Z,VForm:x.Z,VRow:k.Z,VTextField:S.Z})}}]);